<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Моделювання складних систем у Python - 7&nbsp; Лабораторна робота № 7</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./lab_8.html" rel="next">
<link href="./lab_6.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Пошук не дав результату",
    "search-matching-documents-text": "Результати пошуку",
    "search-copy-link-title": "Скопіюйте посилання для пошуку",
    "search-hide-matches-text": "Приховати додаткові результати",
    "search-more-match-text": "Додатковий результат у цьому документі",
    "search-more-matches-text": "Додаткові результати у цьому документі",
    "search-clear-button-title": "Очистити",
    "search-detached-cancel-button-title": "Скасувати",
    "search-submit-button-title": "Надіслати",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./lab_7.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Лабораторна робота № 7</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Моделювання складних систем у Python</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/Butman2099/Complex-systems-book" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./Моделювання-складних-систем-у-Python.docx" rel="" title="Download Docx" class="quarto-navigation-tool px-1" aria-label="Download Docx"><i class="bi bi-file-word"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Передмова</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Лабораторна робота № 1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Лабораторна робота № 2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Лабораторна робота № 3</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Лабораторна робота № 4</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Лабораторна робота № 5</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Лабораторна робота № 6</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_7.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Лабораторна робота № 7</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Лабораторна робота № 8</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Лабораторна робота № 9</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Лабораторна робота № 10</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Лабораторна робота № 11</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Лабораторна робота № 12</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Лабораторна робота № 13</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_14.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Лабораторна робота № 14</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Додатки</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Інструкція зі встановлення Anaconda Navigator</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appb.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Вступ до мови програмування Python</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Основи Jupyter Notebook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Список рекомендованої літератури</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Зміст</h2>
   
  <ul>
  <li><a href="#теоретичні-відомості" id="toc-теоретичні-відомості" class="nav-link active" data-scroll-target="#теоретичні-відомості"><span class="header-section-number">7.1</span> Теоретичні відомості</a>
  <ul class="collapse">
  <li><a href="#визначення-мультифракталів" id="toc-визначення-мультифракталів" class="nav-link" data-scroll-target="#визначення-мультифракталів"><span class="header-section-number">7.1.1</span> Визначення мультифракталів</a></li>
  <li><a href="#узагальнені-фрактальні-розмірності-d_q" id="toc-узагальнені-фрактальні-розмірності-d_q" class="nav-link" data-scroll-target="#узагальнені-фрактальні-розмірності-d_q"><span class="header-section-number">7.1.2</span> Узагальнені фрактальні розмірності <span class="math inline">\(D_{q}\)</span></a></li>
  <li><a href="#функція-мультифрактального-спектра-falpha" id="toc-функція-мультифрактального-спектра-falpha" class="nav-link" data-scroll-target="#функція-мультифрактального-спектра-falpha"><span class="header-section-number">7.1.3</span> Функція мультифрактального спектра <span class="math inline">\(f(\alpha)\)</span></a></li>
  <li><a href="#мультифрактальний-аналіз-детрендованих-флуктуацій" id="toc-мультифрактальний-аналіз-детрендованих-флуктуацій" class="nav-link" data-scroll-target="#мультифрактальний-аналіз-детрендованих-флуктуацій"><span class="header-section-number">7.1.4</span> Мультифрактальний аналіз детрендованих флуктуацій</a></li>
  </ul></li>
  <li><a href="#хід-роботи" id="toc-хід-роботи" class="nav-link" data-scroll-target="#хід-роботи"><span class="header-section-number">7.2</span> Хід роботи</a>
  <ul class="collapse">
  <li><a href="#ширина-спектра-мультифрактальності-deltaalpha" id="toc-ширина-спектра-мультифрактальності-deltaalpha" class="nav-link" data-scroll-target="#ширина-спектра-мультифрактальності-deltaalpha"><span class="header-section-number">7.2.1</span> Ширина спектра мультифрактальності (<span class="math inline">\(\Delta\alpha\)</span>)</a></li>
  <li><a href="#різниця-між-кінцями-спектра-мультифрактальності-delta-f" id="toc-різниця-між-кінцями-спектра-мультифрактальності-delta-f" class="nav-link" data-scroll-target="#різниця-між-кінцями-спектра-мультифрактальності-delta-f"><span class="header-section-number">7.2.2</span> Різниця між кінцями спектра мультифрактальності (<span class="math inline">\(\Delta f\)</span>)</a></li>
  <li><a href="#ширина-лівого-deltaalpha_l-та-правого-deltaalpha_r-хвостів-мультифрактального-спектра" id="toc-ширина-лівого-deltaalpha_l-та-правого-deltaalpha_r-хвостів-мультифрактального-спектра" class="nav-link" data-scroll-target="#ширина-лівого-deltaalpha_l-та-правого-deltaalpha_r-хвостів-мультифрактального-спектра"><span class="header-section-number">7.2.3</span> Ширина лівого (<span class="math inline">\(\Delta\alpha_{L}\)</span>) та правого (<span class="math inline">\(\Delta\alpha_{R}\)</span>) хвостів мультифрактального спектра</a></li>
  <li><a href="#показник-сингулярності-alpha-та-його-різновиди" id="toc-показник-сингулярності-alpha-та-його-різновиди" class="nav-link" data-scroll-target="#показник-сингулярності-alpha-та-його-різновиди"><span class="header-section-number">7.2.4</span> Показник сингулярності <span class="math inline">\(\alpha\)</span> та його різновиди</a></li>
  <li><a href="#тип-довгого-хвоста-мультифрактального-спектра-delta-s" id="toc-тип-довгого-хвоста-мультифрактального-спектра-delta-s" class="nav-link" data-scroll-target="#тип-довгого-хвоста-мультифрактального-спектра-delta-s"><span class="header-section-number">7.2.5</span> Тип довгого хвоста мультифрактального спектра (<span class="math inline">\(\Delta S\)</span>)</a></li>
  <li><a href="#показник-асиметрії-a" id="toc-показник-асиметрії-a" class="nav-link" data-scroll-target="#показник-асиметрії-a"><span class="header-section-number">7.2.6</span> Показник асиметрії <span class="math inline">\(A\)</span></a></li>
  <li><a href="#індекс-h-флуктуацій-hfi" id="toc-індекс-h-флуктуацій-hfi" class="nav-link" data-scroll-target="#індекс-h-флуктуацій-hfi"><span class="header-section-number">7.2.7</span> Індекс <span class="math inline">\(h\)</span>-флуктуацій (<span class="math inline">\(hFI\)</span>)</a></li>
  <li><a href="#кумулятивний-індекс-інкрементів-узагальнених-показників-херста-alpha-cf" id="toc-кумулятивний-індекс-інкрементів-узагальнених-показників-херста-alpha-cf" class="nav-link" data-scroll-target="#кумулятивний-індекс-інкрементів-узагальнених-показників-херста-alpha-cf"><span class="header-section-number">7.2.8</span> Кумулятивний індекс інкрементів узагальнених показників Херста (<span class="math inline">\(\alpha CF\)</span>)</a></li>
  <li><a href="#інтегральна-мультифрактальна-теплоємність-cq" id="toc-інтегральна-мультифрактальна-теплоємність-cq" class="nav-link" data-scroll-target="#інтегральна-мультифрактальна-теплоємність-cq"><span class="header-section-number">7.2.9</span> Інтегральна мультифрактальна теплоємність <span class="math inline">\(C(q)\)</span></a></li>
  <li><a href="#хаусдорфова-розмірність-d_0" id="toc-хаусдорфова-розмірність-d_0" class="nav-link" data-scroll-target="#хаусдорфова-розмірність-d_0"><span class="header-section-number">7.2.10</span> Хаусдорфова розмірність (<span class="math inline">\(D_{0}\)</span>)</a></li>
  <li><a href="#інформаційна-розмірність-d_1" id="toc-інформаційна-розмірність-d_1" class="nav-link" data-scroll-target="#інформаційна-розмірність-d_1"><span class="header-section-number">7.2.11</span> Інформаційна розмірність (<span class="math inline">\(D_{1}\)</span>)</a></li>
  <li><a href="#кореляційна-розмірність-d_2" id="toc-кореляційна-розмірність-d_2" class="nav-link" data-scroll-target="#кореляційна-розмірність-d_2"><span class="header-section-number">7.2.12</span> Кореляційна розмірність (<span class="math inline">\(D_{2}\)</span>)</a></li>
  <li><a href="#кривизна-лівого-delta-d_l-та-правого-delta-d_r-хвостів-розподілу-узагальнених-фрактальних-розмірностей" id="toc-кривизна-лівого-delta-d_l-та-правого-delta-d_r-хвостів-розподілу-узагальнених-фрактальних-розмірностей" class="nav-link" data-scroll-target="#кривизна-лівого-delta-d_l-та-правого-delta-d_r-хвостів-розподілу-узагальнених-фрактальних-розмірностей"><span class="header-section-number">7.2.13</span> Кривизна лівого (<span class="math inline">\(\Delta D_{L}\)</span>) та правого (<span class="math inline">\(\Delta D_{R}\)</span>) хвостів розподілу узагальнених фрактальних розмірностей</a></li>
  <li><a href="#дво--та-тривимірна-візуалізація-показників-мультифрактальності" id="toc-дво--та-тривимірна-візуалізація-показників-мультифрактальності" class="nav-link" data-scroll-target="#дво--та-тривимірна-візуалізація-показників-мультифрактальності"><span class="header-section-number">7.2.14</span> Дво- та тривимірна візуалізація показників мультифрактальності</a></li>
  </ul></li>
  <li><a href="#завдання-для-виконання" id="toc-завдання-для-виконання" class="nav-link" data-scroll-target="#завдання-для-виконання"><span class="header-section-number">7.3</span> Завдання для виконання</a></li>
  <li><a href="#контрольні-запитання" id="toc-контрольні-запитання" class="nav-link" data-scroll-target="#контрольні-запитання"><span class="header-section-number">7.4</span> Контрольні запитання</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.dev/Butman2099/Complex-systems-book/blob/main/lab_7.ipynb" class="toc-action">Редагувати сторінку</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Лабораторна робота № 7</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><strong>Тема.</strong> Мультифрактальний аналіз складних систем</p>
<p><strong>Мета.</strong> Навчитися використовувати мультифрактальний аналіз детрендованих флуктуацій для отримання індикаторів нелінійних змін у системі</p>
<section id="теоретичні-відомості" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="теоретичні-відомості"><span class="header-section-number">7.1</span> Теоретичні відомості</h2>
<section id="визначення-мультифракталів" class="level3" data-number="7.1.1">
<h3 data-number="7.1.1" class="anchored" data-anchor-id="визначення-мультифракталів"><span class="header-section-number">7.1.1</span> Визначення мультифракталів</h3>
<p>У цій лабораторній ми викладемо основи теорії мультифракталів — <strong>неоднорідних фрактальних об’єктів</strong>, для повного опису яких, на відміну від регулярних фракталів, недостатньо введення лише однієї величини, його фрактальної розмірності <span class="math inline">\(D\)</span>, а потрібен цілий спектр таких розмірностей, кількість яких, взагалі кажучи, нескінченна. Причина цього полягає в тому, що поряд із суто геометричними характеристиками, які визначаються величиною <span class="math inline">\(D\)</span>, такі фрактали характеризуються й деякими специфічними статистичними властивостями.</p>
<p>Простіше всього пояснити, що розуміється під “неоднорідним фракталом” на прикладі трикутника Серпинського, отриманого за допомогою методу випадкових ітерацій (<a href="#fig-triangle">Рис.&nbsp;<span>7.1</span></a>).</p>
<div id="fig-triangle" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Images\lab_7\triangle.jpg" style="height:10cm" class="figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.1: Трикутник Серпинського, області якого згенеровані з різними ймовірностями</figcaption>
</figure>
</div>
<p>Припустимо, що в методі випадкових ітерацій ми тепер із якоїсь причини віддали перевагу одній із вершин трикутника, наприклад, вершині А, і стали вибирати її з імовірністю 90%. Дві ж інші вершини В і С для нас рівноцінні, але на їхню частку тепер припадає всього лише по 5%. Результат такої несиметричної гри” зображено нижче на рисунку вище.</p>
<p>Видно, що точки всередині трикутника АВС розподілені тепер вкрай нерівномірно. Більша їх частина перебуває біля вершини А та її прообразів. Водночас у вершин В і С (і їхніх прообразів) їх є вкрай мало. Проте, за звичайною термінологією, ця множина точок (за умови прагнення числа ітерацій до нескінченності) є фракталом, тому що збереглася основна властивість фрактала — самоподібність. Дійсно, трикутник DFC, хоча в ньому у 20 разів менше точок, за своїми статистичними і геометричними властивостями повністю подібний до великого трикутника АВС. Так само, як і у великому трикутнику, точки в ньому концентруються здебільшого поблизу вершини D — аналогу вершини А.</p>
<p><a href="#fig-dist-serp">Рис.&nbsp;<span>7.2</span></a> більш детально демонструє результуючий розподіл точок по трикутнику Серпинського. Цифри в кожному з маленьких трикутників показують його відносну заселеність точками множини.</p>
<div id="fig-dist-serp" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Images\lab_7\distribution_of_points.jpg" style="height:6cm" class="figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.2: Розподіл точок по трикутнику Серпинського, представленого на попередньому рисунку</figcaption>
</figure>
</div>
<p>Однак, не дивлячись на нерівномірність розподілу точок фрактала, фрактальна розмірність залишилась при цьому такою ж, <span class="math inline">\(D=\ln{3}/\ln{2}\)</span>. Покриття цієї множини все меншими трикутниками можна здійснити по тому ж алгоритму, що й раніше. Таке співпадіння змушує замислитись над пошуком нових кількісних характеристик, котрі могли б відрізнити нерівномірний розподіл точок від рівномірного.</p>
<p>Інший, складніший приклад неоднорідного фрактала, який ми б хотіли ще навести, показано на наступному рисунку. Ліворуч продемонстровано великий квадрат зі стороною, що дорівнює одиниці, який на цьому (нульовому) етапі повністю покриває собою деяку фрактальну множину точок <span class="math inline">\(M\)</span>. На наступному (першому) етапі, у центрі рисунка, показано, як ту саму множину можна покрити трьома меншими квадратами зі сторонами <span class="math inline">\(l_1=1/2, \ l_2=l_3=5/16\)</span>, у яких, відповідно, міститься частка <span class="math inline">\(p_1=1/2, \ p_2=1/3\)</span> та <span class="math inline">\(p_3=1/6\)</span> усіх точок.</p>
<div id="fig-dist-square" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Images\lab_7\square_fractal.jpg" style="height:6.5cm" class="figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.3: Приклад мультифрактала, що підкоряється ренормалізаційній схемі</figcaption>
</figure>
</div>
<p>Наступний етап покриття (зображений на рисунку праворуч) містить уже 9 квадратів зі сторонами <span class="math inline">\(l_{1}^{2}=1/4, \ l_{1}l_{2}=l_{1}l_{3}=5/32\)</span> (у нижньому правому куті) і <span class="math inline">\(l_{2}l_{1}=5/32, \ l_{2}^{2}=l_{2}l_{3}=25/256\)</span> (угорі праворуч і ліворуч). Відносна заселеність цих квадратів точками множини показана на рисунку. Вона відповідає добутку чинників заселеності (імовірностей): <span class="math inline">\(p_{1}^{2}=1/4, \ p_{1}p_{2}=1/6, \ p_{1}p_{3}=1/12\)</span> — для нижньої правої групи, <span class="math inline">\(p_{2}p_{1}=1/6, \ p_{2}^{2}=1/9, \ p_{2}p_{3} = 1/18\)</span> — для верхньої лівої та <span class="math inline">\(p_{3}p_{1}=1/12, \ p_{3}p_{2}=1/18, \ p_{3}^{2}=1/36\)</span> — для верхньої правої групи. Зазначимо, що є чітка відповідність між заселеністю квадрата <span class="math inline">\(p_{j}p_{i}\)</span> і його розмірами <span class="math inline">\(l_{i}l_{i}\)</span>.</p>
<p>Подальший процес розбиття і покриття множини <span class="math inline">\(M\)</span> здійснюється згідно із цією ренормалізаційною схемою. Кожен квадрат, що має на <span class="math inline">\(n\)</span>-му кроці розмір <span class="math inline">\(l\)</span> і заселеність <span class="math inline">\(р\)</span>, замінюється на <span class="math inline">\(n+1\)</span> кроці трьома квадратами з розмірами <span class="math inline">\(ll_{1}, \ ll_{2}, \ ll_{3}\)</span> і заселеностями <span class="math inline">\(pp_{1}, \ pp_{2}, \ pp_{3}\)</span> відповідно, розміщеними таким самим чином відносно один одного, як показано на <a href="#fig-dist-square">Рис.&nbsp;<span>7.3</span></a>.</p>
<p>Двоє з розглянутих вище випадки являють собою приклади неоднорідних фракталів. Під словом “неоднорідний” ми тут розуміємо нерівномірний розподіл точок множини по фракталу або нерівномірний розподіл малих та великих флуктуацій у часовому ряді. Причина неоднорідності в попередніх випадках одна й та сама — різні ймовірності заповнення геометрично однакових елементів фрактала, або в загальному випадку невідповідність імовірностей заповнення геометричним розмірам відповідних областей. Такі неоднорідні фрактальні об’єкти в літературі називають мультифракталами, і їх вивченням ми й займемося надалі.</p>
</section>
<section id="узагальнені-фрактальні-розмірності-d_q" class="level3" data-number="7.1.2">
<h3 data-number="7.1.2" class="anchored" data-anchor-id="узагальнені-фрактальні-розмірності-d_q"><span class="header-section-number">7.1.2</span> Узагальнені фрактальні розмірності <span class="math inline">\(D_{q}\)</span></h3>
<p>Дамо загальне визначення мультифрактала. Розглянемо фрактальний об’єкт, що займає якусь обмежену ділянку <span class="math inline">\(\Omega\)</span> розміру <span class="math inline">\(L\)</span> у Евклідовому просторі з розмірністю <span class="math inline">\(d\)</span>. Нехай на якомусь етапі його побудови він являє собою множину з <span class="math inline">\(N \gg 1\)</span> точок, якось розподілених у цій області. Ми будемо припускати, що врешті-решт <span class="math inline">\(N \to \infty\)</span>. Прикладом такої множини може слугувати трикутник Серпінського, побудований методом випадкових ітерацій. Кожен крок ітераційної процедури додає до цієї множини одну нову точку.</p>
<p>Розіб’ємо всю область <span class="math inline">\(\Omega\)</span> на кубічні клітинки зі стороною <span class="math inline">\(\varepsilon \ll L\)</span> та об’ємом <span class="math inline">\(\varepsilon^{d}\)</span>. Далі нас будуть цікавити тільки зайняті клітинки, у яких міститься хоча б одна точка. Нехай номер зайнятих комірок <span class="math inline">\(i\)</span> змінюється в межах <span class="math inline">\(і=1, 2,..., N(\varepsilon)\)</span>, де <span class="math inline">\(N(\varepsilon)\)</span> — сумарна кількість зайнятих клітинок, яка, звісно, залежить від розміру клітинки <span class="math inline">\(\varepsilon\)</span>.</p>
<p>Нехай <span class="math inline">\(n_{i}(\varepsilon)\)</span> представляє собою кількість точок у клітинці з номером <span class="math inline">\(i\)</span>, тоді величина <span class="math inline">\(p_{i}(\varepsilon) = \lim_{N\to\infty}n_{i}(\varepsilon)/{N}\)</span> представляє собою ймовірність того, що навмання взята точка з нашої множини знаходиться в комірці <span class="math inline">\(i\)</span>. Інакше кажучи, ймовірності <span class="math inline">\(р_{i}\)</span> характеризують відносну заселеність комірок. З умови нормування ймовірності випливає, що</p>
<p><span class="math display">\[
\sum_{i=1}^{N(\varepsilon)}p_{i}(\varepsilon)=1.
\]</span></p>
<p>Уведемо тепер у розгляд <strong>узагальнену статистичну суму</strong> <span class="math inline">\(Z(q,\varepsilon)\)</span>, що характеризується показником ступеня <span class="math inline">\(q\)</span>, який може набувати будь-яких значень в інтервалі <span class="math inline">\(-\infty&lt;q&lt;+\infty\)</span></p>
<p><span class="math display">\[
Z(q,\varepsilon)=\sum_{i=1}^{N(\varepsilon)}p_{i}^{q}(\varepsilon).
\]</span></p>
<p>Спектр <strong>узагальнених фрактальних розмірностей</strong> <span class="math inline">\(D_{q}\)</span>, що характеризує даний розподіл точок в області <span class="math inline">\(\Omega\)</span>, визначається за допомогою співвідношення <span class="math inline">\(D_{q} = \tau(q)\big/(q-1)\)</span>, де функція <span class="math inline">\(\tau(q)\)</span> має вид</p>
<p><span class="math display">\[
\tau(q)=\lim_{\varepsilon\to 0} \ln{Z(q,\varepsilon)} \big/ \ln{\varepsilon}.
\]</span></p>
<p>Як ми покажемо нижче, якщо <span class="math inline">\(D_{q}=D=\text{const}\)</span>, тобто не залежить від <span class="math inline">\(q\)</span>, то дана множина точок являє собою звичайний, регулярний фрактал, який характеризується лише однією величиною — фрактальною розмірністю <span class="math inline">\(D\)</span>. Навпаки, якщо функція <span class="math inline">\(D_{q}\)</span> якось змінюється з <span class="math inline">\(q\)</span>, то розглянута множина точок представляє мультифрактал.</p>
<p>Таким чином, мультифрактал у загальному випадку характеризується деякою <strong>нелінійною</strong> функцією <span class="math inline">\(\tau(q)\)</span>, що визначає поведінку статистичної суми <span class="math inline">\(Z(q,\varepsilon)\)</span> при <span class="math inline">\(\varepsilon\to 0\)</span></p>
<p><span id="eq-1"><span class="math display">\[
Z(q,\varepsilon)=\sum_{i=1}^{N(\varepsilon)}p_{i}^{q}(\varepsilon) \approx \varepsilon^{\tau(q)}.
\tag{7.1}\]</span></span></p>
<p>Слід мати на увазі, що в реальній ситуації ми завжди маємо скінченне, хоча й дуже велике число дискретних точок <span class="math inline">\(N\)</span>, тому при комп’ютерному моделюванні конкретної множини граничний перехід <span class="math inline">\(\varepsilon\to 0\)</span> треба виконувати з обережністю, пам’ятаючи, що йому завжди передує ліміт <span class="math inline">\(N \to 0\)</span>.</p>
<p>Покажемо тепер, як поводиться узагальнена статистична сума у випадку звичайного регулярного фрактала з фрактальною розмірністю <span class="math inline">\(D\)</span>. У цьому випадку в усіх зайнятих комірках міститься однакова кількість точок, <span class="math inline">\(n_{i}(\varepsilon) = N \big/ N(\varepsilon)\)</span>, тобто фрактал представляється <strong>однорідним</strong>. Тоді очевидно, що відносні населеності клітинок, <span class="math inline">\(p_{i}(\varepsilon)=1/N(\varepsilon)\)</span>, також однакові, і узагальнена статистична сума набуває вигляду</p>
<p><span id="eq-2"><span class="math display">\[
Z(q,\varepsilon) = N^{1-q}(\varepsilon).
\tag{7.2}\]</span></span></p>
<p>Врахуємо тепер, що, згідно визначеню фрактальної розмірності <span class="math inline">\(D\)</span>, кількість зайнятих клітинок при достатньо малому <span class="math inline">\(\varepsilon\)</span> поводить себе наступним чином:</p>
<p><span id="eq-3"><span class="math display">\[
N(\varepsilon) \approx \varepsilon^{-D}.
\tag{7.3}\]</span></span></p>
<p>Підставляючи (<a href="#eq-3"><span>7.3</span></a>) у (<a href="#eq-2"><span>7.2</span></a>), і порівнюючи з (<a href="#eq-1"><span>7.1</span></a>), отримуємо</p>
<p><span id="eq-4"><span class="math display">\[
\varepsilon^{\tau(q)} = \varepsilon^{-D(1-q)} \to \tau(q)=(q-1)D.
\tag{7.4}\]</span></span></p>
<p>Ми приходимо до висновку, що у випадку звичайного фрактала функція (<a href="#eq-4"><span>7.4</span></a>) є лінійною. Тоді всі <span class="math inline">\(D_{q}\)</span> дійсно не залежать від <span class="math inline">\(q\)</span>. Фрактал у якого всі узагальнені фрактальні розмірності <span class="math inline">\(D_{q}\)</span> співпадають називається <strong>монофракталом</strong>.</p>
<p>Якщо розподіл точок по клітинкам неоднаковий, тоді фрактал називається неоднорідним, тобто представляє із себе мультифрактал, і для його характеристики необхідний цілий спектр узагальнених фрактальних розмірностей <span class="math inline">\(D_{q}\)</span>, кількість котрих, у загальному випадку, нескінченна.</p>
<p>Так, наприклад, при <span class="math inline">\(q \to +\infty\)</span> основний внесок в узагальнену статистичну суму (<a href="#eq-1"><span>7.1</span></a>) вносять комірки, що містять найбільшу кількість частинок <span class="math inline">\(n_{i}\)</span> у них і, відповідно, що характеризуються найбільшою ймовірністю їх заповнення <span class="math inline">\(p_{i}\)</span>. Навпаки, при <span class="math inline">\(q \to -\infty\)</span> основний внесок в узагальнену статистичну суму вносять найбільш розрідженні комірки з найменшою ймовірністю їх заповнення <span class="math inline">\(p_{i}\)</span>. Таким чином, функція <span class="math inline">\(D_{q}\)</span> показує, наскільки неоднорідним представляється досліджувана множина точок <span class="math inline">\(\Omega\)</span>.</p>
<p>У подальшому для характеристики розподілу точок необхідно знати не тільки функцію <span class="math inline">\(\tau(q)\)</span>, але і її похідну:</p>
<p><span class="math display">\[
\frac{d\tau(q)}{dq} = \lim_{\varepsilon\to 0} \sum_{i=1}^{N(\varepsilon)}p_{i}^{q}\ln{p_{i}} \Bigg/ \left( \sum_{i=1}^{N(\varepsilon)}p_{i}^{q} \right)\ln{\varepsilon}.
\]</span></p>
<p>Ця похідна має важливий фізичний зміст, який буде продемонстровано пізніше. Зараз знову зазначимо, що для мультифрактальної системи вона не залишається константною і змінюється з <span class="math inline">\(q\)</span>.</p>
</section>
<section id="функція-мультифрактального-спектра-falpha" class="level3" data-number="7.1.3">
<h3 data-number="7.1.3" class="anchored" data-anchor-id="функція-мультифрактального-спектра-falpha"><span class="header-section-number">7.1.3</span> Функція мультифрактального спектра <span class="math inline">\(f(\alpha)\)</span></h3>
<section id="спектр-фрактальних-розмірностей" class="level4" data-number="7.1.3.1">
<h4 data-number="7.1.3.1" class="anchored" data-anchor-id="спектр-фрактальних-розмірностей"><span class="header-section-number">7.1.3.1</span> Спектр фрактальних розмірностей</h4>
<p>У попередньому пункті ми ввели поняття мультифрактала — об’єкта, що представляє собою неоднорідний фрактал. Для його опису ми ввели множину узагальнених фрактальних розмірностей <span class="math inline">\(D_{q}\)</span>, де <span class="math inline">\(q\)</span> приймає будь-які значення в інтервалі <span class="math inline">\(-\infty&lt;q&lt;+\infty\)</span>. Однак величини <span class="math inline">\(D_{q}\)</span> не є, строго кажучи, фрактальними розмірностями в загальному розумінні цього слова.</p>
<p>Тому часто поряд із ними для характеристики мультифрактальної множини використовують так звану <strong>функцію мультифрактального спектра</strong> <span class="math inline">\(f(\alpha)\)</span> (спектр сингулярностей мультифрактала), до якої, як ми побачимо надалі, більше підходить термін фрактальна розмірність. Ми покажемо, що величина <span class="math inline">\(f(\alpha)\)</span> фактично дорівнює хаусдорфовій розмірності якоїсь однорідної фрактальної підмножини із вихідної множини <span class="math inline">\(\Omega\)</span>, що дає домінантний внесок у статистичну суму при заданій величині <span class="math inline">\(q\)</span>.</p>
<p>Однією з основних характеристик мультифрактала є набір імовірностей <span class="math inline">\(р_{i}\)</span>, що показують відносну заселеність клітинок <span class="math inline">\(\varepsilon\)</span>, якими ми покриваємо цю множину. Чим менший розмір клітинки, тим менша величина її заселеності. Для самоподібних множин залежність <span class="math inline">\(p_{i}\)</span> від розміру клітинки <span class="math inline">\(\varepsilon\)</span> має степеневий характер:</p>
<p><span class="math display">\[
p_{i}(\varepsilon) \approx \varepsilon^{\alpha_{i}},
\]</span></p>
<p>де <span class="math inline">\(\alpha_{i}\)</span> являє собою деякий показник ступеня (різний для різнок клітинок <span class="math inline">\(i\)</span>).</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Додатково по <span class="math inline">\(\alpha\)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Спрямовуючи значення <span class="math inline">\(\varepsilon\)</span> до нуля, фрактальність можна розглядати локально для кожної точки (елемента) досліджуваної системи, і таким чином показник <span class="math inline">\(\alpha\)</span> є локальною фрактальною розмірністю. Його ще називають <em>показником Гьолдера</em> або <em>силою сингулярності</em></p>
<p>Можемо спостерігати саме степеневу залежність, оскільки, вочевидь, розподіл маси (флуктуацій) концентрується з різною “силою” <span class="math inline">\(\alpha\)</span>, тож і ймовірнісна міра змінюється пропорційно розмірам вікон <span class="math inline">\(\varepsilon\)</span></p>
</div>
</div>
<div id="fig-alpha-dependence" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Images\lab_7\alpha.jpg" style="height:8cm" class="figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.4: Схематичне представлення залежності сили сингулярності та густини порівняно з околицями</figcaption>
</figure>
</div>
<p>Сірий масштаб являє собою ймовірнісну міру для кожної локації, як показано на кожній панелі. На рисунку (a) тільки <span class="math inline">\(i\)</span>-та локація має ненульову щільність, інші місця порожні. Імовірнісна міра на комірці залишається <span class="math inline">\(\rho\)</span>, навіть коли розмір клітинки <span class="math inline">\(\varepsilon\)</span> збільшується. <span class="math inline">\(\varepsilon\)</span> збільшується, що підкреслюється жирною лінією. Проте, через те, що далі ми не спостерігаємо зростання щільності, показник <span class="math inline">\(\alpha\)</span> залишається нульовим. На <a href="#fig-alpha-dependence">Рис.&nbsp;<span>7.22</span></a> (b) усі комірки мають однакову щільність. Імовірнісні міри комірок дорівнюють <span class="math inline">\(\rho\)</span>, <span class="math inline">\(9\rho\)</span> і <span class="math inline">\(25\rho\)</span> для найменшої, другої найменшої та найбільшої комірки (виділено жирною лінією). Таким чином, сила сингулярності <span class="math inline">\(i\)</span>-го осередку дорівнює 2. На <a href="#fig-alpha-dependence">Рис.&nbsp;<span>7.22</span></a> (c) <span class="math inline">\(i\)</span>-й осередок є розрідженим порівняно з навколишніми осередками. Імовірнісна міра осередків дорівнює <span class="math inline">\(\rho\)</span>, <span class="math inline">\(27\rho\)</span> і <span class="math inline">\(125\rho\)</span> для найменшого, другого найменшого і найбільшого осередку (виділено жирною лінією). Таким чином, сила сингулярності <span class="math inline">\(i\)</span>-ої комірки дорівнює 3.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Додатково по <span class="math inline">\(\alpha\)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Можна сказати, що чим більш гладкою видається поверхня системи, чим менше елементів задіяно в її розвитку, тим меншим є показник сингулярності. Що більше елементів системи вступають у взаємозв’язок один з одним, що більше процесів протікає під час еволюції системи, то більшим є показник сингулярності</p>
</div>
</div>
<p>Відомо, що для регулярного (однорідного) фрактала всі показники ступеня <span class="math inline">\(\alpha_{i}\)</span> однакові й рівні фрактальній розмірності <span class="math inline">\(D\)</span>:</p>
<p><span class="math display">\[
p_{i} = 1 \big/ N(\varepsilon) \approx \varepsilon^{D}.
\]</span></p>
<p>У даному випадку статистична сума <a href="#eq-1">Рівняння&nbsp;<span>7.1</span></a> приймає наступний вигляд:</p>
<p><span class="math display">\[
Z(q,\varepsilon) = \sum_{i=1}^{N(\varepsilon)}p_{i}^{q}(\varepsilon) = N(\varepsilon)\varepsilon^{Dq}=\varepsilon^{-D}\varepsilon^{Dq} \approx \varepsilon^{D(q-1)}.
\]</span></p>
<p>Тому <span class="math inline">\(\tau(q)=D(q-1)\)</span> і всі узагальнені фрактальні розмірності <span class="math inline">\(D_{q}=D\)</span> у цьому випадку співпадають та не залежать від <span class="math inline">\(q\)</span>.</p>
<p>Однак, для такого складного об’єкта, як мультифрактал, унаслідок його неоднорідності, ймовірності заповнення клітинок <span class="math inline">\(p_{i}\)</span> у загальному випадку різняться, і показник ступеня <span class="math inline">\(\alpha_{i}\)</span> для різних клітинок може приймати різні значення. Достатньо типовою є ситуація, коли ці значення неперервно заповнюють деякий закритий інтервал <span class="math inline">\(\left( \alpha_{min}, \alpha_{max} \right)\)</span>, причому <span class="math inline">\(p_{min} \approx \varepsilon^{\alpha_{max}}\)</span>, a <span class="math inline">\(p_{max} \approx \varepsilon^{\alpha_{min}}\)</span>.</p>
<p>Тепер перейдемо до питання розподілу ймовірностей різних значень <span class="math inline">\(\alpha_{i}\)</span>. Нехай <span class="math inline">\(n(\alpha)d\alpha\)</span> є ймовірністю того, що <span class="math inline">\(\alpha_{i}\)</span> знаходиться в інтервалі від <span class="math inline">\(\alpha\)</span> до <span class="math inline">\(\alpha+d\alpha\)</span>. Іншими словами, <span class="math inline">\(n(\alpha)d\alpha\)</span> представляє собою відносну кількість клітинок <span class="math inline">\(i\)</span>, що характеризуються однією і тією самою мірою <span class="math inline">\(p_{i}\)</span> з <span class="math inline">\(\alpha_{i}\)</span>, що лежать у цьому інтервалі. У випадку монофрактала, для котрого всі <span class="math inline">\(\alpha_{i}\)</span> однакові (і рівні фрактальній розмірності <span class="math inline">\(D\)</span>), це число, очевидно, пропорційно повній кількості клітинок <span class="math inline">\(N(\varepsilon) \approx \varepsilon^{-D}\)</span>, степеневим чином залежних від розміру клітинки <span class="math inline">\(\varepsilon\)</span>. Показник степеня в цьому співвідношені визначається фрактальною розмірністю множини <span class="math inline">\(D\)</span>.</p>
<p>Для мультифрактала, однак, це не так, і різні значення <span class="math inline">\(\alpha_{i}\)</span> зустрічаються з ймовірністю, що характеризується не однією і тією ж величиною <span class="math inline">\(D\)</span>, а різними (в залежності від <span class="math inline">\(\alpha\)</span>) значеннями показниками степеня <span class="math inline">\(f(\alpha)\)</span>,</p>
<p><span id="eq-5"><span class="math display">\[
n(\alpha) \approx \varepsilon^{-f(\alpha)}.
\tag{7.5}\]</span></span></p>
<p>Таким чином, фізичний сенс функції <span class="math inline">\(f(\alpha)\)</span> полягає в тому, що вона представляє собою розмірність Хаусдорфа деякої однорідної підмножини <span class="math inline">\(\Omega_{\alpha}\)</span> із вихідної множини <span class="math inline">\(\Omega\)</span>, що характеризується однаковими ймовірностями заповнення клітинок <span class="math inline">\(p_{i} \approx \varepsilon^{\alpha}\)</span>. Оскільки фрактальна розмірність підмножини очевидно завжди менша або рівна фрактальній розмірності вихідної множини <span class="math inline">\(D_{0}\)</span>, має місце важлива нерівність для функції <span class="math inline">\(f(\alpha)\)</span>:</p>
<p><span class="math display">\[
f(\alpha) \leq D_{0}.
\]</span></p>
<p>У результаті можна зробити висновок, що множина різних значень функції <span class="math inline">\(f(\alpha)\)</span> (при різних <span class="math inline">\(\alpha\)</span>) представляє собою <strong>спектр фрактальних розмірностей</strong> <span class="citation" data-cites="PhysRevA.33.1141 frisch1985turbulence">&nbsp;[<a href="references.html#ref-PhysRevA.33.1141" role="doc-biblioref">1</a>,<a href="references.html#ref-frisch1985turbulence" role="doc-biblioref">2</a>]</span> однорідних підмножин <span class="math inline">\(\Omega_{\alpha}\)</span>, на які можна розбити вихідну множину <span class="math inline">\(\Omega\)</span>, кожна з яких характеризується власним значенням фрактальної розмірності <span class="math inline">\(f(\alpha)\)</span>.</p>
</section>
<section id="перетворення-лежандра" class="level4" data-number="7.1.3.2">
<h4 data-number="7.1.3.2" class="anchored" data-anchor-id="перетворення-лежандра"><span class="header-section-number">7.1.3.2</span> Перетворення Лежандра</h4>
<p>Встановимо зв’язок функції <span class="math inline">\(f(\alpha)\)</span> із введенною раніше функцією <span class="math inline">\(\tau(q)\)</span>. Обчислимо для цього статистичну суму <span class="math inline">\(Z(q,\varepsilon)\)</span>. Підставляючи у <span class="math inline">\(Z(q,\varepsilon)\)</span> ймовірності <span class="math inline">\(p_i \approx \varepsilon^{\alpha_i}\)</span>, та переходячи від підсумовування по <span class="math inline">\(i\)</span> до інтегрування по <span class="math inline">\(\alpha\)</span> з щільністю ймовірностей (<a href="#eq-5"><span>7.5</span></a>), отримаємо</p>
<p><span id="eq-6"><span class="math display">\[
Z(q,\varepsilon) = \sum_{i=1}^{N(\varepsilon)} p_{i}^{q}(\varepsilon) \approx \int d\alpha n(\alpha)\varepsilon^{q\alpha} \approx \int d\alpha\varepsilon^{q\alpha-f(\alpha)}.
\tag{7.6}\]</span></span></p>
<p>Так як величина <span class="math inline">\(\varepsilon\)</span> дуже мала, основний внесок у цей інтеграл вноситимуть ті значення <span class="math inline">\(\alpha(q)\)</span>, при яких показник степеня <span class="math inline">\(q\alpha-f(\alpha)\)</span> виявляється мінімальним (а підінтегральна функція — максимальною). Цей вклад буде пропорційним значенню підінтегральної функції у точці максимума. Саме ж значення <span class="math inline">\(\alpha(q)\)</span> визначається при цьому з наступної умови:</p>
<p><span class="math display">\[
\left. \frac{d}{d\alpha}[ q\alpha-f(\alpha) ] \right \vert_{\alpha=\alpha(q)} = 0.
\]</span></p>
<p>Також, з умови мінімуму ми маємо</p>
<p><span class="math display">\[
\left. \frac{d^{2}}{d\alpha^{2}}[ q\alpha-f(\alpha) ] \right \vert_{\alpha=\alpha(q)} &gt; 0.
\]</span></p>
<p>У результаті отримуємо, що залежність <span class="math inline">\(\alpha(q)\)</span> неявним чином визначається з <span class="math inline">\(q = df(\alpha) \big/ d\alpha\)</span>, і що функція <span class="math inline">\(f(\alpha)\)</span> усюди є випуклою:</p>
<p><span class="math display">\[
f^{''}(\alpha)&gt;0.
\]</span></p>
<p>Це значить, що величина <span class="math inline">\(f(\alpha(q))\)</span> дійсно є фрактальною розмірністю підмножини <span class="math inline">\(\Omega_{\alpha(q)}\)</span>, що має найбільший домінуючий внесок у статистичну суму (<a href="#eq-6"><span>7.6</span></a>) при заданій величині показника ступеня <span class="math inline">\(q\)</span>.</p>
<p>Оскільки <span class="math inline">\(Z(q,\varepsilon)=\tau(q)\)</span>, приходимо до висновку, що</p>
<p><span id="eq-7"><span class="math display">\[
\tau(q) = q\alpha(q) - f(\alpha(q)).
\tag{7.7}\]</span></span></p>
<p>Пам’ятаючи, що <span class="math inline">\(\tau(q)=D(q-1)\)</span>, можемо віднайти функцію <span class="math inline">\(D_{q}\)</span>:</p>
<p><span id="eq-8"><span class="math display">\[
D_{q} = \frac{1}{q-1}[ q\alpha(q)-f(\alpha(q)) ].
\tag{7.8}\]</span></span></p>
<p>Таким чином, якщо ми знаємо функцію мультифрактального спектра <span class="math inline">\(f(\alpha)\)</span>, то за домомогою співвідношень (<a href="#eq-8"><span>7.8</span></a>) та (<a href="#eq-9"><span>7.9</span></a>) ми можемо знайти функцію <span class="math inline">\(D_{q}\)</span>. Навпаки, знаючи <span class="math inline">\(D_{q}\)</span>, ми можемо відтворити залежність <span class="math inline">\(\alpha(q)\)</span> за допомогою рівняння</p>
<p><span id="eq-9"><span class="math display">\[
\alpha(q) = \frac{d}{dq}[(q-1)D_{q}]
\tag{7.9}\]</span></span></p>
<p>і після цього знайти із (<a href="#eq-9"><span>7.9</span></a>) <span class="math inline">\(f(\alpha(q))\)</span>. Ці два рівняння і визначають функцію <span class="math inline">\(f(\alpha)\)</span>.</p>
<p><span class="math display">\[
\frac{d\tau}{dq}\frac{dq}{d\alpha} = q + \alpha\frac{dq}{d\alpha} - \frac{df}{d\alpha}.
\]</span></p>
<p>Приймаючи до уваги, що <span class="math inline">\(q=df/d\alpha\)</span>, і скорочуючи це рівняння на <span class="math inline">\(dq/d\alpha\)</span>, приходимо до співвідношення</p>
<p><span class="math display">\[
\alpha = \frac{d\tau(q)}{dq},
\]</span></p>
<p>яке еквівалентне (<a href="#eq-9"><span>7.9</span></a>).</p>
<p>Вирази для <span class="math inline">\(\tau(q)\)</span> та <span class="math inline">\(\alpha(q)\)</span> задають <strong>перетворення Лежандра</strong> <span class="citation" data-cites="GRASSBERGER1983227 HALSEY1987501">&nbsp;[<a href="references.html#ref-GRASSBERGER1983227" role="doc-biblioref">3</a>,<a href="references.html#ref-HALSEY1987501" role="doc-biblioref">4</a>]</span> від змінних <span class="math inline">\(\{ q, \tau(q) \}\)</span> до змінних <span class="math inline">\(\{\alpha, f(\alpha)\}\)</span>: <span class="math inline">\(\alpha = d\tau \big/ dq\)</span> та <span class="math inline">\(f(\alpha) = q\left( d\tau \big/ dq \right) - \tau(q)\)</span>. Як відомо, для однорідного фрактала <span class="math inline">\(D_{q}=D=\text{const}\)</span>. Тому <span class="math inline">\(\alpha=d\tau/dq=D\)</span> і <span class="math inline">\(f(\alpha)=q\alpha-\tau(q)=qD-D(q-1)=D\)</span>. У цьому випадку “графік” функції <span class="math inline">\(f(\alpha)\)</span> на площині <span class="math inline">\(\left( \alpha, f(\alpha) \right)\)</span> складається лише з однієї точки <span class="math inline">\(\left( D, D \right)\)</span>.</p>
</section>
</section>
<section id="мультифрактальний-аналіз-детрендованих-флуктуацій" class="level3" data-number="7.1.4">
<h3 data-number="7.1.4" class="anchored" data-anchor-id="мультифрактальний-аналіз-детрендованих-флуктуацій"><span class="header-section-number">7.1.4</span> Мультифрактальний аналіз детрендованих флуктуацій</h3>
<p>Монофрактальні та мультифрактальні структури фінансових сигналів є особливим різновидом масштабно-інваріантних структур. Найчастіше монофрактальна структура фінансових часових рядів визначається одним степеневим показником і передбачає, що масштабо-інваріантність не залежить від часу і простору. Однак, часто ми маємо змогу спостерігати просторово-часову варіацію масштабно-інваріантної структури досліджуваної складної системи. Ці просторово-часові варіації вказують на мультифрактальність фінансового сигналу, яка визначається мультифрактальним спектром. Мультифрактальний спектр може допомогти кількісно визначити асиметрію підйомів та спадів на фондовому чи криптовалютному ринках, передбачити фінансову кризу, що поступово наближується, і, таким чином, сприяти успішності подальших торгівельних рішень. Основна мета цього розділу — представити одну з найточніших процедур для визначення множини фрактальних показників — <strong>мультифрактальний аналіз детрендованих флуктуацій</strong> (multifractal detrended fluctuation analysis, MFDFA) <span class="citation" data-cites="KANTELHARDT2001441 Kantelhardt2011 KANTELHARDT200287">&nbsp;[<a href="references.html#ref-KANTELHARDT2001441" role="doc-biblioref">5</a>–<a href="references.html#ref-KANTELHARDT200287" role="doc-biblioref">7</a>]</span>, котрий і досі залишається одним із найпотужніших методів для аналізу систем різної природи та складності <span class="citation" data-cites="Dutta_2010 MAIORINO2015302 FIGUEIREDO20102090 Jafari_2012 Jiang_2019 Telesca_2005 doi:10.1080/00045608.2011.592733 Liao_2011 TELESCA2005629 PhysRevE.84.021103 MALI201525 Pedron_2010 Rak_2015 WATOREK20211">&nbsp;[<a href="references.html#ref-Dutta_2010" role="doc-biblioref">8</a>–<a href="references.html#ref-WATOREK20211" role="doc-biblioref">21</a>]</span>.</p>
<p>Побудова MFDFA складається з 9 кроків:</p>
<ol type="1">
<li><em>“Шум і випадкові блукання у часовому ряді”</em> представляє метод приведення часового ряду до такого, що подібний до випадкового блукання.</li>
<li><em>“Обчислення середньоквадратичної варіації часового ряду”</em> представляє середньоквадратичну варіацію, яка є основною процедурою для подальших обчислень в MFDFA і типовим способом обчислення середньої варіації часових рядів різної природи.</li>
<li><em>“Локальна середньоквадратична варіація часового ряду”</em> представляє обчислення локальної варіації часового ряду як середньоквадратичного відхилення часового ряду в межах сегментів, що можуть як перекриватися, так і не перекриватися.</li>
<li><em>“Локальне детрендування часового ряду”</em> представляє обчислення такого ж локального середньоквадратичного відхилення навколо трендів, які часто зустрічаються у фінансових часових рядах.</li>
<li><em>“Монофрактальний аналіз детрендованих флуктуацій”</em>: амплітуди локальних середніх квадратичних відхилень підсумовуються в узагальнене середнє квадратичне відхилення. У сумарному середньоквадратичному відхиленні для сегментів з малими розмірами вибірки переважають швидкі флуктуації часового ряду. На противагу цьому, у сумарному середньоквадратичному відхиленні для сегментів з великими розмірами вибірки переважають повільні коливання. Степенева залежність між загальним середнім квадратичним відхиленням для декількох розмірів вибірки (тобто масштабів) визначається за допомогою монофрактального аналізу дентрендованих флуктуацій (monofractal detrended fluctuation analysis, DFA) і називається показником Херста (Hurst exponent, <span class="math inline">\(H\)</span>).</li>
<li><em>“Мультифрактальний аналіз детрендованих флуктуацій”</em>: MFDFA отримують шляхом розширення на <span class="math inline">\(q\)</span>-й порядок узагальненого середньоквадратичного відхилення. Середньоквадратичне відхилення <span class="math inline">\(q\)</span>-го порядку може розрізняти сегменти з малими та великими флуктуаціями. Степенева залежність між середньоквадратичним відхиленням <span class="math inline">\(q\)</span>-го порядку чисельно визначається як узагальнейний показник Херста <span class="math inline">\(q\)</span>-го порядку.</li>
<li><em>“Мультифрактальний спектр часових рядів”</em>: на основі показника Херста <span class="math inline">\(q\)</span>-го порядку обчислено декілька мультифрактальних спектрів.</li>
<li><em>“Узагальнені фрактальні розмірності”</em> представляє більш детальний опис показників <span class="math inline">\(D_{q}\)</span>, що будуть описані в подальшому.</li>
<li><em>“Аналогії мультифракталів із термодинамікою”</em> показує, що отримані кількісні мультифрактальні показники мають зв’язок із термодинамічними показниками, що дозволило нам вивести мультифрактальну “теплоємність”.</li>
</ol>
<p>Для подальшої візуалізації кожного кроку процедури MFDFA імпортуємо наступні модулі:</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.gridspec <span class="im">as</span> gridspec</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> neurokit2 <span class="im">as</span> nk</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> yfinance <span class="im">as</span> yf</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scienceplots</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> cumulative_trapezoid</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tqdm <span class="im">import</span> tqdm</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>І виконаємо налаштування рисунків для виведення:</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>plt.style.use([<span class="st">'science'</span>, <span class="st">'notebook'</span>, <span class="st">'grid'</span>]) <span class="co"># стиль, що використовуватиметься</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                                               <span class="co"># для виведення рисунків</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> {</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'figure.figsize'</span>: (<span class="dv">8</span>, <span class="dv">6</span>),          <span class="co"># встановлюємо ширину та висоту рисунків за замовчуванням</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'font.size'</span>: <span class="dv">24</span>,                   <span class="co"># розмір фонтів рисунку</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'lines.linewidth'</span>: <span class="dv">2</span>,              <span class="co"># товщина ліній</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.titlesize'</span>: <span class="st">'small'</span>,         <span class="co"># розмір титулки над рисунком</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'font.family'</span>: <span class="st">"Times New Roman"</span>,  <span class="co"># сімейство стилів підписів </span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'font.serif'</span>: [<span class="st">"Times"</span>],           <span class="co"># стиль підпису</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'mathtext.fontset'</span>: <span class="st">"dejavuserif"</span>, <span class="co"># стиль математичних виразів </span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'savefig.dpi'</span>: <span class="dv">300</span>                 <span class="co"># якість збережених зображень</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>plt.rcParams.update(params)            <span class="co"># оновлення стилю згідно налаштувань</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Цього разу розглянему можливість побудови індикаторів або індикаторів-передвісників на прикладі індексу сирої нафти West Texas Intermediate (WTI). При описі процедури MFDFA порівнюватимемо мультифрактальність даного ряду зі штучно згенерованими монофрактальними рядами, складність яких, очевидно, має бути меншою.</p>
<p>Сам сайт Yahoo! Finance містить досить коротку історію щодених цін на нафту даної марки. Цього разу, в якості альтернативного прикладу, будемо послуговуватись альтернативним джерелом фінансових даних — <a href="https://fred.stlouisfed.org">федеральним резервом економічних даних федерального резервного банку Сент-Луїса</a> (Federal Reserve Economic Data of the Federal Reserve Bank of St.&nbsp;Louis, FRED). На Python було створено бібліотеку для вивантаження даних із даного джерела — <code>pandas-datareader</code>. Для її встановлення достатньо прописати наступну команду:</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install pandas<span class="op">-</span>datareader</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Тепер імпортуємо відповідну бібліотеку:</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas_datareader.data <span class="im">as</span> web</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>та виконаємо зчитування індексу з FRED, використовуючи функціонал даної бібліотеки. Завантажимо дані за весь період, що нам буде доступний:</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>symbol <span class="op">=</span> <span class="st">'DCOILWTICO'</span>    <span class="co"># cимвол індексу, як указано на сайті FRED</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> <span class="st">"1986-01-01"</span>     <span class="co"># Дата початку зчитування даних</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>end <span class="op">=</span> <span class="st">"2023-01-21"</span>       <span class="co"># Дата закінчення зчитування даних</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>wti <span class="op">=</span> web.DataReader(symbol, <span class="st">'fred'</span>, start, end) <span class="co"># зчитуємо значення ряду </span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>time_ser <span class="op">=</span> wti[symbol].copy()                    <span class="co"># зберігаємо саме ціни закриття</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>xlabel <span class="op">=</span> <span class="st">'time, days'</span>    <span class="co"># підпис по вісі Ох </span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>ylabel <span class="op">=</span> symbol          <span class="co"># підпис по вісі Оу</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Виведемо досліджуваний ряд:</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()                   <span class="co"># Створюємо порожній графік</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>ax.plot(time_ser.index, time_ser.values)   <span class="co"># Додаємо дані до графіку</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>ax.legend([symbol])                        <span class="co"># Додаємо легенду</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(xlabel)                      <span class="co"># Встановимо підпис по вісі Ох</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(ylabel)                      <span class="co"># Встановимо підпис по вісі Oy</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)                    <span class="co"># оберт позначок по осі Ох на 45 градусів</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="ss">f'</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">.jpg'</span>)               <span class="co"># Зберігаємо графік </span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>plt.show()<span class="op">;</span>                                <span class="co"># Виводимо графік</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-wti-init" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="lab_7_files/figure-html/fig-wti-init-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.5: Динаміка щоденних змін індексу сирої нафти WTI</figcaption>
</figure>
</div>
</div>
</div>
<p>Розглянемо опис нашого масиву даних:</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>time_ser.describe()</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>count    9336.000000
mean       46.078743
std        29.597897
min       -36.980000
25%        19.990000
50%        35.955000
75%        67.242500
max       145.310000
Name: DCOILWTICO, dtype: float64</code></pre>
</div>
</div>
<p>На представленому рисунку видно, що в значеннях досліджуваного індексу існують пропуски та негативні значення на ціну нафти. Для того, щоб позбутися від’ємного значення, можна виконати заміну значення на таке, що близьке до нуля. Для видалення значень <code>NaN</code> достатньо скористатися методом <code>dropna()</code> бібліотеки <code>pandas</code>.</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>time_ser <span class="op">=</span> time_ser.dropna()    <span class="co"># видаляємо значення NaN</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>time_ser[time_ser.values<span class="op">&lt;</span><span class="dv">0</span>] <span class="op">=</span> <span class="dv">5</span> <span class="co"># замінюємо від'ємне значення на 5</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Знову візуалізуємо результат:</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()                   <span class="co"># Створюємо порожній графік</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>ax.plot(time_ser.index, time_ser.values)   <span class="co"># Додаємо дані до графіку</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>ax.legend([symbol])                        <span class="co"># Додаємо легенду</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(xlabel)                      <span class="co"># Встановимо підпис по вісі Ох</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(ylabel)                      <span class="co"># Встановимо підпис по вісі Oy</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)                    <span class="co"># оберт позначок по осі Ох на 45 градусів</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="ss">f'</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_filtered.jpg'</span>)      <span class="co"># Зберігаємо графік </span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>plt.show()<span class="op">;</span>                                <span class="co"># Виводимо графік</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-wti-corrected" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="lab_7_files/figure-html/fig-wti-corrected-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.6: Динаміка щоденних змін індексу сирої нафти WTI (із видаленими NaN та заміненим від’ємним значенням)</figcaption>
</figure>
</div>
</div>
</div>
<p>Останнє, що нам залишається, це приведення вихідного ряду до прибутковостей. Для цього визначимо функцію <code>transformation()</code> та знайдемо з її допомогою прибутковості:</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> transformation(signal, ret_type):</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    for_rec <span class="op">=</span> signal.copy()</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ret_type <span class="op">==</span> <span class="dv">1</span>:       <span class="co"># Зважаючи на вид ряду, виконуємо</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># необхідні перетворення</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> ret_type <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>        for_rec <span class="op">=</span> for_rec.diff()</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> ret_type <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>        for_rec <span class="op">=</span> for_rec.pct_change()</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> ret_type <span class="op">==</span> <span class="dv">4</span>:</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>        for_rec <span class="op">=</span> for_rec.pct_change()</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>        for_rec <span class="op">-=</span> for_rec.mean()</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>        for_rec <span class="op">/=</span> for_rec.std()</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> ret_type <span class="op">==</span> <span class="dv">5</span>: </span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>        for_rec <span class="op">=</span> for_rec.pct_change()</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>        for_rec <span class="op">-=</span> for_rec.mean()</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>        for_rec <span class="op">/=</span> for_rec.std()</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>        for_rec <span class="op">=</span> for_rec.<span class="bu">abs</span>()</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> ret_type <span class="op">==</span> <span class="dv">6</span>:</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>        for_rec <span class="op">-=</span> for_rec.mean()</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>        for_rec <span class="op">/=</span> for_rec.std()</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    for_rec <span class="op">=</span> for_rec.dropna().values</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> for_rec</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>signal <span class="op">=</span> time_ser.copy()</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>ret_type <span class="op">=</span> <span class="dv">4</span>    <span class="co"># вид ряду: 1 - вихідний, </span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 2 - детрендований (різниця між теп. значенням та попереднім)</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 3 - прибутковості звичайні, </span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 4 - стандартизовані прибутковості, </span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 5 - абсолютні значення (волатильності)</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 6 - стандартизований ряд</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>wti_ret <span class="op">=</span> transformation(signal, ret_type) <span class="co"># знаходимо прибутковості </span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>wti_length <span class="op">=</span> <span class="bu">len</span>(wti_ret)                  <span class="co"># визначаємо довжину прибутковостей</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Як вже зазначалося, при описі процедури MFDFA, ми будемо послуговуватись для порівняння і монофрактальними сигналами. Для подальших розрахунків згенеруємо сигнал білого та рожевого шумів. У цьому нам може допомогти функція <code>signal_noise()</code> бібліотеки <code>neurokit2</code>. Ця функція генерує чистий гаусовий <code>(1/f)**beta</code> шум. Спектр потужності згенерованого шуму пропорційний <code>S(f) = (1/f)**beta</code>. Було описано наступні категорії шуму:</p>
<ul>
<li>фіолетовий шум: beta = -2;</li>
<li>синій шум: beta = -1;</li>
<li>білий шум: beta = 0;</li>
<li>флікер/рожевий шум: beta = 1;</li>
<li>коричневий шум: beta = 2.</li>
</ul>
<p>Її синтаксис:</p>
<p><strong><code>signal_noise(duration=10, sampling_rate=1000, beta=1, random_state=None)</code></strong></p>
<p><strong>Параметри:</strong></p>
<ul>
<li><strong>duration</strong> (<em>float</em>) — бажана тривалість (у секундах);</li>
<li><strong>sampling_rate</strong> (<em>int</em>) — бажана частота дискретизації (у Гц, тобто відліків на секунду);</li>
<li><strong>beta</strong> (<em>float</em>) — експонента шуму;</li>
<li><strong>random_state</strong> (<em>None, int, numpy.random.RandomState або numpy.random.Generator</em>) — початкове значення (зерно) для генератора випадкових чисел.</li>
</ul>
<p><strong>Повертає:</strong></p>
<ul>
<li><strong>noise</strong> (<em>array</em>) — сигнал чистого шуму.</li>
</ul>
<p>Тепер можемо згенерувати 2 види шумів:</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>white_noise <span class="op">=</span> nk.signal_noise(duration<span class="op">=</span>wti_length, <span class="co"># генеруємо білий шум </span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                              sampling_rate<span class="op">=</span><span class="dv">1</span>, </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                              beta<span class="op">=</span><span class="dv">0</span>, </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                              random_state<span class="op">=</span><span class="dv">123</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>pink_noise <span class="op">=</span> nk.signal_noise(duration<span class="op">=</span>wti_length,  <span class="co"># генеруємо рожевий шум </span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>                              sampling_rate<span class="op">=</span><span class="dv">1</span>, </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>                              beta<span class="op">=</span><span class="dv">1</span>, </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>                              random_state<span class="op">=</span><span class="dv">123</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="шум-і-випадкові-блукання-у-часовому-ряді" class="level4" data-number="7.1.4.1">
<h4 data-number="7.1.4.1" class="anchored" data-anchor-id="шум-і-випадкові-блукання-у-часовому-ряді"><span class="header-section-number">7.1.4.1</span> Шум і випадкові блукання у часовому ряді</h4>
<p>Мультифрактальний аналіз детрендованих флуктуацій базується на класичному аналізі детрендованих флуктуацій (DFA). Класичний DFA застосовується до часових рядів зі структурою, подібною до випадкових блукань <span class="citation" data-cites="Peng_1995">&nbsp;[<a href="references.html#ref-Peng_1995" role="doc-biblioref">22</a>]</span>. Однак більшість фінансових часових рядів мають коливання, які більш схожі на прирости випадкових блукань. Якщо фінансовий часовий ряд має структуру, подібну до шуму, як у прибутковостей, його слід перетворити на випадково-блукаючий часовий ряд перед застосуванням DFA. Шуми можна перетворити на випадкові блукання шляхом віднімання середнього значення та інтегрування часового ряду (знаходження його кумулятивної суми). Часовий ряд з білим шумом, монофрактал (рожевий шум) і мультифрактал є шумовими часовими рядами і перетворюються на випадкові блукання за допомогою коду, наведеного на <a href="#fig-step-1"><span>7.7</span></a>:</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>RW1 <span class="op">=</span> np.cumsum(white_noise<span class="op">-</span>np.mean(white_noise)) <span class="co"># випадкове блукання білого шуму</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>RW2 <span class="op">=</span> np.cumsum(pink_noise<span class="op">-</span>np.mean(pink_noise))   <span class="co"># випадкове блукання монофракталу</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>RW3 <span class="op">=</span> np.cumsum(wti_ret<span class="op">-</span>np.mean(wti_ret))         <span class="co"># випадкове блукання для нафти</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">3</span>, <span class="dv">1</span>, sharex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(time_ser.index[<span class="dv">1</span>:], wti_ret)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(time_ser.index[<span class="dv">1</span>:], RW3, <span class="st">'r'</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].grid(<span class="va">False</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].margins(x<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_title(<span class="st">'Мультифрактальний часовий ряд'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(time_ser.index[<span class="dv">1</span>:], pink_noise, label<span class="op">=</span><span class="st">'Шумоподібний часовий ряд'</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(time_ser.index[<span class="dv">1</span>:], RW2, <span class="st">'r'</span>, label<span class="op">=</span><span class="st">'Випадкове блукання'</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].grid(<span class="va">False</span>)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].margins(x<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_title(<span class="st">'Монофрактальний часовий ряд'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].legend()</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].plot(time_ser.index[<span class="dv">1</span>:], white_noise)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].plot(time_ser.index[<span class="dv">1</span>:], RW1, <span class="st">'r'</span>)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].grid(<span class="va">False</span>)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].margins(x<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].set_title(<span class="st">'Білий шум'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>plt.show()<span class="op">;</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-step-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="lab_7_files/figure-html/fig-step-1-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.7: Мультифрактальний (верхня панель), монофрактальний (середня панель) та подібний до білого шуму (нижня панель) часові ряди</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="обчислення-середньоквадратичної-варіації-часового-ряду" class="level4" data-number="7.1.4.2">
<h4 data-number="7.1.4.2" class="anchored" data-anchor-id="обчислення-середньоквадратичної-варіації-часового-ряду"><span class="header-section-number">7.1.4.2</span> Обчислення середньоквадратичної варіації часового ряду</h4>
<p>Традиційний аналіз варіації часових рядів полягає в обчисленні середнього значення варіації як середньоквадратичного відхилення. Читач може скористатися наведеним нижче кодом для обчислення середньоквадратичного відхилення для часових рядів з білим шумом, монофрактальних і мультифрактальних даних:</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>RMS_ordinary <span class="op">=</span> np.sqrt(np.mean(white_noise<span class="op">**</span><span class="dv">2</span>))    <span class="co"># середньоквадратична варіація білого шуму</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>RMS_monofractal <span class="op">=</span> np.sqrt(np.mean(pink_noise<span class="op">**</span><span class="dv">2</span>))  <span class="co"># середньоквадратична варіація монофрактала</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>RMS_multifractal <span class="op">=</span> np.sqrt(np.mean(wti_ret<span class="op">**</span><span class="dv">2</span>))    <span class="co"># середньоквадратична варіація мультифрактала</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">3</span>, <span class="dv">1</span>, sharex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(time_ser.index[<span class="dv">1</span>:], wti_ret, label<span class="op">=</span><span class="st">'Шумоподібний часовий ряд'</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].axhline(y<span class="op">=</span>np.mean(wti_ret), c<span class="op">=</span><span class="st">'r'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'Середнє'</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].axhline(y<span class="op">=</span>np.mean(wti_ret)<span class="op">+</span>RMS_multifractal, c<span class="op">=</span><span class="st">'r'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>, label<span class="op">=</span><span class="st">'+/- 1 RMS'</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].axhline(y<span class="op">=</span>np.mean(wti_ret)<span class="op">-</span>RMS_multifractal, c<span class="op">=</span><span class="st">'r'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_ylim(<span class="op">-</span><span class="dv">20</span>, <span class="dv">20</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].grid(<span class="va">False</span>)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].margins(x<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_title(<span class="st">'Мультифрактальний часовий ряд'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(time_ser.index[<span class="dv">1</span>:], pink_noise)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].axhline(y<span class="op">=</span>np.mean(pink_noise), c<span class="op">=</span><span class="st">'r'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].axhline(y<span class="op">=</span>np.mean(pink_noise)<span class="op">+</span>RMS_monofractal, c<span class="op">=</span><span class="st">'r'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>)</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].axhline(y<span class="op">=</span>np.mean(pink_noise)<span class="op">-</span>RMS_monofractal, c<span class="op">=</span><span class="st">'r'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].grid(<span class="va">False</span>)</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].margins(x<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_title(<span class="st">'Монофрактальний часовий ряд'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].plot(time_ser.index[<span class="dv">1</span>:], white_noise)</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].axhline(y<span class="op">=</span>np.mean(white_noise), c<span class="op">=</span><span class="st">'r'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].axhline(y<span class="op">=</span>np.mean(white_noise)<span class="op">+</span>RMS_ordinary, c<span class="op">=</span><span class="st">'r'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>)</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].axhline(y<span class="op">=</span>np.mean(white_noise)<span class="op">-</span>RMS_ordinary, c<span class="op">=</span><span class="st">'r'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>)</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].grid(<span class="va">False</span>)</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].margins(x<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].set_title(<span class="st">'Білий шум'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>handles, labels <span class="op">=</span> ax[<span class="dv">0</span>].get_legend_handles_labels()</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>fig.legend(handles, labels, loc<span class="op">=</span><span class="st">'lower center'</span>)</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>plt.show()<span class="op">;</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-step-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="lab_7_files/figure-html/fig-step-2-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.8: Мультифрактальний (верхня панель), монофрактальний (середня панель) та подібний до білого шуму (нижня панель) часові ряди з нульовим середнім значенням (червона штрихова лінія) і <span class="math inline">\(\pm\)</span> <code>RMS</code> (червона суцільна лінія)</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-step-2">Рис.&nbsp;<span>7.8</span></a> ілюструє, що середня амплітуда варіації (тобто середньоквадратичне відхилення) є однаковою для всіх трьох часових рядів, навіть якщо вони мають досить різну структуру. MFDFA може розрізняти ці структури.</p>
</section>
<section id="локальна-середньоквадратична-варіація-часового-ряду" class="level4" data-number="7.1.4.3">
<h4 data-number="7.1.4.3" class="anchored" data-anchor-id="локальна-середньоквадратична-варіація-часового-ряду"><span class="header-section-number">7.1.4.3</span> Локальна середньоквадратична варіація часового ряду</h4>
<p>Мультифрактальні часові ряди на верхній панелі мають локальні флуктуації різної величини. Середньоквадратичне відхилення (RMS) у попередньому коді можна обчислити для сегментів часового ряду, щоб розрізнити величини локальних флуктуацій. Проста процедура полягає в тому, щоб розділити часовий ряд на однакові за розміром сегменти, що не перекриваються, і обчислити локальне середнє квадратичне відхилення для кожного сегмента. Це можна зробити за допомогою коду наведеного нижче:</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calc_rms(arr, scale<span class="op">=</span><span class="dv">1335</span>, m<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># симулюємо випадкове блукання (X)</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> np.cumsum(arr <span class="op">-</span> np.mean(arr))</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># транспонуємо значення X </span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> X.T                           </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># визначаємо довжини сегментів </span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    scale <span class="op">=</span> scale</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># визначаємо порядок полінома</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    m <span class="op">=</span> m</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># визначаємо кількість сегментів</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    segments <span class="op">=</span> np.floor(<span class="bu">len</span>(X) <span class="op">/</span> scale).astype(<span class="bu">int</span>)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    Index <span class="op">=</span> {}  <span class="co"># словник індексів значень</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    fit <span class="op">=</span> {}    <span class="co"># словник для збереження отриманих поліноміальних кривих</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>                <span class="co"># для кожного сегмента</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    RMS <span class="op">=</span> []    <span class="co"># список середньоквадратичних відхилень</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> v <span class="kw">in</span> <span class="bu">range</span>(segments<span class="op">+</span><span class="dv">1</span>):       <span class="co"># проходимо по кожному сегменту</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>        Idx_start <span class="op">=</span> v <span class="op">*</span> scale         <span class="co"># визначаємо початкове значення сегмента                                           </span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>        Idx_stop <span class="op">=</span> (v <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> scale    <span class="co"># визначаємо кінцеве значення</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># формуємо масив індексів значень досліджуваного сегмента</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>        Index[v] <span class="op">=</span> np.arange(Idx_start, <span class="bu">min</span>(Idx_stop, <span class="bu">len</span>(X)))  </span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># вилучаємо значення по індексам</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>        X_Idx <span class="op">=</span> X[Index[v]]                       </span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>        <span class="co"># визначаємо поліноміальні коефіцієнти порядку m</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>        C <span class="op">=</span> np.polyfit(Index[v], X_Idx, m) </span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>        <span class="co"># будуємо поліноміальну криву по визначеним коефіцієнтам</span></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>        fit[v] <span class="op">=</span> np.polyval(C, Index[v])         </span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>                 </span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>        <span class="co"># визначаємо варіацію ряду навколо поліноміального тренда</span></span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>        RMS.append(np.sqrt(np.mean((X_Idx <span class="op">-</span> fit[v]) <span class="op">**</span> <span class="dv">2</span>)))  </span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fit, RMS, Index, X</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Перший рядок коду функції <code>calc_rms()</code> перетворює зашумлений часовий ряд, мультифрактал, на часовий ряд випадкового блукання <span class="math inline">\(X\)</span>. Третій рядок коду задає масштаб параметра, який визначає розмір вибірки сегментів, що не перетинаються, для яких обчислюється локальне середнє квадратичне відхилення, <code>RMS</code>. П’ятий рядок — це кількість сегментів, на які можна розбити часовий ряд <span class="math inline">\(X\)</span>, де <code>len(X)</code> — розмір вибірки часового ряду <span class="math inline">\(X\)</span>. Таким чином, <code>segments = 6</code> при <code>len(X) = 9335</code> і <code>scale = 1335</code>. З дев’ятого по шістнадцятий рядки — це цикл, що обчислює локальне середньоквадратичне значення навколо тренду <code>fit[v]</code> для кожного сегмента, оновлюючи часовий індекс. У першому циклі <code>v = 0</code>, <code>Index[0]</code> переходить від 0 до 1335 значення сегмента (не включно). У другому циклі <span class="math inline">\(v = 1\)</span>, <code>Index[1]</code> переходить від 1335 до 2670 значення другого сегмента. В останньому циклі <span class="math inline">\(v = 6\)</span>, <code>Index[6]</code> переходить від 8010-го до 9345-го значення (не включно).</p>
</section>
<section id="локальне-детрендування-часового-ряду" class="level4" data-number="7.1.4.4">
<h4 data-number="7.1.4.4" class="anchored" data-anchor-id="локальне-детрендування-часового-ряду"><span class="header-section-number">7.1.4.4</span> Локальне детрендування часового ряду</h4>
<p>У складних системах наявні повільні мінливі тренди, тому для кількісної оцінки масштабо-інваріантності флуктуацій навколо цих трендів необхідно провести детрендування сигналу. У попередньому коді до <span class="math inline">\(X\)</span> на кожному сегменті <span class="math inline">\(v\)</span> підбирається поліноміальний тренд <code>fit[v]</code>. Параметр <span class="math inline">\(m\)</span> визначає порядок полінома. Поліноміальний тренд є лінійним, якщо <span class="math inline">\(m = 1\)</span>, квадратичним, якщо <span class="math inline">\(m = 2\)</span>, і кубічним, якщо <span class="math inline">\(m = 3\)</span>. Рядок <code>C = np.polyfit(Index[v], X[Index[v]], m)</code> визначає коефіцієнти полінома <code>C</code>, які використовуються для створення поліноміальної залежності тренду <code>fit[v]</code> для кожного сегмента. Потім для залишкової варіації, <code>X(Index[v])-fit[v]</code>, обчислюється локальне середньоквадратичне відхилення, <code>RMS[v]</code>, в межах кожного сегмента <span class="math inline">\(v\)</span>. Локальна середньоквадратична варіація, <code>RMS[v]</code>, представлена на <a href="#fig-step-3">Рис.&nbsp;<span>7.9</span></a> як відстань між червоними пунктирними трендами і червоними суцільними лініями.</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>fit_1, RMS_1, Index_1, X <span class="op">=</span> calc_rms(wti_ret, scale<span class="op">=</span><span class="dv">1335</span>, m<span class="op">=</span><span class="dv">1</span>) <span class="co"># оцінка локального відхилення для мультифрактала</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>fit_2, RMS_2, Index_2, X <span class="op">=</span> calc_rms(wti_ret, scale<span class="op">=</span><span class="dv">1335</span>, m<span class="op">=</span><span class="dv">2</span>) <span class="co"># оцінка локального відхилення для монофрактала</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>fit_3, RMS_3, Index_3, X <span class="op">=</span> calc_rms(wti_ret, scale<span class="op">=</span><span class="dv">1335</span>, m<span class="op">=</span><span class="dv">3</span>) <span class="co"># оцінка локального відхилення для білого шуму</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">3</span>, <span class="dv">1</span>, sharex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(time_ser.index[<span class="dv">1</span>:], X)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> v <span class="kw">in</span> <span class="bu">list</span>(fit_1.keys()):</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">0</span>].plot(time_ser.index[Index_1[v]], fit_1[v], <span class="st">'r--'</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">0</span>].plot(time_ser.index[Index_1[v]], fit_1[v]<span class="op">+</span>RMS_1[v], c<span class="op">=</span><span class="st">'r'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">0</span>].plot(time_ser.index[Index_1[v]], fit_1[v]<span class="op">-</span>RMS_1[v], c<span class="op">=</span><span class="st">'r'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].grid(<span class="va">False</span>)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].margins(x<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_title(<span class="st">'Лінійне детрендування '</span> <span class="op">+</span> <span class="vs">r'$(m=1)$'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(time_ser.index[<span class="dv">1</span>:], X, label<span class="op">=</span><span class="st">'Випадкове блукання мультифрактального сигналу'</span>)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> v <span class="kw">in</span> <span class="bu">list</span>(fit_2.keys()):</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> v <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>        ax[<span class="dv">1</span>].plot(time_ser.index[Index_2[v]], fit_2[v], <span class="st">'r--'</span>, label<span class="op">=</span><span class="st">'Локальний тренд'</span>)</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>        ax[<span class="dv">1</span>].plot(time_ser.index[Index_2[v]], fit_2[v]<span class="op">+</span>RMS_2[v], c<span class="op">=</span><span class="st">'r'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>, label<span class="op">=</span><span class="st">'+/- 1 RMS'</span>)</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>        ax[<span class="dv">1</span>].plot(time_ser.index[Index_2[v]], fit_2[v]<span class="op">-</span>RMS_2[v], c<span class="op">=</span><span class="st">'r'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>)</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>        ax[<span class="dv">1</span>].plot(time_ser.index[Index_2[v]], fit_2[v], <span class="st">'r--'</span>)</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>        ax[<span class="dv">1</span>].plot(time_ser.index[Index_2[v]], fit_2[v]<span class="op">+</span>RMS_2[v], c<span class="op">=</span><span class="st">'r'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>)</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>        ax[<span class="dv">1</span>].plot(time_ser.index[Index_2[v]], fit_2[v]<span class="op">-</span>RMS_2[v], c<span class="op">=</span><span class="st">'r'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>)</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].grid(<span class="va">False</span>)</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].margins(x<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_title(<span class="st">'Квадратичне детрендування '</span> <span class="op">+</span> <span class="vs">r'$(m=2)$'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].plot(time_ser.index[<span class="dv">1</span>:], X)</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> v <span class="kw">in</span> <span class="bu">list</span>(fit_3.keys()):</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">2</span>].plot(time_ser.index[Index_3[v]], fit_3[v], <span class="st">'r--'</span>)</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">2</span>].plot(time_ser.index[Index_3[v]], fit_3[v]<span class="op">+</span>RMS_3[v], c<span class="op">=</span><span class="st">'r'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>)</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">2</span>].plot(time_ser.index[Index_3[v]], fit_3[v]<span class="op">-</span>RMS_3[v], c<span class="op">=</span><span class="st">'r'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>)</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].grid(<span class="va">False</span>)</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].margins(x<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].set_title(<span class="st">'Кубічне детрендування '</span> <span class="op">+</span> <span class="vs">r'$(m=3)$'</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>handles, labels <span class="op">=</span> ax[<span class="dv">1</span>].get_legend_handles_labels()</span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>fig.legend(handles, labels, loc<span class="op">=</span><span class="st">'lower center'</span>)</span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>plt.show()<span class="op">;</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-step-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="lab_7_files/figure-html/fig-step-3-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.9: Обчислення локальних флуктуацій <code>RMS</code> навколо лінійного, квадратичного та кубічного трендів за допомогою функції <code>calc_rms()</code> (<span class="math inline">\(m = 1\)</span>, <span class="math inline">\(m = 2\)</span> та <span class="math inline">\(m = 3\)</span>, відповідно). Червона пунктирна лінія — це підігнаний тренд, <code>fit[v]</code>, у семи сегментах вибірки розміром 1335. Відстань між червоним штриховим трендом і суцільними червоними лініями становить <span class="math inline">\(\pm\)</span> <code>RMS</code></figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="монофрактальний-аналіз-детрендованих-флуктуацій" class="level4" data-number="7.1.4.5">
<h4 data-number="7.1.4.5" class="anchored" data-anchor-id="монофрактальний-аналіз-детрендованих-флуктуацій"><span class="header-section-number">7.1.4.5</span> Монофрактальний аналіз детрендованих флуктуацій</h4>
<p>У DFA варіації локального середньоквадратичного відхилення кількісно оцінюються загальним середньоквадратичним відхиленням (<span class="math inline">\(F\)</span>).</p>
<p>Швидкі коливання часового ряду <span class="math inline">\(X\)</span> впливатимуть на загальне середньоквадратичне відхилення <span class="math inline">\(F\)</span> у сегментах малої довжини (масштабу), тоді як повільні коливання впливатимуть на <span class="math inline">\(F\)</span> у сегментах великої довжини (масштабу). Таким чином, функція флуктуацій <span class="math inline">\(F\)</span> повинна бути обчислена для декількох масштабів, щоб виокремити вплив як швидкоплинних, так і повільних коливань, які у свою чергу визначають структурні перетворення часового ряду. Функція флуктуацій <span class="math inline">\(F(ns)\)</span> може бути обчислена для декількох масштабів шляхом модифікації попереднього коду:</p>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calc_F(arr, scale, m<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> np.cumsum(arr <span class="op">-</span> np.mean(arr)) <span class="co"># симулюємо випадкове блукання (X)</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> X.T                           <span class="co"># транспонуємо значення X</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    scale <span class="op">=</span> scale</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    m <span class="op">=</span> m</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    segments <span class="op">=</span> np.zeros(<span class="bu">len</span>(scale), dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    F <span class="op">=</span> np.zeros(<span class="bu">len</span>(scale))</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    Index <span class="op">=</span> {}  <span class="co"># словник індексів значень</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    fit <span class="op">=</span> {}    <span class="co"># словник для збереження отриманих поліноміальних кривих</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>                <span class="co"># для кожного сегмента</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    RMS <span class="op">=</span> {}    <span class="co"># словник середньоквадратичних відхилень</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> ns <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(scale)):</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>        segments[ns] <span class="op">=</span> np.floor(<span class="bu">len</span>(X) <span class="op">/</span> scale[ns]).astype(<span class="bu">int</span>)</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>        RMS[ns] <span class="op">=</span> np.zeros(segments[ns])</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> v <span class="kw">in</span> <span class="bu">range</span>(segments[ns]):         <span class="co"># проходимо по кожному сегменту</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>            <span class="co"># визначаємо початкове значення сегмента</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>            Idx_start <span class="op">=</span> v <span class="op">*</span> scale[ns]  </span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>                       </span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>            <span class="co"># визначаємо кінцеве значення</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>            Idx_stop <span class="op">=</span> (v <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> scale[ns] <span class="cf">if</span> v <span class="op">&lt;</span> segments[ns] <span class="op">-</span> <span class="dv">1</span> <span class="cf">else</span> <span class="bu">len</span>(X)    </span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>            <span class="co"># формуємо масив індексів значень досліджуваного сегмента</span></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>            Index[v, ns] <span class="op">=</span> np.arange(Idx_start, Idx_stop)  </span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>            <span class="co"># вилучаємо значення по індексам</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>            X_Idx <span class="op">=</span> X[Index[v, ns]]                       </span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>            <span class="co"># визначаємо поліноміальні коефіцієнти порядку m</span></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>            C <span class="op">=</span> np.polyfit(Index[v, ns], X_Idx, m) </span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>            <span class="co"># будуємо поліноміальну криву по визначеним коефіцієнтам</span></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>            fit[v, ns] <span class="op">=</span> np.polyval(C, Index[v, ns])  </span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>            <span class="co"># оцінюємо середньоквадратичне відхилення для фрагмента v на масштабі ns </span></span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>            RMS[ns][v] <span class="op">=</span> np.sqrt(np.mean((X_Idx <span class="op">-</span> fit[v, ns]) <span class="op">**</span> <span class="dv">2</span>)) </span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>        <span class="co"># оцінюємо загальне середньоквадратичне відхилення в межах масштабу ns</span></span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>        F[ns] <span class="op">=</span> np.sqrt(np.mean(RMS[ns] <span class="op">**</span> <span class="dv">2</span>))</span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> F, RMS, Index, X</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>scales <span class="op">=</span> [<span class="dv">16</span>, <span class="dv">32</span>, <span class="dv">64</span>, <span class="dv">128</span>, <span class="dv">256</span>, <span class="dv">512</span>, <span class="dv">1024</span>][::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>F, RMS, Index, X <span class="op">=</span> calc_F(wti_ret, scale<span class="op">=</span>scales) <span class="co"># оцінка узагальненої функції флуктуацій по різним масштабам</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="bu">len</span>(scales), sharex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> scale, val <span class="kw">in</span> <span class="bu">enumerate</span>(scales):</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    l <span class="op">=</span> [Index[val] <span class="cf">for</span> val <span class="kw">in</span> Index.keys() <span class="cf">if</span> (val[<span class="dv">1</span>] <span class="op">==</span> scale)]</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> np.array([])</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> v <span class="kw">in</span> l:</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> np.concatenate([x, v])</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> np.array([])</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx, v <span class="kw">in</span> <span class="bu">enumerate</span>(l): </span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> np.concatenate([y, RMS[scale][idx]<span class="op">*</span>np.ones(<span class="bu">len</span>(v))])</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> scales[scale] <span class="op">==</span> <span class="dv">16</span>:</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>        ax[scale].plot(time_ser.index[<span class="dv">1</span>:], y, c<span class="op">=</span><span class="st">'b'</span>, label<span class="op">=</span><span class="st">"Локальні флуктуацій: RMS"</span>)</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>        ax[scale].axhline(y<span class="op">=</span>F[scale], c<span class="op">=</span><span class="st">'r'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>, label<span class="op">=</span><span class="vs">r"RMS локальних флуктуацій: $F$"</span>)</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>        ax[scale].grid(<span class="va">False</span>)</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>        ax[scale].set_title(<span class="ss">f"Масштаб = </span><span class="sc">{</span>scales[scale]<span class="sc">}</span><span class="ss">"</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>        ax[scale].margins(x<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>: </span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>        ax[scale].plot(time_ser.index[<span class="dv">1</span>:], y, c<span class="op">=</span><span class="st">'b'</span>)</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>        ax[scale].axhline(y<span class="op">=</span>F[scale], c<span class="op">=</span><span class="st">'r'</span>, linestyle<span class="op">=</span><span class="st">'-'</span>)</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>        ax[scale].grid(<span class="va">False</span>)</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>        ax[scale].set_title(<span class="ss">f"Масштаб = </span><span class="sc">{</span>scales[scale]<span class="sc">}</span><span class="ss">"</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>        ax[scale].margins(x<span class="op">=</span><span class="dv">0</span>)       </span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>handles, labels <span class="op">=</span> ax[<span class="op">-</span><span class="dv">1</span>].get_legend_handles_labels()</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>fig.legend(handles, labels, loc<span class="op">=</span><span class="st">'upper left'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>fig.tight_layout(pad<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>plt.show()<span class="op">;</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-step-5" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="lab_7_files/figure-html/fig-step-5-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.10: Локальні флуктуації <code>RMS[ns]</code> обчислені для сегментів із різними масштабами. Функція флуктуацій <code>F[ns]</code> є загальним середньоквадратичним відхиленням локальних коливань <code>RMS[ns]</code>. Зверніть увагу, що <code>F[ns]</code> зменшується зі зменшенням масштабу</figcaption>
</figure>
</div>
</div>
</div>
<p>DFA визначає монофрактальну структуру часового ряду відповідно до степеневої залежність між загальним середнім квадратичним відхиленням (тобто <span class="math inline">\(F\)</span>), обчисленим для декількох масштабів. Степенева залежність між загальним середнім квадратичним відхиленням позначається нахилом (<span class="math inline">\(H\)</span>) лінії регресії, розрахованим за допомогою наступного коду:</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>C <span class="op">=</span> np.polyfit(np.log(scales), np.log(F), <span class="dv">1</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>H <span class="op">=</span> C[<span class="dv">0</span>]</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>RegLine <span class="op">=</span> np.polyval(C, np.log(scales))</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Модифікуємо попередній код, додавши нові фрагменти:</p>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calc_H(arr, scale, m<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> np.cumsum(arr <span class="op">-</span> np.mean(arr)) <span class="co"># симулюємо випадкове блукання (X)</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> X.T                           <span class="co"># транспонуємо значення X</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    scale <span class="op">=</span> scale</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    m <span class="op">=</span> m</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    segments <span class="op">=</span> np.zeros(<span class="bu">len</span>(scale), dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    F <span class="op">=</span> np.zeros(<span class="bu">len</span>(scale))</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    Index <span class="op">=</span> {}  <span class="co"># словник індексів значень</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    fit <span class="op">=</span> {}    <span class="co"># словник для збереження отриманих поліноміальних кривих</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>                <span class="co"># для кожного сегмента</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    RMS <span class="op">=</span> {}    <span class="co"># словник середньоквадратичних відхилень</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> ns <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(scale)):</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>        segments[ns] <span class="op">=</span> np.floor(<span class="bu">len</span>(X) <span class="op">/</span> scale[ns]).astype(<span class="bu">int</span>)</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>        RMS[ns] <span class="op">=</span> np.zeros(segments[ns])</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> v <span class="kw">in</span> <span class="bu">range</span>(segments[ns]):         <span class="co"># проходимо по кожному сегменту</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>            <span class="co"># визначаємо початкове значення сегмента</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>            Idx_start <span class="op">=</span> v <span class="op">*</span> scale[ns]  </span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>                       </span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>            <span class="co"># визначаємо кінцеве значення</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>            Idx_stop <span class="op">=</span> (v <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> scale[ns] <span class="cf">if</span> v <span class="op">&lt;</span> segments[ns] <span class="op">-</span> <span class="dv">1</span> <span class="cf">else</span> <span class="bu">len</span>(X)    </span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>            <span class="co"># формуємо масив індексів значень досліджуваного сегмента</span></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>            Index[v, ns] <span class="op">=</span> np.arange(Idx_start, Idx_stop)  </span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>            <span class="co"># вилучаємо значення по індексам</span></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>            X_Idx <span class="op">=</span> X[Index[v, ns]]                       </span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>            <span class="co"># визначаємо поліноміальні коефіцієнти порядку m</span></span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>            C <span class="op">=</span> np.polyfit(Index[v, ns], X_Idx, m) </span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>            <span class="co"># будуємо поліноміальну криву по визначеним коефіцієнтам</span></span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>            fit[v, ns] <span class="op">=</span> np.polyval(C, Index[v, ns])  </span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>            <span class="co"># оцінюємо середньоквадратичне відхилення для фрагмента v на масштабі ns </span></span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>            RMS[ns][v] <span class="op">=</span> np.sqrt(np.mean((X_Idx <span class="op">-</span> fit[v, ns]) <span class="op">**</span> <span class="dv">2</span>)) </span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>        <span class="co"># оцінюємо загальне середньоквадратичне відхилення в межах масштабу ns</span></span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>        F[ns] <span class="op">=</span> np.sqrt(np.mean(RMS[ns] <span class="op">**</span> <span class="dv">2</span>))</span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># знаходимо коефіцієнти рівняння прямої </span></span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>    C <span class="op">=</span> np.polyfit(np.log(scale), np.log(F), <span class="dv">1</span>) </span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># беремо кут нахилу прямої в якості показника Херста</span></span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>    H <span class="op">=</span> C[<span class="dv">0</span>]</span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a>    <span class="co"># будуємо саме рівняння</span></span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>    RegLine <span class="op">=</span> np.polyval(C, np.log(scale))</span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> H, RegLine, F</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Тепер розглянемо залежність загальної функції флуктуацій <span class="math inline">\(F\)</span> від різних довжин (масштабів) локальних сегментів ряду для досліджуваних нами рядів:</p>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>scmin <span class="op">=</span> <span class="dv">16</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>scmax <span class="op">=</span> <span class="dv">1024</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>scres <span class="op">=</span> <span class="dv">19</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>exponents <span class="op">=</span> np.linspace(np.log(scmin), np.log(scmax), scres)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>scales_exp <span class="op">=</span> np.<span class="bu">round</span>(np.exp(<span class="dv">1</span>)<span class="op">**</span>exponents).astype(<span class="bu">int</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>H_multifrac, RegLine_multifrac, F_multifrac <span class="op">=</span> calc_H(wti_ret, scale<span class="op">=</span>scales_exp, m<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>H_monofrac, RegLine_monofrac, F_monofrac <span class="op">=</span> calc_H(pink_noise, scale<span class="op">=</span>scales_exp, m<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>H_white_noise, RegLine_white_noise, F_white_noise <span class="op">=</span> calc_H(white_noise, scale<span class="op">=</span>scales_exp, m<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>ax.set_xscale(<span class="st">'log'</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>ax.set_yscale(<span class="st">'log'</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>ax.scatter(scales_exp, F_multifrac, </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>           label<span class="op">=</span><span class="vs">fr"Мультифрактальний ряд ($H$=</span><span class="sc">{</span>H_multifrac<span class="sc">:.2f}</span><span class="vs">)"</span>, </span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>           color<span class="op">=</span><span class="st">'darkblue'</span>)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>plt.plot(scales_exp, np.exp(RegLine_multifrac),  color<span class="op">=</span><span class="st">'darkblue'</span>)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>ax.scatter(scales_exp, F_monofrac, </span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>           label<span class="op">=</span><span class="vs">fr"Монофрактальний ряд ($H$=</span><span class="sc">{</span>H_monofrac<span class="sc">:.2f}</span><span class="vs">)"</span>, </span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>           color<span class="op">=</span><span class="st">'magenta'</span>)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>plt.plot(scales_exp, np.exp(RegLine_monofrac), color<span class="op">=</span><span class="st">'magenta'</span>)</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>ax.scatter(scales_exp, F_white_noise, </span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>           label<span class="op">=</span><span class="vs">fr"Білий шум ($H$=</span><span class="sc">{</span>H_white_noise<span class="sc">:.2f}</span><span class="vs">)"</span>, </span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>           color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>plt.plot(scales_exp, np.exp(RegLine_white_noise), color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="vs">r'$\log</span><span class="sc">{ns}</span><span class="vs">$'</span>)</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">r"$\log{F(ns)}$"</span>)</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>plt.legend(fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>plt.show()<span class="op">;</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-step-6" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="lab_7_files/figure-html/fig-step-6-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.11: Графік залежності загального середньоквадратичного відхилення (тобто, функції флуктуацій <span class="math inline">\(F\)</span>) від масштабу. Масштабно-інваріантна залежність позначається нахилом <span class="math inline">\(H\)</span> ліній регресії (показником Херста)</figcaption>
</figure>
</div>
</div>
</div>
<p>Показник Херста визначає монофрактальну структуру часового ряду, вказуючи, наскільки швидко зростає загальне середньоквадратичне відхилення <span class="math inline">\(F\)</span> локальних коливань <code>RMS</code> зі збільшенням розміру локальних сегментів ряду (тобто, масштабу). <a href="#fig-step-6">Рис.&nbsp;<span>7.11</span></a> показує, що загальне середньоквадратичне значення локальних флуктуацій <span class="math inline">\(F\)</span> у порівнянні з індексом нафти та білим шумом зростає швидше зі збільшенням розміру вибірки сегментів для монофрактального рожевого шуму. <a href="#fig-hurst">Рис.&nbsp;<span>7.12</span></a> ілюструє, що показник Херста визначає континуум між часовими рядами, подібними до шуму, і часовими рядами, подібними до випадкового блукання. Показник Херста знаходиться в інтервалі від 0 до 1 для зашумлений часових рядів, тоді як для часових рядів, подібних до випадкових блукань, він перевищує 1. Часовий ряд має довгострокову залежну (тобто корельовану) структуру, коли показник Херста знаходиться в інтервалі 0.5-1, і антикорельовану структуру, коли показник Херста знаходиться в інтервалі 0-0.5. Часовий ряд має незалежну або короткострокову залежну структуру в окремому випадку, коли показник Херста дорівнює 0.5. Згідно з попереднім рисунком, часові ряди білого шуму та нафти представляються непередбачуваними, оскільки показник Херста близький до 0.5, тоді як рожевий шум довгостроково залежну структуру з показником Херста близьким до 1.</p>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>betas <span class="op">=</span> np.linspace(<span class="fl">0.0</span>, <span class="fl">2.0</span>, <span class="dv">12</span>)[::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>scmin <span class="op">=</span> <span class="dv">16</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>scmax <span class="op">=</span> <span class="dv">1024</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>scres <span class="op">=</span> <span class="dv">19</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>exponents <span class="op">=</span> np.linspace(np.log(scmin), np.log(scmax), scres)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>scales_exp <span class="op">=</span> np.<span class="bu">round</span>(np.exp(<span class="dv">1</span>)<span class="op">**</span>exponents).astype(<span class="bu">int</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>color <span class="op">=</span> <span class="bu">iter</span>(plt.cm.rainbow(np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="bu">len</span>(betas))))</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="bu">len</span>(betas), <span class="dv">1</span>, sharex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, beta <span class="kw">in</span> <span class="bu">enumerate</span>(betas):</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    noise <span class="op">=</span> nk.signal_noise(duration<span class="op">=</span>wti_length,  <span class="co"># генеруємо шум із різними значеннями beta </span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>                              sampling_rate<span class="op">=</span><span class="dv">1</span>, </span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>                              beta<span class="op">=</span>beta, </span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>                              random_state<span class="op">=</span><span class="dv">123</span>)   </span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    H_noise, _, _ <span class="op">=</span> calc_H(arr<span class="op">=</span>noise, scale<span class="op">=</span>scales_exp, m<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    c <span class="op">=</span> <span class="bu">next</span>(color)</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    ax[idx].plot(np.arange(<span class="bu">len</span>(noise)), noise, label<span class="op">=</span><span class="vs">fr"$H$ = </span><span class="sc">{</span>H_noise<span class="sc">:.2f}</span><span class="vs">"</span>, c<span class="op">=</span>c)</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    ax[idx].grid(<span class="va">False</span>)</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    ax[idx].legend(loc<span class="op">=</span><span class="st">"upper right"</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>    ax[idx].margins(x<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>fig.subplots_adjust(hspace<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>plt.show()<span class="op">;</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-hurst" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="lab_7_files/figure-html/fig-hurst-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.12: Діапазон показників Херста визначає континуум фрактальних структур між білим шумом (<span class="math inline">\(Н = 0.5\)</span>) і коричневим шумом (<span class="math inline">\(H = 1.5\)</span>). Рожевий шум <span class="math inline">\(H = 1\)</span> розділяє шуми <span class="math inline">\(H &lt; 1\)</span>, які мають більш помітні швидкі флуктуації, і випадкові блукання <span class="math inline">\(H &gt; 1\)</span>, які мають більш помітні повільні флуктуації</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="мультифрактальний-аналіз-детрендованих-флуктуацій-1" class="level4" data-number="7.1.4.6">
<h4 data-number="7.1.4.6" class="anchored" data-anchor-id="мультифрактальний-аналіз-детрендованих-флуктуацій-1"><span class="header-section-number">7.1.4.6</span> Мультифрактальний аналіз детрендованих флуктуацій</h4>
<p>Структури монофрактального та мультифрактального часових рядів відрізняється, хоча вони мають схожі загальні середньоквадратичні значення. Мультифрактальні часові ряди містять локальні флуктуації як з екстремально малими, так і з екстремально великими значеннями, що не характерно для монофрактальних часових рядів. Відсутність флуктуацій з екстремально великими та малими значеннями призводить до нормального розподілу для монофрактального часового ряду, де варіація описується лише статистичним моментом другого порядку (дисперсією). Отже, монофрактальний DFA базується на статистиці другого порядку загального середньоквадратичного відхилення (тобто, <span class="math inline">\(F\,\)</span>). У мультифрактальному часовому ряді локальні коливання, <code>RMS[ns][v]</code>, будуть екстремально великими для сегментів <span class="math inline">\(v\)</span> в межах часових періодів великих коливань і екстремально малими для сегментів <span class="math inline">\(v\)</span> в межах часових періодів малих коливань. Отже, мультифрактальні часові ряди не є нормально розподіленими і слід враховувати всі статистичні моменти <span class="math inline">\(q\)</span>-го порядку. Таким чином, необхідно розширити загальне середньоквадратичне значення монофрактального DFA до середньоквадратичної функції флуктуацій <span class="math inline">\(q\)</span>-го порядку мультифрактального DFA <span class="math inline">\((F_{q})\)</span>:</p>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calc_Fq(arr, scale, q, m<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> np.cumsum(arr <span class="op">-</span> np.mean(arr)) <span class="co"># симулюємо випадкове блукання (X)</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> X.T                           <span class="co"># транспонуємо значення X</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    scale <span class="op">=</span> scale </span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    qs <span class="op">=</span> q</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    m <span class="op">=</span> m</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    segments <span class="op">=</span> np.zeros(<span class="bu">len</span>(scale), dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    Fq <span class="op">=</span> np.zeros((<span class="bu">len</span>(qs), <span class="bu">len</span>(scale)))</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    Index <span class="op">=</span> {}</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    RMS <span class="op">=</span> {}    <span class="co"># словник локальних середньоквадратичних відхилень</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    fit <span class="op">=</span> {}    <span class="co"># словник для збереження отриманих поліноміальних кривих</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>                <span class="co"># для кожного сегмента</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>    qRMS <span class="op">=</span> {}   <span class="co"># словник локальних відхилень зважених показником q</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> ns <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(scale)):</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>        segments[ns] <span class="op">=</span> np.floor(<span class="bu">len</span>(X) <span class="op">/</span> scale[ns]).astype(<span class="bu">int</span>)</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>        RMS[ns] <span class="op">=</span> np.zeros(segments[ns])</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># проходимо по кожному сегменту</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> v <span class="kw">in</span> <span class="bu">range</span>(segments[ns]): </span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>            <span class="co"># визначаємо початкове значення сегмента</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>            Idx_start <span class="op">=</span> v <span class="op">*</span> scale[ns]  </span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>                       </span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>            <span class="co"># визначаємо кінцеве значення</span></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>            Idx_stop <span class="op">=</span> (v <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> scale[ns] <span class="cf">if</span> v <span class="op">&lt;</span> segments[ns] <span class="op">-</span> <span class="dv">1</span> <span class="cf">else</span> <span class="bu">len</span>(X)    </span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>            <span class="co"># формуємо масив індексів значень досліджуваного сегмента</span></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>            Index[v] <span class="op">=</span> np.arange(Idx_start, Idx_stop)  </span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>            <span class="co"># вилучаємо значення по індексам</span></span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>            X_Idx <span class="op">=</span> X[Index[v]]                       </span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>            <span class="co"># визначаємо поліноміальні коефіцієнти порядку m</span></span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>            C <span class="op">=</span> np.polyfit(Index[v], X_Idx, m) </span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>            <span class="co"># будуємо поліноміальну криву по визначеним коефіцієнтам</span></span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a>            fit <span class="op">=</span> np.polyval(C, Index[v])  </span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a>            <span class="co"># оцінюємо середньоквадратичне відхилення для фрагмента v на масштабі ns </span></span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a>            RMS[ns][v] <span class="op">=</span> np.sqrt(np.mean((X_Idx <span class="op">-</span> fit) <span class="op">**</span> <span class="dv">2</span>)) </span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a>        <span class="co"># приводимо q значення до типу float</span></span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a>        qs <span class="op">=</span> np.asarray_chkfinite(qs, dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a>        <span class="co"># для мультифрактальності</span></span>
<span id="cb30-49"><a href="#cb30-49" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ----------------------------</span></span>
<span id="cb30-50"><a href="#cb30-50" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> nq, qval <span class="kw">in</span> <span class="bu">enumerate</span>(qs):</span>
<span id="cb30-51"><a href="#cb30-51" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (qval <span class="op">!=</span> <span class="fl">0.</span>): </span>
<span id="cb30-52"><a href="#cb30-52" aria-hidden="true" tabindex="-1"></a>                qRMS[nq, ns] <span class="op">=</span> RMS[ns] <span class="op">**</span> q[nq]</span>
<span id="cb30-53"><a href="#cb30-53" aria-hidden="true" tabindex="-1"></a>                Fq[nq, ns] <span class="op">=</span> np.mean(qRMS[nq, ns]) <span class="op">**</span> (<span class="dv">1</span> <span class="op">/</span> q[nq])</span>
<span id="cb30-54"><a href="#cb30-54" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb30-55"><a href="#cb30-55" aria-hidden="true" tabindex="-1"></a>                Fq[nq, ns] <span class="op">=</span> np.exp(<span class="fl">0.5</span> <span class="op">*</span> np.mean(np.log(RMS[ns] <span class="op">**</span> <span class="dv">2</span>)))</span>
<span id="cb30-56"><a href="#cb30-56" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ----------------------------</span></span>
<span id="cb30-57"><a href="#cb30-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-58"><a href="#cb30-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> Fq, qRMS, Index</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>У новому блоці коду запускається цикл, який обчислює загальне середньоквадратичне значення <span class="math inline">\(q\)</span>-порядку <span class="math inline">\(F_{q}(nq)\)</span> від від’ємних до додатних <span class="math inline">\(q\)</span>. Порядок <span class="math inline">\(q\)</span> зважує вплив сегментів ряду з великими та малими коливаннями, <code>RMS</code>, як показано на наступному рисунку. На величину <span class="math inline">\(F_{q}(nq)\)</span> для від’ємних <span class="math inline">\(q\)</span> впливають сегменти <span class="math inline">\(v\)</span> з малими <code>RMS(v)</code>. Навпаки, на <span class="math inline">\(F_{q}(nq)\)</span> для додатних <span class="math inline">\(q\)</span> впливають відрізки <span class="math inline">\(v\)</span> з великими <code>RMS(v)</code>. Локальні флуктуації <code>RMS</code> з великими та малими величинами класифікуються за величиною від’ємного або додатного порядку <span class="math inline">\(q\)</span> відповідно. На <span class="math inline">\(F_{q}\)</span> для <span class="math inline">\(q = -3\)</span> і <span class="math inline">\(3\)</span> більше впливають відрізки <span class="math inline">\(v\)</span> з найменшим і найбільшим <code>RMS(v)</code>, відповідно, порівняно з <span class="math inline">\(F_{q}\)</span> для <span class="math inline">\(q = -1\)</span> і <span class="math inline">\(1\)</span>. Середня точка <span class="math inline">\(q = 0\)</span> є нейтральною щодо впливу відрізків з малим та великим <code>RMS</code>. Зверніть увагу, що в останньому рядку коду нового блоку перевизначено окремий випадок <span class="math inline">\(q(nq) = 0\)</span>, оскільки <span class="math inline">\(1/0\)</span> прямує до нескінченності (тобто, <span class="math inline">\(1/q(q = 0) = \infty\)</span>). Читач також повинен помітити, що <span class="math inline">\(F_{q}[q == 2]\)</span> дорівнює статистиці другого порядку <span class="math inline">\(F\)</span>, оскільки <span class="math inline">\(\sqrt{x} = x^{1/2}\)</span>. Монофрактальний DFA тепер розширюється до MFDFA.</p>
<div class="cell" data-execution_count="135">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>scales <span class="op">=</span> np.array([<span class="dv">32</span>])</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>nq <span class="op">=</span> np.array([<span class="op">-</span><span class="dv">3</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>])</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>Fq, qRMS, Index <span class="op">=</span> calc_Fq(wti_ret, scale<span class="op">=</span>scales, q<span class="op">=</span>nq, m<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>Fq_pink, qRMS_pink, Index <span class="op">=</span> calc_Fq(pink_noise, scale<span class="op">=</span>scales, q<span class="op">=</span>nq, m<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="140">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots((<span class="bu">len</span>(nq)<span class="op">+</span><span class="dv">1</span>), <span class="dv">1</span>, sharex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(time_ser.index[<span class="dv">1</span>:], wti_ret, label<span class="op">=</span><span class="st">"Мультифрактал"</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(time_ser.index[<span class="dv">1</span>:], pink_noise, label<span class="op">=</span><span class="st">"Монофрактал"</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].grid(<span class="va">False</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].margins(x<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].legend(loc<span class="op">=</span><span class="st">'upper left'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].get_xaxis().set_visible(<span class="va">False</span>)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(nq)<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    l <span class="op">=</span> [Index[val] <span class="cf">for</span> val <span class="kw">in</span> Index.keys()]</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> np.array([])</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> v <span class="kw">in</span> l:</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> np.concatenate([x, v])</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> np.array([])</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>    y_pink <span class="op">=</span> np.array([])</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, v <span class="kw">in</span> <span class="bu">enumerate</span>(l): </span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> np.concatenate([y, qRMS[(idx<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>)][i]<span class="op">*</span>np.ones(<span class="bu">len</span>(v))])</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>        y_pink <span class="op">=</span> np.concatenate([y_pink, qRMS_pink[(idx<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>)][i]<span class="op">*</span>np.ones(<span class="bu">len</span>(v))])</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>    ax[idx].set_title(<span class="vs">fr"Локальні варіації для </span><span class="sc">{</span>scales[<span class="dv">0</span>]<span class="sc">}</span><span class="vs">-го масштабу при $q=$</span><span class="sc">{</span>nq[idx<span class="op">-</span><span class="dv">1</span>]<span class="sc">}</span><span class="vs">"</span>, fontsize<span class="op">=</span><span class="dv">14</span>)</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>    ax[idx].plot(time_ser.index[<span class="dv">1</span>:], y)</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>    ax[idx].plot(time_ser.index[<span class="dv">1</span>:], y_pink)</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>    ax[idx].grid(<span class="va">False</span>)</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>    ax[idx].margins(x<span class="op">=</span><span class="dv">0</span>)       </span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>handles, labels <span class="op">=</span> ax[<span class="dv">0</span>].get_legend_handles_labels()</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>fig.tight_layout(pad<span class="op">=</span><span class="fl">0.01</span>)</span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>plt.show()<span class="op">;</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-step-7" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="lab_7_files/figure-html/fig-step-7-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.13: Ілюстрація залежності локальних флуктуацій <code>qRMS</code> від <span class="math inline">\(q\)</span> при масштабі 32</figcaption>
</figure>
</div>
</div>
</div>
<p><code>qRMS</code> на <a href="#fig-step-7">Рис.&nbsp;<span>7.13</span></a> — це <span class="math inline">\(q\)</span>-порядок локальних флуктуацій (тобто, <code>RMS</code>) і є складовою частиною загального<span class="math inline">\(q\)</span>-порядку <code>RMS</code> (тобто, <span class="math inline">\(F_{q}\)</span>). <code>qRMS</code> представлено для монофрактального (зелена смуга) та мультифрактальних (синя смуга) часових рядів. Від’ємний порядок <span class="math inline">\(q\)</span> (<span class="math inline">\(q = -3\)</span> і <span class="math inline">\(-1\)</span>) підсилює сегменти в мультифрактальному часовому ряді з екстремально малими <code>RMS</code>, тоді як додатний порядок <span class="math inline">\(q\)</span> (<span class="math inline">\(q = 3\)</span> і <span class="math inline">\(1\)</span>) підсилює відрізки з екстремально великими <code>RMS</code>. Зверніть увагу, що <span class="math inline">\(q = -3\)</span> і <span class="math inline">\(q = 3\)</span> підсилюють малу і велику варіацію відповідно більше, ніж <span class="math inline">\(q = -1\)</span> і <span class="math inline">\(q = 1\)</span>. Зауважте також, що монофрактальний часовий ряд не має відрізків з екстремально великими або малими коливаннями і, таким чином, не має піків у <code>qRMS</code>. Загальне середньоквадратичне відхилення <span class="math inline">\(q\)</span>-го порядку здатне розрізняти структуру малих і великих флуктуацій і, відповідно, монофрактальних і мультифрактальних часових рядів.</p>
<p>Тепер можна визначити показники Херста <span class="math inline">\(q\)</span>-го порядку як нахили <span class="math inline">\(h(q)\)</span> ліній регресії для кожного середньоквадратичного значення <span class="math inline">\(F_{q}\)</span> <span class="math inline">\(q\)</span>-го порядку. І <span class="math inline">\(h(q)\)</span>, і лінія регресії визначаються в циклі для кожного <span class="math inline">\(q\)</span>-го порядку:</p>
<div class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calc_Hq(arr, scale, q, m<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> np.cumsum(arr <span class="op">-</span> np.mean(arr)) <span class="co"># симулюємо випадкове блукання (X)</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> X.T                           <span class="co"># транспонуємо значення X</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    scale <span class="op">=</span> scale </span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    qs <span class="op">=</span> q</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    m <span class="op">=</span> m</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    segments <span class="op">=</span> np.zeros(<span class="bu">len</span>(scale), dtype<span class="op">=</span><span class="bu">int</span>) </span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    Fq <span class="op">=</span> np.zeros((<span class="bu">len</span>(qs), <span class="bu">len</span>(scale)))       <span class="co"># масив для збереження загальної функції флуктуацій </span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    hq <span class="op">=</span> np.zeros(<span class="bu">len</span>(qs), dtype<span class="op">=</span><span class="bu">float</span>)        <span class="co"># масив для збереження Херста q-го порядку</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    qRegLine <span class="op">=</span> {} <span class="co"># словник для збереження ліній регресій</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    Index <span class="op">=</span> {}    <span class="co"># словник для збереження індексів сегментів ряду</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    RMS <span class="op">=</span> {}      <span class="co"># словник локальних середньоквадратичних відхилень</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>    fit <span class="op">=</span> {}      <span class="co"># словник для збереження отриманих поліноміальних кривих</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># для кожного сегмента</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>    qRMS <span class="op">=</span> {}     <span class="co"># словник локальних відхилень зважених показником q</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> ns <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(scale)):</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>        segments[ns] <span class="op">=</span> np.floor(<span class="bu">len</span>(X) <span class="op">/</span> scale[ns]).astype(<span class="bu">int</span>)</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>        RMS[ns] <span class="op">=</span> np.zeros(segments[ns])</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>        <span class="co"># проходимо по кожному сегменту</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> v <span class="kw">in</span> <span class="bu">range</span>(segments[ns]): </span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>            <span class="co"># визначаємо початкове значення сегмента</span></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>            Idx_start <span class="op">=</span> v <span class="op">*</span> scale[ns]  </span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>                       </span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>            <span class="co"># визначаємо кінцеве значення</span></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>            Idx_stop <span class="op">=</span> (v <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> scale[ns] <span class="cf">if</span> v <span class="op">&lt;</span> segments[ns] <span class="op">-</span> <span class="dv">1</span> <span class="cf">else</span> <span class="bu">len</span>(X)    </span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>            <span class="co"># формуємо масив індексів значень досліджуваного сегмента</span></span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>            Index[v] <span class="op">=</span> np.arange(Idx_start, Idx_stop)  </span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>            <span class="co"># вилучаємо значення по індексам</span></span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>            X_Idx <span class="op">=</span> X[Index[v]]                       </span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>            <span class="co"># визначаємо поліноміальні коефіцієнти порядку m</span></span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>            C <span class="op">=</span> np.polyfit(Index[v], X_Idx, m) </span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>            <span class="co"># будуємо поліноміальну криву по визначеним коефіцієнтам</span></span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a>            fit <span class="op">=</span> np.polyval(C, Index[v])  </span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a>            <span class="co"># оцінюємо середньоквадратичне відхилення для фрагмента v на масштабі ns </span></span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a>            RMS[ns][v] <span class="op">=</span> np.sqrt(np.mean((X_Idx <span class="op">-</span> fit) <span class="op">**</span> <span class="dv">2</span>)) </span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a>        <span class="co"># приводимо q значення до типу float</span></span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a>        qs <span class="op">=</span> np.asarray_chkfinite(qs, dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true" tabindex="-1"></a>        <span class="co"># для мультифрактальності</span></span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ----------------------------</span></span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> nq, qval <span class="kw">in</span> <span class="bu">enumerate</span>(qs):</span>
<span id="cb33-53"><a href="#cb33-53" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (qval <span class="op">!=</span> <span class="fl">0.</span>): </span>
<span id="cb33-54"><a href="#cb33-54" aria-hidden="true" tabindex="-1"></a>                qRMS[nq, ns] <span class="op">=</span> RMS[ns] <span class="op">**</span> q[nq]</span>
<span id="cb33-55"><a href="#cb33-55" aria-hidden="true" tabindex="-1"></a>                Fq[nq, ns] <span class="op">=</span> np.mean(qRMS[nq, ns]) <span class="op">**</span> (<span class="dv">1</span> <span class="op">/</span> q[nq])</span>
<span id="cb33-56"><a href="#cb33-56" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb33-57"><a href="#cb33-57" aria-hidden="true" tabindex="-1"></a>                Fq[nq, ns] <span class="op">=</span> np.exp(<span class="fl">0.5</span> <span class="op">*</span> np.mean(np.log(RMS[ns] <span class="op">**</span> <span class="dv">2</span>)))</span>
<span id="cb33-58"><a href="#cb33-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-59"><a href="#cb33-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> nq, _ <span class="kw">in</span> <span class="bu">enumerate</span>(qs): </span>
<span id="cb33-60"><a href="#cb33-60" aria-hidden="true" tabindex="-1"></a>            <span class="co"># якщо флуктуації дорів. 0, log2 стикнеться з діленням на 0 </span></span>
<span id="cb33-61"><a href="#cb33-61" aria-hidden="true" tabindex="-1"></a>            old_setting <span class="op">=</span> np.seterr(divide<span class="op">=</span><span class="st">"ignore"</span>, invalid<span class="op">=</span><span class="st">"ignore"</span>)</span>
<span id="cb33-62"><a href="#cb33-62" aria-hidden="true" tabindex="-1"></a>            C <span class="op">=</span> np.polyfit(np.log(scale), np.log(Fq[nq, :]), m)</span>
<span id="cb33-63"><a href="#cb33-63" aria-hidden="true" tabindex="-1"></a>            np.seterr(<span class="op">**</span>old_setting)</span>
<span id="cb33-64"><a href="#cb33-64" aria-hidden="true" tabindex="-1"></a>            hq[nq] <span class="op">=</span> C[<span class="dv">0</span>]</span>
<span id="cb33-65"><a href="#cb33-65" aria-hidden="true" tabindex="-1"></a>            qRegLine[nq] <span class="op">=</span> np.polyval(C, np.log(scale))</span>
<span id="cb33-66"><a href="#cb33-66" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ----------------------------</span></span>
<span id="cb33-67"><a href="#cb33-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-68"><a href="#cb33-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> hq, qRegLine, Fq </span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>scmin <span class="op">=</span> <span class="dv">16</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>scmax <span class="op">=</span> <span class="dv">1024</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>scres <span class="op">=</span> <span class="dv">19</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>q_min <span class="op">=</span> <span class="op">-</span><span class="fl">5.0</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>q_max <span class="op">=</span> <span class="fl">5.0</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>q_step <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>nq <span class="op">=</span> np.arange(q_min, q_max<span class="op">+</span>q_step, q_step)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>exponents <span class="op">=</span> np.linspace(np.log(scmin), np.log(scmax), scres)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>scales_exp <span class="op">=</span> np.<span class="bu">round</span>(np.exp(<span class="dv">1</span>)<span class="op">**</span>exponents).astype(<span class="bu">int</span>)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>Hq_multifrac, qRegLine_multifrac, Fq_multifrac <span class="op">=</span> calc_Hq(wti_ret, scale<span class="op">=</span>scales_exp, q<span class="op">=</span>nq, m<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>Hq_monofrac, qRegLine_monofrac, Fq_monofrac <span class="op">=</span> calc_Hq(pink_noise, scale<span class="op">=</span>scales_exp, q<span class="op">=</span>nq, m<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>Hq_white_noise, qRegLine_white_noise, Fq_white_noise <span class="op">=</span> calc_Hq(white_noise, scale<span class="op">=</span>scales_exp, q<span class="op">=</span>nq, m<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">0</span>].set_title(<span class="st">"Мультифрактал"</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">0</span>].set_xlabel(<span class="vs">r"$ns$"</span>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">0</span>].set_ylabel(<span class="vs">r"$F_</span><span class="sc">{q}</span><span class="vs">(ns)$"</span>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">0</span>].set_xscale(<span class="st">'log'</span>)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">0</span>].set_yscale(<span class="st">'log'</span>)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(nq)):</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">0</span>][<span class="dv">0</span>].scatter(scales_exp, Fq_multifrac[i, :], color<span class="op">=</span><span class="st">'darkblue'</span>)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">0</span>][<span class="dv">0</span>].plot(scales_exp, np.exp(qRegLine_multifrac[i]),  color<span class="op">=</span><span class="st">'darkblue'</span>)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">1</span>].set_title(<span class="st">"Монофрактал"</span>)</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">1</span>].set_xlabel(<span class="vs">r"$ns$"</span>)</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">1</span>].set_xscale(<span class="st">'log'</span>)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">1</span>].set_yscale(<span class="st">'log'</span>)</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(nq)):</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">0</span>][<span class="dv">1</span>].scatter(scales_exp, Fq_monofrac[i, :], color<span class="op">=</span><span class="st">'magenta'</span>)</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">0</span>][<span class="dv">1</span>].plot(scales_exp, np.exp(qRegLine_monofrac[i]),  color<span class="op">=</span><span class="st">'magenta'</span>)</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">0</span>].set_title(<span class="st">"Білий шум"</span>)</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">0</span>].set_xlabel(<span class="vs">r"$ns$"</span>)</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">0</span>].set_ylabel(<span class="vs">r"$F_</span><span class="sc">{q}</span><span class="vs">(ns)$"</span>)</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">0</span>].set_xscale(<span class="st">'log'</span>)</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">0</span>].set_yscale(<span class="st">'log'</span>)</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(nq)):</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">1</span>][<span class="dv">0</span>].scatter(scales_exp, Fq_white_noise[i, :], color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>    ax[<span class="dv">1</span>][<span class="dv">0</span>].plot(scales_exp, np.exp(qRegLine_white_noise[i]),  color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">1</span>].set_title(<span class="vs">r"Показники Херста $q$-го порядку"</span>)</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">1</span>].set_xlabel(<span class="vs">r"$q$"</span>)</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">1</span>].set_ylabel(<span class="vs">r"$h(q)$"</span>)</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">1</span>].plot(nq, Hq_multifrac, linestyle<span class="op">=</span><span class="st">'-'</span>, marker<span class="op">=</span><span class="st">'o'</span>, label<span class="op">=</span><span class="st">"Мультифрактал"</span>, color<span class="op">=</span><span class="st">'darkblue'</span>)</span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">1</span>].plot(nq, Hq_monofrac,linestyle<span class="op">=</span><span class="st">'-'</span>, marker<span class="op">=</span><span class="st">'o'</span>, label<span class="op">=</span><span class="st">"Монофрактал"</span>, color<span class="op">=</span><span class="st">'magenta'</span>)</span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">1</span>].plot(nq, Hq_white_noise, linestyle<span class="op">=</span><span class="st">'-'</span>, marker<span class="op">=</span><span class="st">'o'</span>, label<span class="op">=</span><span class="st">"Білий шум"</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">1</span>].legend(loc<span class="op">=</span><span class="st">'center right'</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>fig.tight_layout(pad<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>plt.show()<span class="op">;</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-step8" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="lab_7_files/figure-html/fig-step8-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.14: Середньоквадратичні значення <span class="math inline">\(F_{q}\)</span> для різних <span class="math inline">\(q\)</span>-их порядків та відповідні лінії регресії, обчислені за допомогою MFDFA для мультифракталу, монофракталу та білого шуму</figcaption>
</figure>
</div>
</div>
</div>
<p>Можемо бачити, що узагальнена функція флуктуацій для мультифракталу залежить не лише від масштабу, але й від <span class="math inline">\(q\)</span>, що демонструють різні нахили ліній регресії <span class="math inline">\(h(q)\)</span>. Масштабуючі узагальнені функції флуктуацій <span class="math inline">\(F_{q}\)</span> для монофракталу та білого шуму є <span class="math inline">\(q\)</span>-незалежними, оскільки їх лінії регресії для різних масштабів мають один і той самий кут нахилу. Показник Херста <span class="math inline">\(q\)</span>-го порядку <span class="math inline">\(h(q)\)</span> для мультифрактального ряду (синя лінія) представляється незалежним для <span class="math inline">\(q&lt;0\)</span> і змінним для <span class="math inline">\(q&gt;0\)</span>. Це вказує на те, що джерелом мультифрактальності нафти є аномально великі флуктуацій як, наприклад, криза коронавірусної пандемії. Для монофракталу (рожева лінія) та білого шуму (червона лінія) <span class="math inline">\(h(q)\)</span> залишаються сталими.</p>
</section>
<section id="мультифрактальний-спектр-часових-рядів" class="level4" data-number="7.1.4.7">
<h4 data-number="7.1.4.7" class="anchored" data-anchor-id="мультифрактальний-спектр-часових-рядів"><span class="header-section-number">7.1.4.7</span> Мультифрактальний спектр часових рядів</h4>
<p>Показник Херста <span class="math inline">\(q\)</span>-го порядку <span class="math inline">\(h(q)\)</span> є лише одним з декількох типів масштабних показників, що використовуються для параметризації мультифрактальної структури часових рядів. Як уже було представлено попередньо, ми можемо вивести показник маси <span class="math inline">\(q\)</span>-го порядку (<span class="math inline">\(\tau(q)\)</span>), а потім через <span class="math inline">\(\tau(q)\)</span> отримати показник сингулярності <span class="math inline">\(q\)</span>-го порядку (<span class="math inline">\(\alpha(q)\)</span>) і фрактальну розмірність (<span class="math inline">\(f(\alpha)\)</span>) флуктуацій (областей) із ступенем сингулярності <span class="math inline">\(\alpha(q)\)</span>. Графік залежності <span class="math inline">\(\alpha(q)\)</span> від <span class="math inline">\(f(\alpha)\)</span> представляє мультифрактальний спектр. Показники маси, сингулярності та фрактальності можна обчислити згідно коду, що наведений нижче:</p>
<div class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>tau_multifrac <span class="op">=</span> nq <span class="op">*</span> Hq_multifrac <span class="op">-</span> <span class="dv">1</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>tau_monofrac <span class="op">=</span> nq <span class="op">*</span> Hq_monofrac <span class="op">-</span> <span class="dv">1</span> </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>tau_white_noise <span class="op">=</span> nq <span class="op">*</span> Hq_white_noise <span class="op">-</span> <span class="dv">1</span> </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>alpha_multifrac <span class="op">=</span> np.gradient(tau_multifrac, nq)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>alpha_monofrac <span class="op">=</span> np.gradient(tau_monofrac, nq)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>alpha_white_noise <span class="op">=</span> np.gradient(tau_white_noise, nq)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>f_multifrac <span class="op">=</span> nq <span class="op">*</span> alpha_multifrac <span class="op">-</span> tau_multifrac</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>f_monofrac <span class="op">=</span> nq <span class="op">*</span> alpha_monofrac <span class="op">-</span> tau_monofrac</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>f_white_noise <span class="op">=</span> nq <span class="op">*</span> alpha_white_noise <span class="op">-</span> tau_white_noise</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xlabel(<span class="vs">r"$q$"</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_ylabel(<span class="vs">r"$\tau(q)$"</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(nq, tau_multifrac, linestyle<span class="op">=</span><span class="st">'-'</span>, marker<span class="op">=</span><span class="st">'o'</span>, label<span class="op">=</span><span class="st">"Мультифрактал"</span>, color<span class="op">=</span><span class="st">'darkblue'</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(nq, tau_monofrac, linestyle<span class="op">=</span><span class="st">'-'</span>, marker<span class="op">=</span><span class="st">'o'</span>, label<span class="op">=</span><span class="st">"Монофрактал"</span>, color<span class="op">=</span><span class="st">'magenta'</span>)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(nq, tau_white_noise, linestyle<span class="op">=</span><span class="st">'-'</span>, marker<span class="op">=</span><span class="st">'o'</span>, label<span class="op">=</span><span class="st">"Білий шум"</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].legend()</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xlabel(<span class="vs">r"$\alpha$"</span>)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_ylabel(<span class="vs">r"$f(\alpha)$"</span>)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(alpha_multifrac, f_multifrac, linestyle<span class="op">=</span><span class="st">'-'</span>, marker<span class="op">=</span><span class="st">'o'</span>, label<span class="op">=</span><span class="st">"Мультифрактал"</span>, color<span class="op">=</span><span class="st">'darkblue'</span>)</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(alpha_monofrac, f_monofrac, linestyle<span class="op">=</span><span class="st">'-'</span>, marker<span class="op">=</span><span class="st">'o'</span>, label<span class="op">=</span><span class="st">"Монофрактал"</span>, color<span class="op">=</span><span class="st">'magenta'</span>)</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(alpha_white_noise, f_white_noise, linestyle<span class="op">=</span><span class="st">'-'</span>, marker<span class="op">=</span><span class="st">'o'</span>, label<span class="op">=</span><span class="st">"Білий шум"</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].set_xlabel(<span class="vs">r"$q$"</span>)</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].set_ylabel(<span class="vs">r"$f(\alpha)$"</span>)</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].plot(nq, f_multifrac, linestyle<span class="op">=</span><span class="st">'-'</span>, marker<span class="op">=</span><span class="st">'o'</span>, label<span class="op">=</span><span class="st">"Мультифрактал"</span>, color<span class="op">=</span><span class="st">'darkblue'</span>)</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].plot(nq, f_monofrac, linestyle<span class="op">=</span><span class="st">'-'</span>, marker<span class="op">=</span><span class="st">'o'</span>, label<span class="op">=</span><span class="st">"Монофрактал"</span>, color<span class="op">=</span><span class="st">'magenta'</span>)</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].plot(nq, f_white_noise, linestyle<span class="op">=</span><span class="st">'-'</span>, marker<span class="op">=</span><span class="st">'o'</span>, label<span class="op">=</span><span class="st">"Білий шум"</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>fig.tight_layout(pad<span class="op">=</span><span class="fl">0.01</span>) </span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>plt.show()<span class="op">;</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-step9" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="lab_7_files/figure-html/fig-step9-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.15: Множинне представляння мультифрактального спектра для мультифрактала, монофрактала та білого шуму</figcaption>
</figure>
</div>
</div>
</div>
<p>Показники сингулярності <span class="math inline">\(\alpha\)</span> для великих висококонцентрованих флуктуацій малі й розташовані в лівому хвості спектра, тоді як <span class="math inline">\(\alpha\)</span> для малих флуктуацій великі й розташовані в правому хвості спектра.</p>
<p>Таким чином, сила мультифрактальності описується великим відхиленням експоненти локальної сингулярності <span class="math inline">\(\alpha\)</span> від центральної тенденції <span class="math inline">\(\alpha(0)\)</span>. Монофрактальний сигнал — це випадок, коли <span class="math inline">\(\alpha\)</span> залишається майже константною, і в деяких випадках мультифрактальний спектр зводиться до однієї точки за даною <span class="math inline">\(\alpha\)</span>.</p>
<p>Діапазон <span class="math inline">\(\alpha\)</span> вказує на різноманітність експонент сингулярності, що описують динаміку системи, а величина <span class="math inline">\(f(\alpha)\)</span> вказує на величину внеску елементів із відповідним показником <span class="math inline">\(\alpha\)</span>.</p>
<p>Мультифрактальний спектр може характеризуватися різною шириною, що вказує на варіативність процесів, що відбуваються всередині системи. Так само він може бути як симетричним, так і асиметричним. Асиметрія буває як правосторонньою, так і лівосторонньою, що вказує на різний ступінь впливу висококонцентрованих і низькоконцентрованих елементів (флуктуацій). Мультифрактальний спектр матиме довгий лівий хвіст, коли часовий ряд має мультифрактальну структуру, чутливу до локальних флуктуацій з великими амплітудами.</p>
<p>Навпаки, мультифрактальний спектр матиме довгий правий хвіст, коли він чутливий до локальних флуктуацій з малими амплітудами.</p>
<p>Проілюструємо залежність ширини спектра мультифрактальності від рівня флуктуацій у ряді. Дану залежність будемо демонструвати на прикладі рядів, що розподілятимуться згідно <a href="https://en.wikipedia.org/wiki/Stable_distribution">альфа-стабільному розподілу Леві</a>, який ми ще розглядатимемо в наступних роботах. Для генерації випадкових величин із даного розподілу, використовуватимемо модуль <code>scipy.stats</code>. З нього імпортуємо клас <code>levy_stable</code> для використання методу <code>rvs()</code>. Метод приймає показник <span class="math inline">\(\alpha\)</span>, що відповідає за частоту виникнення подій, що виходять за межі нормального розподілу. Розглянемо діапазон таких значень <span class="math inline">\(\alpha\)</span> та спектри згенерованих рядів.</p>
<div class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> levy_stable</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>alphas <span class="op">=</span> np.linspace(<span class="fl">1.5</span>, <span class="fl">2.0</span>, <span class="dv">7</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>scmin <span class="op">=</span> <span class="dv">16</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>scmax <span class="op">=</span> <span class="dv">1024</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>scres <span class="op">=</span> <span class="dv">19</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>q_min <span class="op">=</span> <span class="op">-</span><span class="fl">5.0</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>q_max <span class="op">=</span> <span class="fl">5.0</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>q_step <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>nq_levy <span class="op">=</span> np.arange(q_min, q_max<span class="op">+</span>q_step, q_step)</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>exponents <span class="op">=</span> np.linspace(np.log(scmin), np.log(scmax), scres)</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>scales_exp <span class="op">=</span> np.<span class="bu">round</span>(np.exp(<span class="dv">1</span>)<span class="op">**</span>exponents).astype(<span class="bu">int</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>color <span class="op">=</span> <span class="bu">iter</span>(plt.cm.plasma(np.linspace(<span class="dv">0</span>, <span class="fl">0.8</span>, <span class="bu">len</span>(alphas))))</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure()</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>subfigs <span class="op">=</span> fig.subfigures(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> subfigs[<span class="dv">0</span>].subplots(<span class="bu">len</span>(alphas), <span class="dv">1</span>, sharex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> subfigs[<span class="dv">1</span>].subplots(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(alphas)):</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># генеруємо альфа-стабільний процес</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> levy_stable.rvs(alpha<span class="op">=</span>alphas[i], beta<span class="op">=</span><span class="dv">0</span>, loc<span class="op">=</span><span class="dv">0</span>, </span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>                        scale<span class="op">=</span><span class="dv">1</span>, size<span class="op">=</span><span class="bu">len</span>(wti_ret), random_state<span class="op">=</span><span class="dv">123</span>)</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>    Hq_levy, qRegLine_levy, Fq_levy <span class="op">=</span> calc_Hq(r, scale<span class="op">=</span>scales_exp, q<span class="op">=</span>nq_levy, m<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>    tau_levy <span class="op">=</span> nq_levy <span class="op">*</span> Hq_levy <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>    alpha_levy <span class="op">=</span> np.gradient(tau_levy, nq_levy)</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>    f_levy <span class="op">=</span> nq_levy <span class="op">*</span> alpha_levy <span class="op">-</span> tau_levy</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>    c <span class="op">=</span> <span class="bu">next</span>(color)</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>    ax1[i].plot(np.arange(<span class="bu">len</span>(r)), r, label<span class="op">=</span><span class="vs">fr'$\alpha$=</span><span class="sc">{</span>alphas[i]<span class="sc">:.2f}</span><span class="vs">'</span>, c<span class="op">=</span>c)</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>    ax1[i].margins(x<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>    ax1[i].legend(loc<span class="op">=</span><span class="st">"upper left"</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>    ax2.plot(alpha_levy, f_levy, marker<span class="op">=</span><span class="st">'o'</span>, c<span class="op">=</span>c)</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>ax1[<span class="dv">0</span>].set_title(<span class="st">"Мультифрактальні часові ряди"</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>ax1[<span class="op">-</span><span class="dv">1</span>].set_xlabel(<span class="st">"Час (порядковий номер)"</span>)</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>ax1[<span class="bu">len</span>(alphas) <span class="op">//</span> <span class="dv">2</span>].set_ylabel(<span class="st">'Амплітуда коливань'</span>)</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">"Мультифрактальні спектри"</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="vs">r"$\alpha$"</span>)</span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="vs">r"$f(\alpha)$"</span>)</span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>fig.subplots_adjust(hspace<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>plt.show()<span class="op">;</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-spectrum-dependence" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="lab_7_files/figure-html/fig-spectrum-dependence-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.16: Ілюстрація множини мультифрактальних часових рядів (Леві альфа-стабільних процесів) та їх мультифрактальних спектрів, що були згенеровані з різними значеннями <span class="math inline">\(\alpha\)</span>. Зверніть увагу на зростання структурних відмінностей між періодами з малими і великими флуктуаціями зі збільшенням ширини мультифрактального спектра</figcaption>
</figure>
</div>
</div>
</div>
<p>Система, складність якої зумовлена висококонцентрованими елементами, матиме чітко виражений лівосторонній спектр. Складність системи, що зумовлена слабко концентрованими елементами, характеризує правий хвіст мультифрактального спектра. Якщо складність системи розвивається за рахунок елементів двох типів, тоді спектр представлятиметься симетричним, де елементи двох типів будуть рівноймовірними. Для згенерованих вище Леві альфа-стабільних процесів видно, що чим нижче значення <span class="math inline">\(\alpha\)</span>, тим сильніша домінація висококонцентрованих (великих) флуктуацій. При <span class="math inline">\(\alpha=2.0\)</span> спектр усе сильніше звужується до сингулярної точки.</p>
<p>Далі буде показано, що для отриманої мультифрактальної параболи мультифрактального спектра можуть бути розраховані показники як всієї ширини спектра <span class="math inline">\((\Delta\alpha)\)</span>, так і окремо його правого та лівого хвостів (<span class="math inline">\(R\)</span> та <span class="math inline">\(L\)</span>). Також можна розрахувати значення сингулярності, де <span class="math inline">\(f(\alpha)\)</span> приймає максимальне значення <span class="math inline">\(\alpha_0\)</span>, і навіть так звану “асиметрію” цього спектра <span class="math inline">\((\Delta f)\)</span>. На <a href="#fig-alpha-indicators">Рис.&nbsp;<span>7.17</span></a> схематично представлено положення ключових індикаторів мультифрактальності спектра.</p>
<div id="fig-alpha-indicators" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Images\lab_7\f_alpha.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.17: Графік мультифрактального спектра із відміченними на ньому показниками ширини спектра мультифрактальності (<span class="math inline">\(\Delta\alpha\)</span>), значень мінімальної, центральної та максимальної сингулярності (<span class="math inline">\(\alpha_{min}, \alpha_0, \alpha_{max}\)</span>), ширини лівого та правого хвостів спектра (<span class="math inline">\(L, R\)</span>) та різниці між фрактальними розмірностями в кінцях параболи (<span class="math inline">\(\Delta f\)</span>)</figcaption>
</figure>
</div>
<p>Також варто зазначити, що дана схема не представляє вичерпний список індикаторів мультифрактальності системи, що ми використовуватимемо в подальшому, але має надавати інтуїтивне розуміння того, як виводиться більшість мультифрактальних показників.</p>
</section>
<section id="узагальнені-фрактальні-розмірності" class="level4" data-number="7.1.4.8">
<h4 data-number="7.1.4.8" class="anchored" data-anchor-id="узагальнені-фрактальні-розмірності"><span class="header-section-number">7.1.4.8</span> Узагальнені фрактальні розмірності</h4>
<p>Наряду з мультифрактальним спектром корисно буде розглянути спектр узагальнених фрактальних розмірностей або по іншому, <em>розмірностей Реньї</em>, оскільки вони також мають інформаційно-теоретичне значення. З’ясуємо фізичний сенс узагальнених фрактальних розмірностей для деяких значень <span class="math inline">\(q\)</span>. При <span class="math inline">\(q=0\)</span>, <span class="math inline">\(Z(0, \varepsilon) = N(\varepsilon)\)</span>. З іншого боку, можна визначити, що <span class="math inline">\(Z(0, \varepsilon) \approx \varepsilon^{\tau(0)} = \varepsilon^{-D_{0}}\)</span>. Співставляючи зазначені рівності, можемо прийти до співвідношення <span class="math inline">\(N(\varepsilon) \approx \varepsilon^{-D_{0}}\)</span>. Отже, величина <span class="math inline">\(D_{0}\)</span> представляє собою звичайну хаусдорфову розмірність множини <span class="math inline">\(\Omega\)</span>. Також вона відповідає максимуму мультифрактального спектра, <span class="math inline">\(f(\alpha)\)</span>, що завжди дорівнює одиниці для одновимірного сигналу. Для задач розпізнавання кризових явищ ця характеристика є найгрубішою і не несе інформації про статистичні властивості системи.</p>
<p>Тепер з’ясуємо сенс величини <span class="math inline">\(D_{1}\)</span>. Оскільки при <span class="math inline">\(q=1\)</span> статистична сума <span class="math inline">\(Z(1, \varepsilon) = 1\)</span>, то <span class="math inline">\(\tau(1)=0\)</span>. Таким чином, ми маємо невизначеність, коли <span class="math inline">\(D_{1}=\tau(1)/(1-1)\)</span>. Розкриємо цю невизначеність за допомогою наступної рівності:</p>
<p><span class="math display">\[
Z(q, \varepsilon) = \sum_{i=1}^{N(\varepsilon)} p_{i}^{q} = \sum_{i=1}^{N(\varepsilon)} p_{i}\exp{[(q-1)\ln{p_{i}}]}.
\]</span></p>
<p>Тепер, спрямовуючи <span class="math inline">\(q \to 1\)</span>, розкладаючи експоненту і враховуючи умову нормування ймовірностей <span class="math inline">\(p_{i}\)</span>, отримуємо</p>
<p><span class="math display">\[
Z(q \to 1, \varepsilon) \approx \sum_{i=1}^{N(\varepsilon)} [p_{i} + (q-1)p_{i}\ln{p_{i}}] = 1 + (q-1)\sum_{i=1}^{N(\varepsilon)} p_{i}\ln{p_{i}}.
\]</span></p>
<p>У результаті ми приходимо до наступного виразу:</p>
<p><span class="math display">\[
D_{1} = \lim_{\varepsilon \to 0} \sum_{i=1}^{N(\varepsilon)}p_{i}\ln{p_{i}} \bigg/ \ln{\varepsilon}.
\]</span></p>
<p>З точністю до знака, чисельник у цій формулі представляє собою <strong>інформаційну ентропію</strong> фрактальної множини <span class="math inline">\(S(\varepsilon)\)</span>:</p>
<p><span class="math display">\[
S(\varepsilon) = -\sum_{i=1}^{N(\varepsilon)}p_i\ln{p_i}.
\]</span></p>
<p>Таким чином, результуюча величина узагальненої фрактальної розмірності <span class="math inline">\(D_{1}\)</span> пов’язана з ентропією <span class="math inline">\(S(\varepsilon)\)</span> наступним співвідношенням:</p>
<p><span class="math display">\[
D_{1} = - \lim_{\varepsilon \to 0} S(\varepsilon) \big/ \ln{\varepsilon}.
\]</span></p>
<p>Повертаючись до задачі розподілу точок на фрактальній множині <span class="math inline">\(\Omega\)</span>, можно сказати, що оскільки <span class="math inline">\(S(\varepsilon) \approx \varepsilon^{-D_1}\)</span>, величина <span class="math inline">\(D_{1}\)</span> характеризує інформацію, необхідну для опису положення точки в деякій комірці.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Додаткова інформація по інформаційній розмірності
</div>
</div>
<div class="callout-body-container callout-body">
<p>Інформаційна розмірність може бути використана для опису просторової неоднорідності системи. Що однорідніший атрактор, то вищим має бути цей показник. Тобто, чим більшу кількість конфігурацій здатні займати елементи даної системи, тим більша кількість інформації нам потрібна для обліку кожного елемента. За просторової однорідності інформаційна ентропія так само зростає, що пов’язує інформаційну розмірність із поняттям ентропії. Оскільки <span class="math inline">\(D_{1}\)</span> це тангенс кута нахилу лінії регресії, що будується для залежності між ентропією та радіусом кіл, у яких вимірюється частота влучання окремих елементів атрактора, можна сказати, що інформаційна розмірність відображає швидкість зміни інформаційної ентропії. Чим вища <span class="math inline">\(D_{1}\)</span>, тим стрімкіше зростає ентропія — міра нашого нинішнього незнання про систему. Чим нижча <span class="math inline">\(D_{1}\)</span>, тим менша сама ентропія. Інакше кажучи, тим більша просторова асиметрія, упорядкованіша складність, вищі наші знання про поточний стан системи, і тим менше інформації нам потрібно для опису тих конфігурацій, які система може займати</p>
</div>
</div>
<p>Для узагальненої фрактальної розмірності при <span class="math inline">\(q=2\)</span> справедливий наступний вираз:</p>
<p><span class="math display">\[
D_{2} = \lim_{\varepsilon \to 0} \ln{\sum_{i=1}^{N(\varepsilon)}p_{i}^{2}} \bigg/ \ln{\varepsilon}.
\]</span></p>
<p>Величина <span class="math inline">\(p_{i}\)</span> представляє собою ймовірність попадання точки в комірку розміром <span class="math inline">\(\varepsilon\)</span>. Тоді величина <span class="math inline">\(p_{i}^{2}\)</span> є ймовірністю попадання в цю комірку двох точок. Знаходячи суму <span class="math inline">\(p_{i}^{2}\)</span> по всім зайнятим коміркам, ми отримуємо ймовірність того, що дві навмання обрані точки з множини <span class="math inline">\(\Omega\)</span> знаходяться всередині однієї комірки з розміром <span class="math inline">\(\varepsilon\)</span>. Отже, відстань між цима двома точками буде менше або порядку <span class="math inline">\(\varepsilon\)</span>. Ймовірність знаходження двох траєкторій у межах околиці з радіусом <span class="math inline">\(\varepsilon\)</span> можна знайти за допомогою кореляційного інтеграла.</p>
<p>У такому разі ми приходимо до висновку, що узагальнена розмірність визначає залежність кореляційного інтеграла <span class="math inline">\(C(\varepsilon)\)</span> від <span class="math inline">\(\varepsilon\)</span>. З цієї причини величину <span class="math inline">\(D_{2}\)</span> в літературі іменують <strong>кореляційною розмірністю</strong>.</p>
<p>Тепер проаналізуємо поведінку <span class="math inline">\(f(\alpha)\)</span>. Значення функції в максимумі легко визначити, якщо скористатися виразом (<a href="#eq-7"><span>7.7</span></a>), де <span class="math inline">\(\tau(q) = q\alpha(q) - f(\alpha(q))\)</span> або <span class="math inline">\((q-1)D_{q} = q\alpha(q) - f(\alpha(q))\)</span>. При <span class="math inline">\(q=0\)</span> ми отримаємо, що <span class="math inline">\(f(\alpha_0)=D_{0}\)</span>, тобто максимальне значення спектра дорівнює хаусдорфовій розмірності.</p>
<div id="fig-D0" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Images\lab_7\D-0.jpg" style="height:10cm" class="figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.18: Максимум функції <span class="math inline">\(f(\alpha)\)</span> дорівнює фрактальній розмірності <span class="math inline">\(D_{0}\)</span></figcaption>
</figure>
</div>
<p>Розглянемо випадок, коли <span class="math inline">\(q=1\)</span>. Оскільки <span class="math inline">\(\tau(1) = 0\)</span>, тоді з рівняння вище слідує, що <span class="math inline">\(\alpha(1) = f(\alpha(1))\)</span>. З іншого боку ми знаємо, що оскільки <span class="math inline">\(q = df(\alpha) \big/ d\alpha\)</span>, похідна <span class="math inline">\(f(\alpha)\)</span> в цій точці дорівнює 1. Диференцюючи співвідношення <span class="math inline">\(\tau(q) = (q-1)D_{q}\)</span> по <span class="math inline">\(q\)</span>,</p>
<p><span class="math display">\[
\frac{d\tau}{dq} = D_{q} + (q-1)D_{q}^{'} = \alpha(q),
\]</span></p>
<p>і припускаючи, що <span class="math inline">\(q=1\)</span>, ми отримуємо, що <span class="math inline">\(\alpha(1)=D_{1}\)</span>. Таким чином, ми маємо <span class="math inline">\(D_{1} = \alpha(1) = f(\alpha(1))\)</span>. Отже, інформаційна розмірність <span class="math inline">\(D_{1}\)</span> лежить на кривій <span class="math inline">\(f(\alpha)\)</span> в точці, де <span class="math inline">\(\alpha=f(\alpha)\)</span> і <span class="math inline">\(f^{'}(\alpha)=1\)</span>.</p>
<div id="fig-D1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Images\lab_7\D-1.jpg" style="height:10cm" class="figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.19: Положення інформаційної розмірності <span class="math inline">\(D_{1}: D_{1}=\alpha=f(\alpha)\)</span></figcaption>
</figure>
</div>
<p>Тепер розглянемо випадок, коли <span class="math inline">\(q=2\)</span>. Користуючись попередньою формулою, отримаємо, що <span class="math inline">\(D_{2} = 2\alpha(2) - f(\alpha(2))\)</span> або <span class="math inline">\(f(\alpha(2)) = 2\alpha(2)-D_{2}\)</span>.</p>
<div id="fig-D2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Images\lab_7\D-2.jpg" style="height:10cm" class="figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.20: Геометричне визначення кореляційної розмірності <span class="math inline">\(D_{2}\)</span></figcaption>
</figure>
</div>
<p>Далі розглянемо залежність узагальненої фрактальної розмірності <span class="math inline">\(D_{q}\)</span> від різних значень <span class="math inline">\(q\)</span> для мультифрактального ряду, монофрактального та білого шуму.</p>
<div class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>difference_zero <span class="op">=</span> np.absolute(nq<span class="op">-</span><span class="dv">0</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>idx_zero <span class="op">=</span> difference_zero.argmin()</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>difference_one <span class="op">=</span> np.absolute(nq<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>idx_one <span class="op">=</span> difference_one.argmin()</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>difference_two <span class="op">=</span> np.absolute(nq<span class="op">-</span><span class="dv">2</span>)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>idx_two <span class="op">=</span> difference_two.argmin()</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="co"># ініціалізуємо масиви під розмірності</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>Dq_multifrac <span class="op">=</span> np.zeros(<span class="bu">len</span>(nq))</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>Dq_monofrac <span class="op">=</span> np.zeros(<span class="bu">len</span>(nq))</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>Dq_white_noise <span class="op">=</span> np.zeros(<span class="bu">len</span>(nq))</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Визначаємо узагальнені фрактальні розмірності там де q!=1 </span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>Dq_multifrac[nq<span class="op">!=</span>nq[idx_one]] <span class="op">=</span> tau_multifrac[nq<span class="op">!=</span>nq[idx_one]] <span class="op">/</span> (nq[nq<span class="op">!=</span>nq[idx_one]] <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>Dq_monofrac[nq<span class="op">!=</span>nq[idx_one]] <span class="op">=</span> tau_monofrac[nq<span class="op">!=</span>nq[idx_one]] <span class="op">/</span> (nq[nq<span class="op">!=</span>nq[idx_one]] <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>Dq_white_noise[nq<span class="op">!=</span>nq[idx_one]] <span class="op">=</span> tau_white_noise[nq<span class="op">!=</span>nq[idx_one]] <span class="op">/</span> (nq[nq<span class="op">!=</span>nq[idx_one]] <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Визначаємо окремо узагальнені фрактальні розмірності при q=1</span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>Dq_multifrac[nq<span class="op">==</span>nq[idx_one]] <span class="op">=</span> <span class="op">-</span>tau_multifrac[nq<span class="op">==</span>nq[idx_one]] </span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>Dq_monofrac[nq<span class="op">==</span>nq[idx_one]] <span class="op">=</span> <span class="op">-</span>tau_monofrac[nq<span class="op">==</span>nq[idx_one]]</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>Dq_white_noise[nq<span class="op">==</span>nq[idx_one]] <span class="op">=</span> <span class="op">-</span>tau_white_noise[nq<span class="op">==</span>nq[idx_one]]</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>ax.plot(nq, Dq_multifrac, linestyle<span class="op">=</span><span class="st">'-'</span>, marker<span class="op">=</span><span class="st">'o'</span>, label<span class="op">=</span><span class="st">"Мультифрактал"</span>, color<span class="op">=</span><span class="st">'darkblue'</span>)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>ax.plot(nq, Dq_monofrac, linestyle<span class="op">=</span><span class="st">'-'</span>, marker<span class="op">=</span><span class="st">'o'</span>, label<span class="op">=</span><span class="st">"Монофрактал"</span>, color<span class="op">=</span><span class="st">'magenta'</span>)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>ax.plot(nq, Dq_white_noise, linestyle<span class="op">=</span><span class="st">'-'</span>, marker<span class="op">=</span><span class="st">'o'</span>, label<span class="op">=</span><span class="st">"Білий шум"</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="vs">r"$q$"</span>)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">r"$D_</span><span class="sc">{q}</span><span class="vs">$"</span>)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>ax.legend(loc<span class="op">=</span><span class="st">"upper right"</span>)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>ax.annotate(<span class="vs">fr'$D_</span><span class="sc">{</span><span class="dv">0</span><span class="sc">}</span><span class="vs">$=</span><span class="sc">{</span>Dq_multifrac[nq<span class="op">==</span>nq[idx_zero]][<span class="dv">0</span>]<span class="sc">:.2f}</span><span class="vs">'</span>, </span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>            xy<span class="op">=</span>(nq[idx_zero], Dq_multifrac[nq<span class="op">==</span>nq[idx_zero]]), </span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>            xytext<span class="op">=</span>(nq[idx_zero]<span class="op">-</span><span class="dv">2</span>, Dq_multifrac[nq<span class="op">==</span>nq[idx_zero]]<span class="op">+</span><span class="dv">2</span>),</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>            arrowprops<span class="op">=</span><span class="bu">dict</span>(facecolor<span class="op">=</span><span class="st">'black'</span>, shrink<span class="op">=</span><span class="fl">0.05</span>), fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>ax.annotate(<span class="vs">fr'$D_</span><span class="sc">{</span><span class="dv">1</span><span class="sc">}</span><span class="vs">$=</span><span class="sc">{</span>Dq_multifrac[nq<span class="op">==</span>nq[idx_one]][<span class="dv">0</span>]<span class="sc">:.3f}</span><span class="vs">'</span>, </span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>            xy<span class="op">=</span>(nq[idx_one], Dq_multifrac[nq<span class="op">==</span>nq[idx_one]]), </span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>            xytext<span class="op">=</span>(nq[idx_one]<span class="op">-</span><span class="dv">3</span>, Dq_multifrac[nq<span class="op">==</span>nq[idx_one]]<span class="op">-</span><span class="fl">1.5</span>),</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>            arrowprops<span class="op">=</span><span class="bu">dict</span>(facecolor<span class="op">=</span><span class="st">'black'</span>, shrink<span class="op">=</span><span class="fl">0.05</span>), fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>ax.annotate(<span class="vs">fr'$D_</span><span class="sc">{</span><span class="dv">2</span><span class="sc">}</span><span class="vs">$=</span><span class="sc">{</span>Dq_multifrac[nq<span class="op">==</span>nq[idx_two]][<span class="dv">0</span>]<span class="sc">:.2f}</span><span class="vs">'</span>, </span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>            xy<span class="op">=</span>(nq[idx_two], Dq_multifrac[nq<span class="op">==</span>nq[idx_two]]), </span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>            xytext<span class="op">=</span>(nq[idx_two], Dq_multifrac[nq<span class="op">==</span>nq[idx_two]]<span class="op">-</span><span class="fl">1.5</span>),</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>            arrowprops<span class="op">=</span><span class="bu">dict</span>(facecolor<span class="op">=</span><span class="st">'black'</span>, shrink<span class="op">=</span><span class="fl">0.05</span>), fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>plt.show()<span class="op">;</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-gen-frac" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="lab_7_files/figure-html/fig-gen-frac-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.21: Залежність узагальнених фрактальних розмірностей <span class="math inline">\(D(q)\)</span> від <span class="math inline">\(q\)</span></figcaption>
</figure>
</div>
</div>
</div>
<p>З представленого рисунку видно, що, по-переше, для всіх сигналів <span class="math inline">\(D_{0}=1\)</span>, що відповідає теоретичним міркуванням. Інформаційна розмірність <span class="math inline">\(D_{1}\)</span> для мультифрактала та білого шуму однакова, що може говорити і про інформаційну зачущість обох сигналів. Для монофрактала вона близька до нуля. Кореляційна розмірність <span class="math inline">\(D_{2}\)</span> показує, що загалом як WTI, так і білий шум доволі схожі: їх значення в більшості своїй постають незалежними один від одного. Це розбігається з тими висновками, що були зробені в попередній роботі, де наближення <span class="math inline">\(D_{2}\)</span> до нуля вказувало на зростання ступеня корельованості системи. Для монофракталу <span class="math inline">\(D_{2}\)</span> знаходиться на рівні 1, що вказує на вищий ступінь кореляцій у цьому сигналі, порівнюючи з мульти- та монофракталами.</p>
</section>
<section id="аналогії-мультифракталів-із-термодинамікою" class="level4" data-number="7.1.4.9">
<h4 data-number="7.1.4.9" class="anchored" data-anchor-id="аналогії-мультифракталів-із-термодинамікою"><span class="header-section-number">7.1.4.9</span> Аналогії мультифракталів із термодинамікою</h4>
<p>Використовуючи концепції MFDFA, ми можемо по-новому поглянути на часовий сигнал як на термодинамічну систему. В рамках MFDFA показник маси <span class="math inline">\(\tau(q)\)</span> можна розглядати як аналоги вільної енергії, показник сингулярності <span class="math inline">\(\alpha\)</span> як аналог внутрішньої енергії <span class="math inline">\(U\)</span>, мультифрактальний спектр <span class="math inline">\(f(\alpha)\)</span> як ентропію. Дійсно, форма мультифрактального спектра нагадує залежність ентропії термодинамічної системи від енергії <span class="math inline">\(U\)</span>. Показники <span class="math inline">\(\alpha_{min}\)</span> та <span class="math inline">\(\alpha_{max}\)</span> можна охарактеризувати як верхній та нижній ліміти внутрішньої енергії системи. Функція <span class="math inline">\(Z(q)\)</span> є формальним аналогом статистичної суми <span class="math inline">\(Z(\beta)\)</span> в термодинаміці, де <span class="math inline">\(\beta=1/T=q\)</span>.</p>
<div id="fig-alpha-dependence" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Images\lab_7\multifractal-physics.jpg" style="height:13cm" class="figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.22: Схематичне представлення аналогії мультифракталів із концепціями термодинаміки</figcaption>
</figure>
</div>
<p>Окрім цього, ми можемо прорахувати “температуру” досліджуваного сигнала. Більш конкретно, мультифрактальну “питому теплоємність” <span class="math inline">\(C(q)\)</span> <span class="citation" data-cites="EnriqueCanessa_2000">&nbsp;[<a href="references.html#ref-EnriqueCanessa_2000" role="doc-biblioref">23</a>]</span> можна визначити як</p>
<p><span class="math display">\[
C(q) \equiv -\left(\partial^{2} \tau(q) \big/ \partial q^{2} \right) = -\left(\partial \alpha \big/ \partial q \right) \approx \tau(q+1) - 2\tau(q) + \tau(q-1).
\]</span></p>
<p>Питома теплоємність, як міра швидкості зміни енергії, слугує індикатором явищ фазового переходу. У термодинамічній системі фаза характеризується однорідними фізичними властивостями, а фазовий перехід — стрибкоподібною зміною певних властивостей за критичної зовнішньої умови. Вивчення фазових переходів у мультифрактальному спектрі обмежувалося простими системами, такими як множина Кантора та логістична карта. Однак наш аналіз показує наявність фазових переходів <span class="citation" data-cites="RePEc:spr:eurphb:v:76:y:2010:i:4:p:513-527">&nbsp;[<a href="references.html#ref-RePEc:spr:eurphb:v:76:y:2010:i:4:p:513-527" role="doc-biblioref">24</a>]</span> у мультифрактальному спектрі фінансових систем. Зокрема, “енергія” <span class="math inline">\(\alpha\)</span> виявляє значні флуктуації в околі <span class="math inline">\(q_c\)</span>, які відображаються піком питомої теплоємності <span class="math inline">\(C(q_c)\)</span>.</p>
<div class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>C_q_multifrac <span class="op">=</span> <span class="op">-</span>np.gradient(alpha_multifrac, nq, edge_order<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>C_q_monofrac <span class="op">=</span> <span class="op">-</span>np.gradient(alpha_monofrac, nq, edge_order<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>C_q_white_noise <span class="op">=</span> <span class="op">-</span>np.gradient(alpha_white_noise, nq, edge_order<span class="op">=</span><span class="dv">2</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(nq, C_q_multifrac, linestyle<span class="op">=</span><span class="st">'-'</span>, marker<span class="op">=</span><span class="st">'o'</span>, label<span class="op">=</span><span class="st">"Мультифрактал"</span>, color<span class="op">=</span><span class="st">'darkblue'</span>)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(nq, C_q_monofrac, linestyle<span class="op">=</span><span class="st">'-'</span>, marker<span class="op">=</span><span class="st">'o'</span>, label<span class="op">=</span><span class="st">"Монофрактал"</span>, color<span class="op">=</span><span class="st">'magenta'</span>)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(nq, C_q_white_noise, linestyle<span class="op">=</span><span class="st">'-'</span>, marker<span class="op">=</span><span class="st">'o'</span>, label<span class="op">=</span><span class="st">"Білий шум"</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xlabel(<span class="vs">r"$q$"</span>)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_ylabel(<span class="vs">r"$C(q)$"</span>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].legend(loc<span class="op">=</span><span class="st">'center left'</span>)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(alpha_multifrac, C_q_multifrac, linestyle<span class="op">=</span><span class="st">'-'</span>, marker<span class="op">=</span><span class="st">'o'</span>, label<span class="op">=</span><span class="st">"Мультифрактал"</span>, color<span class="op">=</span><span class="st">'darkblue'</span>)</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(alpha_monofrac, C_q_monofrac, linestyle<span class="op">=</span><span class="st">'-'</span>, marker<span class="op">=</span><span class="st">'o'</span>, label<span class="op">=</span><span class="st">"Монофрактал"</span>, color<span class="op">=</span><span class="st">'magenta'</span>)</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(alpha_white_noise, C_q_white_noise, linestyle<span class="op">=</span><span class="st">'-'</span>, marker<span class="op">=</span><span class="st">'o'</span>, label<span class="op">=</span><span class="st">"Білий шум"</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xlabel(<span class="vs">r"$\alpha$"</span>)</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>fig.tight_layout(pad<span class="op">=</span><span class="fl">0.3</span>) </span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>plt.show()<span class="op">;</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-step10" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="lab_7_files/figure-html/fig-step10-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.23: Залежність мультифрактальної теплоємності <span class="math inline">\(C(q)\)</span> від <span class="math inline">\(q\)</span> та <span class="math inline">\(\alpha\)</span></figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-step10">Рис.&nbsp;<span>7.23</span></a> демонструє, що <span class="math inline">\(C(q)\)</span> досягає максимуму в діапазоні <span class="math inline">\(q\)</span> від 2 до 3, що свідчить про те, що індекс WTI стає вкрай нерегулярним через велику флуктуацію катастрофи “COVID-19”, яка слугує квазіфазовим переходом досліджуваного індексу. Можна стверджувати, що колапс коронавірусної пандемії має найбільший вплив на мультифрактальність досліджуваного ряду.</p>
</section>
</section>
</section>
<section id="хід-роботи" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="хід-роботи"><span class="header-section-number">7.2</span> Хід роботи</h2>
<p>Звісно ж фрактальний аналіз усього ряду є важливим, але такий підхід ігнорує припущення про існування в часовій послідовності як монофрактальних, так і мультифрактальних ділянок. Тобто, ігнорується припущення про зміну ступеня складності з плином часу. Кількісні міри мультифрактальності, розраховані в рамках підходу ковзного вікна, є найбільш об’єктивними та практичними при аналізі систем. Окрім цього кількісні показники можуть бути використані як індикатори або індикатори-провісники аномальних явищ, або як базис для побудови іншої прогностичної моделі.</p>
<p>Повторно зчитаємо значення ряду із сайту FRED:</p>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>symbol <span class="op">=</span> <span class="st">'DCOILWTICO'</span>    <span class="co"># cимвол індексу, як указано на сайті FRED</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> <span class="st">"1986-01-01"</span>     <span class="co"># Дата початку зчитування даних</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>end <span class="op">=</span> <span class="st">"2023-01-21"</span>       <span class="co"># Дата закінчення зчитування даних</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>wti <span class="op">=</span> web.DataReader(symbol, <span class="st">'fred'</span>, start, end) <span class="co"># зчитуємо значення ряду </span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>time_ser <span class="op">=</span> wti[symbol].copy()                    <span class="co"># зберігаємо саме ціни закриття</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="co">#------- фільтрація від'ємних значень -------</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>time_ser <span class="op">=</span> time_ser.dropna()    <span class="co"># видаляємо значення NaN</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>time_ser[time_ser.values<span class="op">&lt;</span><span class="dv">0</span>] <span class="op">=</span> <span class="dv">5</span> <span class="co"># замінюємо від'ємне значення на 5</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="co">#--------------------------------------------</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>xlabel <span class="op">=</span> <span class="st">'time, days'</span>    <span class="co"># підпис по вісі Ох </span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>ylabel <span class="op">=</span> symbol          <span class="co"># підпис по вісі Оу</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Увага
</div>
</div>
<div class="callout-body-container callout-body">
<p>Виконайте цей блок, якщо хочете зчитати дані не з Yahoo! Finance або FRED, а із власного файлу. Зрозуміло, що й аналіз результатів, і висновки залежать від того з яким рядом ми працюємо</p>
</div>
</div>
<hr>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>symbol <span class="op">=</span> <span class="st">'sMpa11'</span>                  <span class="co"># Символ індексу</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> <span class="st">"databases\sMpa11.txt"</span>      <span class="co"># шлях по якому здійснюється зчитування файлу</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(path,           <span class="co"># зчитування даних </span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>                   names<span class="op">=</span>[symbol])</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>time_ser <span class="op">=</span> data[symbol].copy()     <span class="co"># копіюємо значення кривої </span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>                                   <span class="co"># "напруга-видовження" до окремої змінної</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>xlabel <span class="op">=</span> <span class="vs">r'$\varepsilon$'</span>          <span class="co"># підпис по вісі Ох </span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>ylabel <span class="op">=</span> symbol                    <span class="co"># підпис по вісі Оу</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p>Виводимо досліджуваний ряд:</p>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()                   <span class="co"># Створюємо порожній графік</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>ax.plot(time_ser.index, time_ser.values)   <span class="co"># Додаємо дані до графіку</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>ax.legend([symbol])                        <span class="co"># Додаємо легенду</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(xlabel)                      <span class="co"># Встановимо підпис по вісі Ох</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(ylabel)                      <span class="co"># Встановимо підпис по вісі Oy</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)                    <span class="co"># оберт позначок по осі Ох на 45 градусів</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="ss">f'</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">.jpg'</span>)               <span class="co"># Зберігаємо графік </span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>plt.show()<span class="op">;</span>                                <span class="co"># Виводимо графік</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-wti-init-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="lab_7_files/figure-html/fig-wti-init-2-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.24: Динаміка щоденних змін індексу сирої нафти</figcaption>
</figure>
</div>
</div>
</div>
<p>Деякі графіки будуть представляти парну побудову лише часового ряду та мультифрактального індикатора. Скористаємось функцією <code>plot_pair()</code>, що ми визначали в попередніх лабораторних:</p>
<div class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_pair(x_values, </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>              y1_values,</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>              y2_values,  </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>              y1_label, </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>              y2_label,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>              x_label, </span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>              file_name, </span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>              clr<span class="op">=</span><span class="st">"magenta"</span>):</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>    ax2 <span class="op">=</span> ax.twinx()</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>    ax2.spines.right.set_position((<span class="st">"axes"</span>, <span class="fl">1.03</span>))</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>    p1, <span class="op">=</span> ax.plot(x_values, </span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>                  y1_values, </span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"b-"</span>, label<span class="op">=</span><span class="vs">fr"</span><span class="sc">{</span>y1_label<span class="sc">}</span><span class="vs">"</span>)</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>    p2, <span class="op">=</span> ax2.plot(x_values,</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>                   y2_values, </span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>                   color<span class="op">=</span>clr, </span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>                   label<span class="op">=</span>y2_label)</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(x_label)</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="ss">f"</span><span class="sc">{</span>y1_label<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>    ax.yaxis.label.set_color(p1.get_color())</span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>    ax2.yaxis.label.set_color(p2.get_color())</span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>    tkw <span class="op">=</span> <span class="bu">dict</span>(size<span class="op">=</span><span class="dv">2</span>, width<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a>    ax.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, <span class="op">**</span>tkw)</span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>    ax.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, colors<span class="op">=</span>p1.get_color(), <span class="op">**</span>tkw)</span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>    ax2.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, colors<span class="op">=</span>p2.get_color(), <span class="op">**</span>tkw)</span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a>    ax2.legend(handles<span class="op">=</span>[p1, p2])</span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a>    plt.savefig(file_name <span class="op">+</span> <span class="st">".jpg"</span>)</span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a>    plt.show()<span class="op">;</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="віконна-процедура" class="level4" data-number="7.2.0.1">
<h4 data-number="7.2.0.1" class="anchored" data-anchor-id="віконна-процедура"><span class="header-section-number">7.2.0.1</span> Віконна процедура</h4>
<p>Для подальших розрахунків знову скористаємось бібліотекою <code>fathon</code>, що ми використовували попередньо для виконання класичного аналізу детрендованих флуктуацій. Переваги саме цієї бібліотеки полягають у можливості використання процедури розрахунку розбиття ряду на сегменти починаючи з кінця ряду, оскільки довжина ряду не завжди дозволяє поділити його на локальні сегменти націло. Тобто, теоретично у нас залишається сегмент ряду, що не піддається розбиттю на локальні сегменти. Тому повторна процедура розбиття на локальні сегменти починаючи з кінця ряду дозволяє обійти дану проблему. Для спрощення представлення теоретичного матеріалу ми не стали імплементувати дану процедуру, але вона доступна в бібліотеці <code>fathon</code>. Окрім цього, бібліотека надає можливість обчислення крос-кореляційного аналізу детрендованих флуктуацій та його мультифрактального аналогу.</p>
<div class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> fathon</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fathon <span class="im">import</span> fathonUtils <span class="im">as</span> fu</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Приступимо до ініціалізації параметрів.</p>
<div class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>window <span class="op">=</span> <span class="dv">500</span>        <span class="co"># розмір вікна</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>tstep <span class="op">=</span> <span class="dv">5</span>           <span class="co"># крок вікна</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>ret_type <span class="op">=</span> <span class="dv">4</span>        <span class="co"># вид ряду: </span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># 1 - вихідний, </span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># 2 - детрендований (різниця між теп. значенням та попереднім)</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># 3 - прибутковості звичайні, </span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># 4 - стандартизовані прибутковості, </span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># 5 - абсолютні значення (волатильності)</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># 6 - стандартизований ряд</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>win_beg <span class="op">=</span> <span class="dv">10</span>        <span class="co"># Початкова ширина сегменту</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>win_end <span class="op">=</span> window<span class="op">-</span><span class="dv">1</span>  <span class="co"># Кінцева ширина сегменту</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>scales_exp_wind <span class="op">=</span> fu.linRangeByStep(win_beg, win_end) <span class="co"># генеруємо масив </span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>                                                      <span class="co"># лінійно розділених </span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>                                                      <span class="co"># елементів</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>rev <span class="op">=</span> <span class="va">True</span>      <span class="co"># чи повторювати розрахунок ф-ції флуктуацій з кінця</span></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>length <span class="op">=</span> <span class="bu">len</span>(time_ser.values)</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>q_min <span class="op">=</span> <span class="op">-</span><span class="dv">5</span>         <span class="co"># мінімальне значення q</span></span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>q_max <span class="op">=</span> <span class="dv">5</span>          <span class="co"># максимальне значення q</span></span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>q_step <span class="op">=</span> <span class="dv">1</span>         <span class="co"># крок збільшення q</span></span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>nq <span class="op">=</span> np.arange(q_min, </span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>               q_max<span class="op">+</span>q_step, </span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a>               q_step)</span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a>order <span class="op">=</span> <span class="dv">1</span>           <span class="co"># порядок поліноміального тренду</span></span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a>delta_alph <span class="op">=</span> []</span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a>delta_spec <span class="op">=</span> []</span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a>max_alph <span class="op">=</span> []</span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a>min_alph <span class="op">=</span> []</span>
<span id="cb49-36"><a href="#cb49-36" aria-hidden="true" tabindex="-1"></a>mean_alph <span class="op">=</span> []</span>
<span id="cb49-37"><a href="#cb49-37" aria-hidden="true" tabindex="-1"></a>alpha_zero <span class="op">=</span> []</span>
<span id="cb49-38"><a href="#cb49-38" aria-hidden="true" tabindex="-1"></a>delta_alph_right <span class="op">=</span> []</span>
<span id="cb49-39"><a href="#cb49-39" aria-hidden="true" tabindex="-1"></a>delta_alph_left <span class="op">=</span> []</span>
<span id="cb49-40"><a href="#cb49-40" aria-hidden="true" tabindex="-1"></a>assym <span class="op">=</span> []</span>
<span id="cb49-41"><a href="#cb49-41" aria-hidden="true" tabindex="-1"></a>delta_s <span class="op">=</span> []</span>
<span id="cb49-42"><a href="#cb49-42" aria-hidden="true" tabindex="-1"></a>D_0 <span class="op">=</span> []</span>
<span id="cb49-43"><a href="#cb49-43" aria-hidden="true" tabindex="-1"></a>D_1 <span class="op">=</span> []</span>
<span id="cb49-44"><a href="#cb49-44" aria-hidden="true" tabindex="-1"></a>D_2 <span class="op">=</span> []</span>
<span id="cb49-45"><a href="#cb49-45" aria-hidden="true" tabindex="-1"></a>D_left <span class="op">=</span> []</span>
<span id="cb49-46"><a href="#cb49-46" aria-hidden="true" tabindex="-1"></a>D_right <span class="op">=</span> []</span>
<span id="cb49-47"><a href="#cb49-47" aria-hidden="true" tabindex="-1"></a>C_q <span class="op">=</span> []</span>
<span id="cb49-48"><a href="#cb49-48" aria-hidden="true" tabindex="-1"></a>h_q <span class="op">=</span> []</span>
<span id="cb49-49"><a href="#cb49-49" aria-hidden="true" tabindex="-1"></a>tau_q <span class="op">=</span> []</span>
<span id="cb49-50"><a href="#cb49-50" aria-hidden="true" tabindex="-1"></a>D_q <span class="op">=</span> []</span>
<span id="cb49-51"><a href="#cb49-51" aria-hidden="true" tabindex="-1"></a>mfSpect <span class="op">=</span> []</span>
<span id="cb49-52"><a href="#cb49-52" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> []</span>
<span id="cb49-53"><a href="#cb49-53" aria-hidden="true" tabindex="-1"></a>hFI <span class="op">=</span> []</span>
<span id="cb49-54"><a href="#cb49-54" aria-hidden="true" tabindex="-1"></a>alphaCF <span class="op">=</span> []</span>
<span id="cb49-55"><a href="#cb49-55" aria-hidden="true" tabindex="-1"></a>C_q_area_wind <span class="op">=</span> []</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Розпочнемо процедуру рухомого вікна, що об’єднуватиме у собі попередні етапи розрахунків:</p>
<div class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> tqdm(<span class="bu">range</span>(<span class="dv">0</span>,length<span class="op">-</span>window,tstep)):</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># відбираємо фрагменти</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    fragm <span class="op">=</span> time_ser.iloc[i:i<span class="op">+</span>window].copy()  </span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># виконуємо процедуру трансформації ряду </span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    fragm <span class="op">=</span> transformation(fragm, ret_type)</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># знаходження кумулятивного ряду</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>    cumulative <span class="op">=</span> fu.toAggregated(fragm)</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># інціалізації процедури mfdfa</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>    pymfdfa <span class="op">=</span> fathon.MFDFA(cumulative)</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># обчислення функції флуктуацій та отримання узагальненого показника Херста</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>    n, F <span class="op">=</span> pymfdfa.computeFlucVec(scales_exp_wind, nq, revSeg<span class="op">=</span>rev, polOrd<span class="op">=</span>order)</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>    Hq_fragm, _ <span class="op">=</span> pymfdfa.fitFlucVec()</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># отримання показника tau</span></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>    tau_wind <span class="op">=</span> nq <span class="op">*</span> Hq_fragm <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># отримання показника сингулярності</span></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>    alpha_wind <span class="op">=</span> np.gradient(tau_wind, nq, edge_order<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># отримання мультифрактального спектра</span></span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a>    f_wind <span class="op">=</span> nq <span class="op">*</span> alpha_wind <span class="op">-</span> tau_wind</span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># отримання мультифрактальної теплоємності</span></span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>    C_q_wind <span class="op">=</span> <span class="op">-</span>np.gradient(alpha_wind, nq, edge_order<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># інтегральний показник C(q) </span></span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a>    C_q_area <span class="op">=</span> cumulative_trapezoid(np.<span class="bu">abs</span>(C_q_wind), nq, initial<span class="op">=</span><span class="dv">0</span>)[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ширина спектра мультифрактальності</span></span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a>    delta_alpha_wind <span class="op">=</span> alpha_wind.<span class="bu">max</span>() <span class="op">-</span> alpha_wind.<span class="bu">min</span>()</span>
<span id="cb50-36"><a href="#cb50-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-37"><a href="#cb50-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># відстань між кінцями спектра мультифрактальності</span></span>
<span id="cb50-38"><a href="#cb50-38" aria-hidden="true" tabindex="-1"></a>    delta_phi <span class="op">=</span> f_wind[<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> f_wind[<span class="dv">0</span>]</span>
<span id="cb50-39"><a href="#cb50-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-40"><a href="#cb50-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># максимальне значення альфи</span></span>
<span id="cb50-41"><a href="#cb50-41" aria-hidden="true" tabindex="-1"></a>    maximal_alpha <span class="op">=</span> alpha_wind.<span class="bu">max</span>()</span>
<span id="cb50-42"><a href="#cb50-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-43"><a href="#cb50-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># мінімальне значення альфи</span></span>
<span id="cb50-44"><a href="#cb50-44" aria-hidden="true" tabindex="-1"></a>    minimal_alpha <span class="op">=</span> alpha_wind.<span class="bu">min</span>()</span>
<span id="cb50-45"><a href="#cb50-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-46"><a href="#cb50-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># середнє значення альфи</span></span>
<span id="cb50-47"><a href="#cb50-47" aria-hidden="true" tabindex="-1"></a>    mean_alpha <span class="op">=</span> np.mean(alpha_wind)</span>
<span id="cb50-48"><a href="#cb50-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-49"><a href="#cb50-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># значення сингулярності при якому спектр приймає максимальне значення (α0)</span></span>
<span id="cb50-50"><a href="#cb50-50" aria-hidden="true" tabindex="-1"></a>    alpha_0 <span class="op">=</span> alpha_wind[np.nanargmax(f_wind)]</span>
<span id="cb50-51"><a href="#cb50-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-52"><a href="#cb50-52" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ширина правого хвоста спектра</span></span>
<span id="cb50-53"><a href="#cb50-53" aria-hidden="true" tabindex="-1"></a>    delt_alpha_right <span class="op">=</span> maximal_alpha <span class="op">-</span> alpha_0</span>
<span id="cb50-54"><a href="#cb50-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-55"><a href="#cb50-55" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ширина лівого хвоста спектра</span></span>
<span id="cb50-56"><a href="#cb50-56" aria-hidden="true" tabindex="-1"></a>    delt_alpha_left <span class="op">=</span> alpha_0 <span class="op">-</span> minimal_alpha</span>
<span id="cb50-57"><a href="#cb50-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-58"><a href="#cb50-58" aria-hidden="true" tabindex="-1"></a>    <span class="co"># різниця між шириною лівого та правого хвостів</span></span>
<span id="cb50-59"><a href="#cb50-59" aria-hidden="true" tabindex="-1"></a>    delt_s <span class="op">=</span> delt_alpha_right <span class="op">-</span> delt_alpha_left</span>
<span id="cb50-60"><a href="#cb50-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-61"><a href="#cb50-61" aria-hidden="true" tabindex="-1"></a>    <span class="co"># показник асиметрії</span></span>
<span id="cb50-62"><a href="#cb50-62" aria-hidden="true" tabindex="-1"></a>    A <span class="op">=</span> (delt_alpha_left <span class="op">-</span> delt_alpha_right)<span class="op">/</span>(delt_alpha_left <span class="op">+</span> delt_alpha_right)</span>
<span id="cb50-63"><a href="#cb50-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-64"><a href="#cb50-64" aria-hidden="true" tabindex="-1"></a>    <span class="co"># визначаємо індекс при q=0</span></span>
<span id="cb50-65"><a href="#cb50-65" aria-hidden="true" tabindex="-1"></a>    difference_zero <span class="op">=</span> np.absolute(nq<span class="op">-</span><span class="dv">0</span>)</span>
<span id="cb50-66"><a href="#cb50-66" aria-hidden="true" tabindex="-1"></a>    idx_zero <span class="op">=</span> difference_zero.argmin()</span>
<span id="cb50-67"><a href="#cb50-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-68"><a href="#cb50-68" aria-hidden="true" tabindex="-1"></a>    <span class="co"># визначаємо індекс при q=1</span></span>
<span id="cb50-69"><a href="#cb50-69" aria-hidden="true" tabindex="-1"></a>    difference_one <span class="op">=</span> np.absolute(nq<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb50-70"><a href="#cb50-70" aria-hidden="true" tabindex="-1"></a>    idx_one <span class="op">=</span> difference_one.argmin()</span>
<span id="cb50-71"><a href="#cb50-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-72"><a href="#cb50-72" aria-hidden="true" tabindex="-1"></a>    <span class="co"># визначаємо індекс при q=2</span></span>
<span id="cb50-73"><a href="#cb50-73" aria-hidden="true" tabindex="-1"></a>    difference_two <span class="op">=</span> np.absolute(nq<span class="op">-</span><span class="dv">2</span>)</span>
<span id="cb50-74"><a href="#cb50-74" aria-hidden="true" tabindex="-1"></a>    idx_two <span class="op">=</span> difference_two.argmin()</span>
<span id="cb50-75"><a href="#cb50-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-76"><a href="#cb50-76" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ініціалізуємо масиви під розмірності</span></span>
<span id="cb50-77"><a href="#cb50-77" aria-hidden="true" tabindex="-1"></a>    Dq_wind <span class="op">=</span> np.zeros(<span class="bu">len</span>(nq))</span>
<span id="cb50-78"><a href="#cb50-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-79"><a href="#cb50-79" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Визначаємо узагальнені фрактальні розмірності там де q!=1 </span></span>
<span id="cb50-80"><a href="#cb50-80" aria-hidden="true" tabindex="-1"></a>    Dq_wind[nq<span class="op">!=</span>nq[idx_one]] <span class="op">=</span> tau_wind[nq<span class="op">!=</span>nq[idx_one]] <span class="op">/</span> (nq[nq<span class="op">!=</span>nq[idx_one]] <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb50-81"><a href="#cb50-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-82"><a href="#cb50-82" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Визначаємо окремо узагальнені фрактальні розмірності при q=1</span></span>
<span id="cb50-83"><a href="#cb50-83" aria-hidden="true" tabindex="-1"></a>    Dq_wind[nq<span class="op">==</span>nq[idx_one]] <span class="op">=</span> <span class="op">-</span>tau_wind[nq<span class="op">==</span>nq[idx_one]] </span>
<span id="cb50-84"><a href="#cb50-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-85"><a href="#cb50-85" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Узагальнені фрактальні розмірності отримані з мультифрактального спектра</span></span>
<span id="cb50-86"><a href="#cb50-86" aria-hidden="true" tabindex="-1"></a>    D_zero <span class="op">=</span> f_wind[nq<span class="op">==</span>nq[idx_zero]]</span>
<span id="cb50-87"><a href="#cb50-87" aria-hidden="true" tabindex="-1"></a>    D_one <span class="op">=</span> f_wind[nq<span class="op">==</span>nq[idx_one]]</span>
<span id="cb50-88"><a href="#cb50-88" aria-hidden="true" tabindex="-1"></a>    D_two <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> alpha_wind[nq<span class="op">==</span>nq[idx_two]] <span class="op">-</span> f_wind[np.where(alpha_wind[nq<span class="op">==</span>nq[idx_two]])]</span>
<span id="cb50-89"><a href="#cb50-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-90"><a href="#cb50-90" aria-hidden="true" tabindex="-1"></a>    <span class="co"># відстань від центру розподілу узагальнених розмірностей до лівого кінця</span></span>
<span id="cb50-91"><a href="#cb50-91" aria-hidden="true" tabindex="-1"></a>    delta_D_Q_left <span class="op">=</span> Dq_wind[nq<span class="op">==</span>q_min] <span class="op">-</span> Dq_wind[nq<span class="op">==</span>nq[idx_zero]]</span>
<span id="cb50-92"><a href="#cb50-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-93"><a href="#cb50-93" aria-hidden="true" tabindex="-1"></a>    <span class="co"># відстань від центру розподілу узагальнених розмірностей до правого кінця</span></span>
<span id="cb50-94"><a href="#cb50-94" aria-hidden="true" tabindex="-1"></a>    delta_D_Q_right <span class="op">=</span> Dq_wind[nq<span class="op">==</span>nq[idx_zero]] <span class="op">-</span> Dq_wind[nq<span class="op">==</span>q_max]</span>
<span id="cb50-95"><a href="#cb50-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-96"><a href="#cb50-96" aria-hidden="true" tabindex="-1"></a>    <span class="co"># індекс h-флуктуацій (hFI)</span></span>
<span id="cb50-97"><a href="#cb50-97" aria-hidden="true" tabindex="-1"></a>    fluct <span class="op">=</span> np.<span class="bu">sum</span>(np.gradient(np.gradient(Hq_fragm, nq, edge_order<span class="op">=</span><span class="dv">2</span>), nq, edge_order<span class="op">=</span><span class="dv">2</span>) <span class="op">**</span> <span class="dv">2</span>)<span class="op">/</span>(<span class="dv">2</span> <span class="op">*</span> np.<span class="bu">max</span>(np.<span class="bu">abs</span>(nq)) <span class="op">+</span> <span class="dv">2</span>)</span>
<span id="cb50-98"><a href="#cb50-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-99"><a href="#cb50-99" aria-hidden="true" tabindex="-1"></a>    <span class="co"># кумулятивний індекс інкрементів узагальнених показників Херста (αCF)</span></span>
<span id="cb50-100"><a href="#cb50-100" aria-hidden="true" tabindex="-1"></a>    incr <span class="op">=</span> np.<span class="bu">sum</span>(np.gradient(Hq_fragm, edge_order<span class="op">=</span><span class="dv">2</span>) <span class="op">**</span> <span class="dv">2</span> <span class="op">/</span> np.gradient(nq, edge_order<span class="op">=</span><span class="dv">2</span>))</span>
<span id="cb50-101"><a href="#cb50-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-102"><a href="#cb50-102" aria-hidden="true" tabindex="-1"></a>    delta_alph.append(delta_alpha_wind)</span>
<span id="cb50-103"><a href="#cb50-103" aria-hidden="true" tabindex="-1"></a>    delta_spec.append(delta_phi)</span>
<span id="cb50-104"><a href="#cb50-104" aria-hidden="true" tabindex="-1"></a>    max_alph.append(maximal_alpha)</span>
<span id="cb50-105"><a href="#cb50-105" aria-hidden="true" tabindex="-1"></a>    min_alph.append(minimal_alpha)</span>
<span id="cb50-106"><a href="#cb50-106" aria-hidden="true" tabindex="-1"></a>    mean_alph.append(mean_alpha)</span>
<span id="cb50-107"><a href="#cb50-107" aria-hidden="true" tabindex="-1"></a>    alpha_zero.append(alpha_0)</span>
<span id="cb50-108"><a href="#cb50-108" aria-hidden="true" tabindex="-1"></a>    delta_alph_right.append(delt_alpha_right)</span>
<span id="cb50-109"><a href="#cb50-109" aria-hidden="true" tabindex="-1"></a>    delta_alph_left.append(delt_alpha_left)</span>
<span id="cb50-110"><a href="#cb50-110" aria-hidden="true" tabindex="-1"></a>    delta_s.append(delt_s)</span>
<span id="cb50-111"><a href="#cb50-111" aria-hidden="true" tabindex="-1"></a>    assym.append(A)</span>
<span id="cb50-112"><a href="#cb50-112" aria-hidden="true" tabindex="-1"></a>    D_0.append(D_zero)</span>
<span id="cb50-113"><a href="#cb50-113" aria-hidden="true" tabindex="-1"></a>    D_1.append(D_one)</span>
<span id="cb50-114"><a href="#cb50-114" aria-hidden="true" tabindex="-1"></a>    D_2.append(D_two)</span>
<span id="cb50-115"><a href="#cb50-115" aria-hidden="true" tabindex="-1"></a>    D_left.append(delta_D_Q_left)</span>
<span id="cb50-116"><a href="#cb50-116" aria-hidden="true" tabindex="-1"></a>    D_right.append(delta_D_Q_right)</span>
<span id="cb50-117"><a href="#cb50-117" aria-hidden="true" tabindex="-1"></a>    C_q.append(C_q_wind)</span>
<span id="cb50-118"><a href="#cb50-118" aria-hidden="true" tabindex="-1"></a>    mfSpect.append(f_wind)</span>
<span id="cb50-119"><a href="#cb50-119" aria-hidden="true" tabindex="-1"></a>    alpha.append(alpha_wind)</span>
<span id="cb50-120"><a href="#cb50-120" aria-hidden="true" tabindex="-1"></a>    hFI.append(fluct)</span>
<span id="cb50-121"><a href="#cb50-121" aria-hidden="true" tabindex="-1"></a>    alphaCF.append(incr)</span>
<span id="cb50-122"><a href="#cb50-122" aria-hidden="true" tabindex="-1"></a>    C_q_area_wind.append(C_q_area)</span>
<span id="cb50-123"><a href="#cb50-123" aria-hidden="true" tabindex="-1"></a>    h_q.append(Hq_fragm)</span>
<span id="cb50-124"><a href="#cb50-124" aria-hidden="true" tabindex="-1"></a>    tau_q.append(tau_wind)</span>
<span id="cb50-125"><a href="#cb50-125" aria-hidden="true" tabindex="-1"></a>    D_q.append(Dq_wind)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 1768/1768 [04:11&lt;00:00,  7.03it/s]</code></pre>
</div>
</div>
<p>Зберігаємо абсолютні значення показників до текстових файлів.</p>
<div class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># перелік назв кожного індикатора для збереження до txt</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>subtitle_of_txts <span class="op">=</span> [<span class="st">'delta_alpha'</span>, <span class="st">'delta_f'</span>, <span class="st">'max_alpha'</span>, <span class="st">'min_alpha'</span>, <span class="st">'mean_alpha'</span>, </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'zero_alpha'</span>, <span class="st">'delta_alpha_right'</span>, <span class="st">'delta_alpha_left'</span>, <span class="st">'assymetry'</span>,</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'delta_s'</span>, <span class="st">'D_0'</span>, <span class="st">'D_1'</span>, <span class="st">'D_2'</span>, <span class="st">'hFI'</span>, <span class="st">'alphaCF'</span>, <span class="st">'C_q_area'</span>,</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'delta_d_left'</span>, <span class="st">'delta_d_right'</span>]</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="co"># перелік вихідних значень індикаторів для збереження до txt</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>mfdfa_indicators <span class="op">=</span> [delta_alph, delta_spec, max_alph, min_alph, mean_alph, alpha_zero,</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>                    delta_alph_right, delta_alph_left, assym, delta_s, D_0, D_1, D_2,</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>                    hFI, alphaCF, C_q_area_wind, D_left, D_right]</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(subtitle_of_txts)):</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>    np.savetxt(<span class="ss">f"mfdfa_</span><span class="sc">{</span>subtitle_of_txts[i]<span class="sc">}</span><span class="ss">_name=</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_ret=</span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_ </span><span class="ch">\</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a><span class="ss">               order=</span><span class="sc">{</span>order<span class="sc">}</span><span class="ss">_qmin=</span><span class="sc">{</span>q_min<span class="sc">}</span><span class="ss">_qmax=</span><span class="sc">{</span>q_max<span class="sc">}</span><span class="ss">_qinc=</span><span class="sc">{</span>q_step<span class="sc">}</span><span class="ss">_ </span><span class="ch">\</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a><span class="ss">               wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_windbeg=</span><span class="sc">{</span>win_beg<span class="sc">}</span><span class="ss">_winden=</span><span class="sc">{</span>win_end<span class="sc">}</span><span class="ss">.txt"</span>, mfdfa_indicators[i])</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Проаналізуємо динаміку отриманих індикаторів.</p>
</section>
<section id="ширина-спектра-мультифрактальності-deltaalpha" class="level3" data-number="7.2.1">
<h3 data-number="7.2.1" class="anchored" data-anchor-id="ширина-спектра-мультифрактальності-deltaalpha"><span class="header-section-number">7.2.1</span> Ширина спектра мультифрактальності (<span class="math inline">\(\Delta\alpha\)</span>)</h3>
<p>Першим і одним із найпрактичніших індикаторів складності системи є ширина спектра мультифрактальності, <span class="math inline">\(\Delta\alpha\)</span>, яку можна подати як різницю між максимальним ступенем синґулярності та мінімальним:</p>
<p><span id="eq-7-1"><span class="math display">\[
\Delta\alpha = \alpha_{max} - \alpha_{min}.
\tag{7.10}\]</span></span></p>
<p>Якщо проводити аналогію з термодинамічними показниками, то в такому разі ширина спектра мультифрактальності становитиме різницю між найбільшим і найменшим значенням внутрішньої енергії системи. Розглянемо динаміку даного показника для ринку нафти.</p>
<div class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>measure_label <span class="op">=</span> <span class="vs">r'$\Delta\alpha$'</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>file_name <span class="op">=</span> <span class="ss">f"mfdfa_delta_alpha_name=</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_ret=</span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_order=</span><span class="sc">{</span>order<span class="sc">}</span><span class="ss">_qmin=</span><span class="sc">{</span>q_min<span class="sc">}</span><span class="ss">_qmax=</span><span class="sc">{</span>q_max<span class="sc">}</span><span class="ss">_qinc=</span><span class="sc">{</span>q_step<span class="sc">}</span><span class="ss">_ </span><span class="ch">\</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="ss">           wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_windbeg=</span><span class="sc">{</span>win_beg<span class="sc">}</span><span class="ss">_winden=</span><span class="sc">{</span>win_end<span class="sc">}</span><span class="ss">"</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>plot_pair(time_ser.index[window:length:tstep],</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>          time_ser.values[window:length:tstep],</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>          delta_alph, </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>          ylabel, </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>          measure_label,</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>          xlabel,</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>          file_name, </span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>          clr<span class="op">=</span><span class="st">'red'</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-wti-wind-delta-alpha" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="lab_7_files/figure-html/fig-wti-wind-delta-alpha-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.25: Динаміка індексу сирої нафти WTI та показника ширини спектра мультифрактальності <span class="math inline">\(\Delta\alpha\)</span></figcaption>
</figure>
</div>
</div>
</div>
<p>На <a href="#fig-wti-wind-delta-alpha"><span>7.25</span></a> видно, що ширина спектра мультифрактальності зростає під час кризових подій, що вказує на зростання загального ступеня складності та періодизації. Тобто, даний показник слугує ще одним підтвердженням, що трейдери на ринку, наприклад, нафти поводять себе у синхронній манері в ході кризи. Зростання загального ступеня мультифрактальності є індикатором зростання кореляцій в системі, що підтверджувалось і попередніми індикаторами складності.</p>
</section>
<section id="різниця-між-кінцями-спектра-мультифрактальності-delta-f" class="level3" data-number="7.2.2">
<h3 data-number="7.2.2" class="anchored" data-anchor-id="різниця-між-кінцями-спектра-мультифрактальності-delta-f"><span class="header-section-number">7.2.2</span> Різниця між кінцями спектра мультифрактальності (<span class="math inline">\(\Delta f\)</span>)</h3>
<p>Однак проста ширина спектра мультифрактальності не показує, наприклад, флуктуації якого типу є найвірогіднішими, елементи якого типу щільності відіграють найбільшу роль у зростанні або зниженні складності системи. Надалі було запропоновано такий показник мультифрактальності як <span class="math inline">\(\Delta f\)</span>, який можна представити наступним чином <span class="citation" data-cites="DAI2014332 DAI2016722 SUN2001553">&nbsp;[<a href="references.html#ref-DAI2014332" role="doc-biblioref">25</a>–<a href="references.html#ref-SUN2001553" role="doc-biblioref">27</a>]</span>:</p>
<p><span id="eq-7-2"><span class="math display">\[
\Delta f = f(\alpha_{min}) - f(\alpha_{max}).
\tag{7.11}\]</span></span></p>
<div class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>measure_label <span class="op">=</span> <span class="vs">r'$\Delta f$'</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>file_name <span class="op">=</span> <span class="ss">f"mfdfa_delta_f_name=</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_ret=</span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_order=</span><span class="sc">{</span>order<span class="sc">}</span><span class="ss">_qmin=</span><span class="sc">{</span>q_min<span class="sc">}</span><span class="ss">_qmax=</span><span class="sc">{</span>q_max<span class="sc">}</span><span class="ss">_qinc=</span><span class="sc">{</span>q_step<span class="sc">}</span><span class="ss">_ </span><span class="ch">\</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="ss">           wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_windbeg=</span><span class="sc">{</span>win_beg<span class="sc">}</span><span class="ss">_winden=</span><span class="sc">{</span>win_end<span class="sc">}</span><span class="ss">"</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>plot_pair(time_ser.index[window:length:tstep],</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>          time_ser.values[window:length:tstep],</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>          delta_spec, </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>          ylabel, </span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>          measure_label,</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>          xlabel,</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>          file_name, </span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>          clr<span class="op">=</span><span class="st">'brown'</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-wti-wind-delta-f" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="lab_7_files/figure-html/fig-wti-wind-delta-f-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.26: Динаміка індексу сирої нафти WTI та показника відстані між кінцями спектра мультифрактальності <span class="math inline">\(\Delta f\)</span></figcaption>
</figure>
</div>
</div>
</div>
<p>Сенс даного показника полягає в тому, що він дає нам змогу визначити ступінь імовірності появи елементів з великими щільностями і малими. Якщо цей показник менший за нуль, тоді флуктуації, що відображають елементи з найбільшою концентрацією (найбільшими фруктуаціями), мають найбільшу ймовірність. Якщо цей показник вищий за нуль, тоді флуктуації, що відображають малоконцентровані елементи (малі флуктуації), визначають динаміку системи. Якщо цей показник перебуває в нулі, тоді як високосингулярні, так і малосингулярні елементи мають рівномірний внесок у динаміку системи.</p>
<p>Звертаючись до термодинаміки, можна згадати, що <span class="math inline">\(f(\alpha)\)</span> — це ентропія системи. Тоді стає зрозуміло, що варіативність спектра мультифрактальності дає нам змогу визначити ступінь внеску висококонцентрованих і малоконцентрованих елементів у мінімізацію ентропії системи. Лівостороння асиметрія мультифрактального спектра <span class="math inline">\((\Delta f &gt; 0)\)</span> підказує нам, що висококонцентровані елементи фазового простору дають найбільший внесок у мінімум термодинамічної ентропії. Іншими словами, ці елементи і є двигуном зростання впорядкованості динаміки системи. Своєю чергою, правостороння асиметрія мультифрактального спектра <span class="math inline">\((\Delta f &lt; 0)\)</span> вказує на мінімізацію ентропії за рахунок малоконцентрованих елементів. Симетрія кінців спектра вказує на рівний внесок високощільних і розріджених областей на мінімізацію ентропії. Як уже згадувалося, трапляються випадки, коли мультифрактальний спектр практично сходиться в сингулярність (одну точку). У такому разі ми маємо справу з простою монофрактальною системою, яка в нашому випадку характеризувалася незалежними і нормально розподіленими випадковими величинами. Для такого спектра і <span class="math inline">\(\Delta\alpha\)</span>, і <span class="math inline">\(\Delta f\)</span> будуть прямувати до нуля. Для такого часового ряду вже спостерігається не множина фрактальних розмірностей, а тільки один фрактальний показник, <span class="math inline">\(f[\alpha(q=0)] = 1\)</span>. Це саме та область, де система досягає своєї термодинамічної рівноваги — максимуму ентропії. У свою чергу <span class="math inline">\(\Delta f\)</span> можна охарактеризувати як різницю ентропій за граничної максимальної та мінімальної внутрішньої енергії системи.</p>
</section>
<section id="ширина-лівого-deltaalpha_l-та-правого-deltaalpha_r-хвостів-мультифрактального-спектра" class="level3" data-number="7.2.3">
<h3 data-number="7.2.3" class="anchored" data-anchor-id="ширина-лівого-deltaalpha_l-та-правого-deltaalpha_r-хвостів-мультифрактального-спектра"><span class="header-section-number">7.2.3</span> Ширина лівого (<span class="math inline">\(\Delta\alpha_{L}\)</span>) та правого (<span class="math inline">\(\Delta\alpha_{R}\)</span>) хвостів мультифрактального спектра</h3>
<p>Крім цього, ми можемо дослідити ступінь складності динаміки окремо високощільних областей (з великими флуктуаціями) і низькощільних (з малими флуктуаціями). Для цього виміряємо ширину окремо лівого і правого хвостів. Ширину лівого хвоста визначимо як</p>
<p><span id="eq-7-3"><span class="math display">\[
\Delta\alpha_{L} = \alpha_{0} - \alpha_{min},
\tag{7.12}\]</span></span></p>
<p>а ширину правого хвоста як</p>
<p><span id="eq-7-4"><span class="math display">\[
\Delta\alpha_{R} = \alpha_{max} - \alpha_{0}.
\tag{7.13}\]</span></span></p>
<p>У свою чергу ширина лівого хвоста вимірює ступінь складності флуктуацій з великою амплітудою, а ширина правого хвоста — малих. Зростання ширини кожного з хвостів відображатиме зростання ступеня кореляцій між елементами.</p>
<div class="cell" data-execution_count="95">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> ax.twinx()</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>ax3 <span class="op">=</span> ax.twinx()</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>ax2.spines.right.set_position((<span class="st">"axes"</span>, <span class="fl">1.03</span>))</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>ax3.spines.right.set_position((<span class="st">"axes"</span>, <span class="fl">1.12</span>))</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>p1, <span class="op">=</span> ax.plot(time_ser.index[window:length:tstep], </span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>              time_ser.values[window:length:tstep], </span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>              <span class="st">"b-"</span>, label<span class="op">=</span><span class="vs">fr"</span><span class="sc">{</span>ylabel<span class="sc">}</span><span class="vs">"</span>)</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>p2, <span class="op">=</span> ax2.plot(time_ser.index[window:length:tstep], </span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>               delta_alph_left, color<span class="op">=</span><span class="st">"r"</span>, label<span class="op">=</span><span class="vs">r"$\Delta\alpha_</span><span class="sc">{L}</span><span class="vs">$"</span>)</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>p3, <span class="op">=</span> ax3.plot(time_ser.index[window:length:tstep], </span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>               delta_alph_right, color<span class="op">=</span><span class="st">"g"</span>, label<span class="op">=</span><span class="vs">r"$\Delta\alpha_</span><span class="sc">{R}</span><span class="vs">$"</span>)</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(xlabel)</span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="ss">f"</span><span class="sc">{</span>ylabel<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>ax.yaxis.label.set_color(p1.get_color())</span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>ax2.yaxis.label.set_color(p2.get_color())</span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>ax3.yaxis.label.set_color(p3.get_color())</span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>tkw <span class="op">=</span> <span class="bu">dict</span>(size<span class="op">=</span><span class="dv">4</span>, width<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a>ax.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, colors<span class="op">=</span>p1.get_color(), <span class="op">**</span>tkw)</span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a>ax2.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, colors<span class="op">=</span>p2.get_color(), <span class="op">**</span>tkw)</span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a>ax3.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, colors<span class="op">=</span>p3.get_color(), <span class="op">**</span>tkw)</span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a>ax.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, <span class="op">**</span>tkw)</span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-31"><a href="#cb57-31" aria-hidden="true" tabindex="-1"></a>ax3.legend(handles<span class="op">=</span>[p1, p2, p3])</span>
<span id="cb57-32"><a href="#cb57-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-33"><a href="#cb57-33" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="ss">f"mfdfa_delta_alpha_left_right_name=</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_ret=</span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_order=</span><span class="sc">{</span>order<span class="sc">}</span><span class="ss">_qmin=</span><span class="sc">{</span>q_min<span class="sc">}</span><span class="ss">_qmax=</span><span class="sc">{</span>q_max<span class="sc">}</span><span class="ss">_qinc=</span><span class="sc">{</span>q_step<span class="sc">}</span><span class="ss">_ </span><span class="ch">\</span></span>
<span id="cb57-34"><a href="#cb57-34" aria-hidden="true" tabindex="-1"></a><span class="ss">           wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_windbeg=</span><span class="sc">{</span>win_beg<span class="sc">}</span><span class="ss">_winden=</span><span class="sc">{</span>win_end<span class="sc">}</span><span class="ss">.jpg"</span>)</span>
<span id="cb57-35"><a href="#cb57-35" aria-hidden="true" tabindex="-1"></a>plt.show()<span class="op">;</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-delta-alpha-left-right" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="lab_7_files/figure-html/fig-delta-alpha-left-right-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.27: Динаміка індексу сирої нафти WTI та ширини лівого і правого хвостів мультифрактального спектра</figcaption>
</figure>
</div>
</div>
</div>
<p>Із <a href="#fig-delta-alpha-left-right">Рис.&nbsp;<span>7.27</span></a> видно, що досліджувані індикатори реагують у характерний спосіб на кризові події. Ширина лівої сторони спектра мультифрактальності зростає під час 1992, 1996-2000, 2008, 2016 років та коронавірусної пандемії. Це вказує на домінацію висококонцентрованих флуктуацій (з великою амплітудою коливань). Окрім цього, зростання ширини лівого хвоста вказує на те, що флуктуації з великою амплітудою коливань характеризуються зростанням ступеня кореляцій під час кризових подій, що в свою чергу може слугувати індикатором зростання процесів самоорганізації.</p>
<p>Хоча і меншою, але не менш примітною є динаміка ширини правого хвоста мультифрактального спектра. Цей індикатор працює майже аналогічно до ширини лівого хвоста, але характеризує динаміку малоконцентрованих величин — флуктуацій з малою амплітудою коливань. Майже синхронна динаміка обох показників указує на зростання впливу коливань як флуктуацій з великою амплітудою коливань, так і флуктуацій з малою амплітудою коливань. Тобто, два типи флуктуацій є джерелом зростання нелінійних кореляцій під час кризових подій.</p>
</section>
<section id="показник-сингулярності-alpha-та-його-різновиди" class="level3" data-number="7.2.4">
<h3 data-number="7.2.4" class="anchored" data-anchor-id="показник-сингулярності-alpha-та-його-різновиди"><span class="header-section-number">7.2.4</span> Показник сингулярності <span class="math inline">\(\alpha\)</span> та його різновиди</h3>
<p>В якості можливих індикаторів складності системи можна взяти <span class="math inline">\(\alpha_{min}\)</span>, <span class="math inline">\(\alpha_{max}\)</span>, <span class="math inline">\(\alpha_{mean}\)</span> і <span class="math inline">\(\alpha_0\)</span>, які, відповідно, характеризують мінімальну силу сингулярності, максимальну, середню і сингулярність за умови рівноважного врахування як великих флуктуацій, так і малих.</p>
<div class="cell" data-execution_count="96">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> ax.twinx()</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>ax3 <span class="op">=</span> ax.twinx()</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>ax4 <span class="op">=</span> ax.twinx()</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>ax5 <span class="op">=</span> ax.twinx()</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>ax3.spines.right.set_position((<span class="st">"axes"</span>, <span class="fl">1.08</span>))</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>ax4.spines.right.set_position((<span class="st">"axes"</span>, <span class="fl">1.18</span>))</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>ax5.spines.right.set_position((<span class="st">"axes"</span>, <span class="fl">1.27</span>))</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>p1, <span class="op">=</span> ax.plot(time_ser.index[window:length:tstep], time_ser[window:length:tstep], <span class="st">"b-"</span>, label<span class="op">=</span><span class="vs">fr"</span><span class="sc">{</span>ylabel<span class="sc">}</span><span class="vs">"</span>)</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>p2, <span class="op">=</span> ax2.plot(time_ser.index[window:length:tstep], max_alph, <span class="st">"r-"</span>, label<span class="op">=</span><span class="vs">r"$\alpha_</span><span class="sc">{max}</span><span class="vs">$"</span>)</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>p3, <span class="op">=</span> ax3.plot(time_ser.index[window:length:tstep], min_alph, <span class="st">"g-"</span>, label<span class="op">=</span><span class="vs">r"$\alpha_</span><span class="sc">{min}</span><span class="vs">$"</span>)</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>p4, <span class="op">=</span> ax4.plot(time_ser.index[window:length:tstep], mean_alph, <span class="st">"c-"</span>, label<span class="op">=</span><span class="vs">r"$\alpha_</span><span class="sc">{mean}</span><span class="vs">$"</span>)</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>p5, <span class="op">=</span> ax5.plot(time_ser.index[window:length:tstep], alpha_zero, <span class="st">"m-"</span>, label<span class="op">=</span><span class="vs">r"$\alpha_</span><span class="sc">{0}</span><span class="vs">$"</span>)</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(xlabel)</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">fr"</span><span class="sc">{</span>ylabel<span class="sc">}</span><span class="vs">"</span>)</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>ax.yaxis.label.set_color(p1.get_color())</span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>ax2.yaxis.label.set_color(p2.get_color())</span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>ax3.yaxis.label.set_color(p3.get_color())</span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a>ax4.yaxis.label.set_color(p4.get_color())</span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>ax5.yaxis.label.set_color(p5.get_color())</span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a>tkw <span class="op">=</span> <span class="bu">dict</span>(size<span class="op">=</span><span class="dv">4</span>, width<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a>ax.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, colors<span class="op">=</span>p1.get_color(), <span class="op">**</span>tkw)</span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a>ax2.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, colors<span class="op">=</span>p2.get_color(), <span class="op">**</span>tkw)</span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a>ax3.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, colors<span class="op">=</span>p3.get_color(), <span class="op">**</span>tkw)</span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a>ax4.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, colors<span class="op">=</span>p4.get_color(), <span class="op">**</span>tkw)</span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a>ax5.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, colors<span class="op">=</span>p5.get_color(), <span class="op">**</span>tkw)</span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true" tabindex="-1"></a>ax.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, <span class="op">**</span>tkw, pad<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb58-34"><a href="#cb58-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-35"><a href="#cb58-35" aria-hidden="true" tabindex="-1"></a>ax5.legend(handles<span class="op">=</span>[p1, p2, p3, p4, p5])</span>
<span id="cb58-36"><a href="#cb58-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-37"><a href="#cb58-37" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="ss">f"mfdfa_alpha_min_max_mean_zero_name=</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_ret=</span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_order=</span><span class="sc">{</span>order<span class="sc">}</span><span class="ss">_qmin=</span><span class="sc">{</span>q_min<span class="sc">}</span><span class="ss">_qmax=</span><span class="sc">{</span>q_max<span class="sc">}</span><span class="ss">_qinc=</span><span class="sc">{</span>q_step<span class="sc">}</span><span class="ss">_ </span><span class="ch">\</span></span>
<span id="cb58-38"><a href="#cb58-38" aria-hidden="true" tabindex="-1"></a><span class="ss">            wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_windbeg=</span><span class="sc">{</span>win_beg<span class="sc">}</span><span class="ss">_winden=</span><span class="sc">{</span>win_end<span class="sc">}</span><span class="ss">.jpg"</span>, bbox_inches<span class="op">=</span><span class="st">"tight"</span>)</span>
<span id="cb58-39"><a href="#cb58-39" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-wti-wind-alphas" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="lab_7_files/figure-html/fig-wti-wind-alphas-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.28: Динаміка індексу сирої нафти WTI та показників сингулярності</figcaption>
</figure>
</div>
</div>
</div>
<p>Як видно з <a href="#fig-wti-wind-alphas">Рис.&nbsp;<span>7.28</span></a>, усі показники сингулярності зростають в області фінансового фазового переходу зі стану стабільності до стану кризи. Це говорить про зростання складності системи: різкому прирості кількості агентів, що задіяні в самоорганізованому розвитку досліджуваної системи. З погляду термодинаміки можна було б сказати, що при фінансових крахових подіях зростає внутрішня енергія системи.</p>
</section>
<section id="тип-довгого-хвоста-мультифрактального-спектра-delta-s" class="level3" data-number="7.2.5">
<h3 data-number="7.2.5" class="anchored" data-anchor-id="тип-довгого-хвоста-мультифрактального-спектра-delta-s"><span class="header-section-number">7.2.5</span> Тип довгого хвоста мультифрактального спектра (<span class="math inline">\(\Delta S\)</span>)</h3>
<p>Крім такої міри як, наприклад, <span class="math inline">\(\Delta f\)</span> можна представити й інші міри асиметрії мультифрактального спектра. Наприклад, ми можемо визначити тип довгого хвоста мультифрактального спектра за допомогою показника <span class="math inline">\(\Delta S\)</span> <span class="citation" data-cites="10.3389/fphys.2012.00141">&nbsp;[<a href="references.html#ref-10.3389/fphys.2012.00141" role="doc-biblioref">28</a>]</span>:</p>
<p><span id="eq-7-5"><span class="math display">\[
\Delta S = \Delta\alpha_{R} - \Delta\alpha_{L}.
\tag{7.14}\]</span></span></p>
<p>Якщо <span class="math inline">\(\Delta S &lt; 0\)</span>, мультифрактальний спектр має довгий лівий хвіст, що свідчить про чутливість часового ряду до локальних флуктуацій з великою амплітудою. Якщо <span class="math inline">\(\Delta S &gt; 0\)</span>, мультифрактальний спектр має довгий правий хвіст, який вказує на чутливість структури сигналу до локальних флуктуацій з малою амплітудою коливань. У тих випадках, коли високо- і низькофлуктуаційні компоненти сигналу співставні, спектр сингулярностей буде приблизно симетричним і <span class="math inline">\(\Delta\alpha_{R} = \Delta\alpha_{L}\)</span>.</p>
<div class="cell" data-execution_count="97">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>measure_label <span class="op">=</span> <span class="vs">r'$\Delta S$'</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>file_name <span class="op">=</span> <span class="ss">f"mfdfa_delta_s_name=</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_ret=</span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_order=</span><span class="sc">{</span>order<span class="sc">}</span><span class="ss">_qmin=</span><span class="sc">{</span>q_min<span class="sc">}</span><span class="ss">_qmax=</span><span class="sc">{</span>q_max<span class="sc">}</span><span class="ss">_qinc=</span><span class="sc">{</span>q_step<span class="sc">}</span><span class="ss">_ </span><span class="ch">\</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="ss">           wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_windbeg=</span><span class="sc">{</span>win_beg<span class="sc">}</span><span class="ss">_winden=</span><span class="sc">{</span>win_end<span class="sc">}</span><span class="ss">"</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="98">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>plot_pair(time_ser.index[window:length:tstep],</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>          time_ser.values[window:length:tstep],</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>          delta_s, </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>          ylabel, </span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>          measure_label,</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>          xlabel,</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>          file_name, </span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>          clr<span class="op">=</span><span class="st">'darkorange'</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-wti-wind-delta-s" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="lab_7_files/figure-html/fig-wti-wind-delta-s-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.29: Динаміка індексу сирої нафти WTI та показника типу хвоста мультифрактального спектра <span class="math inline">\(\Delta S\)</span></figcaption>
</figure>
</div>
</div>
</div>
<p>З огляду на <a href="#fig-wti-wind-delta-s">Рис.&nbsp;<span>7.29</span></a> видно, що <span class="math inline">\(\Delta S &lt; 0\)</span>, що свідчить про те, що найбільш крахові ділянки нафтового ринку зумовлені флуктуаціями з великою амплітудою коливань. Особливо помітними тут предстають кризи 1992 та 2020 років.</p>
</section>
<section id="показник-асиметрії-a" class="level3" data-number="7.2.6">
<h3 data-number="7.2.6" class="anchored" data-anchor-id="показник-асиметрії-a"><span class="header-section-number">7.2.6</span> Показник асиметрії <span class="math inline">\(A\)</span></h3>
<p>Далі ми можемо визначити наступний параметр асиметрії <span class="citation" data-cites="OSWIECIMKA2018231 PhysRevE.91.030902 Dro_d__2018">&nbsp;[<a href="references.html#ref-OSWIECIMKA2018231" role="doc-biblioref">29</a>–<a href="references.html#ref-Dro_d__2018" role="doc-biblioref">31</a>]</span>:</p>
<p><span id="eq-7-6"><span class="math display">\[
A = (\Delta\alpha_{L} - \Delta\alpha_{R})\big/(\Delta\alpha_{R} + \Delta\alpha_{L}) = -\Delta S \big/ \Delta\alpha.
\tag{7.15}\]</span></span></p>
<p>Параметр асиметрії пов’язаний з предомінуючим типом коливань у досліджуваній системі. Якщо <span class="math inline">\(A=0\)</span> (<span class="math inline">\(\Delta\alpha_{L}=\Delta\alpha_{R}\)</span>), динаміку системи представляє симетричний спектр. Якщо <span class="math inline">\(A&lt;0\)</span> (<span class="math inline">\(\Delta\alpha_{L}&lt;\Delta\alpha_{R}\)</span>), мультифрактальний спектр має правосторонню асиметрію, що підкреслює сильніший вплив малих флуктуацій на мультифрактальність. І навпаки, коли <span class="math inline">\(A&gt;0\)</span> (<span class="math inline">\(\Delta\alpha_{L}&gt;\Delta\alpha_{R}\)</span>), тоді ми маємо справу з лівостороннім спектром, який позначає більшу неоднорідність для великих флуктуацій і вказує на те, що в часовому ряді переважає мультифрактальна природа неоднорідностей з високими щільностями. Оскільки асиметрію виявляють за знаком <span class="math inline">\(A\)</span>, що еквівалентний знаку <span class="math inline">\(\Delta S\)</span>, то, ґрунтуючись тільки по знаку <span class="math inline">\(\Delta S\)</span>, можна зробити висновки як про тип довгого хвоста, так і про знак показника <span class="math inline">\(A\)</span> мультифрактального спектра, тобто нечутливість і тип домінантних коливань мультифрактальності часового ряду.</p>
<div class="cell" data-execution_count="99">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>measure_label <span class="op">=</span> <span class="vs">r'$A$'</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>file_name <span class="op">=</span> <span class="ss">f"mfdfa_A_name=</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_ret=</span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_order=</span><span class="sc">{</span>order<span class="sc">}</span><span class="ss">_qmin=</span><span class="sc">{</span>q_min<span class="sc">}</span><span class="ss">_qmax=</span><span class="sc">{</span>q_max<span class="sc">}</span><span class="ss">_qinc=</span><span class="sc">{</span>q_step<span class="sc">}</span><span class="ss">_ </span><span class="ch">\</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="ss">           wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_windbeg=</span><span class="sc">{</span>win_beg<span class="sc">}</span><span class="ss">_winden=</span><span class="sc">{</span>win_end<span class="sc">}</span><span class="ss">"</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="100">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>plot_pair(time_ser.index[window:length:tstep],</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>          time_ser.values[window:length:tstep],</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>          assym, </span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>          ylabel, </span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>          measure_label,</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>          xlabel,</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>          file_name, </span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>          clr<span class="op">=</span><span class="st">'darkviolet'</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-wti-asymmetry" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="lab_7_files/figure-html/fig-wti-asymmetry-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.30: Динаміка індексу сирої нафти WTI та показника асиметрії мультифрактального спектра <span class="math inline">\(A\)</span></figcaption>
</figure>
</div>
</div>
</div>
<p>З <a href="#fig-wti-asymmetry">Рис.&nbsp;<span>7.30</span></a> видно, що, як правило, показник асиметрії зростає під час крахових подій і вказує на домінацію лівостороннього спектра (висококонцентрованих флуктуацій з великою амплітудою коливань). Окрім цього видно, що, наприклад, для криз 2008 та 2015-2016 років спостерігалась помітна короткочасна правостороння асиметрія, що характеризується швидкоплинним сплеском показника асиметрії у сторону від’ємних значень. Асоціювати малі та великі флуктуації з конкретними настроями або поведінковими патернами ринку доволі складно. На даний момент ми можемо відзначити тільки те, що дані події представляли найбільш багату варіацію як короткострокових, так і довгострокових кореляцій.</p>
</section>
<section id="індекс-h-флуктуацій-hfi" class="level3" data-number="7.2.7">
<h3 data-number="7.2.7" class="anchored" data-anchor-id="індекс-h-флуктуацій-hfi"><span class="header-section-number">7.2.7</span> Індекс <span class="math inline">\(h\)</span>-флуктуацій (<span class="math inline">\(hFI\)</span>)</h3>
<p>Флуктуацію можна проаналізувати за допомогою другої похідної узагальненого показника Херста. Зауважимо, що амплітуда другої похідної у випадку мультифрактальних сигналів більша, ніж для монофрактальних. Для одержання потрібної інформації з <span class="math inline">\(h(q)\)</span> було запропоновано <span class="math inline">\(h\)</span>-індекс флуктуації <span class="math inline">\((hFI)\)</span> <span class="citation" data-cites="Orozco_Duque_2015">&nbsp;[<a href="references.html#ref-Orozco_Duque_2015" role="doc-biblioref">32</a>]</span>, що визначається як степінь другої похідної від <span class="math inline">\(h(q)\)</span>:</p>
<p><span id="eq-7-7"><span class="math display">\[
hFI = \frac{1}{2|q_{max}|+2}\sum_{q=q_{min}-2}^{q_{max}}\left[ h(q) - 2h(q-1) + h(q-2) \right]^{2}.
\tag{7.16}\]</span></span></p>
<p>Чим вище значення даного показника, тим вища самоорганізованість системи.</p>
<div class="cell" data-execution_count="101">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>measure_label <span class="op">=</span> <span class="vs">r'$hFI$'</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>file_name <span class="op">=</span> <span class="ss">f"mfdfa_hFI_name=</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_ret=</span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_order=</span><span class="sc">{</span>order<span class="sc">}</span><span class="ss">_qmin=</span><span class="sc">{</span>q_min<span class="sc">}</span><span class="ss">_qmax=</span><span class="sc">{</span>q_max<span class="sc">}</span><span class="ss">_qinc=</span><span class="sc">{</span>q_step<span class="sc">}</span><span class="ss">_ </span><span class="ch">\</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="ss">           wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_windbeg=</span><span class="sc">{</span>win_beg<span class="sc">}</span><span class="ss">_winden=</span><span class="sc">{</span>win_end<span class="sc">}</span><span class="ss">"</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="102">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>plot_pair(time_ser.index[window:length:tstep],</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>          time_ser.values[window:length:tstep],</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>          hFI, </span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>          ylabel, </span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>          measure_label,</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>          xlabel,</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>          file_name, </span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>          clr<span class="op">=</span><span class="st">'green'</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-wti-hfi" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="lab_7_files/figure-html/fig-wti-hfi-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.31: Динаміка індексу сирої нафти WTI та індексу <span class="math inline">\(h\)</span>-флуктуацій <span class="math inline">\(hFI\)</span></figcaption>
</figure>
</div>
</div>
</div>
<p>Видно, що за <span class="math inline">\(hFI\)</span> найвищий ступінь мультифрактальності проявляється саме для криз 1992, 2008, 2016 та 2020 років. Дані крахові події включають в себе найбільшу кількість різноманітних факторів, що впливали на динаміку досліджуваної системи. Особливо помітно це для коронавірусної пандемії.</p>
</section>
<section id="кумулятивний-індекс-інкрементів-узагальнених-показників-херста-alpha-cf" class="level3" data-number="7.2.8">
<h3 data-number="7.2.8" class="anchored" data-anchor-id="кумулятивний-індекс-інкрементів-узагальнених-показників-херста-alpha-cf"><span class="header-section-number">7.2.8</span> Кумулятивний індекс інкрементів узагальнених показників Херста (<span class="math inline">\(\alpha CF\)</span>)</h3>
<p>Кумулятивна функція квадратів інкрементів (<span class="math inline">\(\alpha CF\)</span>) <span class="citation" data-cites="doi:10.1098/rsta.2020.0254">&nbsp;[<a href="references.html#ref-doi:10.1098/rsta.2020.0254" role="doc-biblioref">33</a>]</span> узагальнених показників Херста між послідовними моментними порядками є більш надійним показником розподілу узагальнених показників Херста.</p>
<div class="cell" data-execution_count="103">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>measure_label <span class="op">=</span> <span class="vs">r'$\alpha CF$'</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>file_name <span class="op">=</span> <span class="ss">f"mfdfa_alphaCF_name=</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_ret=</span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_order=</span><span class="sc">{</span>order<span class="sc">}</span><span class="ss">_qmin=</span><span class="sc">{</span>q_min<span class="sc">}</span><span class="ss">_qmax=</span><span class="sc">{</span>q_max<span class="sc">}</span><span class="ss">_qinc=</span><span class="sc">{</span>q_step<span class="sc">}</span><span class="ss">_ </span><span class="ch">\</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="ss">           wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_windbeg=</span><span class="sc">{</span>win_beg<span class="sc">}</span><span class="ss">_winden=</span><span class="sc">{</span>win_end<span class="sc">}</span><span class="ss">"</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="104">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>plot_pair(time_ser.index[window:length:tstep],</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>          time_ser.values[window:length:tstep],</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>          alphaCF, </span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>          ylabel, </span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>          measure_label,</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>          xlabel,</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>          file_name, </span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>          clr<span class="op">=</span><span class="st">'crimson'</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-wti-wind-alphacf" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="lab_7_files/figure-html/fig-wti-wind-alphacf-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.32: Динаміка індексу сирої нафти WTI та кумулятивний індексу інкрементів узагальнених показників Херста <span class="math inline">\(\alpha CF\)</span></figcaption>
</figure>
</div>
</div>
</div>
<p>Представлений кумулятивний індекс дещо відрізняється від <span class="math inline">\(hFI\)</span>, але за логікою приблизно однаковий: події з найвищим ступенем мультифрактальності характеризуються вищою амплітудою <span class="math inline">\(\alpha CF\)</span>. Представлений показник виділяє ті самі кризи, що й попередній, але динаміка цього показника більш виразна, що робить його більш надійним для ідентифікації періодів самоорганізації системи.</p>
</section>
<section id="інтегральна-мультифрактальна-теплоємність-cq" class="level3" data-number="7.2.9">
<h3 data-number="7.2.9" class="anchored" data-anchor-id="інтегральна-мультифрактальна-теплоємність-cq"><span class="header-section-number">7.2.9</span> Інтегральна мультифрактальна теплоємність <span class="math inline">\(C(q)\)</span></h3>
<p>Загальний ступінь мультифрактальності, інтегральну мультифрактальну питому теплоємність (<span class="math inline">\(C_{area}\)</span>), можна виразити через рівняння (<a href="#eq-7-8"><span>7.17</span></a>):</p>
<p><span id="eq-7-8"><span class="math display">\[
C_{area} = \int C(q)dq.
\tag{7.17}\]</span></span></p>
<p>Розрахуємо і проаналізуємо динаміку цього показника.</p>
<div class="cell" data-execution_count="105">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>measure_label <span class="op">=</span> <span class="vs">r'$C_</span><span class="sc">{area}</span><span class="vs">$'</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>file_name <span class="op">=</span> <span class="ss">f"mfdfa_C_q_area_name=</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_ret=</span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_order=</span><span class="sc">{</span>order<span class="sc">}</span><span class="ss">_qmin=</span><span class="sc">{</span>q_min<span class="sc">}</span><span class="ss">_qmax=</span><span class="sc">{</span>q_max<span class="sc">}</span><span class="ss">_qinc=</span><span class="sc">{</span>q_step<span class="sc">}</span><span class="ss">_ </span><span class="ch">\</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="ss">           wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_windbeg=</span><span class="sc">{</span>win_beg<span class="sc">}</span><span class="ss">_winden=</span><span class="sc">{</span>win_end<span class="sc">}</span><span class="ss">"</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="106">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>plot_pair(time_ser.index[window:length:tstep],</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>          time_ser.values[window:length:tstep],</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>          C_q_area_wind, </span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>          ylabel, </span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>          measure_label,</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>          xlabel,</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>          file_name, </span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>          clr<span class="op">=</span><span class="st">'darkslateblue'</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-wti-wind-c-q-arad" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="lab_7_files/figure-html/fig-wti-wind-c-q-arad-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.33: Динаміка індексу сирої нафти WTI та інтегральної мультифрактальної теплоємності <span class="math inline">\(C_{area}\)</span></figcaption>
</figure>
</div>
</div>
</div>
<p>З представленого рисунку видно, що динаміка інтегральної теплоємності дуже подібна до ширини спектра мультифрактальності. Тобто, <span class="math inline">\(C_{area}\)</span> є показником складності, що вказує на ступінь самоорганізованості фінансового фазового переходу. Видно, що фінансові крахи представляють доволі трендостійку динаміку, що є наслідком цілеспрямованих та колективних дій трейдерів на ринку.</p>
</section>
<section id="хаусдорфова-розмірність-d_0" class="level3" data-number="7.2.10">
<h3 data-number="7.2.10" class="anchored" data-anchor-id="хаусдорфова-розмірність-d_0"><span class="header-section-number">7.2.10</span> Хаусдорфова розмірність (<span class="math inline">\(D_{0}\)</span>)</h3>
<p>Як уже зазначалось, <span class="math inline">\(D_{0}\)</span> представляє верхню межу змін розмірностей фрактальних підмножин атрактора системи. Інформацію про статистичні властивості системи він не містить і не представляє особливої цінності.</p>
<div class="cell" data-execution_count="107">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>measure_label <span class="op">=</span> <span class="vs">r'$D_</span><span class="sc">{0}</span><span class="vs">$'</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>file_name <span class="op">=</span> <span class="ss">f"mfdfa_D_0_area_name=</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_ret=</span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_order=</span><span class="sc">{</span>order<span class="sc">}</span><span class="ss">_qmin=</span><span class="sc">{</span>q_min<span class="sc">}</span><span class="ss">_qmax=</span><span class="sc">{</span>q_max<span class="sc">}</span><span class="ss">_qinc=</span><span class="sc">{</span>q_step<span class="sc">}</span><span class="ss">_ </span><span class="ch">\</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="ss">           wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_windbeg=</span><span class="sc">{</span>win_beg<span class="sc">}</span><span class="ss">_winden=</span><span class="sc">{</span>win_end<span class="sc">}</span><span class="ss">"</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="108">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>plot_pair(time_ser.index[window:length:tstep],</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>          time_ser.values[window:length:tstep],</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>          D_0, </span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>          ylabel, </span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>          measure_label,</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>          xlabel,</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>          file_name, </span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>          clr<span class="op">=</span><span class="st">'darkred'</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-wti-wind-d-0" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="lab_7_files/figure-html/fig-wti-wind-d-0-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.34: Динаміка індексу сирої нафти WTI та хаусдорфової розмірності цього часового сигналу <span class="math inline">\(D_{0}\)</span></figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="інформаційна-розмірність-d_1" class="level3" data-number="7.2.11">
<h3 data-number="7.2.11" class="anchored" data-anchor-id="інформаційна-розмірність-d_1"><span class="header-section-number">7.2.11</span> Інформаційна розмірність (<span class="math inline">\(D_{1}\)</span>)</h3>
<p>Інформаційна розмірність тісно пов’язана з інформаційною ентропією Шеннона. Чим вище значення <span class="math inline">\(D_1\)</span>, тим швидше збільшується ентропія, що є показником того, наскільки мало ми знаємо про поточний стан системи. Зі зменшенням <span class="math inline">\(D_1\)</span> ентропія знижується, що, своєю чергою, свідчить про збільшення асиметрії в просторі, зменшення складності та розширення нашого розуміння поточного стану системи. Це також означає, що для опису можливих конфігурацій системи нам буде потрібно менше інформації.</p>
<div class="cell" data-execution_count="109">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>measure_label <span class="op">=</span> <span class="vs">r'$D_</span><span class="sc">{1}</span><span class="vs">$'</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>file_name <span class="op">=</span> <span class="ss">f"mfdfa_D_1_area_name=</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_ret=</span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_order=</span><span class="sc">{</span>order<span class="sc">}</span><span class="ss">_qmin=</span><span class="sc">{</span>q_min<span class="sc">}</span><span class="ss">_qmax=</span><span class="sc">{</span>q_max<span class="sc">}</span><span class="ss">_qinc=</span><span class="sc">{</span>q_step<span class="sc">}</span><span class="ss">_ </span><span class="ch">\</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="ss">           wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_windbeg=</span><span class="sc">{</span>win_beg<span class="sc">}</span><span class="ss">_winden=</span><span class="sc">{</span>win_end<span class="sc">}</span><span class="ss">"</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="110">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>plot_pair(time_ser.index[window:length:tstep],</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>          time_ser.values[window:length:tstep],</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>          D_1, </span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>          ylabel, </span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>          measure_label,</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>          xlabel,</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>          file_name, </span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>          clr<span class="op">=</span><span class="st">'darkred'</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-wti-informdim" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="lab_7_files/figure-html/fig-wti-informdim-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.35: Динаміка індексу сирої нафти WTI та інформаційної розмірності цього часового сигналу <span class="math inline">\(D_{1}\)</span></figcaption>
</figure>
</div>
</div>
</div>
<p>На <a href="#fig-wti-informdim">Рис.&nbsp;<span>7.35</span></a> видно, що інформаційна розмірність характеризується спадом під час крахових подій. Це вказує на зростання ступеня впорядкованості системи та колективної атракції агентів ринку до конкретної області фазового простору досліджуваної системи.</p>
</section>
<section id="кореляційна-розмірність-d_2" class="level3" data-number="7.2.12">
<h3 data-number="7.2.12" class="anchored" data-anchor-id="кореляційна-розмірність-d_2"><span class="header-section-number">7.2.12</span> Кореляційна розмірність (<span class="math inline">\(D_{2}\)</span>)</h3>
<p>Кореляційну розмірність, аналогічно інформаційній розмірності, можна подати як тангенс кута нахилу лінії регресії, побудованої в логарифмічному масштабі, щодо залежності кореляційного інтеграла <span class="math inline">\(C(\varepsilon)\)</span> від <span class="math inline">\(\varepsilon\)</span>. Подібно до <span class="math inline">\(D_1\)</span>, кореляційна розмірність також визначає, як швидко змінюється значення кореляційного інтеграла.</p>
<div class="cell" data-execution_count="111">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>measure_label <span class="op">=</span> <span class="vs">r'$D_</span><span class="sc">{2}</span><span class="vs">$'</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>file_name <span class="op">=</span> <span class="ss">f"mfdfa_D_2_area_name=</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_ret=</span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_order=</span><span class="sc">{</span>order<span class="sc">}</span><span class="ss">_qmin=</span><span class="sc">{</span>q_min<span class="sc">}</span><span class="ss">_qmax=</span><span class="sc">{</span>q_max<span class="sc">}</span><span class="ss">_qinc=</span><span class="sc">{</span>q_step<span class="sc">}</span><span class="ss">_</span><span class="ch">\</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="ss">           wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_windbeg=</span><span class="sc">{</span>win_beg<span class="sc">}</span><span class="ss">_winden=</span><span class="sc">{</span>win_end<span class="sc">}</span><span class="ss">"</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="112">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>plot_pair(time_ser.index[window:length:tstep],</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>          time_ser.values[window:length:tstep],</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>          D_2, </span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>          ylabel, </span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>          measure_label,</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>          xlabel,</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>          file_name, </span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>          clr<span class="op">=</span><span class="st">'darkred'</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-wti-corrdim" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="lab_7_files/figure-html/fig-wti-corrdim-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.36: Динаміка індексу сирої нафти WTI та кореляційної розмірності цього часового сигналу <span class="math inline">\(D_{2}\)</span></figcaption>
</figure>
</div>
</div>
</div>
<p>Кореляційна розмірність на <a href="#fig-wti-corrdim">Рис.&nbsp;<span>7.36</span></a> характеризується зростанням у передкризовий період та спадом під час кризи. Це говорить про те, що більшість агентів ринку починає орієнтуватися на один конкретний вектор розвитку системи.</p>
</section>
<section id="кривизна-лівого-delta-d_l-та-правого-delta-d_r-хвостів-розподілу-узагальнених-фрактальних-розмірностей" class="level3" data-number="7.2.13">
<h3 data-number="7.2.13" class="anchored" data-anchor-id="кривизна-лівого-delta-d_l-та-правого-delta-d_r-хвостів-розподілу-узагальнених-фрактальних-розмірностей"><span class="header-section-number">7.2.13</span> Кривизна лівого (<span class="math inline">\(\Delta D_{L}\)</span>) та правого (<span class="math inline">\(\Delta D_{R}\)</span>) хвостів розподілу узагальнених фрактальних розмірностей</h3>
<p>Охарактеризувати ступінь цієї складності можна за кривизною окремо правого та лівого хвостів узагальнених фрактальних розмірностей. Праву сторону (<span class="math inline">\(\Delta D_{R}\)</span>) можна визначити як</p>
<p><span id="eq-7-9"><span class="math display">\[
\Delta D_{R} = D_0 - D_{q_{max}}.
\tag{7.18}\]</span></span></p>
<p>І чим більшим буде значення цієї міри, тим сильнішим буде ступінь впливу елементів із найбільшою концентрацією (щільністю, амплітудою флуктуацій) на загальну складність системи.</p>
<p>Кривизна лівого хвоста кривої узагальнених фрактальних розмірностей (<span class="math inline">\(\Delta D_{L}\)</span>):</p>
<p><span id="eq-7-10"><span class="math display">\[
\Delta D_{L} = D_{q_{min}} - D_{0}.
\tag{7.19}\]</span></span></p>
<p>Цей показник буде говорити нам про те, наскільки сильним є вплив найменш концентрованих елементів на складність системи.</p>
<div class="cell" data-execution_count="113">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> ax.twinx()</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>ax3 <span class="op">=</span> ax.twinx()</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>ax2.spines.right.set_position((<span class="st">"axes"</span>, <span class="fl">1.03</span>))</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>ax3.spines.right.set_position((<span class="st">"axes"</span>, <span class="fl">1.12</span>))</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>p1, <span class="op">=</span> ax.plot(time_ser.index[window:length:tstep], </span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>              time_ser.values[window:length:tstep], </span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>              <span class="st">"b-"</span>, label<span class="op">=</span><span class="vs">fr"</span><span class="sc">{</span>ylabel<span class="sc">}</span><span class="vs">"</span>)</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>p2, <span class="op">=</span> ax2.plot(time_ser.index[window:length:tstep], </span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>               D_left, color<span class="op">=</span><span class="st">"g"</span>, label<span class="op">=</span><span class="vs">r"$\Delta D_</span><span class="sc">{L}</span><span class="vs">$"</span>)</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>p3, <span class="op">=</span> ax3.plot(time_ser.index[window:length:tstep], </span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>               D_right, color<span class="op">=</span><span class="st">"r"</span>, label<span class="op">=</span><span class="vs">r"$\Delta D_</span><span class="sc">{R}</span><span class="vs">$"</span>)</span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(xlabel)</span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="ss">f"</span><span class="sc">{</span>ylabel<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a>ax.yaxis.label.set_color(p1.get_color())</span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a>ax2.yaxis.label.set_color(p2.get_color())</span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a>ax3.yaxis.label.set_color(p3.get_color())</span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true" tabindex="-1"></a>tkw <span class="op">=</span> <span class="bu">dict</span>(size<span class="op">=</span><span class="dv">4</span>, width<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true" tabindex="-1"></a>ax.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, colors<span class="op">=</span>p1.get_color(), <span class="op">**</span>tkw)</span>
<span id="cb75-27"><a href="#cb75-27" aria-hidden="true" tabindex="-1"></a>ax2.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, colors<span class="op">=</span>p2.get_color(), <span class="op">**</span>tkw)</span>
<span id="cb75-28"><a href="#cb75-28" aria-hidden="true" tabindex="-1"></a>ax3.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, colors<span class="op">=</span>p3.get_color(), <span class="op">**</span>tkw)</span>
<span id="cb75-29"><a href="#cb75-29" aria-hidden="true" tabindex="-1"></a>ax.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, <span class="op">**</span>tkw)</span>
<span id="cb75-30"><a href="#cb75-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-31"><a href="#cb75-31" aria-hidden="true" tabindex="-1"></a>ax3.legend(handles<span class="op">=</span>[p1, p2, p3])</span>
<span id="cb75-32"><a href="#cb75-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-33"><a href="#cb75-33" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="ss">f"mfdfa_delta_D_left_right_name=</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_ret=</span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_order=</span><span class="sc">{</span>order<span class="sc">}</span><span class="ss">_qmin=</span><span class="sc">{</span>q_min<span class="sc">}</span><span class="ss">_qmax=</span><span class="sc">{</span>q_max<span class="sc">}</span><span class="ss">_qinc=</span><span class="sc">{</span>q_step<span class="sc">}</span><span class="ss">_ </span><span class="ch">\</span></span>
<span id="cb75-34"><a href="#cb75-34" aria-hidden="true" tabindex="-1"></a><span class="ss">           wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_windbeg=</span><span class="sc">{</span>win_beg<span class="sc">}</span><span class="ss">_winden=</span><span class="sc">{</span>win_end<span class="sc">}</span><span class="ss">.jpg"</span>)</span>
<span id="cb75-35"><a href="#cb75-35" aria-hidden="true" tabindex="-1"></a>plt.show()<span class="op">;</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-delta-lr" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="lab_7_files/figure-html/fig-delta-lr-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.37: Індекс сирої нафти WTI та кривизна лівого і правого хвостів спектра узагальнених фрактальних розмірностей</figcaption>
</figure>
</div>
</div>
</div>
<p>На рисунку (<a href="#fig-delta-lr">Рис.&nbsp;<span>7.37</span></a>) видно, що спостерігаються етапи, при який два показники можуть вести себе як асинхронно, так і синхронно. Для 1992 року видно, що у передкризовий етап спостерігалась короткочасна домінація великих флуктуацій, на що і вказує <span class="math inline">\(\Delta D_{R}\)</span>. Під час краху спостерігалась домінація малоконцентрованих елементів, що демонструє зростання <span class="math inline">\(\Delta D_{L}\)</span>. Для 2001 року бачимо зростання впливу правого хвоста і зменшення впливу лівого. Для краху 2008 року видно зростання впливу висококонцентрованих елементів напередодні кризи. Після цього домінують малоконцентровані елементи. Бачимо зростання впливу малоконцентрованих елементів під час кризи 2016 року, і закономірне зменшення участі великоконцентрованих елементів. Пандемія 2020-2021 років характеризувалась активною участю як малоконцентрованих елементів, так і великоконцентрованих, на що вказує зростання обох показників кривизни хвостів узагальнених розмірностей.</p>
</section>
<section id="дво--та-тривимірна-візуалізація-показників-мультифрактальності" class="level3" data-number="7.2.14">
<h3 data-number="7.2.14" class="anchored" data-anchor-id="дво--та-тривимірна-візуалізація-показників-мультифрактальності"><span class="header-section-number">7.2.14</span> Дво- та тривимірна візуалізація показників мультифрактальності</h3>
<p>Попередньо ми аналізували залежності <span class="math inline">\(h(q)\)</span>, <span class="math inline">\(\tau(q)\)</span>, <span class="math inline">\(D(q)\)</span>, <span class="math inline">\(C(q)\)</span> та <span class="math inline">\(f(\alpha)\)</span> для всього часового ряду. Тепер, скориставшись процедурою ковзного вікна, ми можемо подивитися на їх зміну з плином часу. Скористаємось часовим рядом цін на нафту.</p>
<p>Перш за все оголосимо функції для побудови двовимірних графіків:</p>
<div class="cell" data-execution_count="129">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_2d(X, Y, Z, subtitle_jpg, subtitle_fig, ylabel, barlabel, cmap, lims):</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>    cp <span class="op">=</span> ax.contourf(X, Y, Z, alpha<span class="op">=</span><span class="fl">0.8</span>, cmap<span class="op">=</span>cmap)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>    plt.colorbar(cp, ax<span class="op">=</span>ax, extend<span class="op">=</span><span class="st">'both'</span>, label<span class="op">=</span>barlabel)</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>    ax.set_xlim((time_ser.index[window:length:tstep][<span class="dv">0</span>], </span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>                 time_ser.index[window:length:tstep][<span class="op">-</span><span class="dv">1</span>]))</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>    ax.set_ylim((np.<span class="bu">min</span>(lims), np.<span class="bu">max</span>(lims)))</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(xlabel, fontsize<span class="op">=</span><span class="dv">22</span>)</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(ylabel, fontsize<span class="op">=</span><span class="dv">22</span>)</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>    ax.set_title(subtitle_fig, pad<span class="op">=</span><span class="dv">10</span>, fontsize<span class="op">=</span><span class="dv">22</span>)</span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>    ax.tick_params(axis<span class="op">=</span><span class="st">'both'</span>, which<span class="op">=</span><span class="st">'major'</span>, pad<span class="op">=</span><span class="dv">10</span>, labelsize<span class="op">=</span><span class="dv">22</span>)</span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>    fig.tight_layout()</span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a>    plt.savefig(<span class="ss">f"mfdfa_</span><span class="sc">{</span>subtitle_jpg<span class="sc">}</span><span class="ss">_name=</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_ret=</span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_order=</span><span class="sc">{</span>order<span class="sc">}</span><span class="ss">_ </span><span class="ch">\</span></span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a><span class="ss">                qmin=</span><span class="sc">{</span>q_min<span class="sc">}</span><span class="ss">_qmax=</span><span class="sc">{</span>q_max<span class="sc">}</span><span class="ss">_qinc=</span><span class="sc">{</span>q_step<span class="sc">}</span><span class="ss">_windbeg=</span><span class="sc">{</span>win_beg<span class="sc">}</span><span class="ss">_winden=</span><span class="sc">{</span>win_end<span class="sc">}</span><span class="ss">.jpg"</span>, </span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a>                bbox_inches<span class="op">=</span><span class="st">"tight"</span>)</span>
<span id="cb76-24"><a href="#cb76-24" aria-hidden="true" tabindex="-1"></a>    plt.show()<span class="op">;</span> </span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>та тривимірних:</p>
<div class="cell" data-execution_count="115">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_3d(X, Y, Z, subtitle_jpg, ylabel, zlabel, cmap):</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots(subplot_kw<span class="op">=</span>{<span class="st">"projection"</span>: <span class="st">"3d"</span>})</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>    surf <span class="op">=</span> ax.plot_surface(X, Y, Z, cmap<span class="op">=</span>cmap, rstride<span class="op">=</span><span class="dv">2</span>, cstride<span class="op">=</span><span class="dv">2</span>, linewidth<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(xlabel, fontsize<span class="op">=</span><span class="dv">22</span>, labelpad<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(ylabel, fontsize<span class="op">=</span><span class="dv">22</span>, labelpad<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>    ax.set_zlabel(zlabel, fontsize<span class="op">=</span><span class="dv">22</span>, labelpad<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>    ax.tick_params(axis<span class="op">=</span><span class="st">'both'</span>, which<span class="op">=</span><span class="st">'major'</span>, labelsize<span class="op">=</span><span class="dv">18</span>, pad<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>    fig.colorbar(surf, shrink<span class="op">=</span><span class="fl">0.5</span>, aspect<span class="op">=</span><span class="dv">10</span>, location<span class="op">=</span><span class="st">'right'</span>, pad<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>    fig.tight_layout()</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>    plt.savefig(<span class="ss">f"mfdfa_</span><span class="sc">{</span>subtitle_jpg<span class="sc">}</span><span class="ss">_name=</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_ret=</span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_order=</span><span class="sc">{</span>order<span class="sc">}</span><span class="ss">_ </span><span class="ch">\</span></span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a><span class="ss">                qmin=</span><span class="sc">{</span>q_min<span class="sc">}</span><span class="ss">_qmax=</span><span class="sc">{</span>q_max<span class="sc">}</span><span class="ss">_qinc=</span><span class="sc">{</span>q_step<span class="sc">}</span><span class="ss">_windbeg=</span><span class="sc">{</span>win_beg<span class="sc">}</span><span class="ss">_ </span><span class="ch">\</span></span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a><span class="ss">                winden=</span><span class="sc">{</span>win_end<span class="sc">}</span><span class="ss">.jpg"</span>, bbox_inches<span class="op">=</span><span class="st">"tight"</span>)</span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a>    plt.show()<span class="op">;</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Після оголошення необхідний функцій можна приступати до візуалізації.</p>
<section id="динаміка-hq-з-ходом-часу-в-дво--та-тривимірному-просторах" class="level4" data-number="7.2.14.1">
<h4 data-number="7.2.14.1" class="anchored" data-anchor-id="динаміка-hq-з-ходом-часу-в-дво--та-тривимірному-просторах"><span class="header-section-number">7.2.14.1</span> Динаміка <span class="math inline">\(h(q)\)</span> з ходом часу в дво- та тривимірному просторах</h4>
<div class="cell" data-execution_count="130">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(time_ser.index[window:length:tstep], nq)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> np.array(h_q).T</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>plot_2d(X, Y, Z, </span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>        subtitle_jpg<span class="op">=</span><span class="st">'contour_h(q)'</span>, </span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>        subtitle_fig<span class="op">=</span><span class="vs">fr"Теплова діаграма $h(q)$"</span>, </span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>        ylabel<span class="op">=</span><span class="vs">r"$q$"</span>, </span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>        barlabel<span class="op">=</span><span class="vs">r"$h(q)$"</span>,</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>        cmap<span class="op">=</span><span class="st">'jet'</span>,</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>        lims<span class="op">=</span>nq)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-hq-2d" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="lab_7_files/figure-html/fig-hq-2d-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.38: Двовимірна контурна діаграма динаміки узагальненого показника Херста <span class="math inline">\(h(q)\)</span>, що змінюється з плином часу</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-execution_count="117">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(np.arange(window, length, tstep), nq)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> np.array(h_q).T</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>plot_3d(X, Y, Z, </span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>        subtitle_jpg<span class="op">=</span><span class="st">'3d_h(q)'</span>, </span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>        ylabel<span class="op">=</span><span class="vs">r"$q$"</span>, </span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>        zlabel<span class="op">=</span><span class="vs">r"$h(q)$"</span>,</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>        cmap<span class="op">=</span><span class="st">'jet'</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-hq-3d" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="lab_7_files/figure-html/fig-hq-3d-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.39: Тривимірна діаграма динаміки узагальненого показника Херста <span class="math inline">\(h(q)\)</span>, що змінюється з плином часу</figcaption>
</figure>
</div>
</div>
</div>
<p>На представлений рисунках (<a href="#fig-hq-2d">Рис.&nbsp;<span>7.38</span></a> та <a href="#fig-hq-3d">Рис.&nbsp;<span>7.39</span></a>) видно, що узагальнений показник Херста характеризується значним ростом саме в період криз. Особливо високим <span class="math inline">\(h(q)\)</span> предстає для <span class="math inline">\(q &lt; 0\)</span>, що говорить про значну персистентність малих флуктуацій у періоди турбулентності. Найвищим ступінь нелінійності в даному випадку представляють кризи 1992, 2008-2009, 2015-2016 та 2020-2021 років, що підтверджується й попередніми індикаторами.</p>
</section>
<section id="динаміка-tauq-з-ходом-часу-в-дво--та-тривимірному-просторах" class="level4" data-number="7.2.14.2">
<h4 data-number="7.2.14.2" class="anchored" data-anchor-id="динаміка-tauq-з-ходом-часу-в-дво--та-тривимірному-просторах"><span class="header-section-number">7.2.14.2</span> Динаміка <span class="math inline">\(\tau(q)\)</span> з ходом часу в дво- та тривимірному просторах</h4>
<div class="cell" data-execution_count="131">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(time_ser.index[window:length:tstep], nq)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> np.array(tau_q).T</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>plot_2d(X, Y, Z, </span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>        subtitle_jpg<span class="op">=</span><span class="st">'contour_tau(q)'</span>, </span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>        subtitle_fig<span class="op">=</span><span class="vs">fr"Теплова діаграма $\tau(q)$"</span>, </span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>        ylabel<span class="op">=</span><span class="vs">r"$q$"</span>, </span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>        barlabel<span class="op">=</span><span class="vs">r"$\tau(q)$"</span>,</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>        cmap<span class="op">=</span><span class="st">'viridis'</span>,</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>        lims<span class="op">=</span>nq)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-tauq-2d" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="lab_7_files/figure-html/fig-tauq-2d-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.40: Двовимірна контурна діаграма динаміки показника <span class="math inline">\(\tau(q)\)</span>, що змінюється з плином часу</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-execution_count="121">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(np.arange(window, length, tstep), nq)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> np.array(tau_q).T</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>plot_3d(X, Y, Z, </span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>        subtitle_jpg<span class="op">=</span><span class="st">'3d_tau(q)'</span>, </span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>        ylabel<span class="op">=</span><span class="vs">r"$q$"</span>, </span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>        zlabel<span class="op">=</span><span class="vs">r"$\tau(q)$"</span>,</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>        cmap<span class="op">=</span><span class="st">'viridis'</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-tauq-3d" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="lab_7_files/figure-html/fig-tauq-3d-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.41: Тривимірна діаграма динаміки показника <span class="math inline">\(\tau(q)\)</span>, що змінюється з плином часу</figcaption>
</figure>
</div>
</div>
</div>
<p>Як видно з представлений рисунків (<a href="#fig-tauq-2d">Рис.&nbsp;<span>7.40</span></a> та <a href="#fig-tauq-3d">Рис.&nbsp;<span>7.41</span></a>), <span class="math inline">\(\tau(q)\)</span> стає більш нелінійним для всіх значень <span class="math inline">\(q\)</span>. На кінцях хвостів цього індикатора можна помітити значні впадини, що можуть слугувати індикаторами крахових подій, але в порівнянні з тим же показником Херста даний індикатор є менш виразним.</p>
</section>
<section id="динаміка-dq-з-ходом-часу-в-дво--та-тривимірному-просторах" class="level4" data-number="7.2.14.3">
<h4 data-number="7.2.14.3" class="anchored" data-anchor-id="динаміка-dq-з-ходом-часу-в-дво--та-тривимірному-просторах"><span class="header-section-number">7.2.14.3</span> Динаміка <span class="math inline">\(D(q)\)</span> з ходом часу в дво- та тривимірному просторах</h4>
<div class="cell" data-execution_count="132">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(time_ser.index[window:length:tstep], nq)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> np.array(D_q).T</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>plot_2d(X, Y, Z, </span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>        subtitle_jpg<span class="op">=</span><span class="st">'contour_D(q)'</span>, </span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>        subtitle_fig<span class="op">=</span><span class="vs">fr"Теплова діаграма $D(q)$"</span>, </span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>        ylabel<span class="op">=</span><span class="vs">r"$q$"</span>, </span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>        barlabel<span class="op">=</span><span class="vs">r"$D(q)$"</span>,</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>        cmap<span class="op">=</span><span class="st">'magma'</span>,</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>        lims<span class="op">=</span>nq)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-dq-2d" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="lab_7_files/figure-html/fig-dq-2d-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.42: Двовимірна контурна діаграма динаміки узагальненої фрактальної розмірності <span class="math inline">\(D(q)\)</span>, що змінюється з плином часу</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-execution_count="123">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(np.arange(window, length, tstep), nq)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> np.array(D_q).T</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>plot_3d(X, Y, Z, </span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>        subtitle_jpg<span class="op">=</span><span class="st">'3d_D(q)'</span>, </span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>        ylabel<span class="op">=</span><span class="vs">r"$q$"</span>, </span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>        zlabel<span class="op">=</span><span class="vs">r"$D(q)$"</span>,</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>        cmap<span class="op">=</span><span class="st">'magma'</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-dq-3d" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="lab_7_files/figure-html/fig-dq-3d-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.43: Тривимірна діаграма динаміки узагальненої фрактальної розмірності <span class="math inline">\(D(q)\)</span>, що змінюється з плином часу</figcaption>
</figure>
</div>
</div>
</div>
<p>Дво- та тривимірні представлення узагальненої фрактальної розмірності показують, що <span class="math inline">\(D(q)\)</span> зростає під час кризових подій. Узагальнена фрактальна розмірність також представляє найбільш індикативну динаміку для негативних значень <span class="math inline">\(q\)</span>, хоча для позитивних <span class="math inline">\(q\)</span> також спостерігаються незначні коливання.</p>
</section>
<section id="динаміка-cq-в-дво--та-тривимірному-просторах" class="level4" data-number="7.2.14.4">
<h4 data-number="7.2.14.4" class="anchored" data-anchor-id="динаміка-cq-в-дво--та-тривимірному-просторах"><span class="header-section-number">7.2.14.4</span> Динаміка <span class="math inline">\(C(q)\)</span> в дво- та тривимірному просторах</h4>
<div class="cell" data-execution_count="133">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(time_ser.index[window:length:tstep], nq)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> np.array(C_q).T</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>plot_2d(X, Y, Z, </span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>        subtitle_jpg<span class="op">=</span><span class="st">'contour_C(q)'</span>, </span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>        subtitle_fig<span class="op">=</span><span class="vs">fr"Теплова діаграма $C(q)$"</span>, </span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>        ylabel<span class="op">=</span><span class="vs">r"$q$"</span>, </span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>        barlabel<span class="op">=</span><span class="vs">r"$C(q)$"</span>,</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>        cmap<span class="op">=</span><span class="st">'hot'</span>,</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>        lims<span class="op">=</span>nq)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-heat-2d" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="lab_7_files/figure-html/fig-heat-2d-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.44: Двовимірна контурна діаграма динаміки мультифрактальної теплоємності <span class="math inline">\(C(q)\)</span>, що змінюється з плином часу</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-execution_count="125">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(np.arange(window, length, tstep), nq)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> np.array(C_q).T</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>plot_3d(X, Y, Z, </span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>        subtitle_jpg<span class="op">=</span><span class="st">'3d_C(q)'</span>, </span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>        ylabel<span class="op">=</span><span class="vs">r"$q$"</span>, </span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>        zlabel<span class="op">=</span><span class="vs">r"$C(q)$"</span>,</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>        cmap<span class="op">=</span><span class="st">'hot'</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-heat-3d" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="lab_7_files/figure-html/fig-heat-3d-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.45: Тривимірна контурна діаграма динаміки мультифрактальної теплоємності <span class="math inline">\(C(q)\)</span>, що змінюється з плином часу</figcaption>
</figure>
</div>
</div>
</div>
<p>На даних рисунках (<a href="#fig-heat-2d">Рис.&nbsp;<span>7.44</span></a> та <a href="#fig-heat-3d">Рис.&nbsp;<span>7.45</span></a>) під час кризових подій спостерігаються стрибки мультифрактальної теплоємності, що вказує аналогії фізичних фазових переходів та кризових подій. Можна бачити, що при різних ринкових режимах <span class="math inline">\(C(q)\)</span> може бути симетричною, демонструючи рівномірний вплив на динаміку ринку як висококонцентрованих елементів, так і низькоконцентрованих. Також <span class="math inline">\(C(q)\)</span> може зміщуватись як у ліву сторону, так і вправу, що говорить про мінливість ринку та впливовість різних початкових умов на його структуризацію.</p>
</section>
<section id="динаміка-falpha-з-ходом-часу-в-дво--та-тривимірному-просторах" class="level4" data-number="7.2.14.5">
<h4 data-number="7.2.14.5" class="anchored" data-anchor-id="динаміка-falpha-з-ходом-часу-в-дво--та-тривимірному-просторах"><span class="header-section-number">7.2.14.5</span> Динаміка <span class="math inline">\(f(\alpha)\)</span> з ходом часу в дво- та тривимірному просторах</h4>
<div class="cell" data-execution_count="134">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> time_ser.index[window:length:tstep].values</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.expand_dims(X, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.repeat(a<span class="op">=</span>X, repeats<span class="op">=</span>nq.shape[<span class="dv">0</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> np.array(alpha)</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> np.array(mfSpect)</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>plot_2d(X, Y, Z, </span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>        subtitle_jpg<span class="op">=</span><span class="st">'contour_f(alpha)'</span>, </span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>        subtitle_fig<span class="op">=</span><span class="vs">fr"Теплова діаграма $f(\alpha)$"</span>, </span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>        ylabel<span class="op">=</span><span class="vs">r"$\alpha$"</span>, </span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>        barlabel<span class="op">=</span><span class="vs">r"$f(\alpha)$"</span>,</span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>        cmap<span class="op">=</span><span class="st">'hsv'</span>,</span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>        lims<span class="op">=</span>alpha)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-falpha-2d" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="lab_7_files/figure-html/fig-falpha-2d-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.46: Двовимірна контурна діаграма динаміки мультифрактального спектра <span class="math inline">\(f(\alpha)\)</span>, що змінюється з плином часу</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-execution_count="127">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.arange(window, length, tstep)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.expand_dims(X, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.repeat(a<span class="op">=</span>X, repeats<span class="op">=</span>nq.shape[<span class="dv">0</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> np.array(alpha)</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> np.array(mfSpect)</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>plot_3d(X, Y, Z, </span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>        subtitle_jpg<span class="op">=</span><span class="st">'3d_f(alpha)'</span>, </span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>        ylabel<span class="op">=</span><span class="vs">r"$\alpha$"</span>, </span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>        zlabel<span class="op">=</span><span class="vs">r"$f(\alpha)$"</span>,</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>        cmap<span class="op">=</span><span class="st">'hsv'</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-falpha-3d" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="lab_7_files/figure-html/fig-falpha-3d-output-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Рис.&nbsp;7.47: Тривимірна діаграма динаміки мультифрактального спектра <span class="math inline">\(f(\alpha)\)</span>, що змінюється з плином часу</figcaption>
</figure>
</div>
</div>
</div>
<p>Як видно з останніх рисунків (<a href="#fig-falpha-2d">Рис.&nbsp;<span>7.46</span></a> та <a href="#fig-falpha-3d">Рис.&nbsp;<span>7.47</span></a>), ширина спектра мультифрактальності змінюється у формі з плином часу, і стає ширшою під час кризових подій, що підтверджувалось таким індикатором як, наприклад, <span class="math inline">\(\Delta\alpha\)</span>. Видно, що у передкризові періоди зростає лівостороння асиметрія, що характеризує флуктуації значної амплітуди коливань. Самі кризи представляють зміщення <span class="math inline">\(f(\alpha)\)</span> у праву сторону, що вказує на домінацію флуктуацій з малою амплітудою. У будь-якому разі, зростання ширини спектра є індикатором зростання ступеня самоорганізованості елементів, що залучені до досліджуваної системи. Тобто, як <span class="math inline">\(f(\alpha)\)</span>, так і попередні індикатори можна рекомендувати в якості індикаторів або індикаторів-передвісників кризових подій.</p>
</section>
</section>
</section>
<section id="завдання-для-виконання" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="завдання-для-виконання"><span class="header-section-number">7.3</span> Завдання для виконання</h2>
<ol type="1">
<li>Вибрати із запропонованої бази даних варіант завдання</li>
<li>Провести повний аналіз ряду за допомогою методу MF-DFA</li>
<li>Дати інтерпретацію отриманим результатам</li>
</ol>
</section>
<section id="контрольні-запитання" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="контрольні-запитання"><span class="header-section-number">7.4</span> Контрольні запитання</h2>
<ol type="1">
<li>В чому переваги мультифрактальних характеристик у порівнянні з монофрактальними?</li>
<li>На що вказує мультифрактальність часового ряду?</li>
<li>Яким чином поводять себе різні характеристики, якщо ряд містить кризу?</li>
</ol>


<div id="refs" class="references csl-bib-body" role="list" style="display: none">
<div id="ref-PhysRevA.33.1141" class="csl-entry" role="listitem">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline">T. C. Halsey, M. H. Jensen, L. P. Kadanoff, I. Procaccia, and B. I. Shraiman, <em><a href="https://doi.org/10.1103/PhysRevA.33.1141">Fractal Measures and Their Singularities: The Characterization of Strange Sets</a></em>, Phys. Rev. A <strong>33</strong>, 1141 (1986).</div>
</div>
<div id="ref-frisch1985turbulence" class="csl-entry" role="listitem">
<div class="csl-left-margin">[2] </div><div class="csl-right-inline">U. Frisch and G. Parisi, <em>Turbulence and Predictability of Geophysical Flows and Climate Dynamics</em>, in <em>Proceedings of the International School of Physics“enrico Fermi," Course LXXXVIII, Varenna, 1983</em> (North-Holland, New York, 1985).</div>
</div>
<div id="ref-GRASSBERGER1983227" class="csl-entry" role="listitem">
<div class="csl-left-margin">[3] </div><div class="csl-right-inline">P. Grassberger, <em><a href="https://doi.org/10.1016/0375-9601(83)90753-3">Generalized Dimensions of Strange Attractors</a></em>, Physics Letters A <strong>97</strong>, 227 (1983).</div>
</div>
<div id="ref-HALSEY1987501" class="csl-entry" role="listitem">
<div class="csl-left-margin">[4] </div><div class="csl-right-inline">T. C. Halsey, M. H. Jensen, L. P. Kadanoff, I. Procaccia, and B. I. Shraiman, <em><a href="https://doi.org/10.1016/0920-5632(87)90036-3">Fractal Measures and Their Singularities: The Characterization of Strange Sets</a></em>, Nuclear Physics B - Proceedings Supplements <strong>2</strong>, 501 (1987).</div>
</div>
<div id="ref-KANTELHARDT2001441" class="csl-entry" role="listitem">
<div class="csl-left-margin">[5] </div><div class="csl-right-inline">J. W. Kantelhardt, E. Koscielny-Bunde, H. H. A. Rego, S. Havlin, and A. Bunde, <em><a href="https://doi.org/10.1016/S0378-4371(01)00144-3">Detecting Long-Range Correlations with Detrended Fluctuation Analysis</a></em>, Physica A: Statistical Mechanics and Its Applications <strong>295</strong>, 441 (2001).</div>
</div>
<div id="ref-Kantelhardt2011" class="csl-entry" role="listitem">
<div class="csl-left-margin">[6] </div><div class="csl-right-inline">J. W. Kantelhardt, <em><a href="https://doi.org/10.1007/978-1-4614-1806-1_30">Fractal and Multifractal Time Series</a></em>, in <em>Mathematics of Complexity and&nbsp;Dynamical Systems</em>, edited by R. A. Meyers (Springer New York, New York, NY, 2011), pp. 463–487.</div>
</div>
<div id="ref-KANTELHARDT200287" class="csl-entry" role="listitem">
<div class="csl-left-margin">[7] </div><div class="csl-right-inline">J. W. Kantelhardt, S. A. Zschiegner, E. Koscielny-Bunde, S. Havlin, A. Bunde, and H. E. Stanley, <em><a href="https://doi.org/10.1016/S0378-4371(02)01383-3">Multifractal Detrended Fluctuation Analysis of Nonstationary Time Series</a></em>, Physica A: Statistical Mechanics and Its Applications <strong>316</strong>, 87 (2002).</div>
</div>
<div id="ref-Dutta_2010" class="csl-entry" role="listitem">
<div class="csl-left-margin">[8] </div><div class="csl-right-inline">S. Dutta, <em><a href="https://doi.org/10.1088/1742-5468/2010/12/P12021">Multifractal Properties of ECG Patterns of Patients Suffering from Congestive Heart Failure</a></em>, Journal of Statistical Mechanics: Theory and Experiment <strong>2010</strong>, P12021 (2010).</div>
</div>
<div id="ref-MAIORINO2015302" class="csl-entry" role="listitem">
<div class="csl-left-margin">[9] </div><div class="csl-right-inline">E. Maiorino, L. Livi, A. Giuliani, A. Sadeghian, and A. Rizzi, <em><a href="https://doi.org/10.1016/j.physa.2015.02.026">Multifractal Characterization of Protein Contact Networks</a></em>, Physica A: Statistical Mechanics and Its Applications <strong>428</strong>, 302 (2015).</div>
</div>
<div id="ref-FIGUEIREDO20102090" class="csl-entry" role="listitem">
<div class="csl-left-margin">[10] </div><div class="csl-right-inline">P. H. Figueirêdo, E. Nogueira, M. A. Moret, and S. Coutinho, <em><a href="https://doi.org/10.1016/j.physa.2009.11.045">Multifractal Analysis of Polyalanines Time Series</a></em>, Physica A: Statistical Mechanics and Its Applications <strong>389</strong>, 2090 (2010).</div>
</div>
<div id="ref-Jafari_2012" class="csl-entry" role="listitem">
<div class="csl-left-margin">[11] </div><div class="csl-right-inline">G. R. Jafari, P. Pedram, and L. Hedayatifar, <em><a href="https://doi.org/10.1088/1742-5468/2012/03/E03001">Erratum: Long-Range Correlation and Multifractality in Bach’s Inventions Pitches</a></em>, Journal of Statistical Mechanics: Theory and Experiment <strong>2012</strong>, E03001 (2012).</div>
</div>
<div id="ref-Jiang_2019" class="csl-entry" role="listitem">
<div class="csl-left-margin">[12] </div><div class="csl-right-inline">Z.-Q. Jiang, W.-J. Xie, W.-X. Zhou, and D. Sornette, <em><a href="https://doi.org/10.1088/1361-6633/ab42fb">Multifractal Analysis of Financial Markets: A Review</a></em>, Reports on Progress in Physics <strong>82</strong>, 125901 (2019).</div>
</div>
<div id="ref-Telesca_2005" class="csl-entry" role="listitem">
<div class="csl-left-margin">[13] </div><div class="csl-right-inline">L. Telesca, V. Lapenna, and M. Macchiato, <em><a href="https://doi.org/10.1088/1367-2630/7/1/214">Multifractal Fluctuations in Earthquake-Related Geoelectrical Signals</a></em>, New Journal of Physics <strong>7</strong>, 214 (2005).</div>
</div>
<div id="ref-doi:10.1080/00045608.2011.592733" class="csl-entry" role="listitem">
<div class="csl-left-margin">[14] </div><div class="csl-right-inline">E. G. Yee Leung and Z. Yu, <em><a href="https://doi.org/10.1080/00045608.2011.592733">Temporal Scaling Behavior of Avian Influenza a (H5N1): The Multifractal Detrended Fluctuation Analysis</a></em>, Annals of the Association of American Geographers <strong>101</strong>, 1221 (2011).</div>
</div>
<div id="ref-Liao_2011" class="csl-entry" role="listitem">
<div class="csl-left-margin">[15] </div><div class="csl-right-inline">F. Liao and Y.-K. Jan, <em><a href="https://doi.org/10.1682/jrrd.2010.08.0145">Using Multifractal Detrended Fluctuation Analysis to Assess Sacral Skin Blood Flow Oscillations in People with Spinal Cord Injury</a></em>, The Journal of Rehabilitation Research and Development <strong>48</strong>, 787 (2011).</div>
</div>
<div id="ref-TELESCA2005629" class="csl-entry" role="listitem">
<div class="csl-left-margin">[16] </div><div class="csl-right-inline">L. Telesca, V. Lapenna, and M. Macchiato, <em><a href="https://doi.org/10.1016/j.physa.2005.02.053">Multifractal Fluctuations in Seismic Interspike Series</a></em>, Physica A: Statistical Mechanics and Its Applications <strong>354</strong>, 629 (2005).</div>
</div>
<div id="ref-PhysRevE.84.021103" class="csl-entry" role="listitem">
<div class="csl-left-margin">[17] </div><div class="csl-right-inline">M. S. Movahed, F. Ghasemi, S. Rahvar, and M. R. R. Tabar, <em><a href="https://doi.org/10.1103/PhysRevE.84.021103">Long-Range Correlation in Cosmic Microwave Background Radiation</a></em>, Phys. Rev. E <strong>84</strong>, 021103 (2011).</div>
</div>
<div id="ref-MALI201525" class="csl-entry" role="listitem">
<div class="csl-left-margin">[18] </div><div class="csl-right-inline">P. Mali, S. Sarkar, S. Ghosh, A. Mukhopadhyay, and G. Singh, <em><a href="https://doi.org/10.1016/j.physa.2014.12.037">Multifractal Detrended Fluctuation Analysis of Particle Density Fluctuations in High-Energy Nuclear Collisions</a></em>, Physica A: Statistical Mechanics and Its Applications <strong>424</strong>, 25 (2015).</div>
</div>
<div id="ref-Pedron_2010" class="csl-entry" role="listitem">
<div class="csl-left-margin">[19] </div><div class="csl-right-inline">I. T. Pedron, <em><a href="https://doi.org/10.1088/1742-6596/246/1/012034">Correlation and Multifractality in Climatological Time Series</a></em>, Journal of Physics: Conference Series <strong>246</strong>, 012034 (2010).</div>
</div>
<div id="ref-Rak_2015" class="csl-entry" role="listitem">
<div class="csl-left-margin">[20] </div><div class="csl-right-inline">R. Rak, S. Drożdż, J. Kwapień, and P. Oświȩcimka, <em><a href="https://doi.org/10.1209/0295-5075/112/48001">Detrended Cross-Correlations Between Returns, Volatility, Trading Activity, and Volume Traded for the Stock Market Companies</a></em>, Europhysics Letters <strong>112</strong>, 48001 (2015).</div>
</div>
<div id="ref-WATOREK20211" class="csl-entry" role="listitem">
<div class="csl-left-margin">[21] </div><div class="csl-right-inline">M. Wątorek, S. Drożdż, J. Kwapień, L. Minati, P. Oświęcimka, and M. Stanuszek, <em><a href="https://doi.org/10.1016/j.physrep.2020.10.005">Multiscale Characteristics of the Emerging Global Cryptocurrency Market</a></em>, Physics Reports <strong>901</strong>, 1 (2021).</div>
</div>
<div id="ref-Peng_1995" class="csl-entry" role="listitem">
<div class="csl-left-margin">[22] </div><div class="csl-right-inline">C.-K. Peng, S. Havlin, H. E. Stanley, and A. L. Goldberger, <em><a href="https://doi.org/10.1063/1.166141">Quantification of Scaling Exponents and Crossover Phenomena in Nonstationary Heartbeat Time Series</a></em>, Chaos: An Interdisciplinary Journal of Nonlinear Science <strong>5</strong>, 82 (1995).</div>
</div>
<div id="ref-EnriqueCanessa_2000" class="csl-entry" role="listitem">
<div class="csl-left-margin">[23] </div><div class="csl-right-inline">E. Canessa, <em><a href="https://doi.org/10.1088/0305-4470/33/19/302">Multifractality in Time Series</a></em>, Journal of Physics A: Mathematical and General <strong>33</strong>, 3637 (2000).</div>
</div>
<div id="ref-RePEc:spr:eurphb:v:76:y:2010:i:4:p:513-527" class="csl-entry" role="listitem">
<div class="csl-left-margin">[24] </div><div class="csl-right-inline">A. Kasprzak, R. Kutner, J. Perelló, and J. Masoliver, <em><a href="https://EconPapers.repec.org/RePEc:spr:eurphb:v:76:y:2010:i:4:p:513-527">Higher-Order Phase Transitions on Financial Markets</a></em>, The European Physical Journal B: Condensed Matter and Complex Systems <strong>76</strong>, 513 (2010).</div>
</div>
<div id="ref-DAI2014332" class="csl-entry" role="listitem">
<div class="csl-left-margin">[25] </div><div class="csl-right-inline">M. Dai, C. Zhang, and D. Zhang, <em><a href="https://doi.org/10.1016/j.physa.2014.04.005">Multifractal and Singularity Analysis of Highway Volume Data</a></em>, Physica A: Statistical Mechanics and Its Applications <strong>407</strong>, 332 (2014).</div>
</div>
<div id="ref-DAI2016722" class="csl-entry" role="listitem">
<div class="csl-left-margin">[26] </div><div class="csl-right-inline">M. Dai, J. Hou, and D. Ye, <em><a href="https://doi.org/10.1016/j.physa.2015.10.073">Multifractal Detrended Fluctuation Analysis Based on Fractal Fitting: The Long-Range Correlation Detection Method for Highway Volume Data</a></em>, Physica A: Statistical Mechanics and Its Applications <strong>444</strong>, 722 (2016).</div>
</div>
<div id="ref-SUN2001553" class="csl-entry" role="listitem">
<div class="csl-left-margin">[27] </div><div class="csl-right-inline">X. Sun, H. Chen, Z. Wu, and Y. Yuan, <em><a href="https://doi.org/10.1016/S0378-4371(00)00606-3">Multifractal Analysis of Hang Seng Index in Hong Kong Stock Market</a></em>, Physica A: Statistical Mechanics and Its Applications <strong>291</strong>, 553 (2001).</div>
</div>
<div id="ref-10.3389/fphys.2012.00141" class="csl-entry" role="listitem">
<div class="csl-left-margin">[28] </div><div class="csl-right-inline">E. A. Ihlen, <em><a href="https://doi.org/10.3389/fphys.2012.00141">Introduction to Multifractal Detrended Fluctuation Analysis in Matlab</a></em>, Frontiers in Physiology <strong>3</strong>, (2012).</div>
</div>
<div id="ref-OSWIECIMKA2018231" class="csl-entry" role="listitem">
<div class="csl-left-margin">[29] </div><div class="csl-right-inline">P. Oświȩcimka, L. Livi, and S. Drożdż, <em><a href="https://doi.org/10.1016/j.cnsns.2017.09.022">Right-Side-Stretched Multifractal Spectra Indicate Small-Worldness in Networks</a></em>, Communications in Nonlinear Science and Numerical Simulation <strong>57</strong>, 231 (2018).</div>
</div>
<div id="ref-PhysRevE.91.030902" class="csl-entry" role="listitem">
<div class="csl-left-margin">[30] </div><div class="csl-right-inline">S. Drożdż and P. Oświȩcimka, <em><a href="https://doi.org/10.1103/PhysRevE.91.030902">Detecting and Interpreting Distortions in Hierarchical Organization of Complex Time Series</a></em>, Phys. Rev. E <strong>91</strong>, 030902 (2015).</div>
</div>
<div id="ref-Dro_d__2018" class="csl-entry" role="listitem">
<div class="csl-left-margin">[31] </div><div class="csl-right-inline">S. Drożdż, R. Kowalski, P. Oświȩcimka, R. Rak, and R. Gȩbarowski, <em><a href="https://doi.org/10.1155/2018/7015721">Dynamical Variety of Shapes in Financial Multifractality</a></em>, Complexity <strong>2018</strong>, 1 (2018).</div>
</div>
<div id="ref-Orozco_Duque_2015" class="csl-entry" role="listitem">
<div class="csl-left-margin">[32] </div><div class="csl-right-inline">A. Orozco-Duque, D. Novak, V. Kremen, and J. Bustamante, <em><a href="https://doi.org/10.1088/0967-3334/36/11/2269">Multifractal Analysis for Grading Complex Fractionated Electrograms in Atrial Fibrillation</a></em>, Physiological Measurement <strong>36</strong>, 2269 (2015).</div>
</div>
<div id="ref-doi:10.1098/rsta.2020.0254" class="csl-entry" role="listitem">
<div class="csl-left-margin">[33] </div><div class="csl-right-inline">A. Faini, G. Parati, and P. Castiglioni, <em><a href="https://doi.org/10.1098/rsta.2020.0254">Multiscale Assessment of the Degree of Multifractality for Physiological Time Series</a></em>, Philosophical Transactions of the Royal Society A: Mathematical, Physical and Engineering Sciences <strong>379</strong>, 20200254 (2021).</div>
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Скопійовано!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Скопійовано!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="./lab_6.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Лабораторна робота № 6</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./lab_8.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Лабораторна робота № 8</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>