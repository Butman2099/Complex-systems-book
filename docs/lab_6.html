<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Моделювання складних систем у Python - 6&nbsp; Лабораторна робота № 6</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./lab_7.html" rel="next">
<link href="./lab_5.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Пошук не дав результату",
    "search-matching-documents-text": "Результати пошуку",
    "search-copy-link-title": "Скопіюйте посилання для пошуку",
    "search-hide-matches-text": "Приховати додаткові результати",
    "search-more-match-text": "Додатковий результат у цьому документі",
    "search-more-matches-text": "Додаткові результати у цьому документі",
    "search-clear-button-title": "Очистити",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Скасувати",
    "search-submit-button-title": "Надіслати",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./lab_6.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Лабораторна робота № 6</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Моделювання складних систем у Python</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/Butman2099/Complex-systems-book" title="Вихідний код" class="quarto-navigation-tool px-1" aria-label="Вихідний код"><i class="bi bi-github"></i></a>
    <a href="./Моделювання-складних-систем-у-Python.docx" title="Download Docx" class="quarto-navigation-tool px-1" aria-label="Download Docx"><i class="bi bi-file-word"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Передмова</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Лабораторна робота № 1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Лабораторна робота № 2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Лабораторна робота № 3</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Лабораторна робота № 4</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Лабораторна робота № 5</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_6.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Лабораторна робота № 6</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Лабораторна робота № 7</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Лабораторна робота № 8</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Лабораторна робота № 9</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Лабораторна робота № 10</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Лабораторна робота № 11</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Лабораторна робота № 12</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Лабораторна робота № 13</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_14.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Лабораторна робота № 14</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Додатки</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Інструкція зі встановлення Anaconda Navigator</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appb.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Вступ до мови програмування Python</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Основи Jupyter Notebook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Вступ до Google Colab</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Список рекомендованої літератури</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Зміст</h2>
   
  <ul>
  <li><a href="#теоретичні-відомості" id="toc-теоретичні-відомості" class="nav-link active" data-scroll-target="#теоретичні-відомості"><span class="header-section-number">6.1</span> Теоретичні відомості</a>
  <ul class="collapse">
  <li><a href="#визначення-фрактала" id="toc-визначення-фрактала" class="nav-link" data-scroll-target="#визначення-фрактала"><span class="header-section-number">6.1.1</span> Визначення фрактала</a></li>
  <li><a href="#довжина-берегової-лінії" id="toc-довжина-берегової-лінії" class="nav-link" data-scroll-target="#довжина-берегової-лінії"><span class="header-section-number">6.1.2</span> Довжина берегової лінії</a></li>
  <li><a href="#фрактальна-розмірність-множин" id="toc-фрактальна-розмірність-множин" class="nav-link" data-scroll-target="#фрактальна-розмірність-множин"><span class="header-section-number">6.1.3</span> Фрактальна розмірність множин</a></li>
  <li><a href="#процедури-обчислення-монофрактальних-розмірностей" id="toc-процедури-обчислення-монофрактальних-розмірностей" class="nav-link" data-scroll-target="#процедури-обчислення-монофрактальних-розмірностей"><span class="header-section-number">6.1.4</span> Процедури обчислення монофрактальних розмірностей</a></li>
  </ul></li>
  <li><a href="#хід-роботи" id="toc-хід-роботи" class="nav-link" data-scroll-target="#хід-роботи"><span class="header-section-number">6.2</span> Хід роботи</a>
  <ul class="collapse">
  <li><a href="#обчислення-показника-херста-з-використанням-rs-аналізу" id="toc-обчислення-показника-херста-з-використанням-rs-аналізу" class="nav-link" data-scroll-target="#обчислення-показника-херста-з-використанням-rs-аналізу"><span class="header-section-number">6.2.1</span> Обчислення показника Херста з використанням <em>R/S</em>-аналізу</a></li>
  <li><a href="#обчислення-на-основі-dfa" id="toc-обчислення-на-основі-dfa" class="nav-link" data-scroll-target="#обчислення-на-основі-dfa"><span class="header-section-number">6.2.2</span> Обчислення на основі DFA</a></li>
  <li><a href="#обчислення-фрактальної-розмірності-хігучі" id="toc-обчислення-фрактальної-розмірності-хігучі" class="nav-link" data-scroll-target="#обчислення-фрактальної-розмірності-хігучі"><span class="header-section-number">6.2.3</span> Обчислення фрактальної розмірності Хігучі</a></li>
  <li><a href="#обчислення-фрактальної-розмірності-петросяна" id="toc-обчислення-фрактальної-розмірності-петросяна" class="nav-link" data-scroll-target="#обчислення-фрактальної-розмірності-петросяна"><span class="header-section-number">6.2.4</span> Обчислення фрактальної розмірності Петросяна</a></li>
  <li><a href="#обчислення-фрактальної-розмірності-каца" id="toc-обчислення-фрактальної-розмірності-каца" class="nav-link" data-scroll-target="#обчислення-фрактальної-розмірності-каца"><span class="header-section-number">6.2.5</span> Обчислення фрактальної розмірності Каца</a></li>
  <li><a href="#обчислення-фрактальної-розмірності-шевчика" id="toc-обчислення-фрактальної-розмірності-шевчика" class="nav-link" data-scroll-target="#обчислення-фрактальної-розмірності-шевчика"><span class="header-section-number">6.2.6</span> Обчислення фрактальної розмірності Шевчика</a></li>
  <li><a href="#обчислення-фрактальної-розмірності-через-нормалізовану-щільність-довжини" id="toc-обчислення-фрактальної-розмірності-через-нормалізовану-щільність-довжини" class="nav-link" data-scroll-target="#обчислення-фрактальної-розмірності-через-нормалізовану-щільність-довжини"><span class="header-section-number">6.2.7</span> Обчислення фрактальної розмірності через нормалізовану щільність довжини</a></li>
  <li><a href="#обчислення-фрактальної-розмірності-через-нахил-спектральної-щільності-потужності" id="toc-обчислення-фрактальної-розмірності-через-нахил-спектральної-щільності-потужності" class="nav-link" data-scroll-target="#обчислення-фрактальної-розмірності-через-нахил-спектральної-щільності-потужності"><span class="header-section-number">6.2.8</span> Обчислення фрактальної розмірності через нахил спектральної щільності потужності</a></li>
  <li><a href="#обчислення-кореляційної-розмірності" id="toc-обчислення-кореляційної-розмірності" class="nav-link" data-scroll-target="#обчислення-кореляційної-розмірності"><span class="header-section-number">6.2.9</span> Обчислення кореляційної розмірності</a></li>
  </ul></li>
  <li><a href="#висновок" id="toc-висновок" class="nav-link" data-scroll-target="#висновок"><span class="header-section-number">6.3</span> Висновок</a></li>
  <li><a href="#завдання-для-виконання" id="toc-завдання-для-виконання" class="nav-link" data-scroll-target="#завдання-для-виконання"><span class="header-section-number">6.4</span> Завдання для виконання</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.dev/Butman2099/Complex-systems-book/blob/main/lab_6.ipynb" class="toc-action"><i class="bi bi-github"></i>Редагувати сторінку</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-monofrac-title" class="quarto-section-identifier"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Лабораторна робота № 6</span></span></h1>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<p><strong>Тема.</strong> Фрактальний аналіз складних систем</p>
<p><strong>Мета.</strong> Навчитися використовувати методи монофрактального аналізу для дослідження нелінійних характеристик складних систем</p>
<section id="теоретичні-відомості" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="теоретичні-відомості"><span class="header-section-number">6.1</span> Теоретичні відомості</h2>
<section id="визначення-фрактала" class="level3" data-number="6.1.1">
<h3 data-number="6.1.1" class="anchored" data-anchor-id="визначення-фрактала"><span class="header-section-number">6.1.1</span> Визначення фрактала</h3>
<p><strong>Фракталами</strong> (fractals) називають геометричні об’єкти: лінії, поверхні, просторові тіла, що мають сильно шорстку поверхню або форму і характеризуються властивістю <em>самоподібності</em> <span class="citation" data-cites="mandelbrot1982fractal PhysRevA.42.4528 10.1007/3-7643-7412-8_8">&nbsp;[<a href="references.html#ref-mandelbrot1982fractal" role="doc-biblioref">1</a>–<a href="references.html#ref-10.1007/3-7643-7412-8_8" role="doc-biblioref">3</a>]</span>. Слово фрактал походить від латинського слова <em>fractus</em> і перекладається як дробовий, ламаний. Самоподібність як основна характеристика фрактала означає, що він більш-менш однорідно змінюється в широкому діапазоні масштабів. Так, при збільшенні маленькі фрагменти фрактала стають дуже схожими на великі. В ідеальному випадку така самопподібність призводить до того, що фрактальний об’єкт виявляється інваріантним щодо розтягувань, тобто йому, як кажуть, притаманна дилатаційна симетрія. Вона передбачає незмінність основних геометричних особливостей фрактала при зміні масштабу.</p>
<p>Очевидно, що фрактальні об’єкти реального світу не є нескінченно самоподібними й існує мінімальний масштаб <span class="math inline">\(l_{min}\)</span>, такий, що на масштабі <span class="math inline">\(l \approx l_{min}\)</span> властивість самоподібності зникає. Окрім цього, на достатньо великих масштабах довжин <span class="math inline">\(l &gt; l_{max}\)</span>, де <span class="math inline">\(l_{max}\)</span> — характерний геометричний розмір об’єктів, ця властивість самоподібності також порушується. Тому властивості природніх фракталів розглядаються лише на масштабах <span class="math inline">\(l\)</span>, що задовільняють відношення <span class="math inline">\(l_{min} \ll l \ll l_{max}\)</span>. Такі обмеження природні, оскільки, коли ми приводимо в якості прикладу фракталу — ламану, негладку траєкторію броунівської частинки, то ми розуміємо, що цей образ представляє очевидну ідеалізацію. Справа в тому, що на малих масштабах приховується граничність маси і розмірів броунівської частинки, а також скінченність часу зіткнення. При врахуванні цих обставин траєкторія броунівської частинки починає представляти гладку криву.</p>
<p>Варто зазначити, що властивість точної самоподібності характерна лише для <strong>регулярних фракталів</strong>. Якщо замість детермінованого способу побудови включити в алгоритм їхнього створення деякий елемент випадковості (як це буває, наприклад, у багатьох процесах диференційованого зростання кластерів, електричному пробої тощо), то виникають так звані <strong>випадкові фрактали</strong>. Основна їхня відмінність від регулярних полягає в тому, що властивості самоподібності є справедливими тільки після відповідного усереднення за всіма статистично незалежними реалізаціями об’єкта. При цьому збільшена частина фрактала не точно ідентична вихідному фрагменту, проте їхні статистичні характеристики збігаються.</p>
</section>
<section id="довжина-берегової-лінії" class="level3" data-number="6.1.2">
<h3 data-number="6.1.2" class="anchored" data-anchor-id="довжина-берегової-лінії"><span class="header-section-number">6.1.2</span> Довжина берегової лінії</h3>
<p>Першочергово поняття фрактала у фізиці виникло у зв’язку із завданням про визначення довжини берегової лінії. Під час її вимірювання за наявною картою місцевості з’ясувалася цікава деталь — чим більш великомасштабна карта береться, тим довшою виявляється ця берегова лінія <span class="citation" data-cites="steinhaus1954length vulpiani2014lewis 0c446163-c0a0-36ed-a942-0e71e56cd938 science.156.3775.636">&nbsp;[<a href="references.html#ref-steinhaus1954length" role="doc-biblioref">4</a>–<a href="references.html#ref-science.156.3775.636" role="doc-biblioref">7</a>]</span>. Нехай, наприклад, відстань по прямій між розсташованими на береговій лінії точками А та В дорівнює R (див. <a href="#fig-costline" class="quarto-xref">Рис.&nbsp;<span>6.1</span></a>).</p>
<div id="fig-costline" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-costline-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Images\lab_6\costline.jpg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-costline-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Рис.&nbsp;6.1: Визначення довжини берегової лінії між точками А та В <span class="citation" data-cites="Bozhokin">&nbsp;[<a href="references.html#ref-Bozhokin" role="doc-biblioref">8</a>]</span>
</figcaption>
</figure>
</div>
<p>Тоді, щоб виміряти довжину берегової лінії між цима точками, ми розташуємо по берегу жорстко пов’язані один з одним вузол так, що відстань між сусідніми вузлами дорівнювала б, наприклад, <span class="math inline">\(l=10\)</span> км. Довжину берегової лінії в кілометрах між точками А і В ми приймемо тоді рівною числу вузлів мінус 1, помноженому на 10. Наступне вимірювання цієї довжини ми зробимо так само, але відстань між сусідніми вузлами зробимо вже рівною <span class="math inline">\(l=1\)</span> км.</p>
<p>Виявляється, що результат цих вимірювань буде різним. При зменшенні масштабу <span class="math inline">\(l\)</span> ми отримуватимемо все більші й більші значення довжини. На відміну від гладкої кривої, лінія морського узбережжя виявляється найчастіше настільки порізаною (аж до найменших масштабів), що зі зменшенням довжини ланки <span class="math inline">\(l\)</span> величина <span class="math inline">\(L\)</span> — довжина берегової лінії — не прагне до кінцевого межі, а збільшується за степеневим законом</p>
<p><span id="eq-6-1"><span class="math display">\[
L \approx l\left( R \big/ l \right)^{D},
\tag{6.1}\]</span></span></p>
<p>а <span class="math inline">\(D &gt; 1\)</span> — деякий степеневий показник, котрий іменується <strong>фрактальною розмірністю</strong> (fractal dimension) берегової лінії <span class="citation" data-cites="science.156.3775.636">&nbsp;[<a href="references.html#ref-science.156.3775.636" role="doc-biblioref">7</a>]</span>. Чим більше значення <span class="math inline">\(D\)</span>, тим більш ломаною або деталізованою представляється ця берегова лінія. Походження залежності (<a href="#eq-6-1" class="quarto-xref"><span>6.1</span></a>) має бути інтуїтивно зрозумілим: чим менший масштаб ми використовуємо, тим меньші деталі узбережжя будуть враховані і тим менший вклад вони внесуть у вимірювану довжину. Навпаки, збільшуючи масштаб, ми “розгортаємо” узбережжя, зменшуючи довжину <span class="math inline">\(L\)</span>.</p>
<p>Таким чином, ми бачимо, що для визначення довжини берегової лінії <span class="math inline">\(L\)</span> за допомогою жорсткого масштабу <span class="math inline">\(l\)</span>, необхідно зробити <span class="math inline">\(N=L/l\)</span> кроків, причому величина <span class="math inline">\(L\)</span> змінюється з <span class="math inline">\(l\)</span> так, що <span class="math inline">\(N\)</span> залежить від <span class="math inline">\(l\)</span> за законом <span class="math inline">\(N \approx (R/l)^{D}\)</span>. У результаті зі зменшенням масштабу довжина берегової лінії необмежено зростає. Ця обставина різко відрізняє фрактальну криву від звичайної гладкої кривої (типу кола, еліпса), для якої межа довжини апроксимованої ламаної <span class="math inline">\(L\)</span>, яка апроксимує, за наближення до нуля довжини її ланки <span class="math inline">\(l\)</span> є скінченною. У результаті для гладкої кривої її фрактальна розмірність <span class="math inline">\(D = 1\)</span>, тобто збігається з топологічною.</p>
</section>
<section id="фрактальна-розмірність-множин" class="level3" data-number="6.1.3">
<h3 data-number="6.1.3" class="anchored" data-anchor-id="фрактальна-розмірність-множин"><span class="header-section-number">6.1.3</span> Фрактальна розмірність множин</h3>
<p>Вище було введено поняття про фрактальну розмірність берегової лінії. Дамо тепер загальне визначення цієї величини. Нехай <span class="math inline">\(d\)</span> — звичайна Евклідова розмірність простору, в якому розташований наш фрактальний об’єкт (<span class="math inline">\(d=1\)</span> — лінія, <span class="math inline">\(d=2\)</span> — площина, <span class="math inline">\(d=3\)</span> — звичайний тривимірний простір). Покриємо тепер цей об’єкт цілком <span class="math inline">\(d\)</span>-мірними “кулями” радіуса 1. Припустимо, що нам потребувалося для цього не менше, ніж <span class="math inline">\(N(l)\)</span> куль. Тоді, якщо за досить малих <span class="math inline">\(l\)</span> величина <span class="math inline">\(N(l)\)</span> змінюється з <span class="math inline">\(l\)</span> за степеневим законом</p>
<p><span id="eq-6-2"><span class="math display">\[
N(l) \sim 1 \big/ l^D ,
\tag{6.2}\]</span></span></p>
<p>тоді <span class="math inline">\(D\)</span> — називається <strong>хаусдорфовою</strong> (Hausdorff) або <strong>фрактальною розмірністю</strong> цього об’єкта <span class="citation" data-cites="10.1214/11-STS370">&nbsp;[<a href="references.html#ref-10.1214/11-STS370" role="doc-biblioref">9</a>]</span>. Очевидно, що ця формула еквівалентна відношеню <span class="math inline">\(N \approx \left( R/l \right)^{D}\)</span>, що використовувалось вище для визначення довжини берегової лінії. <a href="#eq-6-3" class="quarto-xref">Рівняння&nbsp;<span>6.3</span></a> можна переписати у вигляді</p>
<p><span id="eq-6-3"><span class="math display">\[
D = -\lim_{l \to 0} \ln{N(l)} \big/ \ln{l}.
\tag{6.3}\]</span></span></p>
<p>Це відношення й слугує загальним визначенням фрактальної розмірності <span class="math inline">\(D\)</span>. У відповідності до нього величина <span class="math inline">\(D\)</span> представляє <strong>локальну</strong> характеристику досліджуваного об’єкта.</p>
</section>
<section id="процедури-обчислення-монофрактальних-розмірностей" class="level3" data-number="6.1.4">
<h3 data-number="6.1.4" class="anchored" data-anchor-id="процедури-обчислення-монофрактальних-розмірностей"><span class="header-section-number">6.1.4</span> Процедури обчислення монофрактальних розмірностей</h3>
<p>Наразі існує багато визначень та методів вимірювання фрактальної розмірності. Найпоширенішими одновимірними фрактальними розмірностями є розмірність Хаусдорфа, розмірність Хігучі, розмірність Петросяна та Мінковського <span class="citation" data-cites="falconer2004fractal">&nbsp;[<a href="references.html#ref-falconer2004fractal" role="doc-biblioref">10</a>]</span>. Розмірність Хаусдорфа є найпростішою фрактальною розмірністю. Але її обчислювальна складність є високою, що ускладнює її практичне застосування. Розмірність Мінковського є відносно простою, і фрактальну розмірність сигналу можна отримати, регулюючи розмір довжини сторони клітини в межах якої визначається “шорсткість” поверхні сигналу. Тому вона є широко впізнаваємою та застосовуваною. Який з показників фрактальної розмірності найточніше описує складність сигналу та здатний ідентифікувати кризові явища і представляє ключовий момент цієї лабораторної роботи.</p>
<section id="rs-аналіз" class="level4" data-number="6.1.4.1">
<h4 data-number="6.1.4.1" class="anchored" data-anchor-id="rs-аналіз"><span class="header-section-number">6.1.4.1</span> <em>R/S</em>-аналіз</h4>
<p><strong>Метод <em>R/S</em>-аналізу</strong> (Rescaled range, <em>R/S</em> analysis), розроблений Мандельбротом та Уоллесом <span class="citation" data-cites="10.1119/1.13295">&nbsp;[<a href="references.html#ref-10.1119/1.13295" role="doc-biblioref">11</a>]</span>, базується на попередньо створеному методі гідрологічного аналізу Херста <span class="citation" data-cites="doi:10.1061/TACEAT.0006518 hurst1957suggested">&nbsp;[<a href="references.html#ref-doi:10.1061/TACEAT.0006518" role="doc-biblioref">12</a>,<a href="references.html#ref-hurst1957suggested" role="doc-biblioref">13</a>]</span>, і дозволяє обчислювати параметр самоподібності <span class="math inline">\(H\)</span>, який вимірює інтенсивність довготривалих залежностей у часовому ряді. Коефіцієнт <span class="math inline">\(H\)</span>, який називають коефіцієнтом Херста, містить мінімальні прогнози стосовно природи системи, що вивчається, і може класифікувати часові ряди. За допомогою цього показника розрізняють випадкові (гаусові) та невипадкові ряди; окрім того, він пов’язаний із фрактальною розмірністю, що, у свою чергу, характеризує ступінь згладженості графіка, побудованого на основі часового ряду. Методом <em>R/S</em>-аналізу можливо також виявити максимальну довжину інтервалу (цикл), на якому значення зберігають інформацію про початкові дані системи (довготривала пам’ять).</p>
<p>Аналіз починається з побудови ряду логарифмічних прибутковостей, <span class="math inline">\(G(t) \equiv \ln{x(t + \Delta t)} - \ln{x(t)}\)</span>, де <span class="math inline">\(x(t)\)</span> — значення вихідного часового ряду в момент <span class="math inline">\(t\)</span>, <span class="math inline">\(\Delta t\)</span> — часовий крок. Отримана послідовність <span class="math inline">\(G(t)\)</span> розбивається на <span class="math inline">\(d\)</span> підпослідовностей довжини <span class="math inline">\(n\)</span>.</p>
<p>Для кожної підпослідовності <span class="math inline">\(m=1,...,d\)</span>:</p>
<ol type="1">
<li>Шукається середнє значення <span class="math inline">\(\mu_m\)</span> та стандартне відхилення <span class="math inline">\(S_m\)</span>.</li>
<li>Дані нормалізуються шляхом віднімання середнього значення послідовності <span class="math inline">\(X_{i,m}=G_{i,m}-\mu_m\)</span>, <span class="math inline">\(i=1,...,n\)</span>.</li>
<li>Знаходиться кумулятивна сума послідовності <span class="math inline">\(X\)</span>ів: <span class="math inline">\(Y_{i,m}=\sum_{j=1}^{i}X_{j,m}\)</span>, <span class="math inline">\(i=1,...,n\)</span>.</li>
<li>У межах кожної підпослідовності знаходиться розмах між максимальним та мінімальним значеннями: <span class="math inline">\(R_m = \max\{Y_{1,m},...,Y_{n,m}\}-\min\{Y_{1,m},...,Y_{n,m}\}\)</span>, який стандартизується середнім квадратичним відхиленням <span class="math inline">\(R_{m}/S_{m}\)</span>.</li>
<li>Обчислюється середнє <span class="math inline">\((R/S)_n\)</span> нормованих значень розмаху для всіх підпослідовностей довжини <span class="math inline">\(n\)</span>.</li>
</ol>
<p><em>R/S</em>-статистика, обрахована таким чином, відповідає співвідношенню <span class="math inline">\((R/S)_{n} \cong cn^{H}\)</span>, де значення <span class="math inline">\(H\)</span> може бути отримане шляхом обчислення <span class="math inline">\((R/S)_n\)</span> для послідовностей інтервалів зі збільшенням часового горизонту:</p>
<p><span id="eq-6-4"><span class="math display">\[
\log{(R/S)}_{n} = \log{c} + H\log{n}.
\tag{6.4}\]</span></span></p>
<p>Знайти коефіцієнт Херста можна, побудувавши залежність <span class="math inline">\((R/S)_n\)</span> vs.&nbsp;<span class="math inline">\(n\)</span> у подвійному логарифмічному масштабі і взявши коефіцієнт нахилу прямої, яка інтерполює точки отриманого графіка. Якщо значення <span class="math inline">\(H=0.5\)</span>, говорять про послідовність, що представляє собою <strong>білий шум</strong>; <span class="math inline">\(0.5 &lt; H \leq 1\)</span> свідчить про <strong>персистентний</strong> (трендостійкий) ряд, коли існує тенденція слідування великих значень ряду за великими і навпаки; <span class="math inline">\(H&lt;0.5\)</span> вказує на <strong>антиперсистентний</strong> (mean-reversion) ряд.</p>
<p>При збільшенні часового горизонту коефіцієнт нахилу інтерполюючої прямої повинен прямувати до значення <span class="math inline">\(H=0.5\)</span>; сам процес переходу свідчить про втрату впливу початкових умов на поточні значення, і, таким чином, можна говорити про горизонт довгої пам’яті — це точка, до якої коефіцієнт нахилу інтерполюючої прямої відмінний від 0.5, а після — близько 0.5.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Примітка до <em>R/S</em>-аналізу
</div>
</div>
<div class="callout-body-container callout-body">
<p>Між фрактальною розмірністю та показником Херста також існує зв’язок</p>
<p><span class="math display">\[
D_f = 2-H.
\]</span></p>
<p>Якщо для берегової лінії ми визначали масштабування її довжини <span class="math inline">\(L\)</span> в залежності від зміни <span class="math inline">\(l\)</span>, то у випадку з <em>R/S</em>-аналізом ми визначаємо зміну нормованого розмаху значень ряду в межах масштабу <span class="math inline">\(n\)</span></p>
</div>
</div>
</section>
<section id="аналіз-детрендованих-флуктуацій" class="level4" data-number="6.1.4.2">
<h4 data-number="6.1.4.2" class="anchored" data-anchor-id="аналіз-детрендованих-флуктуацій"><span class="header-section-number">6.1.4.2</span> Аналіз детрендованих флуктуацій</h4>
<p><strong>Аналіз детрендований флуктуацій</strong> (Detrended fluctuation analysis, DFA) <span class="citation" data-cites="PhysRevE.49.1685">&nbsp;[<a href="references.html#ref-PhysRevE.49.1685" role="doc-biblioref">14</a>]</span> базується на гіпотезі про те, що корельований часовий ряд може бути відображений на самоподібний процес шляхом інтегрування. Таким чином, вимірювання властивостей самоподібності може непрямо свідчити про кореляційні властивості ряду. Переваги DFA порівняно з іншими методами (спектральний аналіз, <em>R/S</em>-аналіз) полягають в тому, що він виявляє довгочасові кореляції нестаціонарних часових рядів, а також дозволяє ігнорувати очевидні випадкові кореляції, що є наслідком нестаціонарності <span class="citation" data-cites="JIANG2014235">&nbsp;[<a href="references.html#ref-JIANG2014235" role="doc-biblioref">15</a>]</span>.</p>
<p>Існують DFA різних порядків, що відрізняються трендами, які вилучаються з даних.</p>
<p>Розглянемо DFA найнижчого порядку.</p>
<ol type="1">
<li><p>Для часового ряду довжини <span class="math inline">\(N\)</span> знаходиться кумулятивна сума, <span class="math inline">\(y(k)=\sum_{i=1}^{k}\left( x_i - \bar{x} \right)\)</span>, де <span class="math inline">\(x_i\)</span> — це <span class="math inline">\(i\)</span>-те значення часового ряду, <span class="math inline">\(\bar{x}\)</span> — його середнє значення, <span class="math inline">\(k=1,...,N\)</span>.</p></li>
<li><p>Отриманий ряд <span class="math inline">\(y(k)\)</span> розбивається на <span class="math inline">\(m\)</span> підпослідовностей (вікон) однакової ширини <span class="math inline">\(n\)</span> і для кожної підпослідовності (у кожному вікні) виконується наступне:</p>
<ul>
<li>за допомогою методу найменших квадратів знаходиться локальний лінійний тренд <span class="math inline">\(y_{t}(k)\)</span>;<br>
</li>
<li>підпослідовність детрендується шляхом віднімання значення локального тренду <span class="math inline">\(y_{t}(k)\)</span> від значень ряду <span class="math inline">\(y(k)\)</span>, що належать послідовності <span class="math inline">\(t\)</span>;</li>
<li>знаходиться середнє <span class="math inline">\(\bar{y_t}\)</span> детрендований значень.</li>
</ul></li>
</ol>
<p>Для отриманих таким чином значень на всіх підпослідовностях знаходиться:</p>
<p><span class="math display">\[
F_n = \sqrt{\bar{y_t} \cdot m^{-1}},
\]</span></p>
<p>де <span class="math inline">\(n\)</span> — кількість точок у підпослідовності (ширина вікна), <span class="math inline">\(m\)</span> — кількість підпослідовностей, <span class="math inline">\(\bar{y_t}\)</span> — середнє детрендованих значень для підпослідовності <span class="math inline">\(t\)</span>.</p>
<p>Вказана процедура повторюється для різних значень <span class="math inline">\(n\)</span>, внаслідок чого ми отримує набір залежностей <span class="math inline">\(F_n\)</span> від <span class="math inline">\(n\)</span>. Побудова залежності <span class="math inline">\(\log{F(n)}\)</span> від <span class="math inline">\(\log{n}\)</span> та інтерполяція отриманих значень лінією регресії дає змогу обчислити показник скейлінга <span class="math inline">\(\alpha\)</span>, що є коефіцієнтом кута нахилу інтерполяційної прямої і характеризує зміну кореляцій флуктуацій часового ряду <span class="math inline">\(F_n\)</span> при збільшенні часового інтервалу <span class="math inline">\(n\)</span>.</p>
<p>Порівняно із <em>R/S</em>-аналізом, DFA дає більші можливості інтерпретації скейлінгового показника <span class="math inline">\(\alpha\)</span>:</p>
<ul>
<li>для випадкового ряду (перемішаного чи “сурогатного”) <span class="math inline">\(\alpha = 0.5\)</span>;</li>
<li>при наявності лише короткочасових кореляцій <span class="math inline">\(\alpha\)</span> може відрізнятись від 0.5, проте має тенденцію прямувати до 0.5 при збільшенні розміру вікна;</li>
<li>Значення <span class="math inline">\(0.5 &lt; \alpha \leq 1.0\)</span> показує персистентні довгочасові кореляції, що відповідають степеневому закону;</li>
<li><span class="math inline">\(0 &lt; \alpha &lt; 0.5\)</span> означає антиперсистентний ряд;</li>
<li>cпеціальний випадок, коли <span class="math inline">\(\alpha = 1\)</span>, означає наявність <span class="math inline">\(1/f\)</span> шуму.</li>
<li>для випадків, коли <span class="math inline">\(\alpha \geq 1\)</span>, кореляції існують, проте перестають відображувати степеневу залежність;</li>
<li>випадок <span class="math inline">\(\alpha = 1.5\)</span> свідчить про броунівський шум, який представляє інтегрований білий шум.</li>
</ul>
<p>У випадку степеневої залежності функції автокореляцій спостерігається спад автокореляції з показником <span class="math inline">\(\gamma\)</span>:</p>
<p><span class="math display">\[
C(L) \sim L^{-\gamma}.
\]</span></p>
<p>На додачу до цього, спектральна густина також спадає за степеневим законом:</p>
<p><span id="eq-spec-dens"><span class="math display">\[
P(f) \sim f^{-\beta}.
\tag{6.5}\]</span></span></p>
<p>Відповідні показники виражаються через наступні відношення:</p>
<ul>
<li><span class="math inline">\(\gamma=2-2\alpha\)</span>;</li>
<li><span class="math inline">\(\beta=2\alpha-1\)</span>.</li>
</ul>
<p>У DFA другого порядку (DFA2) обчислюються відхилення <span class="math inline">\(F^2(v,s)\)</span> профілю від інтерполяційного многочлена другого порядку. Таким чином, вилучаються впливи можливих лінійних та параболічних трендів для масштабів, більших за розглядувані. Взагалі, у DFA порядку <span class="math inline">\(n\)</span> обчислюються відхилення профілю від інтерполяційного многочлена <span class="math inline">\(n\)</span>-го порядку, що вилучає вплив всіх можливих трендів порядків до (<span class="math inline">\(n-1\)</span>) для масштабів, більших від розміру вікна.</p>
<p>Потім обчислюється найближчий поліном <span class="math inline">\(y_{ν}(s)\)</span> для профілю на кожному із <span class="math inline">\(2N_s\)</span> сегментів <span class="math inline">\(v\)</span> і визначається відхилення</p>
<p><span id="eq-6-5"><span class="math display">\[
F^2(v,s) \equiv \frac{1}{s}\sum_{i=1}^{s}\left( x_{(v-1)s+i} - y_{i}(i) \right)^{2}.
\tag{6.6}\]</span></span></p>
<p>Далі знаходиться середнє значення флуктуацій всіх детрендованих профілів:</p>
<p><span id="eq-6-6"><span class="math display">\[
F_2(s) \equiv \sqrt{\left( \frac{1}{2N_s} \sum_{v=1}^{2N_s}F^{2}(v,s) \right)}.
\tag{6.7}\]</span></span></p>
<p>Значення (<a href="#eq-6-6" class="quarto-xref"><span>6.7</span></a>) можна трактувати як середньоквадратичний зсув (переміщення) точки випадкових блукань у ланцюжку після <span class="math inline">\(s\)</span> кроків.</p>
</section>
<section id="фрактальна-розмірність-хігучі" class="level4" data-number="6.1.4.3">
<h4 data-number="6.1.4.3" class="anchored" data-anchor-id="фрактальна-розмірність-хігучі"><span class="header-section-number">6.1.4.3</span> Фрактальна розмірність Хігучі</h4>
<p><strong>Фрактальна розмірність Хігучі</strong> (Higuchi fractal dimension) <span class="citation" data-cites="HIGUCHI1988277 7168285">&nbsp;[<a href="references.html#ref-HIGUCHI1988277" role="doc-biblioref">16</a>,<a href="references.html#ref-7168285" role="doc-biblioref">17</a>]</span> — це один з різновидів монофрактальної розмірності, яка визначається наступним чином:</p>
<p>Припустимо, що у нас є часовий ряд <span class="math inline">\(x(1), x(2),...,x(N)\)</span> і реконструйований часовий ряд <span class="math inline">\(x_{m}^{k} = \{ x(m), x(m+k), x(m+2k),..., x\left( m+\left[ (N-m) \big/ k \right] \cdot k \right) \}\)</span> для <span class="math inline">\(m=1,2,...,k\)</span>, де <span class="math inline">\(m\)</span> представляє початковий час; <span class="math inline">\(k=2,...,k_{max}\)</span> представляють ступінь часового зміщення. Позначення <span class="math inline">\([\cdot]\)</span> представляє цілу частину <span class="math inline">\(x\)</span>. Для кожного реконструйованого часового ряду <span class="math inline">\(x_{m}^{k}\)</span> розраховується середня довжина часової послідовності <span class="math inline">\(L_{m}(k)\)</span>:</p>
<p><span class="math display">\[
L_{m}(k) = \frac{\sum_{i=1}^{\left[ (N-m)/k \right]} | x(m+ik) - x(m+(i-1)\cdot k) | \cdot (N-1)}{\left[ (N-m) \big/ k \right] \cdot k}.
\]</span></p>
<p>Далі, для всіх середніх довжин <span class="math inline">\(L_{m}(k)\)</span>, знаходиться загальне середнє <span class="math inline">\(L(k) = (k)^{-1}\sum_{m=1}^{k}L_{m}(k)\)</span>. Згідно методу Хігучі узагальне середнє значення <span class="math inline">\(L(k)\)</span> пропорційне масштабу <span class="math inline">\(k\)</span>, тобто <span class="math inline">\(L(k) \propto k^{-D}\)</span>. Далі логарифмуємо обидві сторони й отримуємо рівність <span class="math inline">\(\ln{L(k)} \propto D \cdot \ln{\left( 1 \big/ k \right)}\)</span>. Інтерполювавши лінію регресії через залежність <span class="math inline">\(\ln{L(k)}\)</span> від <span class="math inline">\(\ln{\left( 1 \big/ k \right)}\)</span>, ми можемо отримати показник фрактальності <span class="math inline">\(D\)</span> як кут нахилу цієї лінії. Показник <span class="math inline">\(D\)</span> і представлятиме фрактальну розмірність Хігучі.</p>
</section>
<section id="фрактальна-розмірність-петросяна" class="level4" data-number="6.1.4.4">
<h4 data-number="6.1.4.4" class="anchored" data-anchor-id="фрактальна-розмірність-петросяна"><span class="header-section-number">6.1.4.4</span> Фрактальна розмірність Петросяна</h4>
<p>Спочатку для часового ряду <span class="math inline">\(\{ x_1, x_2,...,y_{N} \}\)</span> створюємо його дискретизовану (бінарну) версію, <span class="math inline">\(z_i\)</span>:</p>
<p><span class="math display">\[
z_i =
\begin{cases}
    1, &amp; x_i &gt; \langle x \rangle, \\
    -1, &amp; x_i \leq \langle x \rangle.
\end{cases}
\]</span></p>
<p><strong>Фрактальну розмірність Петросяна</strong> (Petrosian fractal dimension) <span class="citation" data-cites="465426 904882 goh:inria-00442374">&nbsp;[<a href="references.html#ref-465426" role="doc-biblioref">18</a>–<a href="references.html#ref-goh:inria-00442374" role="doc-biblioref">20</a>]</span> можна визначити як</p>
<p><span class="math display">\[
D = \log_{10}{N} \big/ \left( \log_{10} + \log_{10}{\left[ N \big/ (N+0.4N_{\Delta}) \right]} \right),
\]</span></p>
<p>де <span class="math inline">\(N_{\Delta}\)</span> — кількість загальних змін знаку величини <span class="math inline">\(z_i\)</span>: <span class="math inline">\(N_{\Delta} = \sum_{i=1}^{N-2} \left| (z_{i+1}-z_i) \big/ 2 \right|\)</span>.</p>
</section>
<section id="фрактальна-розмірність-каца" class="level4" data-number="6.1.4.5">
<h4 data-number="6.1.4.5" class="anchored" data-anchor-id="фрактальна-розмірність-каца"><span class="header-section-number">6.1.4.5</span> Фрактальна розмірність Каца</h4>
<p>Представимо, що сигнал складається з пари точок <span class="math inline">\(\left( x_i, y_i \right)\)</span>. Тоді, <strong>фрактальна розмірність Каца</strong> (Katz fractal dimension) <span class="citation" data-cites="KATZ1988145">&nbsp;[<a href="references.html#ref-KATZ1988145" role="doc-biblioref">21</a>]</span> визначається як</p>
<p><span class="math display">\[
D = \log{N}/\left(\log{N} + \log{d/L}\right),
\]</span></p>
<p>де <span class="math inline">\(L = \sum_{i=0}^{N-2}\sqrt{\left( y_{i+1}-y_{i} \right)^{2} + \left( x_{i+1}-x_{i} \right)^{2}}\)</span>, а значення <span class="math inline">\(d = \max{\left( \sqrt{\left( x_i - x_1 \right)^{2} - \left( y_i - y_1 \right)^{2}} \right)}\)</span>.</p>
</section>
<section id="фрактальна-розмірність-шевчика" class="level4" data-number="6.1.4.6">
<h4 data-number="6.1.4.6" class="anchored" data-anchor-id="фрактальна-розмірність-шевчика"><span class="header-section-number">6.1.4.6</span> Фрактальна розмірність Шевчика</h4>
<p>Спочатку, для множини значень <span class="math inline">\(\left( x_i, y_i \right)\)</span> виконується нормалізація: <span class="math inline">\(x_{i}^{*} = \left( x_i-x_{min} \right) \big/ \left( x_{max}-x_{min} \right)\)</span> і <span class="math inline">\(y_{i}^{*} = \left( y_i - y_{min} \right) \big/ \left( y_{max}-y_{min} \right)\)</span>.</p>
<p><strong>Фрактальна розмірність Шевчика</strong> (Sevcik fractal dimension) <span class="citation" data-cites="sevcik2010procedure">&nbsp;[<a href="references.html#ref-sevcik2010procedure" role="doc-biblioref">22</a>]</span> може бути визначена як</p>
<p><span class="math display">\[
D = 1 + \left. \ln{L} \big/ \ln{\left( 2 \cdot  [N-1] \right)} \right.,
\]</span></p>
<p><span class="math inline">\(L\)</span> — це довжина сигналу, що може бути розрахована за формулою <span class="math inline">\(L = \sum_{i=0}^{N-2}\sqrt{\left( y_{i+1}^{*}-y_{i}^{*} \right)^{2} + \left( x_{i+1}^{*}-x_{i}^{*} \right)^{2}}\)</span>.</p>
</section>
<section id="фрактальна-розмірність-через-нормалізовану-щільність-довжини" class="level4" data-number="6.1.4.7">
<h4 data-number="6.1.4.7" class="anchored" data-anchor-id="фрактальна-розмірність-через-нормалізовану-щільність-довжини"><span class="header-section-number">6.1.4.7</span> Фрактальна розмірність через нормалізовану щільність довжини</h4>
<p>Даний показник розраховується в наступний спосіб <span class="citation" data-cites="kalauzi2009extracting">&nbsp;[<a href="references.html#ref-kalauzi2009extracting" role="doc-biblioref">23</a>]</span>:</p>
<ol type="1">
<li>Для часового ряду <span class="math inline">\(\{ x_1, x_2,...,x_n \}\)</span> виконується стандартизація: <span class="math inline">\(y_i = (x_i - \mu)/\sigma\)</span>, де <span class="math inline">\(\mu\)</span> — це середнє значення ряду, <span class="math inline">\(\sigma\)</span> — це стандартне відхилення.</li>
<li>Розраховується нормалізована щільність довжини <span class="math inline">\(NLD = \frac{1}{N}\sum_{i=2}^{N}\left| y_i - y_{i-1} \right|\)</span>. Фактичний розрахунок <strong>фрактальної розмірності через нормалізовану щільність довжини</strong> (fractal dimension via Normalized Length Density, FNLD) базується на побудові монотонної калібрувальної кривої <span class="math inline">\(D = f(NLD)\)</span> за набором функцій Вейєрштрасса, для яких значення <span class="math inline">\(D\)</span> задаються теоретично.</li>
<li>Для обчислювальних цілей створено дві моделі цієї залежності:
<ul>
<li>логарифмічну модель: <span class="math inline">\(D = a \cdot \log{\left(NLD - NLD_{0} \right)} + C\)</span>;</li>
<li>степеневу модель: <span class="math inline">\(D = a \cdot \left(NLD - NLD_{0} \right)^{k}\)</span>. Бібліотека <code>neurokit2</code> використовує саме степеневу модель. Параметр <span class="math inline">\(a=1.9079\)</span>, <span class="math inline">\(k=0.18383\)</span> і <span class="math inline">\(NLD_{0}=0.097178\)</span>, згідно <span class="citation" data-cites="Kalauzi_2009">&nbsp;[<a href="references.html#ref-Kalauzi_2009" role="doc-biblioref">24</a>]</span>.</li>
</ul></li>
</ol>
</section>
<section id="фрактальна-розмірність-і-спектральна-щільність-потужності" class="level4" data-number="6.1.4.8">
<h4 data-number="6.1.4.8" class="anchored" data-anchor-id="фрактальна-розмірність-і-спектральна-щільність-потужності"><span class="header-section-number">6.1.4.8</span> Фрактальна розмірність і спектральна щільність потужності</h4>
<p>Фрактальну розмірність можна обчислити на основі аналізу нахилу <strong>спектральної щільності потужності</strong> (power spectral density slope, PSD) <span class="citation" data-cites="10.3389/fphys.2013.00075 Voss1988">&nbsp;[<a href="references.html#ref-10.3389/fphys.2013.00075" role="doc-biblioref">25</a>,<a href="references.html#ref-Voss1988" role="doc-biblioref">26</a>]</span> в сигналах, що характеризуються степеневою частотною залежністю.</p>
<p>Спочатку виконується перетворення часового ряду до частотної області і далі сигнал розбивається на гармонійні коливання певної амплітуди, які разом “складаються”, щоб представити вихідний сигнал. Якщо існує систематичний зв’язок між частотами в сигналі і потужністю цих частот, то в логарифмічних координатах це проявляється через лінійну залежність. Кут нахилу лінії регресії приймається як оцінка фрактальної розмірності.</p>
<p>Нахил 0 відповідає білому шуму, а нахил менше 0, але більше -1, відповідає рожевому шуму, тобто шуму <span class="math inline">\(1/f\)</span>. Спектральні нахили крутіші за -2 вказують на дробовий броунівський рух, що є проявом процесів випадкового блукання.</p>
</section>
<section id="кореляційна-розмірність" class="level4" data-number="6.1.4.9">
<h4 data-number="6.1.4.9" class="anchored" data-anchor-id="кореляційна-розмірність"><span class="header-section-number">6.1.4.9</span> Кореляційна розмірність</h4>
<p><strong>Кореляційна розмірність</strong> (correlation dimension, <span class="math inline">\(D_2\)</span>) — це похідна величина від кореляційного інтеграла (кореляційної суми) і може бути подана у вигляді <span class="citation" data-cites="GRASSBERGER1983189 PhysRevLett.50.346 GRASSBERGER1983227">&nbsp;[<a href="references.html#ref-GRASSBERGER1983189" role="doc-biblioref">27</a>–<a href="references.html#ref-GRASSBERGER1983227" role="doc-biblioref">29</a>]</span>:</p>
<p><span class="math display">\[
C(\varepsilon) = \frac{1}{N^{2}}\sum_{\substack{i,j=1 \\ i\neq j}}^{N}\Theta \left( \varepsilon - \| \vec{x}(i) - \vec{x}(j) \| \right), \; \vec{x}(i) \in \Re^{m}.
\]</span></p>
<p>Кореляційна розмірність може бути виведена з наступної степеневої залежності:</p>
<p><span class="math display">\[
C(\varepsilon) \sim \varepsilon^{\nu},
\]</span></p>
<p>або</p>
<p><span class="math display">\[
D_2 = \lim_{M\to\infty}\lim_{\varepsilon\to 0} \log{\left( g_{\varepsilon} \big/ N^2 \right)} \big/ \log{\varepsilon},
\]</span></p>
<p>де <span class="math inline">\(g_{\varepsilon}\)</span> — це сумарна кількість пар точок, відстань між якими менша за радіус <span class="math inline">\(\varepsilon\)</span>.</p>
<p>У першому випадку ми відбираємо <span class="math inline">\(i\)</span>-ту траєкторію та всі інші <span class="math inline">\(j\)</span>-ті траєкторії, і дивимося, чи потрапляють <span class="math inline">\(j\)</span>-ті траєкторії в <span class="math inline">\(\varepsilon\)</span>-окіл <span class="math inline">\(i\)</span>-ої траєкторії. Якщо відстань між ними не перевищує окіл радіусом <span class="math inline">\(\varepsilon\)</span>, ми ставимо 1. Але якщо відстань між траєкторіями більша за <span class="math inline">\(\varepsilon\)</span>, тоді ставимо 0. Далі все це підсумовується, ділиться на загальну кількість траєкторій. По суті кореляційний інтеграл це середня ймовірність того, що дві розглянуті траєкторії фазового простору, будуть знаходитися досить близько одна від одної. Чим тісніше розташовані точки фазового простору, тим більше значення кореляційного інтеграла. Чим більш рівновіддаленими видаються траєкторії одна від одної, тим ближче значення кореляційного інтеграла до нуля.</p>
<p>Значення кореляційної розмірності ми можемо відшукати аналогічно попередним фрактальним показникам: ми шукаємо залежність кореляційного інтеграла від значення <span class="math inline">\(\varepsilon\)</span>. Ця залежність будується в логарифмічному масштабі.</p>
<p>Ось деякі цікаві приклади.</p>
<p><strong>Електрокардіограма</strong> (ЕКГ): ЕКГ-сигнали відображають електричну активність серця. Складність ЕКГ-сигналу може бути оцінена за допомогою кореляційної розмірності. Очікується, що кореляційна розмірність ЕКГ здорового серця буде вищою через наявність складних патернів і варіабельності. З іншого боку, аномальні ЕКГ-сигнали, наприклад, від пацієнтів з аритміями або серцевими захворюваннями, можуть мати нижчу кореляційну розмірність через втрату складності сигналу.</p>
<p><strong>Електроенцефалограма</strong> (ЕЕГ): Сигнали ЕЕГ реєструють електричну активність мозку. Кореляційна розмірність може використовуватися для аналізу складності мозкової активності, яка може змінюватися залежно від різних когнітивних станів, стадій сну або неврологічних розладів. У здорових людей сигнали ЕЕГ у стані бадьорості та уваги можуть мати вищу кореляційну розмірність порівняно з сигналами у стадії сну, коли активність мозку є більш регулярною і синхронізованою.</p>
<p><strong>Дихальні сигнали</strong>: Дихальні сигнали, такі як частота дихання або повітряний потік, також можуть бути проаналізовані за допомогою кореляційної розмірності. Складність цих сигналів може змінюватися залежно від таких факторів, як стрес, фізичне навантаження або наявність респіраторних захворювань. За нормального дихання може спостерігатися вища кореляційна розмірність, тоді як порушення в дихальних сигналах, наприклад, за обструктивного апное уві сні або дихальних розладів, можуть призвести до зниження кореляційної розмірності.</p>
<p><strong>Аналіз ходи</strong>: Кореляційна розмірність може бути використана для аналізу моделей ходи. Вона допомагає зрозуміти складність рухів людини під час ходьби чи бігу. Зміни в кореляційній розмірності сигналів ходи можуть свідчити про зміну стабільності ходи або про наявність відхилень у ході, викликаних неврологічними або опорно-руховими захворюваннями.</p>
<p><strong>Варіативність динаміки серцевого ритму</strong> (ВСР): ВСР являє собою зміну часових інтервалів між послідовними ударами серця. Вона перебуває під впливом вегетативної нервової системи і відображає адаптивність і складність серцево-судинної системи. Вищий рівень ВСР, що відповідає вищій кореляційній розмірності, зазвичай асоціюється з кращим станом серцево-судинної системи та її адаптивністю до фізіологічних змін і змін навколишнього середовища. Її падіння може асоціюватися з аномальною динамікою серця.</p>
<p><strong>Послідовності ДНК</strong>: Кореляційна розмірність може бути використана і при аналізі послідовностей ДНК. Вона допомагає виявити самоподібні або фрактальні патерни всередині послідовностей, що може мати значення для розуміння генетичної складності, еволюційних зв’язків і регуляції генів. Висока кореляційна розмірність — висока складність ланцюжка ДНК. Мала кореляційна розмірність — спрощений ланцюжок ДНК.</p>
<p><strong>Фінансові ринки</strong>: Вища кореляційна розмірність у даних часових рядів фінансового ринку свідчить про більшу складність та існування в їхній основі самоподібних моделей або фрактальних структур. Хаотична поведінка цін на акції може бути пов’язана з періодами високої волатильності та непередбачуваності. З іншого боку, нижча величина кореляційної розмірності може свідчити про більш передбачувані та менш складні рухи цін, що відповідає періодам стабільності або менш волатильним ринковим умовам.</p>
</section>
</section>
</section>
<section id="хід-роботи" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="хід-роботи"><span class="header-section-number">6.2</span> Хід роботи</h2>
<p>Розглянемо як можна застосовувати зазначені показники в якості індикаторів кризових станів.</p>
<p>Спочатку імпортуємо необхідні бібліотеки:</p>
<div id="cell-37" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> neurokit2 <span class="im">as</span> nk</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> yfinance <span class="im">as</span> yf</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scienceplots</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tqdm <span class="im">import</span> tqdm</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Далі виконаємо налаштування формату виведення рисунків:</p>
<div id="cell-39" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>plt.style.use([<span class="st">'science'</span>, <span class="st">'notebook'</span>, <span class="st">'grid'</span>]) <span class="co"># стиль, що використовуватиметься</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                                               <span class="co"># для виведення рисунків</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>size <span class="op">=</span> <span class="dv">16</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> {</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'figure.figsize'</span>: (<span class="dv">8</span>, <span class="dv">6</span>),            <span class="co"># встановлюємо ширину та висоту рисунків за замовчуванням</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'font.size'</span>: size,                   <span class="co"># розмір фонтів рисунку</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'lines.linewidth'</span>: <span class="dv">2</span>,                <span class="co"># товщина ліній</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.titlesize'</span>: <span class="st">'small'</span>,           <span class="co"># розмір титулки над рисунком</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.labelsize'</span>: size,              <span class="co"># розмір підписів по осям</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'legend.fontsize'</span>: size,             <span class="co"># розмір легенди</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'xtick.labelsize'</span>: size,             <span class="co"># розмір розмітки по осі Ох</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ytick.labelsize'</span>: size,             <span class="co"># розмір розмітки по осі Ох</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"font.family"</span>: <span class="st">"Serif"</span>,              <span class="co"># сімейство стилів підписів </span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"font.serif"</span>: [<span class="st">"Times New Roman"</span>],   <span class="co"># стиль підпису</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'savefig.dpi'</span>: <span class="dv">300</span>,                  <span class="co"># якість збережених зображень</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.grid'</span>: <span class="va">False</span>                   <span class="co"># побудова сітки на самому рисунку</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>plt.rcParams.update(params)              <span class="co"># оновлення стилю згідно налаштувань</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>На цьому етапі скористаємось монофрактальними показниками для ідентифікації кризових явищ на ринку золота. Розглянемо ціну золота, наприклад, за період з 1 грудня 2001 року по 1 листопада 2023 року:</p>
<div id="cell-41" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>symbol <span class="op">=</span> <span class="st">'GC=F'</span>          <span class="co"># Символ індексу</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> <span class="st">"2001-01-01"</span>     <span class="co"># Дата початку зчитування даних</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>end <span class="op">=</span> <span class="st">"2023-11-01"</span>       <span class="co"># Дата закінчення зчитування даних</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> yf.download(symbol)            <span class="co"># вивантажуємо дані</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>time_ser <span class="op">=</span> data[<span class="st">'Adj Close'</span>].copy()   <span class="co"># зберігаємо саме ціни закриття</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>xlabel <span class="op">=</span> <span class="st">'time, days'</span>                 <span class="co"># підпис по вісі Ох </span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>ylabel <span class="op">=</span> symbol                       <span class="co"># підпис по вісі Оу</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>[*********************100%%**********************]  1 of 1 completed</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Увага
</div>
</div>
<div class="callout-body-container callout-body">
<p>Виконайте цей блок, якщо хочете зчитати дані не з Yahoo! Finance, а із власного файлу. Зрозуміло, що й аналіз результатів, і висновки залежать від того з яким рядом ми працюємо</p>
</div>
</div>
<hr>
<div id="cell-44" class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>symbol <span class="op">=</span> <span class="st">'sMpa11'</span>                  <span class="co"># Символ індексу</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> <span class="st">"databases\sMpa11.txt"</span>      <span class="co"># шлях по якому здійснюється зчитування файлу</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(path,           <span class="co"># зчитування даних </span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                   names<span class="op">=</span>[symbol])</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>time_ser <span class="op">=</span> data[symbol].copy()     <span class="co"># копіюємо значення кривої </span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                                   <span class="co"># "напруга-видовження" до окремої змінної</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>xlabel <span class="op">=</span> <span class="vs">r'$\varepsilon$'</span>          <span class="co"># підпис по вісі Ох </span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>ylabel <span class="op">=</span> symbol                    <span class="co"># підпис по вісі Оу</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p>Виводимо досліджуваний ряд:</p>
<div id="cell-fig-gold-init" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()                   <span class="co"># Створюємо порожній графік</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>ax.plot(time_ser.index, time_ser.values)   <span class="co"># Додаємо дані до графіку</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>ax.legend([symbol])                        <span class="co"># Додаємо легенду</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(xlabel)                      <span class="co"># Встановимо підпис по вісі Ох</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(ylabel)                      <span class="co"># Встановимо підпис по вісі Oy</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">45</span>)                    <span class="co"># оберт позначок по осі Ох на 45 градусів</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="ss">f'</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">.jpg'</span>)               <span class="co"># Зберігаємо графік </span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>plt.show()<span class="op">;</span>                                <span class="co"># Виводимо графік</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-gold-init" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gold-init-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lab_6_files/figure-html/fig-gold-init-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gold-init-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Рис.&nbsp;6.2: Динаміка щоденних змін ціни золота
</figcaption>
</figure>
</div>
</div>
</div>
<p>Визначимо функцію <code>transformation()</code> для стандартизації ряду:</p>
<div id="cell-49" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> transformation(signal, ret_type):</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    for_rec <span class="op">=</span> signal.copy()</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ret_type <span class="op">==</span> <span class="dv">1</span>:       <span class="co"># Зважаючи на вид ряду, виконуємо</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># необхідні перетворення</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">pass</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> ret_type <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>        for_rec <span class="op">=</span> for_rec.diff()</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> ret_type <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>        for_rec <span class="op">=</span> for_rec.pct_change()</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> ret_type <span class="op">==</span> <span class="dv">4</span>:</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>        for_rec <span class="op">=</span> for_rec.pct_change()</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>        for_rec <span class="op">-=</span> for_rec.mean()</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>        for_rec <span class="op">/=</span> for_rec.std()</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> ret_type <span class="op">==</span> <span class="dv">5</span>: </span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>        for_rec <span class="op">=</span> for_rec.pct_change()</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>        for_rec <span class="op">-=</span> for_rec.mean()</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>        for_rec <span class="op">/=</span> for_rec.std()</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>        for_rec <span class="op">=</span> for_rec.<span class="bu">abs</span>()</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> ret_type <span class="op">==</span> <span class="dv">6</span>:</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>        for_rec <span class="op">-=</span> for_rec.mean()</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>        for_rec <span class="op">/=</span> for_rec.std()</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>    for_rec <span class="op">=</span> for_rec.dropna().values</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> for_rec</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="обчислення-показника-херста-з-використанням-rs-аналізу" class="level3" data-number="6.2.1">
<h3 data-number="6.2.1" class="anchored" data-anchor-id="обчислення-показника-херста-з-використанням-rs-аналізу"><span class="header-section-number">6.2.1</span> Обчислення показника Херста з використанням <em>R/S</em>-аналізу</h3>
<p>Для подальших розрахунків використовуватимемо бібліотеку <code>neurokit2</code> та <code>fathon</code>. Другу з них можна встановити в наступний спосіб:</p>
<div id="cell-52" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install fathon</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Далі імпортуємо саму бібліотеку та дотичні до неї модулі:</p>
<div id="cell-54" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> fathon</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fathon <span class="im">import</span> fathonUtils <span class="im">as</span> fu</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Бібліотека <code>neurokit</code> містить необхідний метод для <em>R/S</em>-аналізу — <code>fractal_hurst</code>. Його синтаксис:</p>
<p><strong><code>fractal_hurst(signal, scale='default', corrected=True, show=False)</code></strong></p>
<p><strong>Параметри:</strong></p>
<ul>
<li><strong>signal</strong> (<em>Union[list, np.array, pd.Series]</em>) — сигнал (тобто часовий ряд) у вигляді вектора значень або датафрейму бібліотеки <code>pandas</code>;</li>
<li><strong>scale</strong> (<em>list</em>) — список, що містить довжини вікон (кількість точок даних у кожній підмножині ряду), на які розбито сигнал;</li>
<li><strong>corrected</strong> (<em>bool</em>) — якщо значення <code>True</code>, до вихідних даних буде застосовано поправочний коефіцієнт Аніса-Ллойда-Пітерса <span class="citation" data-cites="Anis_1976">&nbsp;[<a href="references.html#ref-Anis_1976" role="doc-biblioref">30</a>]</span> відповідно до очікуваного значення для окремих значень (<em>R/S</em>);</li>
<li><strong>show</strong> (<em>bool</em>) — якщо значення <code>True</code>, виводить залежність <span class="math inline">\((R/S)_n\)</span> від <span class="math inline">\(n\)</span> (<strong>scale</strong>) у подвійному логарифмічному масштабі.</li>
</ul>
<p><strong>Повертає:</strong></p>
<ul>
<li><strong>h</strong> (<em>float</em>) — показник Херста;</li>
<li><strong>kwargs</strong> — словник, що містить інформацію відносно використовуваних у процедурі параметрів.</li>
</ul>
<p>Розглянемо ступінь трендостійкості в динаміці ціни золота, використовуючи весь часовий ряд. Далі знайдемо значення показника Херста в рамках віконної процедури.</p>
<section id="увесь-часовий-ряд" class="level4" data-number="6.2.1.1">
<h4 data-number="6.2.1.1" class="anchored" data-anchor-id="увесь-часовий-ряд"><span class="header-section-number">6.2.1.1</span> Увесь часовий ряд</h4>
<p>Першочергово знайдемо значення прибутковостей для нашого ряду та стандартизуємо їх. Після цього виконаємо обчислення:</p>
<div id="cell-60" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>signal <span class="op">=</span> time_ser.copy()</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>ret_type <span class="op">=</span> <span class="dv">4</span>    <span class="co"># вид ряду: </span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 1 - вихідний, </span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 2 - детрендований (різниця між теп. значенням та попереднім)</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 3 - прибутковості звичайні, </span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 4 - стандартизовані прибутковості, </span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 5 - абсолютні значення (волатильності)</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 6 - стандартизований ряд</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>for_rs <span class="op">=</span> transformation(signal, ret_type) </span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Виконуємо <em>R/S</em>-аналіз:</p>
<div id="cell-fig-gold-rs-all" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>h, info <span class="op">=</span> nk.fractal_hurst(for_rs, corrected<span class="op">=</span><span class="va">False</span>, show<span class="op">=</span><span class="va">True</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-gold-rs-all" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gold-rs-all-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lab_6_files/figure-html/fig-gold-rs-all-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gold-rs-all-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Рис.&nbsp;6.3: Залежність значень R/S від скейлінгу
</figcaption>
</figure>
</div>
</div>
</div>
<p>Як ми можемо бачити з <a href="#fig-gold-rs-all" class="quarto-xref">Рис.&nbsp;<span>6.3</span></a>, значення <span class="math inline">\(h=0.53\)</span>, що свідчить про подібність цінової динаміки золота до випадкового блукання. Але оскільки закони, що регулюють ринок, змінюються з часом, мають змінюватись і кореляції всередині системи, а тому коефіцієнт Херста також може змінюватись.</p>
</section>
<section id="віконна-процедура" class="level4" data-number="6.2.1.2">
<h4 data-number="6.2.1.2" class="anchored" data-anchor-id="віконна-процедура"><span class="header-section-number">6.2.1.2</span> Віконна процедура</h4>
<p>Визначимо функцію для побудови парних графіків:</p>
<div id="cell-66" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_pair(x_values, </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>              y1_values,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>              y2_values,  </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>              y1_label, </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>              y2_label,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>              x_label, </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>              file_name, clr<span class="op">=</span><span class="st">"magenta"</span>):</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    ax2 <span class="op">=</span> ax.twinx()</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    ax2.spines.right.set_position((<span class="st">"axes"</span>, <span class="fl">1.03</span>))</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    p1, <span class="op">=</span> ax.plot(x_values, </span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>                  y1_values, </span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"b-"</span>, label<span class="op">=</span><span class="vs">fr"</span><span class="sc">{</span>y1_label<span class="sc">}</span><span class="vs">"</span>)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    p2, <span class="op">=</span> ax2.plot(x_values,</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>                   y2_values, </span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>                   color<span class="op">=</span>clr, </span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>                   label<span class="op">=</span>y2_label)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(x_label)</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="ss">f"</span><span class="sc">{</span>y1_label<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    ax.yaxis.label.set_color(p1.get_color())</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    ax2.yaxis.label.set_color(p2.get_color())</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    tkw <span class="op">=</span> <span class="bu">dict</span>(size<span class="op">=</span><span class="dv">2</span>, width<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>    ax.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, rotation<span class="op">=</span><span class="dv">45</span>, <span class="op">**</span>tkw)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    ax.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, colors<span class="op">=</span>p1.get_color(), <span class="op">**</span>tkw)</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>    ax2.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, colors<span class="op">=</span>p2.get_color(), <span class="op">**</span>tkw)</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>    ax2.legend(handles<span class="op">=</span>[p1, p2])</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>    plt.savefig(file_name <span class="op">+</span> <span class="st">".jpg"</span>)</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>    plt.show()<span class="op">;</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Приступимо до віконної процедури:</p>
<div id="cell-68" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># встановлюємо параметри</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>ret_type <span class="op">=</span> <span class="dv">4</span>                   <span class="co"># вид ряду</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>window <span class="op">=</span> <span class="dv">250</span>                   <span class="co"># ширина вікна</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>tstep <span class="op">=</span> <span class="dv">1</span>                      <span class="co"># часовий крок вікна </span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>length <span class="op">=</span> <span class="bu">len</span>(time_ser.values)  <span class="co"># довжина самого ряду</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>corr <span class="op">=</span> <span class="va">False</span>                   <span class="co"># поправочний коефіцієнт Аніса-Ллойда-Пітерса</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>H <span class="op">=</span> []                         <span class="co"># масив для віконного Херсту</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-69" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> tqdm(<span class="bu">range</span>(<span class="dv">0</span>,length<span class="op">-</span>window,tstep)): <span class="co"># фрагменти довжиною window  </span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                                             <span class="co"># з кроком tstep</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># відбираємо фрагменти</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    fragm <span class="op">=</span> time_ser.iloc[i:i<span class="op">+</span>window].copy()  </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># виконуємо процедуру трансформації ряду </span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    fragm <span class="op">=</span> transformation(fragm, ret_type)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># розраховуємо взаємну інформацію </span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    h, _ <span class="op">=</span> nk.fractal_hurst(fragm, corrected<span class="op">=</span>corr, show<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># та додаємо результат до масиву значень</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    H.append(h)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>  5%|▌         | 289/5664 [00:00&lt;00:11, 481.96it/s]100%|██████████| 5664/5664 [00:11&lt;00:00, 486.74it/s]</code></pre>
</div>
</div>
<div id="cell-70" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>np.savetxt(<span class="ss">f"rs_hurst_name=</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_window=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_ </span><span class="ch">\</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="ss">           rettype=</span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_corrected=</span><span class="sc">{</span>corr<span class="sc">}</span><span class="ss">.txt"</span> , H)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Візуалізуємо результат:</p>
<div id="cell-72" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>measure_label <span class="op">=</span> <span class="vs">r'$H$'</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>file_name <span class="op">=</span> <span class="ss">f"rs_hurst_name=</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_window=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_ </span><span class="ch">\</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="ss">           rettype=</span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_corrected=</span><span class="sc">{</span>corr<span class="sc">}</span><span class="ss">"</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-fig-gold-wind-rs" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>plot_pair(time_ser.index[window:length:tstep],</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>          time_ser.values[window:length:tstep],</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>          H, </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>          ylabel, </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>          measure_label,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>          xlabel,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>          file_name)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-gold-wind-rs" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gold-wind-rs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lab_6_files/figure-html/fig-gold-wind-rs-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gold-wind-rs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Рис.&nbsp;6.4: Динаміка ціни золота та показника Херста
</figcaption>
</figure>
</div>
</div>
</div>
<p>На <a href="#fig-gold-wind-rs" class="quarto-xref">Рис.&nbsp;<span>6.4</span></a> можемо бачити, що показник Херста зростає в передкризовий період та спадає під час кризи. Перед кризою динаміка ринку характеризується зростанням трендостійкості (персистентності), що відзеркалює зростання скорельованості дій трейдерів.</p>
</section>
</section>
<section id="обчислення-на-основі-dfa" class="level3" data-number="6.2.2">
<h3 data-number="6.2.2" class="anchored" data-anchor-id="обчислення-на-основі-dfa"><span class="header-section-number">6.2.2</span> Обчислення на основі DFA</h3>
<p>Бібліотека <code>fathon</code> представляє інструментарій як для виконання класичного аналізу детрендованих флуктуацій, так і для його мультифрактального аналогу, мова про який піде в наступній лабораторній роботі.</p>
<section id="для-всього-ряду" class="level4" data-number="6.2.2.1">
<h4 data-number="6.2.2.1" class="anchored" data-anchor-id="для-всього-ряду"><span class="header-section-number">6.2.2.1</span> Для всього ряду</h4>
<p>Спочатку представимо значення <span class="math inline">\(\alpha\)</span> для всього ряду. Процедура розрахунків на основі бібліотеки <code>fathon</code> виглядатиме наступним чином:</p>
<p>Знаходимо стандартизовані прибутковості ряду:</p>
<div id="cell-80" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>signal <span class="op">=</span> time_ser.copy()</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>ret_type <span class="op">=</span> <span class="dv">4</span>    <span class="co"># вид ряду: </span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 1 - вихідний, </span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 2 - детрендований (різниця між теп. значенням та попереднім)</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 3 - прибутковості звичайні, </span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 4 - стандартизовані прибутковості, </span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 5 - абсолютні значення (волатильності)</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 6 - стандартизований ряд</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>for_dfa <span class="op">=</span> transformation(signal, ret_type) </span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-81" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>cumulat <span class="op">=</span> fu.toAggregated(for_dfa) <span class="co"># знаходимо кумулятивні накопичення</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>rev <span class="op">=</span> <span class="va">True</span> <span class="co"># чи повторювати розрахунок ф-ції флуктуацій з кінця</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>order <span class="op">=</span> <span class="dv">2</span>  <span class="co"># порядок локального лінійного тренду </span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>pydfa <span class="op">=</span> fathon.DFA(cumulat) <span class="co"># ініціалізація об'єкту DFA</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># для виконання подальших обчислень</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>win_beg <span class="op">=</span> <span class="dv">100</span>               <span class="co"># початкова ширина сегментів</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>win_end <span class="op">=</span> <span class="dv">2000</span>              <span class="co"># кінцева ширина сегментів</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>wins <span class="op">=</span> fu.linRangeByStep(win_beg, win_end) <span class="co"># генеруємо масив </span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>                                           <span class="co"># лінійно розділених </span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>                                           <span class="co"># елементів.</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>n, F <span class="op">=</span> pydfa.computeFlucVec(wins, </span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>                            polOrd<span class="op">=</span>order, </span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>                            revSeg<span class="op">=</span>rev)    <span class="co"># знаходимо функцію флуктуацій</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>H, H_intercept <span class="op">=</span> pydfa.fitFlucVec()        <span class="co"># знаходимо показник альфа</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Виводимо залежність функції флуктуацій від масштабу:</p>
<div id="cell-83" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>polyfit <span class="op">=</span> np.polyfit(np.log(n), np.log(F), <span class="dv">1</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>fluctfit <span class="op">=</span> np.exp(<span class="dv">1</span>) <span class="op">**</span> np.polyval(polyfit, np.log(n))</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Будуємо залежність функції флуктуацій від масштабу в подвійному логарифмічному масштабі:</p>
<div id="cell-fig-gold-dfa-all" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">"Показник Херста на основі DFA"</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>ax.scatter(</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>        np.log(n),</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>        np.log(F),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>        marker<span class="op">=</span><span class="st">"o"</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>        zorder<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span><span class="st">"_no_legend_"</span>,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>label <span class="op">=</span> <span class="vs">fr"$\alpha$ = </span><span class="sc">{</span>H<span class="sc">:.2f}</span><span class="vs">"</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>ax.plot(np.log(n), np.log(fluctfit), </span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">"#E91E63"</span>, zorder<span class="op">=</span><span class="dv">2</span>, </span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>        linewidth<span class="op">=</span><span class="dv">3</span>, label<span class="op">=</span>label)</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">r'$\ln{F_</span><span class="sc">{2}</span><span class="vs">(n)}$'</span>)</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="vs">r'$\ln</span><span class="sc">{n}</span><span class="vs">$'</span>)</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>ax.legend(loc<span class="op">=</span><span class="st">"lower right"</span>)</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-gold-dfa-all" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gold-dfa-all-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lab_6_files/figure-html/fig-gold-dfa-all-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gold-dfa-all-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Рис.&nbsp;6.5: Логарифмічна залежність значень функції флуктуацій від скейлінгу
</figcaption>
</figure>
</div>
</div>
</div>
<p>Процедура DFA показує, що значення ціни золота представляються скоріше антиперсистентними, але представлений результат доволі близький до того, що був отриманий за допомогою <em>R/S</em>-аналізу. Розглянемо значення <span class="math inline">\(\alpha\)</span> в рамках алгоритму ковзного вікна.</p>
</section>
<section id="віконна-процедура-1" class="level4" data-number="6.2.2.2">
<h4 data-number="6.2.2.2" class="anchored" data-anchor-id="віконна-процедура-1"><span class="header-section-number">6.2.2.2</span> Віконна процедура</h4>
<p>Визначимо наступні параметри:</p>
<div id="cell-89" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>window <span class="op">=</span> <span class="dv">250</span>    <span class="co"># розмір вікна</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>tstep <span class="op">=</span> <span class="dv">1</span>       <span class="co"># крок вікна</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>ret_type <span class="op">=</span> <span class="dv">4</span>    <span class="co"># вид ряду: </span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 1 - вихідний, </span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 2 - детрендований (різниця між теп. значенням </span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>                                                <span class="co"># та попереднім)</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 3 - прибутковості звичайні, </span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 4 - стандартизовані прибутковості, </span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 5 - абсолютні значення (волатильності)</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 6 - стандартизований ряд</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>rev <span class="op">=</span> <span class="va">True</span>      <span class="co"># чи повторювати розрахунок ф-ції флуктуацій з кінця</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>order <span class="op">=</span> <span class="dv">2</span>       <span class="co"># порядок поліноміального тренду</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>periods <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>win_beg <span class="op">=</span> <span class="dv">10</span>             <span class="co"># початковий масштаб сегментів</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>win_end <span class="op">=</span> window<span class="op">-</span><span class="dv">1</span>       <span class="co"># кінцевий масштаб сегментів</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>length <span class="op">=</span> <span class="bu">len</span>(time_ser.values) <span class="co"># довжина ряду</span></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> []               <span class="co"># масив показників альфа (Херста)</span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>D_f <span class="op">=</span> []                 <span class="co"># фрактальна розмірність</span></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>beta <span class="op">=</span> []                <span class="co"># показник спектральної щільності</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>gamma <span class="op">=</span> []               <span class="co"># показник автокореляції</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Знайдемо показник Херста (<span class="math inline">\(\alpha\)</span>), фрактальну розмірність (<span class="math inline">\(D_f\)</span>), показник спектральної щільності (<span class="math inline">\(\beta\)</span>) та показник автокореляції (<span class="math inline">\(\gamma\)</span>):</p>
<div id="cell-91" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> tqdm(<span class="bu">range</span>(<span class="dv">0</span>,length<span class="op">-</span>window,tstep)):</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># відбираємо фрагменти</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    fragm <span class="op">=</span> time_ser.iloc[i:i<span class="op">+</span>window].copy()  </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># виконуємо процедуру трансформації ряду </span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    fragm <span class="op">=</span> transformation(fragm, ret_type)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># знаходимо кумулятивні накопичення</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    cumulat_wind <span class="op">=</span> fu.toAggregated(fragm) </span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ініціалізація об'єкту DFA</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    pydfa <span class="op">=</span> fathon.DFA(cumulat_wind) </span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># генеруємо масив лінійно розділених елементів</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    wins <span class="op">=</span> fu.linRangeByStep(win_beg, win_end) </span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># знаходимо функцію флуктуацій</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>    n, F_wind <span class="op">=</span> pydfa.computeFlucVec(wins, polOrd<span class="op">=</span>order, revSeg<span class="op">=</span>rev)    </span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># знаходимо показник альфа</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>    H_wind, _ <span class="op">=</span> pydfa.fitFlucVec()</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># знаходимо фрактальну розмірність        </span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>    D <span class="op">=</span> <span class="fl">2.</span> <span class="op">-</span> H_wind</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># показник спектральної щільності</span></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>    bi <span class="op">=</span> <span class="fl">2.</span> <span class="op">*</span> H_wind <span class="op">-</span> <span class="dv">1</span> </span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># показник автокореляції</span></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>    gi <span class="op">=</span> <span class="fl">2.</span> <span class="op">-</span> <span class="fl">2.</span> <span class="op">*</span> H_wind</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>    alpha.append(H_wind)</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>    D_f.append(D)</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>    beta.append(bi)</span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>    gamma.append(gi)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 5664/5664 [00:50&lt;00:00, 112.62it/s]</code></pre>
</div>
</div>
<p>Зберігаємо абсолютні значення показників до текстових файлів:</p>
<div id="cell-93" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>np.savetxt(<span class="ss">f"alpha_</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_ </span><span class="ch">\</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>order<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>win_beg<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>win_end<span class="sc">}</span><span class="ss">.txt"</span>, alpha)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>np.savetxt(<span class="ss">f"D_f_</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_ </span><span class="ch">\</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>order<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>win_beg<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>win_end<span class="sc">}</span><span class="ss">.txt"</span>, D_f)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>np.savetxt(<span class="ss">f"beta_</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_ </span><span class="ch">\</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>order<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>win_beg<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>win_end<span class="sc">}</span><span class="ss">.txt"</span>, beta)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>np.savetxt(<span class="ss">f"gamma_</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_ </span><span class="ch">\</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>order<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>win_beg<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>win_end<span class="sc">}</span><span class="ss">.txt"</span>, gamma)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Оголошуємо мітки для рисунків та назви збережених рисунків:</p>
<div id="cell-95" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>label_alpha <span class="op">=</span> <span class="vs">fr'$\alpha$'</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>label_d <span class="op">=</span> <span class="vs">fr'$D_f$'</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>label_beta <span class="op">=</span> <span class="vs">fr'$\beta$'</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>label_gamma <span class="op">=</span> <span class="vs">fr'$\gamma$'</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>file_name_alpha <span class="op">=</span> <span class="ss">f"alpha_</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_ </span><span class="ch">\</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>order<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>win_beg<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>win_end<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>file_name_d <span class="op">=</span> <span class="ss">f"D_f_</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_ </span><span class="ch">\</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>order<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>win_beg<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>win_end<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>file_name_beta <span class="op">=</span> <span class="ss">f"beta_</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_ </span><span class="ch">\</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>order<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>win_beg<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>win_end<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>file_name_gamma <span class="op">=</span> <span class="ss">f"gamma_</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_ </span><span class="ch">\</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="ss">            </span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>order<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>win_beg<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>win_end<span class="sc">}</span><span class="ss">"</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Виводимо результати:</p>
<div id="cell-fig-gold-wind-alpha" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>plot_pair(time_ser.index[window:length:tstep],</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>          time_ser.values[window:length:tstep],</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>          alpha, </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>          ylabel, </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>          label_alpha,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>          xlabel,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>          file_name_alpha)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-gold-wind-alpha" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gold-wind-alpha-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lab_6_files/figure-html/fig-gold-wind-alpha-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gold-wind-alpha-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Рис.&nbsp;6.6: Флуктуації ціни золота та показника альфа
</figcaption>
</figure>
</div>
</div>
</div>
<p>Якщо порівнювати з <em>R/S</em>-аналізом, <a href="#fig-gold-wind-alpha" class="quarto-xref">Рис.&nbsp;<span>6.6</span></a> демонструє, що DFA динаміка <em>узагальненого показника Херста</em> є набагато стабільнішою. Тепер ми здатні диференціювати значну частку крахових подій, що мали місце на ринку золота. Узагальнений Херст показує, що передкризові явища характеризуються зростанням трендостійкості ринку, підвищенням ступеня самоорганізації системи.</p>
<div id="cell-fig-gold-wind-df" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>plot_pair(time_ser.index[window:length:tstep],</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>          time_ser.values[window:length:tstep],</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>          D_f, </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>          ylabel, </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>          label_d,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>          xlabel,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>          file_name_d)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-gold-wind-df" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gold-wind-df-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lab_6_files/figure-html/fig-gold-wind-df-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gold-wind-df-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Рис.&nbsp;6.7: Коливання ціни золота та фрактальної розмірності
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-gold-wind-df" class="quarto-xref">Рис.&nbsp;<span>6.7</span></a> показує, що <span class="math inline">\(D_f\)</span> характеризується спадом при кризових станах. Це є індикатором того, що вищий ступень організованості ринку відзеркалюється в більш згладженій або менш волатильних флуктуаціях досліджуваного сигналу.</p>
<div id="cell-fig-gold-wind-beta" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>plot_pair(time_ser.index[window:length:tstep],</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>          time_ser.values[window:length:tstep],</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>          beta, </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>          ylabel, </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>          label_beta,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>          xlabel,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>          file_name_beta)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-gold-wind-beta" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gold-wind-beta-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lab_6_files/figure-html/fig-gold-wind-beta-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gold-wind-beta-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Рис.&nbsp;6.8: Динаміка ціни золота та показника спектральної щільності
</figcaption>
</figure>
</div>
</div>
</div>
<p>Спектральна густина потужності <span class="math inline">\(\beta\)</span> <a href="#eq-spec-dens" class="quarto-xref">Рівняння&nbsp;<span>6.5</span></a> зростає в кризові періоди, що свідчить про спад потужності сигналу на одиничному інтервалі частоти. Це також є свідченням зростання кореляційних властивостей системи.</p>
<div id="cell-fig-gold-wind-gamma" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>plot_pair(time_ser.index[window:length:tstep],</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>          time_ser.values[window:length:tstep],</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>          gamma, </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>          ylabel, </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>          label_gamma,</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>          xlabel,</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>          file_name_gamma)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-gold-wind-gamma" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gold-wind-gamma-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lab_6_files/figure-html/fig-gold-wind-gamma-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gold-wind-gamma-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Рис.&nbsp;6.9: Динаміка індексу золота та показника автокореляції
</figcaption>
</figure>
</div>
</div>
</div>
<p>З <a href="#fig-gold-wind-gamma" class="quarto-xref">Рис.&nbsp;<span>6.9</span></a> видно, що показник <span class="math inline">\(\gamma\)</span> спадає в кризові та передкризові періоди. Це є показником сповільнення спаду функції автокореляції, що в свою чергу також вказує на зростання корельованності динаміки системи.</p>
</section>
</section>
<section id="обчислення-фрактальної-розмірності-хігучі" class="level3" data-number="6.2.3">
<h3 data-number="6.2.3" class="anchored" data-anchor-id="обчислення-фрактальної-розмірності-хігучі"><span class="header-section-number">6.2.3</span> Обчислення фрактальної розмірності Хігучі</h3>
<p>Як уже зазначалося, фрактальна розмірність Хігучі є одним із різновидів фрактальної розмірності для часових рядів. Вона обчислюється шляхом реконструкції <span class="math inline">\(k_{max}\)</span> кількості нових наборів даних. Для кожного відновленого набору даних обчислюється довжина кривої і відкладається проти відповідного <span class="math inline">\(k_{max}\)</span>-значення в логарифмічній шкалі. HFD відповідає нахилу лінійного тренду за методом найменших квадратів.</p>
<p>Розрахуємо оптимальне значення <span class="math inline">\(k\)</span> для всього часового ряду. Бібліотека <code>neurokit2</code> представляє готову процедуру для автоматизованого підбору даного параметру. Оптимальний <span class="math inline">\(k_{max}\)</span> розраховується на основі точки, в якій значення фрактальної розмірності досягає плато для діапазону значень <span class="math inline">\(k_{max}\)</span> <span class="citation" data-cites="7168285">&nbsp;[<a href="references.html#ref-7168285" role="doc-biblioref">17</a>]</span>.</p>
<p>Синтаксис даної функції виглядає наступним чином:</p>
<p><strong><code>complexity_k(signal, k_max='max', show=False)</code></strong></p>
<p><strong>Параметри:</strong></p>
<ul>
<li><strong>signal</strong> (<em>Union[list, np.array, pd.Series]</em>) — сигнал (тобто часовий ряд) у вигляді вектора значень;</li>
<li><strong><span class="math inline">\(k_{max}\)</span></strong> (<em>Union[int, str, list], optional</em>) — максимальна кількість інтервалів (має бути більше або дорівнювати 3), які потрібно перевірити. Якщо <span class="math inline">\(k_{max}\)</span> = <code>default</code>, тоді вибирається максимально можливе значення, що відповідає половині довжини сигналу;</li>
<li><strong>show</strong> (<em>bool</em>) — візуалізовується нахил кривої для обраного значення <span class="math inline">\(k_{max}\)</span>.</li>
</ul>
<p><strong>Повертає:</strong></p>
<ul>
<li><strong>k</strong> (<em>float</em>) — оптимальний <span class="math inline">\(k_{max}\)</span> часового ряду;</li>
<li><strong>info</strong> (<em>dict</em>) — словник, що містить додаткову інформацію про параметри, які використовуються для обчислення оптимального <span class="math inline">\(k_{max}\)</span>.</li>
</ul>
<section id="для-всього-ряду-1" class="level4" data-number="6.2.3.1">
<h4 data-number="6.2.3.1" class="anchored" data-anchor-id="для-всього-ряду-1"><span class="header-section-number">6.2.3.1</span> Для всього ряду</h4>
<p>Для подальших розрахунків спочатку виконаємо перетворення ряду. Будемо використовувати вихідний часовий ряд для подальших розрахунків:</p>
<div id="cell-110" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>signal <span class="op">=</span> time_ser.copy()</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>ret_type <span class="op">=</span> <span class="dv">1</span>    <span class="co"># вид ряду: </span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 1 - вихідний, </span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 2 - детрендований (різниця між теп. значенням та попереднім)</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 3 - прибутковості звичайні, </span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 4 - стандартизовані прибутковості, </span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 5 - абсолютні значення (волатильності)</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 6 - стандартизований ряд</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>for_higuchi <span class="op">=</span> transformation(signal, ret_type) </span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>І тепер отримаємо оптимальне значення <span class="math inline">\(k_{max}\)</span> згідно зазначеної процедури:</p>
<div id="cell-fig-gold-kmax-all" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>k_max, info <span class="op">=</span> nk.complexity_k(for_higuchi, k_max<span class="op">=</span><span class="dv">100</span>, show<span class="op">=</span><span class="va">True</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-gold-kmax-all" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gold-kmax-all-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lab_6_files/figure-html/fig-gold-kmax-all-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gold-kmax-all-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Рис.&nbsp;6.10: Залежність розмірності Хігучі від діапазону значень kmax
</figcaption>
</figure>
</div>
</div>
</div>
<p>Тепер побудуємо залежність довжини сигналу від часового зміщення в логарифмічному масштабі. Для фрактального сигналу має зберігатися лінійна залежність. Бібліотека <code>neurokit2</code> містить метод для розрахунку даної фрактальної розмірності. Синтаксис цієї процедури виглядає наступним чином:</p>
<p><strong><code>fractal_higuchi(signal, k_max='default', show=False, **kwargs)</code></strong></p>
<p><strong>Параметри:</strong></p>
<ul>
<li><strong>signal</strong> (<em>Union[list, np.array, pd.Series]</em>) — сигнал (тобто часовий ряд) у вигляді вектора значень;</li>
<li><strong><span class="math inline">\(k_{max}\)</span></strong> (<em>Union[int, str, list], optional</em>) — максимальна кількість інтервалів (має бути більше або дорівнювати 3), які потрібно перевірити;</li>
<li><strong>show</strong> (<em>bool</em>) — візуалізовується нахил кривої для обраного значення <span class="math inline">\(k_{max}\)</span>.</li>
</ul>
<p><strong>Повертає:</strong></p>
<ul>
<li><strong>HFD</strong> (<em>float</em>) — фрактальна розмірність Хігучі для досліджуваного часового ряду;</li>
<li><strong>info</strong> (<em>dict</em>) — словник, що містить додаткову інформацію про параметри, які використовуються для обчислення фрактальної розмірності Хігучі.</li>
</ul>
<div id="cell-fig-gold-higuchi-all" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>hfd, info <span class="op">=</span> nk.fractal_higuchi(for_higuchi, k_max<span class="op">=</span>k_max, show<span class="op">=</span><span class="va">True</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-gold-higuchi-all" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gold-higuchi-all-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lab_6_files/figure-html/fig-gold-higuchi-all-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gold-higuchi-all-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Рис.&nbsp;6.11: Залежність довжини сигналу від часового зміщення
</figcaption>
</figure>
</div>
</div>
</div>
<p>У подальшому будемо послуговуватись отриманим оптимальним значенням для розрахунку розмірності Хігучі в рамках алгоритму ковзного вікна.</p>
</section>
<section id="віконна-процедура-2" class="level4" data-number="6.2.3.2">
<h4 data-number="6.2.3.2" class="anchored" data-anchor-id="віконна-процедура-2"><span class="header-section-number">6.2.3.2</span> Віконна процедура</h4>
<p>Скористаємось наступними параметрами:</p>
<div id="cell-119" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>window <span class="op">=</span> <span class="dv">250</span>    <span class="co"># розмір вікна</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>tstep <span class="op">=</span> <span class="dv">1</span>       <span class="co"># крок вікна</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>ret_type <span class="op">=</span> <span class="dv">1</span>    <span class="co"># вид ряду: </span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 1 - вихідний, </span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 2 - детрендований (різниця між теп. значенням </span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>                                                <span class="co"># та попереднім)</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 3 - прибутковості звичайні, </span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 4 - стандартизовані прибутковості, </span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 5 - абсолютні значення (волатильності)</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 6 - стандартизований ряд</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>k_max_wind <span class="op">=</span> <span class="dv">30</span>                    <span class="co"># максимальне часове зміщення</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>length <span class="op">=</span> <span class="bu">len</span>(time_ser.values)      <span class="co"># довжина ряду</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>hfd_wind <span class="op">=</span> []                      <span class="co"># масив показників Хігучі</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Розпочинаємо віконну процедуру:</p>
<div id="cell-121" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> tqdm(<span class="bu">range</span>(<span class="dv">0</span>,length<span class="op">-</span>window,tstep)):</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># відбираємо фрагменти</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    fragm <span class="op">=</span> time_ser.iloc[i:i<span class="op">+</span>window].copy()  </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># виконуємо процедуру трансформації ряду </span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    fragm <span class="op">=</span> transformation(fragm, ret_type)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># розраховуємо фрактальну розмірність Хігучі</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    higuchi, _ <span class="op">=</span> nk.fractal_higuchi(fragm, </span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>                                    k_max<span class="op">=</span>k_max_wind, </span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>                                    show<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># зберігаємо результат до масиву значень</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>    hfd_wind.append(higuchi)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 5664/5664 [00:14&lt;00:00, 401.59it/s]</code></pre>
</div>
</div>
<p>Зберігаємо вихідні значення до текстового документа:</p>
<div id="cell-123" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>np.savetxt(<span class="ss">f"fd_higuchi_name=</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_kmax=</span><span class="sc">{</span>k_max_wind<span class="sc">}</span><span class="ss">_</span><span class="ch">\</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="ss">           wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">.txt"</span>, hfd_wind)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Оголошуємо мітки для рисунків та назви збережених рисунків:</p>
<div id="cell-125" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>label_higuchi <span class="op">=</span> <span class="vs">fr'$HFD$'</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>file_name_higuchi <span class="op">=</span> <span class="ss">f"fd_higuchi_name=</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_kmax=</span><span class="sc">{</span>k_max_wind<span class="sc">}</span><span class="ss">_</span><span class="ch">\</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="ss">           wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">"</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Виводимо результат:</p>
<div id="cell-fig-gold-wind-higuchi" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>plot_pair(time_ser.index[window:length:tstep],</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>          time_ser.values[window:length:tstep],</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>          hfd_wind, </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>          ylabel, </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>          label_higuchi,</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>          xlabel,</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>          file_name_higuchi)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-gold-wind-higuchi" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gold-wind-higuchi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lab_6_files/figure-html/fig-gold-wind-higuchi-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gold-wind-higuchi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Рис.&nbsp;6.12: Динаміка індексу золота та фрактальної розмірності Хігучі
</figcaption>
</figure>
</div>
</div>
</div>
<p>Як можна бачити з представленого рисунку, фрактальна розмірність Хігучі може працювати як індикатор або індикатор-передвісник кризових явищ. Видно, що даний показник починає спадати у передкризові періоди чи у сам момент кризи, вказуючи на зростання згладженності динаміки системи, ступеня кореляцій та трендостійкості динаміки ринку.</p>
</section>
</section>
<section id="обчислення-фрактальної-розмірності-петросяна" class="level3" data-number="6.2.4">
<h3 data-number="6.2.4" class="anchored" data-anchor-id="обчислення-фрактальної-розмірності-петросяна"><span class="header-section-number">6.2.4</span> Обчислення фрактальної розмірності Петросяна</h3>
<p>Петросян <span class="citation" data-cites="465426">&nbsp;[<a href="references.html#ref-465426" role="doc-biblioref">18</a>]</span> запропонував швидкий метод оцінки фрактальної розмірності шляхом перетворення сигналу в двійкову послідовність, з якої оцінюється фрактальна розмірність. Існує кілька варіацій алгоритму (<code>neurokit2</code>, наприклад, пропонує варіанти <code>"A"</code>, <code>"B"</code>, <code>"C"</code> або <code>"D"</code>), що відрізняються насамперед способом створення дискретної (символьної) послідовності (див. <code>complexity_symbolize()</code> для деталей). Найпоширеніший метод (<code>"C"</code>, за замовчуванням) бінаризує сигнал за знаком послідовних різниць.</p>
<p>Більшість з цих методів дискретизації припускають, що сигнал є періодичним (без лінійного тренду). Для усунення лінійних трендів може бути корисним лінійне детрендування.</p>
<p>Синтаксис даної процедури має наступний вигляд:</p>
<p><strong><code>fractal_petrosian(signal, symbolize='C', show=False)</code></strong></p>
<p><strong>Параметри:</strong></p>
<ul>
<li><strong>signal</strong> (<em>Union[list, np.array, pd.Series]</em>) — сигнал (тобто часовий ряд) у вигляді вектора значень;</li>
<li><strong>symbolize</strong> (<em>str</em>) - метод перетворення неперервного вхідного сигналу в символьний (дискретний) сигнал. За замовчуванням присвоює 0 та 1 значенням нижче та вище середнього. Може мати значення <code>None</code>, що припускає дискретність вхідного сигналу;</li>
<li><strong>show</strong> (<em>bool</em>) — виводить дискретизацію сигналу.</li>
</ul>
<p><strong>Повертає:</strong></p>
<ul>
<li><strong>PFD</strong> (<em>float</em>) — фрактальна розмірність Петросяна для досліджуваного часового ряду;</li>
<li><strong>info</strong> (<em>dict</em>) — словник, що містить додаткову інформацію про параметри, які використовуються для обчислення фрактальної розмірності Петросяна.</li>
</ul>
<p>Ми не розглядатимемо детально синтаксис функції <code>complexity_symbolize()</code>. Опишемо лише ті методи дискретизації, що дотичні до фрактальної розмірності Петросяна:</p>
<ul>
<li><strong>метод <code>A</code></strong> бінаризує сигнал за більшими та меншими значеннями порівняно із середнім значенням сигналу. Еквівалентом є <code>method="mean"</code> (<code>method="median"</code> також є допустимим);</li>
<li><strong>метод <code>B</code></strong> використовує значення, що знаходяться в діапазоні <span class="math inline">\(\pm 1\sigma\)</span>, проти значень, що виходять за межі цього діапазону;</li>
<li><strong>метод <code>C</code></strong> обчислює різницю між послідовними вибірками та бінаризує їх залежно від знаку;</li>
<li><strong>метод <code>D</code></strong> відокремлює послідовні відліки, що перевищують <span class="math inline">\(1\sigma\)</span> сигналу, від інших менших змін.</li>
</ul>
<p>Тепер розглянемо віконну динаміку показника.</p>
<section id="віконна-процедура-3" class="level4" data-number="6.2.4.1">
<h4 data-number="6.2.4.1" class="anchored" data-anchor-id="віконна-процедура-3"><span class="header-section-number">6.2.4.1</span> Віконна процедура</h4>
<p>Оскільки більшість з даних методів дискретизації вимагають детрендування ряду, будемо виконувати розрахунки для прибутковостей ціни золота. Скористаємось наступними параметрами:</p>
<div id="cell-136" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>window <span class="op">=</span> <span class="dv">250</span>    <span class="co"># розмір вікна</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>tstep <span class="op">=</span> <span class="dv">1</span>       <span class="co"># крок вікна</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>ret_type <span class="op">=</span> <span class="dv">4</span>    <span class="co"># вид ряду: </span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 1 - вихідний, </span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 2 - детрендований (різниця між теп. значенням </span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>                                                <span class="co"># та попереднім)</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 3 - прибутковості звичайні, </span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 4 - стандартизовані прибутковості, </span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 5 - абсолютні значення (волатильності)</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 6 - стандартизований ряд</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>symb <span class="op">=</span> <span class="st">"B"</span>                    <span class="co"># тип дискретизації ряду</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>length <span class="op">=</span> <span class="bu">len</span>(time_ser.values) <span class="co"># довжина ряду</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>petr_wind <span class="op">=</span> []                 <span class="co"># масив показників Петросяна</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Розпочинаємо віконну процедуру:</p>
<div id="cell-138" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> tqdm(<span class="bu">range</span>(<span class="dv">0</span>,length<span class="op">-</span>window,tstep)):</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># відбираємо фрагменти</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    fragm <span class="op">=</span> time_ser.iloc[i:i<span class="op">+</span>window].copy()  </span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># виконуємо процедуру трансформації ряду </span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    fragm <span class="op">=</span> transformation(fragm, ret_type)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># розраховуємо фрактальну розмірність Петросяна</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>    petrocian, _ <span class="op">=</span> nk.fractal_petrosian(fragm, </span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>                                        symbolize<span class="op">=</span>symb, </span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>                                        show<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># зберігаємо результат до масиву значень</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>    petr_wind.append(petrocian)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code> 89%|████████▉ | 5036/5664 [00:04&lt;00:00, 1195.36it/s]100%|██████████| 5664/5664 [00:04&lt;00:00, 1210.50it/s]</code></pre>
</div>
</div>
<p>Зберігаємо вихідні значення до текстового документа:</p>
<div id="cell-140" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>np.savetxt(<span class="ss">f"fd_petrosian_name=</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_method=</span><span class="sc">{</span>symb<span class="sc">}</span><span class="ss">_</span><span class="ch">\</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="ss">           wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">.txt"</span>, petr_wind)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Оголошуємо мітки для рисунків та назви збережених рисунків:</p>
<div id="cell-142" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>label_petrocian <span class="op">=</span> <span class="vs">fr'$PFD$'</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>file_name_petrocian <span class="op">=</span> <span class="ss">f"fd_petrosian_name=</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_method=</span><span class="sc">{</span>symb<span class="sc">}</span><span class="ss">_</span><span class="ch">\</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="ss">           wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">"</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Виводимо результат:</p>
<div id="cell-fig-gold-wind-petro" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>plot_pair(time_ser.index[window:length:tstep],</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>          time_ser.values[window:length:tstep],</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>          petr_wind, </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>          ylabel, </span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>          label_petrocian,</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>          xlabel,</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>          file_name_petrocian)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-gold-wind-petro" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gold-wind-petro-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lab_6_files/figure-html/fig-gold-wind-petro-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gold-wind-petro-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Рис.&nbsp;6.13: Динаміка ціни золота та фрактальної розмірності Петросяна
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-gold-wind-petro" class="quarto-xref">Рис.&nbsp;<span>6.13</span></a> показує, що показник Петросяна також спадає під час кризових подій і вказує на зростання періодизації ринку та синхронізації активності трейдерів у відповідні моменти часу.</p>
</section>
</section>
<section id="обчислення-фрактальної-розмірності-каца" class="level3" data-number="6.2.5">
<h3 data-number="6.2.5" class="anchored" data-anchor-id="обчислення-фрактальної-розмірності-каца"><span class="header-section-number">6.2.5</span> Обчислення фрактальної розмірності Каца</h3>
<p>Обчислимо фрактальну розмірність Каца. Евклідові відстані між послідовними точками сигналу підсумовуються і усереднюються, а також визначається максимальна відстань між початковою точкою і будь-якою іншою точкою у вибірці.</p>
<p>Фрактальна розмірність варіюється від 1.0 для прямих ліній, приблизно до 1.15 для випадкових блукань і наближається до 1.5 для найбільш “дивних” форм сигналу.</p>
<p>Синтаксис процедури для розрахунку даної розмірності виглядає наступним чином:</p>
<p><strong><code>fractal_katz(signal)</code></strong></p>
<p><strong>Параметри:</strong></p>
<ul>
<li><strong>signal</strong> (<em>Union[list, np.array, pd.Series]</em>) — сигнал (тобто часовий ряд) у вигляді вектора значень.</li>
</ul>
<p><strong>Повертає:</strong></p>
<ul>
<li><strong>KFD</strong> (<em>float</em>) — фрактальна розмірність Каца для досліджуваного часового ряду;</li>
<li><strong>info</strong> (<em>dict</em>) — словник, що містить додаткову інформацію (наразі порожній, але повертається для узгодженості з іншими функціями).</li>
</ul>
<section id="віконна-процедура-4" class="level4" data-number="6.2.5.1">
<h4 data-number="6.2.5.1" class="anchored" data-anchor-id="віконна-процедура-4"><span class="header-section-number">6.2.5.1</span> Віконна процедура</h4>
<p>Оскільки даний показник є параметронезалежним, нам достатньо буде лише розміру часового вікна, кроку та типу ряду:</p>
<div id="cell-151" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>window <span class="op">=</span> <span class="dv">250</span>    <span class="co"># розмір вікна</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>tstep <span class="op">=</span> <span class="dv">1</span>       <span class="co"># крок вікна</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>ret_type <span class="op">=</span> <span class="dv">1</span>    <span class="co"># вид ряду: </span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 1 - вихідний, </span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 2 - детрендований (різниця між теп. значенням </span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>                                                <span class="co"># та попереднім)</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 3 - прибутковості звичайні, </span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 4 - стандартизовані прибутковості, </span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 5 - абсолютні значення (волатильності)</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 6 - стандартизований ряд</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>length <span class="op">=</span> <span class="bu">len</span>(time_ser.values)      <span class="co"># довжина ряду</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>kz_wind <span class="op">=</span> []                      <span class="co"># масив показників Каца</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Розпочинаємо віконну процедуру:</p>
<div id="cell-153" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> tqdm(<span class="bu">range</span>(<span class="dv">0</span>,length<span class="op">-</span>window,tstep)):</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># відбираємо фрагменти</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    fragm <span class="op">=</span> time_ser.iloc[i:i<span class="op">+</span>window].copy()  </span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># виконуємо процедуру трансформації ряду </span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    fragm <span class="op">=</span> transformation(fragm, ret_type)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># розраховуємо фрактальну розмірність Хігучі</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>    katz, _ <span class="op">=</span> nk.fractal_katz(fragm)</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># зберігаємо результат до масиву значень</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>    kz_wind.append(katz)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 5664/5664 [00:01&lt;00:00, 5211.83it/s]</code></pre>
</div>
</div>
<p>Зберігаємо вихідні значення до текстового документа:</p>
<div id="cell-155" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>np.savetxt(<span class="ss">f"fd_katz_name=</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">.txt"</span>, kz_wind)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Оголошуємо мітки для рисунків та назви збережених рисунків:</p>
<div id="cell-157" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>label_katz <span class="op">=</span> <span class="vs">fr'$KFD$'</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>file_name_katz <span class="op">=</span> <span class="ss">f"fd_katz_name=</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">"</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Виводимо результат:</p>
<div id="cell-fig-gold-wind-katz" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>plot_pair(time_ser.index[window:length:tstep],</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>          time_ser.values[window:length:tstep],</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>          kz_wind, </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>          ylabel, </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>          label_katz,</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>          xlabel,</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>          file_name_katz)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-gold-wind-katz" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gold-wind-katz-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lab_6_files/figure-html/fig-gold-wind-katz-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gold-wind-katz-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Рис.&nbsp;6.14: Динаміка ціни золота та фрактальної розмірності Каца
</figcaption>
</figure>
</div>
</div>
</div>
<p>З рисунку видно, що фрактальна розмірність Каца також спадає у кризові та передкризові періоди і також є індикатором зростання ступеня корельованості системи в дані періоди.</p>
</section>
</section>
<section id="обчислення-фрактальної-розмірності-шевчика" class="level3" data-number="6.2.6">
<h3 data-number="6.2.6" class="anchored" data-anchor-id="обчислення-фрактальної-розмірності-шевчика"><span class="header-section-number">6.2.6</span> Обчислення фрактальної розмірності Шевчика</h3>
<p>Алгоритм цієї фрактальної розмірності був запропонований для обчислення фрактальної розмірності сигналів Шевчиком <span class="citation" data-cites="sevcik2010procedure">&nbsp;[<a href="references.html#ref-sevcik2010procedure" role="doc-biblioref">22</a>]</span>. Цей метод можна використовувати для швидкого вимірювання складності сигналу.</p>
<p>Синтаксис методу:</p>
<p><strong><code>fractal_sevcik(signal)</code></strong></p>
<p><strong>Параметри</strong></p>
<ul>
<li><strong>signal</strong> (<em>Union[list, np.array, pd.Series]</em>) — сигнал (тобто часовий ряд) у вигляді вектора значень.</li>
</ul>
<p><strong>Повертає</strong></p>
<ul>
<li><strong>SFD</strong> (<em>float</em>) — фрактальна розмірність Севчика для досліджуваного часового ряду;</li>
<li><strong>info</strong> (<em>dict</em>) — словник, що містить додаткову інформацію (наразі порожній, але повертається для узгодженості з іншими функціями).</li>
</ul>
<section id="віконна-процедура-5" class="level4" data-number="6.2.6.1">
<h4 data-number="6.2.6.1" class="anchored" data-anchor-id="віконна-процедура-5"><span class="header-section-number">6.2.6.1</span> Віконна процедура</h4>
<div id="cell-165" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>window <span class="op">=</span> <span class="dv">250</span>    <span class="co"># розмір вікна</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>tstep <span class="op">=</span> <span class="dv">1</span>       <span class="co"># крок вікна</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>ret_type <span class="op">=</span> <span class="dv">1</span>    <span class="co"># вид ряду: </span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 1 - вихідний, </span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 2 - детрендований (різниця між теп. значенням </span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>                                                <span class="co"># та попереднім)</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 3 - прибутковості звичайні, </span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 4 - стандартизовані прибутковості, </span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 5 - абсолютні значення (волатильності)</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 6 - стандартизований ряд</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>length <span class="op">=</span> <span class="bu">len</span>(time_ser.values)      <span class="co"># довжина ряду</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>sfd_wind <span class="op">=</span> []                      <span class="co"># масив показників Севчика</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Розпочинаємо віконну процедуру:</p>
<div id="cell-167" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> tqdm(<span class="bu">range</span>(<span class="dv">0</span>,length<span class="op">-</span>window,tstep)):</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># відбираємо фрагменти</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    fragm <span class="op">=</span> time_ser.iloc[i:i<span class="op">+</span>window].copy()  </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># виконуємо процедуру трансформації ряду </span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>    fragm <span class="op">=</span> transformation(fragm, ret_type)</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># розраховуємо фрактальну розмірність Севчика</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>    sevcik, _ <span class="op">=</span> nk.fractal_sevcik(fragm)</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># зберігаємо результат до масиву значень</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>    sfd_wind.append(sevcik)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 5664/5664 [00:01&lt;00:00, 4451.83it/s]</code></pre>
</div>
</div>
<p>Зберігаємо вихідні значення до текстового документа:</p>
<div id="cell-169" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>np.savetxt(<span class="ss">f"fd_cevcik_name=</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">.txt"</span>, sfd_wind)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Оголошуємо мітки для рисунків та назви збережених рисунків:</p>
<div id="cell-171" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>label_sevcik <span class="op">=</span> <span class="vs">fr'$SFD$'</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>file_name_sevcik <span class="op">=</span> <span class="ss">f"fd_cevcik_name=</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">"</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Виводимо результат:</p>
<div id="cell-fig-gold-wind-sevcik" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>plot_pair(time_ser.index[window:length:tstep],</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>          time_ser.values[window:length:tstep],</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>          sfd_wind, </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>          ylabel, </span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>          label_sevcik,</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>          xlabel,</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>          file_name_sevcik)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-gold-wind-sevcik" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gold-wind-sevcik-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lab_6_files/figure-html/fig-gold-wind-sevcik-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gold-wind-sevcik-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Рис.&nbsp;6.15: Динаміка ціни золота та фрактальної розмірності Шевчика
</figcaption>
</figure>
</div>
</div>
</div>
<p>Бачимо, що фрактальна розмірність Шевчика реагує спадом на крахові події на ринку золота. Особливо характерними є спади під час криз 2008, 2011, 2015 та 2020 років. Цінові флуктуації золота під час зазначених кризових подій також характеризувалися зростанням персистентності (кореляцій).</p>
</section>
</section>
<section id="обчислення-фрактальної-розмірності-через-нормалізовану-щільність-довжини" class="level3" data-number="6.2.7">
<h3 data-number="6.2.7" class="anchored" data-anchor-id="обчислення-фрактальної-розмірності-через-нормалізовану-щільність-довжини"><span class="header-section-number">6.2.7</span> Обчислення фрактальної розмірності через нормалізовану щільність довжини</h3>
<p>Це доволі простий показник, що відповідає середнім абсолютним послідовним різницям (стандартизованого) сигналу (<code>np.mean(np.abs(np.diff(std_signal)))</code>). Метод було розроблено для вимірювання складності сигналів дуже короткої тривалості (&lt; 30 відліків), і його можна використовувати, наприклад, коли цікавлять неперервні зміни фрактальної розмірності сигналу при обчисленні в межах ковзних вікон.</p>
<p>Синтаксис процедури:</p>
<p><strong><code>fractal_nld(signal, corrected=False)</code></strong></p>
<p><strong>Параметри:</strong></p>
<ul>
<li><strong>signal</strong> (<em>Union[list, np.array, pd.Series]</em>) — сигнал (тобто часовий ряд) у вигляді вектора значень;</li>
<li><strong>corrected</strong> (<em>bool</em>) — якщо значення <code>True</code>, змінює масштаб вихідного значення фрактальної розмірності відповідно до степеневої моделі, щоб зробити його більш порівнянним з “істинним” значенням: <code>FD = 1.9079*((NLD-0.097178)^0.18383)</code>. Зауважте, що це може призвести до <code>np.nan</code>, якщо результат різниці буде від’ємним.</li>
</ul>
<p><strong>Повертає:</strong></p>
<ul>
<li><strong>NLDFD</strong> (<em>float</em>) — фрактальна розмірність;</li>
<li><strong>info</strong> (<em>dict</em>) — словник із додатковою інформацією по розрахункам.</li>
</ul>
<section id="віконна-процедура-6" class="level4" data-number="6.2.7.1">
<h4 data-number="6.2.7.1" class="anchored" data-anchor-id="віконна-процедура-6"><span class="header-section-number">6.2.7.1</span> Віконна процедура</h4>
<p>Для цього показника нам також не потребується нічого зайвого:</p>
<div id="cell-180" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>window <span class="op">=</span> <span class="dv">250</span>    <span class="co"># розмір вікна</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>tstep <span class="op">=</span> <span class="dv">1</span>       <span class="co"># крок вікна</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>ret_type <span class="op">=</span> <span class="dv">4</span>    <span class="co"># вид ряду: </span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 1 - вихідний, </span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 2 - детрендований (різниця між теп. значенням </span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>                                                <span class="co"># та попереднім)</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 3 - прибутковості звичайні, </span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 4 - стандартизовані прибутковості, </span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 5 - абсолютні значення (волатильності)</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 6 - стандартизований ряд</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>nld_corrected <span class="op">=</span> <span class="va">True</span>               <span class="co"># нормалізація фрактальної розмірності</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>length <span class="op">=</span> <span class="bu">len</span>(time_ser.values)      <span class="co"># довжина ряду</span></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>nldfd_wind <span class="op">=</span> []                    <span class="co"># масив показників </span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Розпочинаємо віконну процедуру:</p>
<div id="cell-182" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> tqdm(<span class="bu">range</span>(<span class="dv">0</span>,length<span class="op">-</span>window,tstep)):</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># відбираємо фрагменти</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>    fragm <span class="op">=</span> time_ser.iloc[i:i<span class="op">+</span>window].copy()  </span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># виконуємо процедуру трансформації ряду </span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>    fragm <span class="op">=</span> transformation(fragm, ret_type)</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># розраховуємо фрактальну розмірність </span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>    nld, _ <span class="op">=</span> nk.fractal_nld(fragm, </span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>                            corrected<span class="op">=</span>nld_corrected)</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># зберігаємо результат до масиву значень</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>    nldfd_wind.append(nld)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code> 65%|██████▌   | 3683/5664 [00:02&lt;00:01, 1270.52it/s]100%|██████████| 5664/5664 [00:04&lt;00:00, 1240.46it/s]</code></pre>
</div>
</div>
<p>Зберігаємо вихідні значення до текстового документа:</p>
<div id="cell-184" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>np.savetxt(<span class="ss">f"fd_nld_name=</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_</span><span class="ch">\</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="ss">           step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_corrected=</span><span class="sc">{</span>nld_corrected<span class="sc">}</span><span class="ss">.txt"</span>, nldfd_wind)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Оголошуємо мітки для рисунків та назви збережених рисунків:</p>
<div id="cell-186" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>label_nld <span class="op">=</span> <span class="vs">fr'$NLDFD$'</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>file_name_nld <span class="op">=</span> <span class="ss">f"fd_nld_name=</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_</span><span class="ch">\</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="ss">                step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_corrected=</span><span class="sc">{</span>nld_corrected<span class="sc">}</span><span class="ss">"</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Виводимо результат:</p>
<div id="cell-fig-gold-wind-nld" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>plot_pair(time_ser.index[window:length:tstep],</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>          time_ser.values[window:length:tstep],</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>          nldfd_wind, </span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>          ylabel, </span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>          label_nld,</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>          xlabel,</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>          file_name_nld)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-gold-wind-nld" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gold-wind-nld-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lab_6_files/figure-html/fig-gold-wind-nld-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gold-wind-nld-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Рис.&nbsp;6.16: Динаміка ціни золота та фрактальної розмірності через нормалізовану щільність довжини
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-gold-wind-nld" class="quarto-xref">Рис.&nbsp;<span>6.16</span></a> показує, що <span class="math inline">\(NLDFD\)</span> спадає під час кризових та передкризових подій, що свідчить про зростання кореляцій у дані періоди.</p>
</section>
</section>
<section id="обчислення-фрактальної-розмірності-через-нахил-спектральної-щільності-потужності" class="level3" data-number="6.2.8">
<h3 data-number="6.2.8" class="anchored" data-anchor-id="обчислення-фрактальної-розмірності-через-нахил-спектральної-щільності-потужності"><span class="header-section-number">6.2.8</span> Обчислення фрактальної розмірності через нахил спектральної щільності потужності</h3>
<p>Скористаємось наступним методом бібліотеки <code>neurokit2</code>:</p>
<p><strong><code>fractal_psdslope(signal, method='voss1988', show=False, **kwargs)</code></strong></p>
<p><strong>Параметри:</strong></p>
<ul>
<li><strong>signal</strong> (<em>Union[list, np.array, pd.Series]</em>) — сигнал (тобто часовий ряд) у вигляді вектора значень;</li>
<li><strong>method</strong> (<em>str</em>) — метод оцінки фрактальної розмірності за нахилом, може бути <code>"voss1988"</code> (за замовчуванням) або <code>"hasselman2013"</code>;</li>
<li><strong>show</strong> (<em>bool</em>) — якщо значення <code>True</code>, повертає графік залежності спектральної щільності потужності від частоти в логарифмічному масштабі;</li>
<li><strong>kwargs</strong> — інші аргументи, які слід передати до <code>signal_psd()</code>.</li>
</ul>
<p><strong>Повертає:</strong></p>
<ul>
<li><strong>slope</strong> (<em>float</em>) — оцінка фрактальної розмірності, отримана в результаті аналізу нахилу спектральної щільності потужності;</li>
<li><strong>info</strong> (<em>dict</em>) — словник, що містить додаткову інформацію про параметри, які використовуються для аналізу нахилу спектральної щільності потужності.</li>
</ul>
<section id="для-всього-ряду-2" class="level4" data-number="6.2.8.1">
<h4 data-number="6.2.8.1" class="anchored" data-anchor-id="для-всього-ряду-2"><span class="header-section-number">6.2.8.1</span> Для всього ряду</h4>
<p>Для подальших розрахунків спочатку виконаємо перетворення ряду. Будемо використовувати вихідний часовий ряд для подальших розрахунків:</p>
<div id="cell-195" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>signal <span class="op">=</span> time_ser.copy()</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>ret_type <span class="op">=</span> <span class="dv">1</span>    <span class="co"># вид ряду: </span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 1 - вихідний, </span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 2 - детрендований (різниця між теп. значенням та попереднім)</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 3 - прибутковості звичайні, </span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 4 - стандартизовані прибутковості, </span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 5 - абсолютні значення (волатильності)</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 6 - стандартизований ряд</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>for_psd <span class="op">=</span> transformation(signal, ret_type) </span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>І тепер виведемо графік залежності спектральної щільності потужності від частоти в логарифмічному масштабі:</p>
<div id="cell-fig-gold-psd-all" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>psdslope, info <span class="op">=</span> nk.fractal_psdslope(for_psd,</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>                                     method<span class="op">=</span><span class="st">"voss1988"</span>,</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>                                     show<span class="op">=</span><span class="va">True</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-gold-psd-all" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gold-psd-all-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lab_6_files/figure-html/fig-gold-psd-all-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gold-psd-all-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Рис.&nbsp;6.17: Залежність спектральної щільності потужності від частоти в логарифмічному масштабі
</figcaption>
</figure>
</div>
</div>
</div>
<p>Очевидно, нахил спектральної щільності потужності на різних частотах має лінійну залежність, а кут нахилу прямої побудованої за спектром, близький до -2, що вказує на те, що динаміка індексу золота близька до дробового броунівського руху.</p>
<p>Тепер розглянемо варіацію кута нахилу спектра в рамках алгоритму ковзного вікна.</p>
</section>
<section id="віконна-процедура-7" class="level4" data-number="6.2.8.2">
<h4 data-number="6.2.8.2" class="anchored" data-anchor-id="віконна-процедура-7"><span class="header-section-number">6.2.8.2</span> Віконна процедура</h4>
<p>Встановимо наступні параметри:</p>
<div id="cell-201" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>window <span class="op">=</span> <span class="dv">250</span>    <span class="co"># розмір вікна</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>tstep <span class="op">=</span> <span class="dv">1</span>       <span class="co"># крок вікна</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>ret_type <span class="op">=</span> <span class="dv">4</span>    <span class="co"># вид ряду: </span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 1 - вихідний, </span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 2 - детрендований (різниця між теп. значенням </span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>                                                <span class="co"># та попереднім)</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 3 - прибутковості звичайні, </span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 4 - стандартизовані прибутковості, </span></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 5 - абсолютні значення (волатильності)</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 6 - стандартизований ряд</span></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>method_psd <span class="op">=</span> <span class="st">"voss1988"</span>        <span class="co"># метод для розрахунку</span></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>                               <span class="co"># спектральної щільності</span></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>length <span class="op">=</span> <span class="bu">len</span>(time_ser.values)  <span class="co"># довжина ряду</span></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>psd_wind <span class="op">=</span> []                  <span class="co"># масив показників </span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Розпочинаємо віконну процедуру:</p>
<div id="cell-203" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> tqdm(<span class="bu">range</span>(<span class="dv">0</span>,length<span class="op">-</span>window,tstep)):</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># відбираємо фрагменти</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>    fragm <span class="op">=</span> time_ser.iloc[i:i<span class="op">+</span>window].copy()  </span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># виконуємо процедуру трансформації ряду </span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>    fragm <span class="op">=</span> transformation(fragm, ret_type)</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># розраховуємо фрактальну розмірність </span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>    psd, _ <span class="op">=</span> nk.fractal_psdslope(fragm, method<span class="op">=</span>method_psd)</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># зберігаємо результат до масиву значень</span></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>    psd_wind.append(psd)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 5664/5664 [00:13&lt;00:00, 408.69it/s]</code></pre>
</div>
</div>
<p>Зберігаємо вихідні значення до текстового документа:</p>
<div id="cell-205" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>np.savetxt(<span class="ss">f"fd_psd_name=</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_method</span><span class="sc">{</span>method_psd<span class="sc">}</span><span class="ss">_</span><span class="ch">\</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="ss">           wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">.txt"</span>, psd_wind)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Оголошуємо мітки для рисунків та назви збережених рисунків:</p>
<div id="cell-207" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>label_psd <span class="op">=</span> <span class="vs">fr'$PSDFD$'</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>file_name_psd <span class="op">=</span> <span class="ss">f"fd_psd_name=</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_method</span><span class="sc">{</span>method_psd<span class="sc">}</span><span class="ss">_</span><span class="ch">\</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="ss">                wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">"</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Виводимо результат:</p>
<div id="cell-fig-gold-wind-psd" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>plot_pair(time_ser.index[window:length:tstep],</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>          time_ser.values[window:length:tstep],</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>          psd_wind, </span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>          ylabel, </span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>          label_psd,</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>          xlabel,</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>          file_name_psd)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-gold-wind-psd" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gold-wind-psd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lab_6_files/figure-html/fig-gold-wind-psd-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gold-wind-psd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Рис.&nbsp;6.18: Флуктуації ціни золота та фрактальної розмірності за нахилом спектральної щільності потужності
</figcaption>
</figure>
</div>
</div>
</div>
<p>Рисунок вище показує, що даний показник також реагує спадом на кризові та передкризові події, вказуючи на зростання автокореляції часового ряду. Також зрозуміло, що має місце варіації нахилу спектра щільності потужності. В одні моменти часу динаміка сигналу може бути подібна до броунівського руху, а в інші до білого шуму.</p>
</section>
</section>
<section id="обчислення-кореляційної-розмірності" class="level3" data-number="6.2.9">
<h3 data-number="6.2.9" class="anchored" data-anchor-id="обчислення-кореляційної-розмірності"><span class="header-section-number">6.2.9</span> Обчислення кореляційної розмірності</h3>
<p>Кореляційна розмірність є нижньою границею оцінки фрактальної розмірності досліджуваного фазового простору.</p>
<p>Спочатку здійснюється реконструкція фазового простору сигналу згідно методу часової затримки, і далі обчислюються відстані між усіма точками траєкторії. Потім обчислюється “кореляційна сума”, яка є часткою пар точок, відстань між якими менша за заданий радіус. Остаточна кореляційна розмірність апроксимується графіком залежності кореляційної суми від радіусу багатовимірного околу досліджуваних траєкторій у логарифмічному масштабі.</p>
<p>Цю розмірність можна викликати через <code>fractal_correlation()</code>. Її синтаксис виглядає наступним чином:</p>
<p><strong><code>fractal_correlation(signal, delay=1, dimension=2, radius=64, show=False, **kwargs)</code></strong></p>
<p><strong>Параметри:</strong></p>
<ul>
<li><strong>signal</strong> (<em>Union[list, np.array, pd.Series]</em>) — сигнал (тобто часовий ряд) у вигляді вектора значень;</li>
<li><strong>delay</strong> (<em>int</em>) — часова затримка (<span class="math inline">\(\tau\)</span>);</li>
<li><strong>dimension</strong> (<em>int</em>) — розмірність вкладень (<span class="math inline">\(m\)</span>);</li>
<li><strong>radius</strong> (<em>Union[str, int, list]</em>) — послідовність радіусів для перевірки. Якщо передано ціле число, буде отримано експоненціальну послідовність довжиною заданим скалярним значенням <code>radius</code> у межах від 2.5% до 50% від діапазону відстані. Методи, реалізовані в інших пакетах, можна використовувати, вказуючи <code>"nolds"</code>, <code>"Corr_Dim"</code> або <code>"boon2008"</code>;</li>
<li><strong>show</strong> (<em>bool</em>) — графік кореляційної розмірності, якщо <code>True</code>. За замовчуванням — <code>False</code>;</li>
<li><strong>kwargs</strong> — інші аргументи для передачі (наразі не використовуються).</li>
</ul>
<p><strong>Повертає:</strong></p>
<ul>
<li><strong>cd</strong> (<em>float</em>) — кореляційна розмірність часового ряду;</li>
<li><strong>info</strong> (<em>dict</em>) — словник, що містить додаткову інформацію про параметри, які використовуються для обчислення кореляційної розмірності.</li>
</ul>
<section id="для-всього-часового-ряду" class="level4" data-number="6.2.9.1">
<h4 data-number="6.2.9.1" class="anchored" data-anchor-id="для-всього-часового-ряду"><span class="header-section-number">6.2.9.1</span> Для всього часового ряду</h4>
<p>Розглянемо залежність кореляційної суми від радіусу для всього часового ряду. Перш за все виконаємо перетворення ряду:</p>
<div id="cell-216" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>signal <span class="op">=</span> time_ser.copy()</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>ret_type <span class="op">=</span> <span class="dv">1</span>    <span class="co"># вид ряду: </span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 1 - вихідний, </span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 2 - детрендований (різниця між теп. значенням та попереднім)</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 3 - прибутковості звичайні, </span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 4 - стандартизовані прибутковості, </span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 5 - абсолютні значення (волатильності)</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 6 - стандартизований ряд</span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>for_corr <span class="op">=</span> transformation(signal, ret_type) </span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Тепер розрахуємо кореляційну розмірність, побудувавши залежність кореляційної суми від радіусу в логарифмічному масштабі:</p>
<div id="cell-fig-gold-corr-all" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>cd, info <span class="op">=</span> nk.fractal_correlation(for_corr,</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>                                  delay<span class="op">=</span><span class="dv">1</span>, </span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>                                  dimension<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>                                  radius<span class="op">=</span><span class="st">"nolds"</span>, </span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>                                  show<span class="op">=</span><span class="va">True</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-gold-corr-all" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gold-corr-all-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lab_6_files/figure-html/fig-gold-corr-all-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gold-corr-all-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Рис.&nbsp;6.19: Залежність кореляційної суми від радіусу багатовимірного околу досліджуваних траєкторій
</figcaption>
</figure>
</div>
</div>
</div>
<p>Як ми можемо бачити, кореляційна сума дійсно має лінійну залежність для різних значень радіусу околу певної траєкторії, що вказує на фрактальність системи. Тепер подивимось як варіюється значення кореляційної розмірності в періоди турбулентності.</p>
</section>
<section id="віконна-процедура-8" class="level4" data-number="6.2.9.2">
<h4 data-number="6.2.9.2" class="anchored" data-anchor-id="віконна-процедура-8"><span class="header-section-number">6.2.9.2</span> Віконна процедура</h4>
<p>Для цього показника визначимо наступні параметри:</p>
<div id="cell-222" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>window <span class="op">=</span> <span class="dv">250</span>    <span class="co"># розмір вікна</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>tstep <span class="op">=</span> <span class="dv">1</span>       <span class="co"># крок вікна</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>ret_type <span class="op">=</span> <span class="dv">1</span>    <span class="co"># вид ряду: </span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 1 - вихідний, </span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 2 - детрендований (різниця між теп. значенням </span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>                                                <span class="co"># та попереднім)</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 3 - прибутковості звичайні, </span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 4 - стандартизовані прибутковості, </span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 5 - абсолютні значення (волатильності)</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>                <span class="co"># 6 - стандартизований ряд</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>d_wind <span class="op">=</span> <span class="dv">2</span>          <span class="co"># розмірність вкладень</span></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>tau_wind <span class="op">=</span> <span class="dv">1</span>        <span class="co"># часова затримка</span></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>rad_wind <span class="op">=</span> <span class="st">"nolds"</span>  <span class="co"># метод для визначення масиву радіусів</span></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>length <span class="op">=</span> <span class="bu">len</span>(time_ser.values)      <span class="co"># довжина ряду</span></span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>corr_wind <span class="op">=</span> []                     <span class="co"># масив показників </span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Розпочинаємо віконну процедуру:</p>
<div id="cell-224" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> tqdm(<span class="bu">range</span>(<span class="dv">0</span>,length<span class="op">-</span>window,tstep)):</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># відбираємо фрагменти</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>    fragm <span class="op">=</span> time_ser.iloc[i:i<span class="op">+</span>window].copy()  </span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># виконуємо процедуру трансформації ряду </span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>    fragm <span class="op">=</span> transformation(fragm, ret_type)</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># розраховуємо фрактальну розмірність </span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>    cd_wind, _ <span class="op">=</span> nk.fractal_correlation(fragm,</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>                                        delay<span class="op">=</span>tau_wind, </span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>                                        dimension<span class="op">=</span>d_wind,</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>                                        radius<span class="op">=</span>rad_wind)</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># зберігаємо результат до масиву значень</span></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>    corr_wind.append(cd_wind)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 5664/5664 [00:18&lt;00:00, 298.46it/s]</code></pre>
</div>
</div>
<p>Зберігаємо вихідні значення до текстового документа:</p>
<div id="cell-226" class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>np.savetxt(<span class="ss">f"fd_correlation_name=</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_</span><span class="ch">\</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="ss">                step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_dim=</span><span class="sc">{</span>d_wind<span class="sc">}</span><span class="ss">_tau=</span><span class="sc">{</span>tau_wind<span class="sc">}</span><span class="ss">_</span><span class="ch">\</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="ss">                radius=</span><span class="sc">{</span>rad_wind<span class="sc">}</span><span class="ss">.txt"</span>, corr_wind)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Оголошуємо мітки для рисунків та назви збережених рисунків:</p>
<div id="cell-228" class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>label_cd <span class="op">=</span> <span class="vs">fr'$CD$'</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>file_name_cd <span class="op">=</span> <span class="ss">f"fd_correlation_name=</span><span class="sc">{</span>symbol<span class="sc">}</span><span class="ss">_wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_</span><span class="ch">\</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="ss">                step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_dim=</span><span class="sc">{</span>d_wind<span class="sc">}</span><span class="ss">_tau=</span><span class="sc">{</span>tau_wind<span class="sc">}</span><span class="ss">_</span><span class="ch">\</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="ss">                radius=</span><span class="sc">{</span>rad_wind<span class="sc">}</span><span class="ss">"</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Виводимо результат:</p>
<div id="cell-fig-gold-wind-cd" class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>plot_pair(time_ser.index[window:length:tstep],</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>          time_ser.values[window:length:tstep],</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>          corr_wind, </span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>          ylabel, </span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>          label_cd,</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>          xlabel,</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>          file_name_cd)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-gold-wind-cd" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gold-wind-cd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lab_6_files/figure-html/fig-gold-wind-cd-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gold-wind-cd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Рис.&nbsp;6.20: Динаміка ціни золота та кореляційної фрактальної розмірності
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-gold-wind-cd" class="quarto-xref">Рис.&nbsp;<span>6.20</span></a> демонструє, що кореляційна розмірність для індексу золота також спадає у кризові та передкризові періоди, вказуючи на зростання корельованості теперішніх цін на золото з попередніми. Можна сказати й по іншому: у період криз трейдери починають самоорганізовуватись та колективно скупати або продавати відповідний актив; іншими словами, їх динаміка стає більш синхронною. Оскільки кореляційна розмірність вимірюється для траєкторій фазового простору, спад цього показника свідчить про зростання щільності досліджуваних траєкторій. Тобто, фазовий простір стає більш розрідженим, а всі його траєкторії концентрованими лише в одній конкретній області, що є індикатором згуртованості прихованих змінних досліджуваної системи.</p>
</section>
</section>
</section>
<section id="висновок" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="висновок"><span class="header-section-number">6.3</span> Висновок</h2>
<p>У даній лабораторній роботі було проаналізовано цінові коливання індексу золота з використанням спектра монофрактальних показників. Було показано, що дані методи є досить стійкими до нестаціонарності досілджуваного сигналу. Ринок золота характеризується зростаннями та спадами фрактальної розмірності, що вказує на варіацію ефективності його розвитку в різні моменти часу. Як уже зазначалось, спад фрактальної розмірності в кризовий або передкризовий стан ринку може вказувати на зростання ступеня періодизації (впорядкованості) системи. Зростання фрактальної розмірності може бути індикатором зростання невпорядкованості. У подальшій лабораторній роботі буде продемонстровано підхід, що дозволяє розраховувати спектр фрактальних показників, які можна отримати на різних просторово-часових масштабах системи.</p>
</section>
<section id="завдання-для-виконання" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="завдання-для-виконання"><span class="header-section-number">6.4</span> Завдання для виконання</h2>
<ol type="1">
<li>Вибрати із запропонованої бази даних варіант завдання</li>
<li>Виконати дослідження фрактальних характеристик заданих часових рядів. Зберегти результати в окремому файлі</li>
<li>Порівняти значення коефіцієнтів Херста, одержаних методом R/S-аналізу та DFA</li>
<li>Провести повний аналіз різних методів розрахунку монофрактальних розмірностей</li>
<li>Дати інтерпретацію отриманим результатам</li>
</ol>


<div id="refs" class="references csl-bib-body" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-mandelbrot1982fractal" class="csl-entry" role="listitem">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline">B. B. Mandelbrot and B. B. Mandelbrot, <em>The Fractal Geometry of Nature</em>, Vol. 1 (WH freeman New York, 1982).</div>
</div>
<div id="ref-PhysRevA.42.4528" class="csl-entry" role="listitem">
<div class="csl-left-margin">[2] </div><div class="csl-right-inline">B. B. Mandelbrot, C. J. G. Evertsz, and Y. Hayakawa, <em><a href="https://doi.org/10.1103/PhysRevA.42.4528">Exactly Self-Similar Left-Sided Multifractal Measures</a></em>, Phys. Rev. A <strong>42</strong>, 4528 (1990).</div>
</div>
<div id="ref-10.1007/3-7643-7412-8_8" class="csl-entry" role="listitem">
<div class="csl-left-margin">[3] </div><div class="csl-right-inline">H. F. Jelinek, N. Elston, and B. Zietsch, <em>Fractal Analysis: Pitfalls and Revelations in Neuroscience</em>, in <em>Fractals in Biology and Medicine</em>, edited by G. A. Losa, D. Merlini, T. F. Nonnenmacher, and E. R. Weibel (Birkh<span>ä</span>user Basel, Basel, 2005), pp. 85–94.</div>
</div>
<div id="ref-steinhaus1954length" class="csl-entry" role="listitem">
<div class="csl-left-margin">[4] </div><div class="csl-right-inline">H. Steinhaus, <em>Length, Shape and Area</em>, in <em>Colloquium Mathematicum</em>, Vol. 3 (Polska Akademia Nauk. Instytut Matematyczny PAN, 1954), pp. 1–13.</div>
</div>
<div id="ref-vulpiani2014lewis" class="csl-entry" role="listitem">
<div class="csl-left-margin">[5] </div><div class="csl-right-inline">A. Vulpiani, <em><a href="https://doi.org/10.1007/s40329-014-0063-z">Lewis Fry Richardson: Scientist, Visionary and Pacifist</a></em>, Lettera Matematica <strong>2</strong>, 121 (2014).</div>
</div>
<div id="ref-0c446163-c0a0-36ed-a942-0e71e56cd938" class="csl-entry" role="listitem">
<div class="csl-left-margin">[6] </div><div class="csl-right-inline">B. Hayes, <em><a href="http://www.jstor.org/stable/27857587">Computing Science: Statistics of Deadly Quarrels</a></em>, American Scientist <strong>90</strong>, 10 (2002).</div>
</div>
<div id="ref-science.156.3775.636" class="csl-entry" role="listitem">
<div class="csl-left-margin">[7] </div><div class="csl-right-inline">B. Mandelbrot, <em><a href="https://doi.org/10.1126/science.156.3775.636">How Long Is the Coast of Britain? Statistical Self-Similarity and Fractional Dimension</a></em>, Science <strong>156</strong>, 636 (1967).</div>
</div>
<div id="ref-Bozhokin" class="csl-entry" role="listitem">
<div class="csl-left-margin">[8] </div><div class="csl-right-inline">S. V. Bozhokin and D. A. Parshin, <em>Fractals and Multifractals: Textbook</em> (Scientific; Publishing Center "Regular; Chaotic Dynamics", 2001).</div>
</div>
<div id="ref-10.1214/11-STS370" class="csl-entry" role="listitem">
<div class="csl-left-margin">[9] </div><div class="csl-right-inline">T. Gneiting, H. Ševčíková, and D. B. Percival, <em><a href="https://doi.org/10.1214/11-STS370"><span class="nocase">Estimators of Fractal Dimension: Assessing the Roughness of Time Series and Spatial Data</span></a></em>, Statistical Science <strong>27</strong>, 247 (2012).</div>
</div>
<div id="ref-falconer2004fractal" class="csl-entry" role="listitem">
<div class="csl-left-margin">[10] </div><div class="csl-right-inline">K. Falconer, <em><a href="https://doi.org/10.1002/0470013850">Fractal Geometry: Mathematical Foundations and Applications</a></em> (John Wiley &amp; Sons, 2003).</div>
</div>
<div id="ref-10.1119/1.13295" class="csl-entry" role="listitem">
<div class="csl-left-margin">[11] </div><div class="csl-right-inline">B. B. Mandelbrot and J. A. Wheeler, <em><a href="https://doi.org/10.1119/1.13295"><span class="nocase">The Fractal Geometry of Nature</span></a></em>, American Journal of Physics <strong>51</strong>, 286 (1983).</div>
</div>
<div id="ref-doi:10.1061/TACEAT.0006518" class="csl-entry" role="listitem">
<div class="csl-left-margin">[12] </div><div class="csl-right-inline">H. E. Hurst, <em><a href="https://doi.org/10.1061/TACEAT.0006518">Long-Term Storage Capacity of Reservoirs</a></em>, Transactions of the American Society of Civil Engineers <strong>116</strong>, 770 (1951).</div>
</div>
<div id="ref-hurst1957suggested" class="csl-entry" role="listitem">
<div class="csl-left-margin">[13] </div><div class="csl-right-inline">H. E. Hurst, <em><a href="https://doi.org/10.1038/180494a0">A Suggested Statistical Model of Some Time Series Which Occur in Nature</a></em>, Nature <strong>180</strong>, 494 (1957).</div>
</div>
<div id="ref-PhysRevE.49.1685" class="csl-entry" role="listitem">
<div class="csl-left-margin">[14] </div><div class="csl-right-inline">C.-K. Peng, S. V. Buldyrev, S. Havlin, M. Simons, H. E. Stanley, and A. L. Goldberger, <em><a href="https://doi.org/10.1103/PhysRevE.49.1685">Mosaic Organization of DNA Nucleotides</a></em>, Phys. Rev. E <strong>49</strong>, 1685 (1994).</div>
</div>
<div id="ref-JIANG2014235" class="csl-entry" role="listitem">
<div class="csl-left-margin">[15] </div><div class="csl-right-inline">Z.-Q. Jiang, W.-J. Xie, and W.-X. Zhou, <em><a href="https://doi.org/10.1016/j.physa.2014.02.042">Testing the Weak-Form Efficiency of the WTI Crude Oil Futures Market</a></em>, Physica A: Statistical Mechanics and Its Applications <strong>405</strong>, 235 (2014).</div>
</div>
<div id="ref-HIGUCHI1988277" class="csl-entry" role="listitem">
<div class="csl-left-margin">[16] </div><div class="csl-right-inline">T. Higuchi, <em><a href="https://doi.org/10.1016/0167-2789(88)90081-4">Approach to an Irregular Time Series on the Basis of the Fractal Theory</a></em>, Physica D: Nonlinear Phenomena <strong>31</strong>, 277 (1988).</div>
</div>
<div id="ref-7168285" class="csl-entry" role="listitem">
<div class="csl-left-margin">[17] </div><div class="csl-right-inline">C. F. Vega and J. Noel, <em><a href="https://doi.org/10.1109/SPS.2015.7168285">Parameters Analyzed of Higuchi’s Fractal Dimension for EEG Brain Signals</a></em>, in <em>2015 Signal Processing Symposium (SPSympo)</em> (2015), pp. 1–5.</div>
</div>
<div id="ref-465426" class="csl-entry" role="listitem">
<div class="csl-left-margin">[18] </div><div class="csl-right-inline">A. Petrosian, <em><a href="https://doi.org/10.1109/CBMS.1995.465426">Kolmogorov Complexity of Finite Sequences and Recognition of Different Preictal EEG Patterns</a></em>, in <em>Proceedings Eighth IEEE Symposium on Computer-Based Medical Systems</em> (1995), pp. 212–217.</div>
</div>
<div id="ref-904882" class="csl-entry" role="listitem">
<div class="csl-left-margin">[19] </div><div class="csl-right-inline">R. Esteller, G. Vachtsevanos, J. Echauz, and B. Litt, <em><a href="https://doi.org/10.1109/81.904882">A Comparison of Waveform Fractal Dimension Algorithms</a></em>, IEEE Transactions on Circuits and Systems I: Fundamental Theory and Applications <strong>48</strong>, 177 (2001).</div>
</div>
<div id="ref-goh:inria-00442374" class="csl-entry" role="listitem">
<div class="csl-left-margin">[20] </div><div class="csl-right-inline">C. Goh, B. Hamadicharef, G. T. Henderson, and E. C. Ifeachor, <em><a href="https://inria.hal.science/inria-00442374"><span class="nocase">Comparison of Fractal Dimension Algorithms for the Computation of EEG Biomarkers for Dementia</span></a></em>, in <em><span class="nocase">2nd International Conference on Computational Intelligence in Medicine and Healthcare (CIMED2005)</span></em> (<span>Professor Jos<span>é</span> Manuel Fonseca, UNINOVA, Portugal</span>, Lisbon, Portugal, 2005).</div>
</div>
<div id="ref-KATZ1988145" class="csl-entry" role="listitem">
<div class="csl-left-margin">[21] </div><div class="csl-right-inline">M. J. Katz, <em><a href="https://doi.org/10.1016/0010-4825(88)90041-8">Fractals and the Analysis of Waveforms</a></em>, Computers in Biology and Medicine <strong>18</strong>, 145 (1988).</div>
</div>
<div id="ref-sevcik2010procedure" class="csl-entry" role="listitem">
<div class="csl-left-margin">[22] </div><div class="csl-right-inline">C. Sevcik, <em><a href="https://arxiv.org/abs/1003.5266">A Procedure to Estimate the Fractal Dimension of Waveforms</a></em>, (2010).</div>
</div>
<div id="ref-kalauzi2009extracting" class="csl-entry" role="listitem">
<div class="csl-left-margin">[23] </div><div class="csl-right-inline">A. Kalauzi, T. Bojić, and L. Rakić, <em><a href="https://doi.org/10.1186/1753-4631-3-8">Extracting Complexity Waveforms from One-Dimensional Signals</a></em>, Nonlinear Biomedical Physics <strong>3</strong>, 1 (2009).</div>
</div>
<div id="ref-Kalauzi_2009" class="csl-entry" role="listitem">
<div class="csl-left-margin">[24] </div><div class="csl-right-inline">A. Kalauzi, T. Bojić, and L. Rakić, <em><a href="https://doi.org/10.1186/1753-4631-3-8">Extracting Complexity Waveforms from One-Dimensional Signals</a></em>, Nonlinear Biomedical Physics <strong>3</strong>, (2009).</div>
</div>
<div id="ref-10.3389/fphys.2013.00075" class="csl-entry" role="listitem">
<div class="csl-left-margin">[25] </div><div class="csl-right-inline">F. Hasselman, <em><a href="https://doi.org/10.3389/fphys.2013.00075">When the Blind Curve Is Finite: Dimension Estimation and Model Inference Based on Empirical Waveforms</a></em>, Frontiers in Physiology <strong>4</strong>, (2013).</div>
</div>
<div id="ref-Voss1988" class="csl-entry" role="listitem">
<div class="csl-left-margin">[26] </div><div class="csl-right-inline">R. F. Voss, <em><a href="https://doi.org/10.1007/978-1-4612-3784-6_1">Fractals in Nature: From Characterization to Simulation</a></em>, in <em>The Science of Fractal Images</em>, edited by H.-O. Peitgen and D. Saupe (Springer New York, New York, NY, 1988), pp. 21–70.</div>
</div>
<div id="ref-GRASSBERGER1983189" class="csl-entry" role="listitem">
<div class="csl-left-margin">[27] </div><div class="csl-right-inline">P. Grassberger and I. Procaccia, <em><a href="https://doi.org/10.1016/0167-2789(83)90298-1">Measuring the Strangeness of Strange Attractors</a></em>, Physica D: Nonlinear Phenomena <strong>9</strong>, 189 (1983).</div>
</div>
<div id="ref-PhysRevLett.50.346" class="csl-entry" role="listitem">
<div class="csl-left-margin">[28] </div><div class="csl-right-inline">P. Grassberger and I. Procaccia, <em><a href="https://doi.org/10.1103/PhysRevLett.50.346">Characterization of Strange Attractors</a></em>, Phys. Rev. Lett. <strong>50</strong>, 346 (1983).</div>
</div>
<div id="ref-GRASSBERGER1983227" class="csl-entry" role="listitem">
<div class="csl-left-margin">[29] </div><div class="csl-right-inline">P. Grassberger, <em><a href="https://doi.org/10.1016/0375-9601(83)90753-3">Generalized Dimensions of Strange Attractors</a></em>, Physics Letters A <strong>97</strong>, 227 (1983).</div>
</div>
<div id="ref-Anis_1976" class="csl-entry" role="listitem">
<div class="csl-left-margin">[30] </div><div class="csl-right-inline">A. A. Anis and E. H. Lloyd, <em><a href="https://doi.org/10.2307/2335090">The Expected Value of the Adjusted Rescaled Hurst Range of Independent Normal Summands</a></em>, Biometrika <strong>63</strong>, 111 (1976).</div>
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Скопійовано!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Скопійовано!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/butman2099\.github\.io\/Complex-systems-book\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="./lab_5.html" class="pagination-link" aria-label="Лабораторна робота № 5">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Лабораторна робота № 5</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./lab_7.html" class="pagination-link" aria-label="Лабораторна робота № 7">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Лабораторна робота № 7</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.dev/Butman2099/Complex-systems-book/blob/main/lab_6.ipynb" class="toc-action"><i class="bi bi-github"></i>Редагувати сторінку</a></li></ul></div></div></div></footer></body></html>