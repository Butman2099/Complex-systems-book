<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Моделювання складних систем у Python - 8&nbsp; Лабораторна робота № 8</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./lab_9.html" rel="next">
<link href="./lab_7.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Пошук не дав результату",
    "search-matching-documents-text": "Результати пошуку",
    "search-copy-link-title": "Скопіюйте посилання для пошуку",
    "search-hide-matches-text": "Приховати додаткові результати",
    "search-more-match-text": "Додатковий результат у цьому документі",
    "search-more-matches-text": "Додаткові результати у цьому документі",
    "search-clear-button-title": "Очистити",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Скасувати",
    "search-submit-button-title": "Надіслати",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./lab_8.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Лабораторна робота № 8</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Моделювання складних систем у Python</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/Butman2099/Complex-systems-book" title="Вихідний код" class="quarto-navigation-tool px-1" aria-label="Вихідний код"><i class="bi bi-github"></i></a>
    <a href="./Моделювання-складних-систем-у-Python.docx" title="Download Docx" class="quarto-navigation-tool px-1" aria-label="Download Docx"><i class="bi bi-file-word"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Передмова</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Лабораторна робота № 1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Лабораторна робота № 2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Лабораторна робота № 3</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Лабораторна робота № 4</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Лабораторна робота № 5</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Лабораторна робота № 6</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Лабораторна робота № 7</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_8.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Лабораторна робота № 8</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Лабораторна робота № 9</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Лабораторна робота № 10</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Лабораторна робота № 11</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Лабораторна робота № 12</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Лабораторна робота № 13</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_14.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Лабораторна робота № 14</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Додатки</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Інструкція зі встановлення Anaconda Navigator</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appb.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Вступ до мови програмування Python</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Основи Jupyter Notebook</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Вступ до Google Colab</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Список рекомендованої літератури</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Зміст</h2>
   
  <ul>
  <li><a href="#теоретичні-відомості" id="toc-теоретичні-відомості" class="nav-link active" data-scroll-target="#теоретичні-відомості"><span class="header-section-number">8.1</span> Теоретичні відомості</a>
  <ul class="collapse">
  <li><a href="#знаходження-коефіцієнтів-матриці-крос-кореляцій" id="toc-знаходження-коефіцієнтів-матриці-крос-кореляцій" class="nav-link" data-scroll-target="#знаходження-коефіцієнтів-матриці-крос-кореляцій"><span class="header-section-number">8.1.1</span> Знаходження коефіцієнтів матриці крос-кореляцій</a></li>
  <li><a href="#розподіл-власних-значень" id="toc-розподіл-власних-значень" class="nav-link" data-scroll-target="#розподіл-власних-значень"><span class="header-section-number">8.1.2</span> Розподіл власних значень</a></li>
  <li><a href="#розподіл-власних-векторів" id="toc-розподіл-власних-векторів" class="nav-link" data-scroll-target="#розподіл-власних-векторів"><span class="header-section-number">8.1.3</span> Розподіл власних векторів</a></li>
  <li><a href="#обернене-відношення-участі" id="toc-обернене-відношення-участі" class="nav-link" data-scroll-target="#обернене-відношення-участі"><span class="header-section-number">8.1.4</span> Обернене відношення участі</a></li>
  </ul></li>
  <li><a href="#хід-роботи" id="toc-хід-роботи" class="nav-link" data-scroll-target="#хід-роботи"><span class="header-section-number">8.2</span> Хід роботи</a>
  <ul class="collapse">
  <li><a href="#знаходження-коефіцієнтів-матриці-крос-кореляцій-1" id="toc-знаходження-коефіцієнтів-матриці-крос-кореляцій-1" class="nav-link" data-scroll-target="#знаходження-коефіцієнтів-матриці-крос-кореляцій-1"><span class="header-section-number">8.2.1</span> Знаходження коефіцієнтів матриці крос-кореляцій</a></li>
  <li><a href="#розподіл-власних-значень-та-векторів" id="toc-розподіл-власних-значень-та-векторів" class="nav-link" data-scroll-target="#розподіл-власних-значень-та-векторів"><span class="header-section-number">8.2.2</span> Розподіл власних значень та векторів</a></li>
  <li><a href="#обернене-відношення-участі-1" id="toc-обернене-відношення-участі-1" class="nav-link" data-scroll-target="#обернене-відношення-участі-1"><span class="header-section-number">8.2.3</span> Обернене відношення участі</a></li>
  <li><a href="#коефіцієнт-поглинання" id="toc-коефіцієнт-поглинання" class="nav-link" data-scroll-target="#коефіцієнт-поглинання"><span class="header-section-number">8.2.4</span> Коефіцієнт поглинання</a></li>
  <li><a href="#віконна-процедура" id="toc-віконна-процедура" class="nav-link" data-scroll-target="#віконна-процедура"><span class="header-section-number">8.2.5</span> Віконна процедура</a></li>
  </ul></li>
  <li><a href="#висновок" id="toc-висновок" class="nav-link" data-scroll-target="#висновок"><span class="header-section-number">8.3</span> Висновок</a></li>
  <li><a href="#завдання-для-самостійної-роботи" id="toc-завдання-для-самостійної-роботи" class="nav-link" data-scroll-target="#завдання-для-самостійної-роботи"><span class="header-section-number">8.4</span> Завдання для самостійної роботи</a></li>
  <li><a href="#контрольні-запитання" id="toc-контрольні-запитання" class="nav-link" data-scroll-target="#контрольні-запитання"><span class="header-section-number">8.5</span> Контрольні запитання</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.dev/Butman2099/Complex-systems-book/blob/main/lab_8.ipynb" class="toc-action"><i class="bi bi-github"></i>Редагувати сторінку</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Лабораторна робота № 8</span></h1>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<p><strong>Тема.</strong> Дослідження процесів самоорганізації в складних системах із використання теорії випадкових матриць</p>
<p><strong>Мета.</strong> Навчитись використовувати методи теорії випадкових матриць для дослідження колективних процесів у складних системах</p>
<section id="теоретичні-відомості" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="теоретичні-відомості"><span class="header-section-number">8.1</span> Теоретичні відомості</h2>
<p>Вивчення статистичних властивостей матриць з незалежними випадковими елементами — випадкових матриць — має багату історію, що починається з ядерної фізики <span class="citation" data-cites="Wigner_1951_1 Wigner_1951_2 10.1063/1.1703773 10.1063/1.1704008 10.1063/1.1704009 mehta1991random RevModPhys.53.385">&nbsp;[<a href="references.html#ref-Wigner_1951_1" role="doc-biblioref">1</a>–<a href="references.html#ref-RevModPhys.53.385" role="doc-biblioref">7</a>]</span>, де проблема з’явилася більше 50 років тому при дослідженні енергетичних рівнів складних ядер. <strong>Теорія випадкової матриці</strong> (ТВМ) була розвинена в цьому контексті Вігнером (Wigner), Дайсоном (Dyson), Метою (Mehta) та іншими для пояснення статистики рівнів енергії складних квантових систем. Дослідники постулювали, що функція Гамільтона, яка описує важкі ядра, може бути задана матрицею <span class="math inline">\(H\)</span> з незалежними випадковими елементами <span class="math inline">\(H_{ij}\)</span>, отриманими з розподілу імовірності. Відштовхуючись від цього припущення було зроблено низку вражаючих передбачень, які було підтверджено експериментально. Для складних квантових систем результати на основі ТВМ представляють середнє за всіма можливими взаємодіями. Відхилення від універсальних передбачень ТВМ відображують системну специфіку, невипадкові властивості системи, забезпечуючи ключові підходи до розуміння базової взаємодії системи. Недавні дослідження, що використовували методи аналізу ТВМ до аналізу властивостей матриці взаємних кореляцій <span class="math inline">\(C\)</span> для економічних систем, показують, що близько 98% власних значень матриці <span class="math inline">\(C\)</span> співпадають зі значеннями, отримуваними з використанням ТВМ, таким чином пропонуючи задовільний рівень хаотичності у вимірюваних крос-кореляціях. Також було знайдено, що існують відхилення від передбачень за допомогою ТВМ у близько 2% найбільших власних значень. Ці результати викликають наступні питання:</p>
<ol type="1">
<li>Яка можлива інтерпретація для відхилень від ТВМ?</li>
<li>Що можна сказати про структуру C з цих результатів?</li>
<li>Яке практичне значення отриманих результатів?</li>
</ol>
<p>Шляхом комп’ютерного моделювання виявлено, що найбільше власне значення матриці <span class="math inline">\(C\)</span> представляє вплив ринку в цілому. Аналіз змісту власних значень, що відхиляються від ТВМ, показує існування взаємних кореляцій між акціями того ж самого типу діяльності, найбільш капіталізованими акціями, і акціями фірм, що мають бізнес у певному географічному секторі (локалізовані територіально). Обчислюючи скалярний добуток власних векторів від одного періоду часу до наступного, можна побачити, що власні вектори, що відхиляються, мають різні ступені стабільності в часі, визначеному кількісно величиною скалярного добутку. Найбільші два-три власних вектори стійкі протягом тривалих періодів часу, у той час як для іншої частини власних векторів, що відхиляються, стабільність у часі зменшується як тільки відповідні власні значення наближаються до верхньої межі ТВМ.</p>
<section id="знаходження-коефіцієнтів-матриці-крос-кореляцій" class="level3" data-number="8.1.1">
<h3 data-number="8.1.1" class="anchored" data-anchor-id="знаходження-коефіцієнтів-матриці-крос-кореляцій"><span class="header-section-number">8.1.1</span> Знаходження коефіцієнтів матриці крос-кореляцій</h3>
<p>Визначення кореляцій між різними акціями — тема, цікава тема не лише з точки зору розуміння економіки як складної динамічної системи, але також і прагматично, зокрема, з точки зору розміщення активів і оцінки портфельного ризику. Ми будемо аналізувати взаємні кореляції між акціями, застосовуючи поняття і методи теорії випадкових матриць, що використовуються в контексті складних квантових систем, де точний характер взаємодій між підодиницями невідомий.</p>
<p>Для визначення кількісно кореляцій спочатку обчислюється зміна цін (прибутковості) акції <span class="math inline">\(i=1,...,N\)</span> за час <span class="math inline">\(\Delta t\)</span>,</p>
<p><span id="eq-8-1"><span class="math display">\[
G_{i}(t) = \ln S_i(t+\Delta t) - \ln S_i(t),
\tag{8.1}\]</span></span></p>
<p>де <span class="math inline">\(S_i(t)\)</span> позначає ціну акції <span class="math inline">\(i\)</span>. Оскільки різні ціни мають різні рівні змінюванності (стандартні відхилення), визначатимемо стандартизовану прибутковість</p>
<p><span id="eq-8-2"><span class="math display">\[
g_i(t) \equiv \left[ G_i(t) - \left\langle G_i \right\rangle \right] \big/ \sigma_i,
\tag{8.2}\]</span></span></p>
<p>де <span class="math inline">\(\sigma_i \equiv \sqrt{\left\langle G_{i}^{2} \right\rangle - \left\langle G_i \right\rangle^{2}}\)</span> — стандартне відхилення <span class="math inline">\(G_i\)</span>, а <span class="math inline">\(\left\langle...\right\rangle\)</span> позначає середнє значення за досліджуваний період часу. Тоді знаходження матриці кореляцій <span class="math inline">\(C\)</span> зводиться до обчислення формули:</p>
<p><span id="eq-8-3"><span class="math display">\[
C_{ij} \equiv \left\langle g_i(t)g_j(t) \right\rangle.
\tag{8.3}\]</span></span></p>
<p>За побудовою, елементи <span class="math inline">\(C_{ij}\)</span> обмежені областю <span class="math inline">\(−1 \leq C_{ij} \leq 1\)</span>, де <span class="math inline">\(C_{ij} = 1\)</span> відповідає повним кореляціям, <span class="math inline">\(C_{ij} = -1\)</span> — повним антикореляціям, і <span class="math inline">\(C_{ij} = 0\)</span> свідчить про некорельованність пар акцій.</p>
<p>Труднощі в аналізі важливості та значення коефіцієнтів крос-кореляції <span class="math inline">\(C_{ij}\)</span> виникають внаслідок кількох причин, що полягають в наступному:</p>
<ul>
<li>ринкові умови з часом змінюються і взаємна кореляція, що існує між будь-якою парою акцій, може бути не постійною (нестаціонарною);</li>
<li>скінчена довжина досліджуваного ряду, доступного для оцінювання взаємних кореляцій, додає так званий “шум вимірювання” — чим коротший досліджуваний ряд — тим менш точними будуть отримувані значення.</li>
</ul>
<p>Яким же чином можна виділяти з <span class="math inline">\(C_{ij}\)</span> ті акції, що залишилися корельованими на розглядуваному періоді часу? Щоб відповісти на це питання, перевіримо статистику <span class="math inline">\(C\)</span> у порівнянні із так званою “нульовою гіпотезою” випадкової кореляційної матриці — матриці кореляцій, побудованої із взаємно некорельованих часових рядів. Якщо властивості <span class="math inline">\(C\)</span> відповідають властивостям для випадкової матриці кореляцій, тоді можна говорити про те, що значення емпірично вимірюваних властивостей <span class="math inline">\(C\)</span> випадкові. Навпаки, відхилення властивостей <span class="math inline">\(C\)</span> від таких же властивостей для випадкової кореляційної матриці передає інформацію про “справжні” кореляції. Отже, нашою метою є порівняння властивостей <span class="math inline">\(C\)</span> з такими ж властивостями випадкової матриці кореляцій і розділ властивостей <span class="math inline">\(C\)</span> на дві групи: (a) частина <span class="math inline">\(C\)</span>, що відповідає властивостям випадкової кореляційної матриці (“шум”) і (b) частина <span class="math inline">\(C\)</span>, що відхиляється (“інформація”).</p>
</section>
<section id="розподіл-власних-значень" class="level3" data-number="8.1.2">
<h3 data-number="8.1.2" class="anchored" data-anchor-id="розподіл-власних-значень"><span class="header-section-number">8.1.2</span> Розподіл власних значень</h3>
<p>Для отримання інформації про взаємні кореляції <span class="math inline">\(C\)</span> необхідно порівняти властивості <span class="math inline">\(C\)</span> з такими ж властивостями випадкової матриці крос-кореляцій <span class="citation" data-cites="PhysRevLett.83.1467">&nbsp;[<a href="references.html#ref-PhysRevLett.83.1467" role="doc-biblioref">8</a>]</span>. У матричній нотації така матриця може бути виражена як</p>
<p><span id="eq-8-4"><span class="math display">\[
C = \frac{1}{L} GG^{T},
\tag{8.4}\]</span></span></p>
<p>де <span class="math inline">\(G\)</span> — матриця розміру <span class="math inline">\(N \times L\)</span> з елементами <span class="math inline">\(g_{im}=g_i(m\Delta t), i=1,...,N; m=0,...,L-1\)</span> і <span class="math inline">\(G^{T}\)</span> позначає транспонування <span class="math inline">\(G\)</span>. Розглянемо випадкову кореляційну матрицю</p>
<p><span id="eq-8-5"><span class="math display">\[
R = \frac{1}{L} AA^{T},
\tag{8.5}\]</span></span></p>
<p>де <span class="math inline">\(A\)</span> — матриця розміру <span class="math inline">\(N \times L\)</span>, що містить <span class="math inline">\(N\)</span> часових рядів із <span class="math inline">\(L\)</span> випадковими елементів <span class="math inline">\(a_{im}\)</span> з нульовим середнім і одиничним відхиленням, що означають взаємну некорельованість. За побудовою <span class="math inline">\(R\)</span> належить до типу матриць, які часто називають матрицями Вішарта у багатовимірній статистиці <span class="citation" data-cites="Muirhead">&nbsp;[<a href="references.html#ref-Muirhead" role="doc-biblioref">9</a>]</span>.</p>
<p>Статистичні властивості випадкових матриць <span class="math inline">\(R\)</span> відомі <span class="citation" data-cites="dyson1971distribution PhysRevE.60.3389">&nbsp;[<a href="references.html#ref-dyson1971distribution" role="doc-biblioref">10</a>,<a href="references.html#ref-PhysRevE.60.3389" role="doc-biblioref">11</a>]</span>. Зокрема, у наближенні <span class="math inline">\(N \to \infty\)</span>, <span class="math inline">\(L \to \infty\)</span>, такому, що <span class="math inline">\(Q \equiv L/N(&gt;1)\)</span> фіксоване, показано аналітично <span class="citation" data-cites="PhysRevE.60.3389">&nbsp;[<a href="references.html#ref-PhysRevE.60.3389" role="doc-biblioref">11</a>]</span>, що функція розподілу щільності імовірності <span class="math inline">\(P_{rm}(\lambda)\)</span> власних значень <span class="math inline">\(\lambda\)</span> випадкової матриці кореляції <span class="math inline">\(R\)</span> визначається як</p>
<p><span id="eq-8-6"><span class="math display">\[
P_{rm}(\lambda) = \frac{Q}{2\pi}\frac{\sqrt{(\lambda_{+} - \lambda)(\lambda - \lambda_{-})}}{\lambda},
\tag{8.6}\]</span></span></p>
<p>із <span class="math inline">\(\lambda\)</span> в межах границь <span class="math inline">\(\lambda_{-} \leq \lambda_{i} \leq \lambda_{+}\)</span>, де <span class="math inline">\(\lambda_{-}\)</span> і <span class="math inline">\(\lambda_{+}\)</span> — найменше та найбільше власні значення <span class="math inline">\(R\)</span>, які можна визначити аналітично як</p>
<p><span id="eq-8-7"><span class="math display">\[
\lambda_{\pm} = 1 + 1/Q \pm 2\sqrt{1/Q}.
\tag{8.7}\]</span></span></p>
<p>Вираз (<a href="#eq-8-6" class="quarto-xref"><span>8.6</span></a>) є точним для випадку розподілених за Гаусом матричних елементів <span class="math inline">\(a_{im}\)</span>.</p>
<p>Порівняємо розподіл власних значень <span class="math inline">\(P(\lambda)\)</span> для <span class="math inline">\(C\)</span> з <span class="math inline">\(P_{rm}(\lambda)\)</span>. Для цього обчислимо власні значення <span class="math inline">\(\lambda_i\)</span> матриці <span class="math inline">\(C\)</span>, причому <span class="math inline">\(\lambda_i\)</span> впорядкуємо за зростанням (<span class="math inline">\(\lambda_{i+1} &gt; \lambda_{i}\)</span>). При дослідженнях зверніть увагу на присутність чіткої “великої частини” власних значень, що спадають у межах границь <span class="math inline">\([\lambda_{-}, \lambda_{+}]\)</span> для <span class="math inline">\(P_{rm}(\lambda)\)</span>. Також зверніть увагу на відхилення для деяких найбільших і найменших власних значень отриманих за допомогою ТВМ.</p>
<p>Оскільки (<a href="#eq-8-6" class="quarto-xref"><span>8.6</span></a>) є таким, що строго відповідає лише для <span class="math inline">\(L \to \infty\)</span> і <span class="math inline">\(N \to \infty\)</span>, необхідно перевірити також відхилення від ідеального випадку, оскільки робота проводиться завжди зі <strong>скінченими</strong> рядами. При дослідженнях виявляється, що для кількох найбільших (найменших) власних значень ефект впливу скінчених величин <span class="math inline">\(L\)</span> і <span class="math inline">\(N\)</span> відсутній.</p>
</section>
<section id="розподіл-власних-векторів" class="level3" data-number="8.1.3">
<h3 data-number="8.1.3" class="anchored" data-anchor-id="розподіл-власних-векторів"><span class="header-section-number">8.1.3</span> Розподіл власних векторів</h3>
<p>Відхилення <span class="math inline">\(P(\lambda)\)</span> від передбачення ТВМ <span class="math inline">\(P_{rm}(\lambda)\)</span> свідчить про те, що ці відхилення також повинні відображатися в статистиці відповідних компонент власного вектора <span class="citation" data-cites="PhysRevLett.83.1467">&nbsp;[<a href="references.html#ref-PhysRevLett.83.1467" role="doc-biblioref">8</a>]</span>. Відповідно, у даній лабораторній ми будемо аналізувати розподіл компоненти власного вектора. Розподіл компонент <span class="math inline">\(\left\{ u_{l}^{k}; l=1,...,N \right\}\)</span> власного вектора <span class="math inline">\(u^k\)</span> випадкової кореляційної матриці <span class="math inline">\(R\)</span> має відповідати розподілу Гауса з нульовим середнім та одиничною дисперсією:</p>
<p><span class="math display">\[
\rho_{rm}(u) = \frac{1}{\sqrt{2\pi}}\exp\left( -u^{2} \big/ 2 \right).
\]</span></p>
</section>
<section id="обернене-відношення-участі" class="level3" data-number="8.1.4">
<h3 data-number="8.1.4" class="anchored" data-anchor-id="обернене-відношення-участі"><span class="header-section-number">8.1.4</span> Обернене відношення участі</h3>
<p>Вивчивши інтерпретацію найбільшого власного значення, що значно відхиляється від результатів ТВМ, зосередимось на власних значеннях, що залишаються. Відхилення розподілу компонентів власного вектора <span class="math inline">\(u_k\)</span> від ТВМ Гаусового передбачення більш явне, коли відстань від верхньої границі ТВМ <span class="math inline">\(\lambda_k - \lambda_{+}\)</span> збільшується. Оскільки близькість до <span class="math inline">\(\lambda_{+}\)</span> збільшує ефекти хаотичності, визначаємо кількість компонентів, що беруть значну участь у кожному власному векторі, що, у свою чергу, відображає ступінь відхилення від ТВМ для розподілу компонентів власного вектора. Для цього використовується поняття <strong>оберненого відношення участі</strong> (ОВУ) <span class="citation" data-cites="PhysRevLett.83.1471 GUHR1998189 PhysRevLett.69.1093">&nbsp;[<a href="references.html#ref-PhysRevLett.83.1471" role="doc-biblioref">12</a>–<a href="references.html#ref-PhysRevLett.69.1093" role="doc-biblioref">14</a>]</span>, що часто застосовується в теорії локалізації. ОВУ власного вектора <span class="math inline">\(u_k\)</span> визначається як</p>
<p><span id="eq-8-8"><span class="math display">\[
I^{k} \equiv \sum_{l=1}^{N}\left[ u_{l}^{k} \right]^4,
\tag{8.8}\]</span></span></p>
<p>де <span class="math inline">\(u_{l}^{k}\)</span>, <span class="math inline">\(l=1,...,N\)</span> — компоненти власного вектора <span class="math inline">\(u^{k}\)</span>. Значення <span class="math inline">\(I^{k}\)</span> може бути проілюстровано двома граничними випадками:</p>
<ul>
<li>вектор з ідентичними компонентами <span class="math inline">\(u_{l}^{k} \equiv 1 \big/ \sqrt{N}\)</span> має <span class="math inline">\(I^{k} = 1 \big/ N\)</span>;<br>
</li>
<li>вектор з одним компонентом <span class="math inline">\(u_{1}^{k}=1\)</span> і нульовими іншими має <span class="math inline">\(I^{k}=1\)</span>.</li>
</ul>
<p>Таким чином, ОВУ визначає кількість даних з числа компонентів власного вектора, що значно впливають на ринок, заданий системою часових рядів. Наявність векторів з великими значеннями <span class="math inline">\(I^{k}\)</span> також виникає в теорії локалізації Андерсона. У контексті теорії локалізації часто знаходять “випадкову смугу матриць”, що містять узагальнені стани з маленьким <span class="math inline">\(I^{k}\)</span> в більшій частині спектра власних значень, тоді як основні стани локалізовані і мають великі <span class="math inline">\(I^{k}\)</span>. Виявлення локалізованих станів для маленьких і великих власних значень матриці крос-кореляцій <span class="math inline">\(C\)</span> нагадує про локалізацію Андерсона і припускає, що <span class="math inline">\(C\)</span> може мати випадкову зону матричної структури.</p>
</section>
</section>
<section id="хід-роботи" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="хід-роботи"><span class="header-section-number">8.2</span> Хід роботи</h2>
<p>Імпортуємо необхідні бібліотеки:</p>
<div id="acc545ce" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.gridspec <span class="im">as</span> gridspec</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.ticker <span class="im">as</span> mticker</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> yfinance <span class="im">as</span> yf</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scienceplots</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tqdm <span class="im">import</span> tqdm</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>np.seterr(divide<span class="op">=</span><span class="st">'ignore'</span>, invalid<span class="op">=</span><span class="st">'ignore'</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Визначаємо стиль рисунків:</p>
<div id="6020b6f3" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>plt.style.use([<span class="st">'science'</span>, <span class="st">'notebook'</span>, <span class="st">'grid'</span>]) <span class="co"># стиль, що використовуватиметься</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                                               <span class="co"># для виведення рисунків</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>size <span class="op">=</span> <span class="dv">16</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> {</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'figure.figsize'</span>: (<span class="dv">8</span>, <span class="dv">6</span>),            <span class="co"># встановлюємо ширину та висоту рисунків за замовчуванням</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'font.size'</span>: size,                   <span class="co"># розмір фонтів рисунку</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'lines.linewidth'</span>: <span class="dv">2</span>,                <span class="co"># товщина ліній</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.titlesize'</span>: <span class="st">'small'</span>,           <span class="co"># розмір титулки над рисунком</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.labelsize'</span>: size,              <span class="co"># розмір підписів по осям</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'legend.fontsize'</span>: size,             <span class="co"># розмір легенди</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'xtick.labelsize'</span>: size,             <span class="co"># розмір розмітки по осі Ох</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ytick.labelsize'</span>: size,             <span class="co"># розмір розмітки по осі Ох</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"font.family"</span>: <span class="st">"Serif"</span>,              <span class="co"># сімейство стилів підписів </span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"font.serif"</span>: [<span class="st">"Times New Roman"</span>],   <span class="co"># стиль підпису</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'savefig.dpi'</span>: <span class="dv">300</span>,                  <span class="co"># якість збережених зображень</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.grid'</span>: <span class="va">False</span>                   <span class="co"># побудова сітки на самому рисунку</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>plt.rcParams.update(params)              <span class="co"># оновлення стилю згідно налаштувань</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Виконуємо парсинг та фільтрацію заголовків акцій компаній:</p>
<div id="fa94234e" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>headers <span class="op">=</span> {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'authority'</span>: <span class="st">'api.nasdaq.com'</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'accept'</span>: <span class="st">'application/json, text/plain, */*'</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'user-agent'</span>: <span class="st">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36'</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'origin'</span>: <span class="st">'https://www.nasdaq.com'</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'sec-fetch-site'</span>: <span class="st">'same-site'</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'sec-fetch-mode'</span>: <span class="st">'cors'</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'sec-fetch-dest'</span>: <span class="st">'empty'</span>,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'referer'</span>: <span class="st">'https://www.nasdaq.com/'</span>,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'accept-language'</span>: <span class="st">'en-US,en;q=0.9'</span>,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> (</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'tableonly'</span>, <span class="st">'true'</span>),</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'limit'</span>, <span class="st">'25'</span>),</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'offset'</span>, <span class="st">'0'</span>),</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'download'</span>, <span class="st">'true'</span>),</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> requests.get(<span class="st">'https://api.nasdaq.com/api/screener/stocks'</span>, headers<span class="op">=</span>headers, params<span class="op">=</span>params)</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> r.json()[<span class="st">'data'</span>]</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data[<span class="st">'rows'</span>], columns<span class="op">=</span>data[<span class="st">'headers'</span>])</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.dropna(subset<span class="op">=</span>{<span class="st">'marketCap'</span>})</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[<span class="op">~</span>df[<span class="st">'symbol'</span>].<span class="bu">str</span>.contains(<span class="st">"\/|\.|\^"</span>)]</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">symbol</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">lastsale</th>
<th data-quarto-table-cell-role="th">netchange</th>
<th data-quarto-table-cell-role="th">pctchange</th>
<th data-quarto-table-cell-role="th">marketCap</th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">ipoyear</th>
<th data-quarto-table-cell-role="th">volume</th>
<th data-quarto-table-cell-role="th">sector</th>
<th data-quarto-table-cell-role="th">industry</th>
<th data-quarto-table-cell-role="th">url</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>A</td>
<td>Agilent Technologies Inc. Common Stock</td>
<td>$145.17</td>
<td>-2.28</td>
<td>-1.546%</td>
<td>42542835578.00</td>
<td>United States</td>
<td>1999</td>
<td>835947</td>
<td>Industrials</td>
<td>Biotechnology: Laboratory Analytical Instruments</td>
<td>/market-activity/stocks/a</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>AA</td>
<td>Alcoa Corporation Common Stock</td>
<td>$31.94</td>
<td>0.54</td>
<td>1.72%</td>
<td>5735114141.00</td>
<td>United States</td>
<td>2016</td>
<td>3432603</td>
<td>Industrials</td>
<td>Aluminum</td>
<td>/market-activity/stocks/aa</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>AACG</td>
<td>ATA Creativity Global American Depositary Shares</td>
<td>$1.06</td>
<td>-0.02</td>
<td>-1.852%</td>
<td>33519500.00</td>
<td>China</td>
<td>2008</td>
<td>3530</td>
<td>Real Estate</td>
<td>Other Consumer Services</td>
<td>/market-activity/stocks/aacg</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>AACI</td>
<td>Armada Acquisition Corp. I Common Stock</td>
<td>$11.01</td>
<td>0.00</td>
<td>0.00%</td>
<td>0.00</td>
<td>United States</td>
<td>2021</td>
<td>1414</td>
<td>Finance</td>
<td>Blank Checks</td>
<td>/market-activity/stocks/aaci</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>AACIW</td>
<td>Armada Acquisition Corp. I Warrant</td>
<td>$0.0749</td>
<td>0.0018</td>
<td>2.462%</td>
<td>0.00</td>
<td>United States</td>
<td>2021</td>
<td>124</td>
<td>Finance</td>
<td>Blank Checks</td>
<td>/market-activity/stocks/aaciw</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>Фільтруємо та сортуємо заголовків акцій за їх капіталізацією:</p>
<div id="b0e1a2d0" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cust_filter(mkt_cap):</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">'M'</span> <span class="kw">in</span> mkt_cap:</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">float</span>(mkt_cap[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> <span class="st">'B'</span> <span class="kw">in</span> mkt_cap:</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">float</span>(mkt_cap[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]) <span class="op">*</span> <span class="dv">1000</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> mkt_cap <span class="op">==</span> <span class="st">''</span>:</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="fl">0.0</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">float</span>(mkt_cap[<span class="dv">1</span>:]) <span class="op">/</span> <span class="fl">1e6</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'marketCap'</span>] <span class="op">=</span> df[<span class="st">'marketCap'</span>].<span class="bu">apply</span>(cust_filter)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.sort_values(<span class="st">'marketCap'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">symbol</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">lastsale</th>
<th data-quarto-table-cell-role="th">netchange</th>
<th data-quarto-table-cell-role="th">pctchange</th>
<th data-quarto-table-cell-role="th">marketCap</th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">ipoyear</th>
<th data-quarto-table-cell-role="th">volume</th>
<th data-quarto-table-cell-role="th">sector</th>
<th data-quarto-table-cell-role="th">industry</th>
<th data-quarto-table-cell-role="th">url</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2886</td>
<td>GOOG</td>
<td>Alphabet Inc. Class C Capital Stock</td>
<td>$151.05</td>
<td>-0.72</td>
<td>-0.474%</td>
<td>878004.650000</td>
<td>United States</td>
<td>2004</td>
<td>10560963</td>
<td>Technology</td>
<td>Computer Software: Programming Data Processing</td>
<td>/market-activity/stocks/goog</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">395</td>
<td>AMZN</td>
<td>Amazon.com Inc. Common Stock</td>
<td>$179.80</td>
<td>0.93</td>
<td>0.52%</td>
<td>867651.156122</td>
<td>United States</td>
<td>1997</td>
<td>20789293</td>
<td>Consumer Discretionary</td>
<td>Catalog/Specialty Distribution</td>
<td>/market-activity/stocks/amzn</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2887</td>
<td>GOOGL</td>
<td>Alphabet Inc. Class A Common Stock</td>
<td>$149.99</td>
<td>-0.78</td>
<td>-0.517%</td>
<td>864825.670000</td>
<td>United States</td>
<td>2004</td>
<td>13005329</td>
<td>Technology</td>
<td>Computer Software: Programming Data Processing</td>
<td>/market-activity/stocks/googl</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">16</td>
<td>AAPL</td>
<td>Apple Inc. Common Stock</td>
<td>$171.60</td>
<td>-0.68</td>
<td>-0.395%</td>
<td>649826.779600</td>
<td>United States</td>
<td>1980</td>
<td>37196662</td>
<td>Technology</td>
<td>Computer Manufacturing</td>
<td>/market-activity/stocks/aapl</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4662</td>
<td>NVDA</td>
<td>NVIDIA Corporation Common Stock</td>
<td>$954.34</td>
<td>11.45</td>
<td>1.214%</td>
<td>385850.000000</td>
<td>United States</td>
<td>1999</td>
<td>47962939</td>
<td>Technology</td>
<td>Semiconductors</td>
<td>/market-activity/stocks/nvda</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<p>Визначаємо найпередовіші акцій за їх капіталізацією:</p>
<div id="373658d9" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>top <span class="op">=</span> <span class="dv">150</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>tickers_list <span class="op">=</span> df.iloc[:top][<span class="st">'symbol'</span>].tolist()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>tickers_list[:<span class="dv">10</span>]</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>['GOOG', 'AMZN', 'GOOGL', 'AAPL', 'NVDA', 'META', 'MSFT', 'CRM', 'NVS', 'TMUS']</code></pre>
</div>
</div>
<p>Зчитуємо дані з Yahoo Finance згідно створенного списку акцій. Вилучимо ціни закриття всіх акцій за період з 31 грудня 2001 року по 1 жовтня 2023 року:</p>
<div id="36c31d28" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>start <span class="op">=</span> <span class="st">"2001-12-31"</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>end <span class="op">=</span> <span class="st">"2023-12-01"</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>data_init <span class="op">=</span> yf.download(tickers_list, start, end)[<span class="st">"Adj Close"</span>]</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>xlabel <span class="op">=</span> <span class="st">'time, days'</span>    <span class="co"># підпис по вісі Ох </span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Далі нам потребується обрати фінансовий індекс для порівняння з розрахованими індикаторами. Далі надається список усіх доступних для нас акцій:</p>
<div id="99e26cbb" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>ylabel <span class="op">=</span> <span class="st">'AAPL'</span>             <span class="co"># підпис по вісі Оу           </span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>data_init.columns.values</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>array(['AAPL', 'ABBV', 'ABT', 'ACN', 'ADBE', 'AMAT', 'AMD', 'AMGN',
       'AMZN', 'ARM', 'ASML', 'AVGO', 'AXP', 'BA', 'BABA', 'BAC', 'BBD',
       'BDX', 'BHP', 'BKNG', 'BLK', 'BMO', 'BNH', 'C', 'CAT', 'CBRE',
       'CCZ', 'CEG', 'CHKP', 'CHT', 'CMCSA', 'CMG', 'COP', 'COST', 'CRM',
       'CVS', 'CVX', 'DE', 'DHR', 'DIS', 'DRI', 'DUKB', 'EBR', 'EL',
       'ELV', 'ETN', 'EXR', 'FDX', 'FMX', 'FTS', 'FTV', 'GE', 'GMAB',
       'GOOG', 'GOOGL', 'GS', 'GWW', 'HBAN', 'HD', 'HDB', 'HIG', 'HON',
       'HPQ', 'HSBC', 'HSY', 'IBM', 'INTC', 'INTU', 'ISRG', 'ITW', 'JBHT',
       'JNJ', 'JPM', 'KKR', 'KMI', 'KO', 'KOF', 'KVUE', 'LIN', 'LLY',
       'LOW', 'LPLA', 'LRCX', 'LYG', 'MA', 'MDT', 'META', 'MKL', 'MMC',
       'MRK', 'MS', 'MSFT', 'MU', 'MUFG', 'NEE', 'NFLX', 'NKE', 'NMR',
       'NOK', 'NOW', 'NVDA', 'NVO', 'NVS', 'ORCL', 'PDD', 'PEP', 'PFE',
       'PFG', 'PG', 'PGR', 'PLD', 'PM', 'PPL', 'QCOM', 'RACE', 'RSG',
       'RTX', 'RY', 'SAP', 'SCHW', 'SHEL', 'SHG', 'SNPS', 'SNY', 'SPG',
       'SPGI', 'STZ', 'SYK', 'T', 'TBB', 'TBC', 'TGT', 'TJX', 'TM', 'TMO',
       'TMUS', 'TSLA', 'TSM', 'TTE', 'TXN', 'UBER', 'UL', 'UNH', 'UNP',
       'UPS', 'V', 'VZ', 'WMT', 'WSM', 'XOM'], dtype=object)</code></pre>
</div>
</div>
<div id="1fb658e6" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>perc <span class="op">=</span> <span class="fl">5.0</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>min_count <span class="op">=</span>  <span class="bu">int</span>(((<span class="dv">100</span><span class="op">-</span>perc)<span class="op">/</span><span class="dv">100</span>)<span class="op">*</span>data_init.shape[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>data_init <span class="op">=</span> data_init.dropna(axis<span class="op">=</span><span class="dv">1</span>, thresh<span class="op">=</span>min_count)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>data_init</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Ticker</th>
<th data-quarto-table-cell-role="th">AAPL</th>
<th data-quarto-table-cell-role="th">ABT</th>
<th data-quarto-table-cell-role="th">ACN</th>
<th data-quarto-table-cell-role="th">ADBE</th>
<th data-quarto-table-cell-role="th">AMAT</th>
<th data-quarto-table-cell-role="th">AMD</th>
<th data-quarto-table-cell-role="th">AMGN</th>
<th data-quarto-table-cell-role="th">AMZN</th>
<th data-quarto-table-cell-role="th">ASML</th>
<th data-quarto-table-cell-role="th">AXP</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">TTE</th>
<th data-quarto-table-cell-role="th">TXN</th>
<th data-quarto-table-cell-role="th">UL</th>
<th data-quarto-table-cell-role="th">UNH</th>
<th data-quarto-table-cell-role="th">UNP</th>
<th data-quarto-table-cell-role="th">UPS</th>
<th data-quarto-table-cell-role="th">VZ</th>
<th data-quarto-table-cell-role="th">WMT</th>
<th data-quarto-table-cell-role="th">WSM</th>
<th data-quarto-table-cell-role="th">XOM</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2001-12-31</td>
<td>0.331081</td>
<td>14.912379</td>
<td>19.321152</td>
<td>15.452657</td>
<td>14.758861</td>
<td>15.860000</td>
<td>40.573254</td>
<td>0.541000</td>
<td>11.885590</td>
<td>22.767019</td>
<td>...</td>
<td>10.828801</td>
<td>18.147404</td>
<td>8.532564</td>
<td>14.236670</td>
<td>9.228433</td>
<td>29.862459</td>
<td>14.652889</td>
<td>12.593814</td>
<td>14.009839</td>
<td>19.206507</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2002-01-02</td>
<td>0.352246</td>
<td>14.936456</td>
<td>18.811560</td>
<td>15.845818</td>
<td>15.336689</td>
<td>16.389999</td>
<td>40.544498</td>
<td>0.548000</td>
<td>12.401443</td>
<td>22.939653</td>
<td>...</td>
<td>10.930552</td>
<td>18.678860</td>
<td>8.558210</td>
<td>14.166265</td>
<td>9.163671</td>
<td>29.840557</td>
<td>14.970891</td>
<td>12.703233</td>
<td>13.405689</td>
<td>19.353123</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2002-01-03</td>
<td>0.356478</td>
<td>14.949829</td>
<td>18.223030</td>
<td>16.462933</td>
<td>16.742651</td>
<td>19.370001</td>
<td>39.063622</td>
<td>0.595000</td>
<td>13.412239</td>
<td>23.304060</td>
<td>...</td>
<td>10.987591</td>
<td>19.897335</td>
<td>8.483836</td>
<td>14.007341</td>
<td>9.500431</td>
<td>30.388485</td>
<td>15.467968</td>
<td>12.687912</td>
<td>13.562436</td>
<td>19.382444</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2002-01-04</td>
<td>0.358142</td>
<td>14.923078</td>
<td>19.880976</td>
<td>17.866358</td>
<td>16.643274</td>
<td>20.000000</td>
<td>39.983780</td>
<td>0.612500</td>
<td>13.530748</td>
<td>24.116026</td>
<td>...</td>
<td>11.038470</td>
<td>19.702888</td>
<td>8.386379</td>
<td>14.081776</td>
<td>9.714135</td>
<td>31.040512</td>
<td>15.625422</td>
<td>12.604758</td>
<td>13.742058</td>
<td>19.548613</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2002-01-07</td>
<td>0.346199</td>
<td>14.818766</td>
<td>18.983816</td>
<td>17.995752</td>
<td>16.466602</td>
<td>19.980000</td>
<td>40.034107</td>
<td>0.617000</td>
<td>13.377389</td>
<td>24.039314</td>
<td>...</td>
<td>10.904343</td>
<td>19.061247</td>
<td>8.296615</td>
<td>13.991246</td>
<td>9.702801</td>
<td>31.292574</td>
<td>15.529715</td>
<td>12.558800</td>
<td>13.768172</td>
<td>19.377560</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2023-11-24</td>
<td>189.727905</td>
<td>102.375435</td>
<td>332.824677</td>
<td>619.429993</td>
<td>150.085632</td>
<td>122.309998</td>
<td>263.400879</td>
<td>146.740005</td>
<td>689.972473</td>
<td>163.890518</td>
<td>...</td>
<td>67.166924</td>
<td>152.387482</td>
<td>47.501419</td>
<td>543.098999</td>
<td>221.883804</td>
<td>150.343994</td>
<td>36.789608</td>
<td>51.651596</td>
<td>182.729935</td>
<td>103.607109</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2023-11-27</td>
<td>189.548126</td>
<td>102.216202</td>
<td>331.220490</td>
<td>619.270020</td>
<td>150.554840</td>
<td>122.650002</td>
<td>262.220093</td>
<td>147.729996</td>
<td>687.177368</td>
<td>163.511749</td>
<td>...</td>
<td>67.088799</td>
<td>151.405243</td>
<td>47.402313</td>
<td>539.614685</td>
<td>217.501144</td>
<td>147.931061</td>
<td>36.730602</td>
<td>51.886585</td>
<td>182.710037</td>
<td>103.002724</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2023-11-28</td>
<td>190.157349</td>
<td>101.569321</td>
<td>331.350037</td>
<td>623.320007</td>
<td>147.809494</td>
<td>122.010002</td>
<td>263.460419</td>
<td>147.029999</td>
<td>674.809021</td>
<td>165.126541</td>
<td>...</td>
<td>67.352470</td>
<td>151.702881</td>
<td>47.471687</td>
<td>536.577087</td>
<td>218.866394</td>
<td>149.068314</td>
<td>36.848614</td>
<td>52.505505</td>
<td>183.207840</td>
<td>102.943283</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2023-11-29</td>
<td>189.128662</td>
<td>103.131775</td>
<td>332.127197</td>
<td>617.390015</td>
<td>149.107300</td>
<td>123.849998</td>
<td>264.532043</td>
<td>146.320007</td>
<td>686.408752</td>
<td>166.890823</td>
<td>...</td>
<td>66.268501</td>
<td>152.000534</td>
<td>47.104992</td>
<td>531.067627</td>
<td>219.103821</td>
<td>150.601105</td>
<td>37.133804</td>
<td>51.658218</td>
<td>186.314056</td>
<td>101.397644</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2023-11-30</td>
<td>189.707916</td>
<td>103.788605</td>
<td>331.927948</td>
<td>611.010010</td>
<td>149.526596</td>
<td>121.160004</td>
<td>267.548492</td>
<td>146.089996</td>
<td>682.565491</td>
<td>170.220078</td>
<td>...</td>
<td>66.454048</td>
<td>151.514374</td>
<td>47.273476</td>
<td>548.926025</td>
<td>222.863235</td>
<td>149.928665</td>
<td>37.694355</td>
<td>51.529133</td>
<td>186.712296</td>
<td>101.793961</td>
</tr>
</tbody>
</table>

<p>5518 rows × 114 columns</p>
</div>
</div>
</div>
</div>
<div id="e3b2cf88" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>data_init <span class="op">=</span> data_init.dropna(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>data_init</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Ticker</th>
<th data-quarto-table-cell-role="th">AAPL</th>
<th data-quarto-table-cell-role="th">ABT</th>
<th data-quarto-table-cell-role="th">ACN</th>
<th data-quarto-table-cell-role="th">ADBE</th>
<th data-quarto-table-cell-role="th">AMAT</th>
<th data-quarto-table-cell-role="th">AMD</th>
<th data-quarto-table-cell-role="th">AMGN</th>
<th data-quarto-table-cell-role="th">AMZN</th>
<th data-quarto-table-cell-role="th">ASML</th>
<th data-quarto-table-cell-role="th">AXP</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">TTE</th>
<th data-quarto-table-cell-role="th">TXN</th>
<th data-quarto-table-cell-role="th">UL</th>
<th data-quarto-table-cell-role="th">UNH</th>
<th data-quarto-table-cell-role="th">UNP</th>
<th data-quarto-table-cell-role="th">UPS</th>
<th data-quarto-table-cell-role="th">VZ</th>
<th data-quarto-table-cell-role="th">WMT</th>
<th data-quarto-table-cell-role="th">WSM</th>
<th data-quarto-table-cell-role="th">XOM</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2001-12-31</td>
<td>0.331081</td>
<td>14.912379</td>
<td>19.321152</td>
<td>15.452657</td>
<td>14.758861</td>
<td>15.860000</td>
<td>40.573254</td>
<td>0.541000</td>
<td>11.885590</td>
<td>22.767019</td>
<td>...</td>
<td>10.828801</td>
<td>18.147404</td>
<td>8.532564</td>
<td>14.236670</td>
<td>9.228433</td>
<td>29.862459</td>
<td>14.652889</td>
<td>12.593814</td>
<td>14.009839</td>
<td>19.206507</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2002-01-02</td>
<td>0.352246</td>
<td>14.936456</td>
<td>18.811560</td>
<td>15.845818</td>
<td>15.336689</td>
<td>16.389999</td>
<td>40.544498</td>
<td>0.548000</td>
<td>12.401443</td>
<td>22.939653</td>
<td>...</td>
<td>10.930552</td>
<td>18.678860</td>
<td>8.558210</td>
<td>14.166265</td>
<td>9.163671</td>
<td>29.840557</td>
<td>14.970891</td>
<td>12.703233</td>
<td>13.405689</td>
<td>19.353123</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2002-01-03</td>
<td>0.356478</td>
<td>14.949829</td>
<td>18.223030</td>
<td>16.462933</td>
<td>16.742651</td>
<td>19.370001</td>
<td>39.063622</td>
<td>0.595000</td>
<td>13.412239</td>
<td>23.304060</td>
<td>...</td>
<td>10.987591</td>
<td>19.897335</td>
<td>8.483836</td>
<td>14.007341</td>
<td>9.500431</td>
<td>30.388485</td>
<td>15.467968</td>
<td>12.687912</td>
<td>13.562436</td>
<td>19.382444</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2002-01-04</td>
<td>0.358142</td>
<td>14.923078</td>
<td>19.880976</td>
<td>17.866358</td>
<td>16.643274</td>
<td>20.000000</td>
<td>39.983780</td>
<td>0.612500</td>
<td>13.530748</td>
<td>24.116026</td>
<td>...</td>
<td>11.038470</td>
<td>19.702888</td>
<td>8.386379</td>
<td>14.081776</td>
<td>9.714135</td>
<td>31.040512</td>
<td>15.625422</td>
<td>12.604758</td>
<td>13.742058</td>
<td>19.548613</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2002-01-07</td>
<td>0.346199</td>
<td>14.818766</td>
<td>18.983816</td>
<td>17.995752</td>
<td>16.466602</td>
<td>19.980000</td>
<td>40.034107</td>
<td>0.617000</td>
<td>13.377389</td>
<td>24.039314</td>
<td>...</td>
<td>10.904343</td>
<td>19.061247</td>
<td>8.296615</td>
<td>13.991246</td>
<td>9.702801</td>
<td>31.292574</td>
<td>15.529715</td>
<td>12.558800</td>
<td>13.768172</td>
<td>19.377560</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2023-11-24</td>
<td>189.727905</td>
<td>102.375435</td>
<td>332.824677</td>
<td>619.429993</td>
<td>150.085632</td>
<td>122.309998</td>
<td>263.400879</td>
<td>146.740005</td>
<td>689.972473</td>
<td>163.890518</td>
<td>...</td>
<td>67.166924</td>
<td>152.387482</td>
<td>47.501419</td>
<td>543.098999</td>
<td>221.883804</td>
<td>150.343994</td>
<td>36.789608</td>
<td>51.651596</td>
<td>182.729935</td>
<td>103.607109</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2023-11-27</td>
<td>189.548126</td>
<td>102.216202</td>
<td>331.220490</td>
<td>619.270020</td>
<td>150.554840</td>
<td>122.650002</td>
<td>262.220093</td>
<td>147.729996</td>
<td>687.177368</td>
<td>163.511749</td>
<td>...</td>
<td>67.088799</td>
<td>151.405243</td>
<td>47.402313</td>
<td>539.614685</td>
<td>217.501144</td>
<td>147.931061</td>
<td>36.730602</td>
<td>51.886585</td>
<td>182.710037</td>
<td>103.002724</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2023-11-28</td>
<td>190.157349</td>
<td>101.569321</td>
<td>331.350037</td>
<td>623.320007</td>
<td>147.809494</td>
<td>122.010002</td>
<td>263.460419</td>
<td>147.029999</td>
<td>674.809021</td>
<td>165.126541</td>
<td>...</td>
<td>67.352470</td>
<td>151.702881</td>
<td>47.471687</td>
<td>536.577087</td>
<td>218.866394</td>
<td>149.068314</td>
<td>36.848614</td>
<td>52.505505</td>
<td>183.207840</td>
<td>102.943283</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2023-11-29</td>
<td>189.128662</td>
<td>103.131775</td>
<td>332.127197</td>
<td>617.390015</td>
<td>149.107300</td>
<td>123.849998</td>
<td>264.532043</td>
<td>146.320007</td>
<td>686.408752</td>
<td>166.890823</td>
<td>...</td>
<td>66.268501</td>
<td>152.000534</td>
<td>47.104992</td>
<td>531.067627</td>
<td>219.103821</td>
<td>150.601105</td>
<td>37.133804</td>
<td>51.658218</td>
<td>186.314056</td>
<td>101.397644</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2023-11-30</td>
<td>189.707916</td>
<td>103.788605</td>
<td>331.927948</td>
<td>611.010010</td>
<td>149.526596</td>
<td>121.160004</td>
<td>267.548492</td>
<td>146.089996</td>
<td>682.565491</td>
<td>170.220078</td>
<td>...</td>
<td>66.454048</td>
<td>151.514374</td>
<td>47.273476</td>
<td>548.926025</td>
<td>222.863235</td>
<td>149.928665</td>
<td>37.694355</td>
<td>51.529133</td>
<td>186.712296</td>
<td>101.793961</td>
</tr>
</tbody>
</table>

<p>5518 rows × 111 columns</p>
</div>
</div>
</div>
</div>
<div id="223f3d40" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> data_init.T</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th">2001-12-31</th>
<th data-quarto-table-cell-role="th">2002-01-02</th>
<th data-quarto-table-cell-role="th">2002-01-03</th>
<th data-quarto-table-cell-role="th">2002-01-04</th>
<th data-quarto-table-cell-role="th">2002-01-07</th>
<th data-quarto-table-cell-role="th">2002-01-08</th>
<th data-quarto-table-cell-role="th">2002-01-09</th>
<th data-quarto-table-cell-role="th">2002-01-10</th>
<th data-quarto-table-cell-role="th">2002-01-11</th>
<th data-quarto-table-cell-role="th">2002-01-14</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">2023-11-16</th>
<th data-quarto-table-cell-role="th">2023-11-17</th>
<th data-quarto-table-cell-role="th">2023-11-20</th>
<th data-quarto-table-cell-role="th">2023-11-21</th>
<th data-quarto-table-cell-role="th">2023-11-22</th>
<th data-quarto-table-cell-role="th">2023-11-24</th>
<th data-quarto-table-cell-role="th">2023-11-27</th>
<th data-quarto-table-cell-role="th">2023-11-28</th>
<th data-quarto-table-cell-role="th">2023-11-29</th>
<th data-quarto-table-cell-role="th">2023-11-30</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Ticker</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">AAPL</td>
<td>0.331081</td>
<td>0.352246</td>
<td>0.356478</td>
<td>0.358142</td>
<td>0.346199</td>
<td>0.341815</td>
<td>0.327301</td>
<td>0.320952</td>
<td>0.318231</td>
<td>0.319743</td>
<td>...</td>
<td>189.468246</td>
<td>189.448257</td>
<td>191.206009</td>
<td>190.397049</td>
<td>191.066193</td>
<td>189.727905</td>
<td>189.548126</td>
<td>190.157349</td>
<td>189.128662</td>
<td>189.707916</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ABT</td>
<td>14.912379</td>
<td>14.936456</td>
<td>14.949829</td>
<td>14.923078</td>
<td>14.818766</td>
<td>14.722468</td>
<td>14.642225</td>
<td>14.775971</td>
<td>15.004192</td>
<td>15.006884</td>
<td>...</td>
<td>99.777985</td>
<td>99.071396</td>
<td>100.713455</td>
<td>101.420052</td>
<td>102.206245</td>
<td>102.375435</td>
<td>102.216202</td>
<td>101.569321</td>
<td>103.131775</td>
<td>103.788605</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ACN</td>
<td>19.321152</td>
<td>18.811560</td>
<td>18.223030</td>
<td>19.880976</td>
<td>18.983816</td>
<td>19.579529</td>
<td>19.787670</td>
<td>19.967098</td>
<td>18.998173</td>
<td>17.900053</td>
<td>...</td>
<td>326.129120</td>
<td>326.637238</td>
<td>329.696075</td>
<td>329.058411</td>
<td>331.917969</td>
<td>332.824677</td>
<td>331.220490</td>
<td>331.350037</td>
<td>332.127197</td>
<td>331.927948</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ADBE</td>
<td>15.452657</td>
<td>15.845818</td>
<td>16.462933</td>
<td>17.866358</td>
<td>17.995752</td>
<td>18.234634</td>
<td>18.727327</td>
<td>18.140078</td>
<td>17.931051</td>
<td>17.717054</td>
<td>...</td>
<td>602.059998</td>
<td>602.659973</td>
<td>612.700012</td>
<td>610.989990</td>
<td>619.719971</td>
<td>619.429993</td>
<td>619.270020</td>
<td>623.320007</td>
<td>617.390015</td>
<td>611.010010</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">AMAT</td>
<td>14.758861</td>
<td>15.336689</td>
<td>16.742651</td>
<td>16.643274</td>
<td>16.466602</td>
<td>16.849388</td>
<td>17.180624</td>
<td>16.926674</td>
<td>16.565987</td>
<td>16.676403</td>
<td>...</td>
<td>154.216721</td>
<td>148.020569</td>
<td>151.985306</td>
<td>148.678024</td>
<td>149.227097</td>
<td>150.085632</td>
<td>150.554840</td>
<td>147.809494</td>
<td>149.107300</td>
<td>149.526596</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">UPS</td>
<td>29.862459</td>
<td>29.840557</td>
<td>30.388485</td>
<td>31.040512</td>
<td>31.292574</td>
<td>31.352852</td>
<td>31.128199</td>
<td>31.150120</td>
<td>30.969296</td>
<td>30.700804</td>
<td>...</td>
<td>145.280777</td>
<td>146.338913</td>
<td>147.911285</td>
<td>148.109070</td>
<td>149.078201</td>
<td>150.343994</td>
<td>147.931061</td>
<td>149.068314</td>
<td>150.601105</td>
<td>149.928665</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">VZ</td>
<td>14.652889</td>
<td>14.970891</td>
<td>15.467968</td>
<td>15.625422</td>
<td>15.529715</td>
<td>15.493931</td>
<td>15.207698</td>
<td>15.360151</td>
<td>15.462824</td>
<td>15.652602</td>
<td>...</td>
<td>35.580006</td>
<td>35.629177</td>
<td>36.120884</td>
<td>36.632263</td>
<td>36.730602</td>
<td>36.789608</td>
<td>36.730602</td>
<td>36.848614</td>
<td>37.133804</td>
<td>37.694355</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">WMT</td>
<td>12.593814</td>
<td>12.703233</td>
<td>12.687912</td>
<td>12.604758</td>
<td>12.558800</td>
<td>12.657275</td>
<td>12.342160</td>
<td>12.473463</td>
<td>12.210861</td>
<td>12.202105</td>
<td>...</td>
<td>51.644978</td>
<td>51.416603</td>
<td>51.400055</td>
<td>51.585403</td>
<td>51.191544</td>
<td>51.651596</td>
<td>51.886585</td>
<td>52.505505</td>
<td>51.658218</td>
<td>51.529133</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">WSM</td>
<td>14.009839</td>
<td>13.405689</td>
<td>13.562436</td>
<td>13.742058</td>
<td>13.768172</td>
<td>13.856347</td>
<td>13.539575</td>
<td>13.840023</td>
<td>13.405689</td>
<td>13.193413</td>
<td>...</td>
<td>170.693298</td>
<td>178.060654</td>
<td>181.146957</td>
<td>179.145844</td>
<td>180.669083</td>
<td>182.729935</td>
<td>182.710037</td>
<td>183.207840</td>
<td>186.314056</td>
<td>186.712296</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">XOM</td>
<td>19.206507</td>
<td>19.353123</td>
<td>19.382444</td>
<td>19.548613</td>
<td>19.377560</td>
<td>19.402000</td>
<td>19.177185</td>
<td>19.250490</td>
<td>18.815535</td>
<td>18.883953</td>
<td>...</td>
<td>101.516541</td>
<td>103.993515</td>
<td>103.537758</td>
<td>103.498123</td>
<td>103.052269</td>
<td>103.607109</td>
<td>103.002724</td>
<td>102.943283</td>
<td>101.397644</td>
<td>101.793961</td>
</tr>
</tbody>
</table>

<p>111 rows × 5518 columns</p>
</div>
</div>
</div>
</div>
<section id="знаходження-коефіцієнтів-матриці-крос-кореляцій-1" class="level3" data-number="8.2.1">
<h3 data-number="8.2.1" class="anchored" data-anchor-id="знаходження-коефіцієнтів-матриці-крос-кореляцій-1"><span class="header-section-number">8.2.1</span> Знаходження коефіцієнтів матриці крос-кореляцій</h3>
<p>Перш за все нам потребується процедура для перетворення ряду до потрібного нам виду. Для цього визначимо функцію <code>transformation()</code>. З її допомогою для всього ряду та у віконній процедурі будемо рахувати прибутковості та всі необхідні індикатори.</p>
<div id="5a0dbf61" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> transformation(signal, ret_type):</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    for_rmt <span class="op">=</span> signal.copy()</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Зважаючи на вид ряду, виконуємо</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># необхідні перетворення</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ret_type <span class="op">==</span> <span class="dv">1</span>:       </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>        for_rmt.values</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> ret_type <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>        for_rmt <span class="op">=</span> for_rmt.diff(axis<span class="op">=</span><span class="dv">1</span>).values</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> ret_type <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>        for_rmt <span class="op">=</span> for_rmt.pct_change(axis<span class="op">=</span><span class="dv">1</span>).values</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> ret_type <span class="op">==</span> <span class="dv">4</span>:</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>        for_rmt <span class="op">=</span> for_rmt.pct_change(axis<span class="op">=</span><span class="dv">1</span>).dropna(axis<span class="op">=</span><span class="dv">1</span>).values</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>        for_rmt <span class="op">-=</span> np.nanmean(for_rmt, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>        for_rmt <span class="op">/=</span> np.nanstd(for_rmt, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> ret_type <span class="op">==</span> <span class="dv">5</span>: </span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>        for_rmt <span class="op">=</span> for_rmt.pct_change(axis<span class="op">=</span><span class="dv">1</span>).values</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>        for_rmt <span class="op">=</span> for_rmt[<span class="op">~</span>np.isnan(for_rmt).<span class="bu">any</span>(axis<span class="op">=</span><span class="dv">1</span>)]</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>        for_rmt <span class="op">-=</span> np.mean(for_rmt, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>        for_rmt <span class="op">/=</span> np.std(for_rmt, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>        for_rmt <span class="op">=</span> np.<span class="bu">abs</span>(for_rmt)</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> ret_type <span class="op">==</span> <span class="dv">6</span>:</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>        for_rmt <span class="op">=</span> for_rmt.values</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>        for_rmt <span class="op">-=</span> np.mean(for_rmt, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>        for_rmt <span class="op">/=</span> np.std(for_rmt, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> for_rmt</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="ffd3dd00" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span> <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>log_ret <span class="op">=</span> transformation(data, <span class="bu">type</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="40909d96" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>N, T <span class="op">=</span> log_ret.shape</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Будуємо матрицю кореляцій для матриці прибутковостей наших активів:</p>
<div id="7768c4ce" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calc_cross_corr(data):</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    C <span class="op">=</span> (<span class="dv">1</span><span class="op">/</span>T)<span class="op">*</span>np.dot(data, data.T)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    di <span class="op">=</span> np.diag_indices(data.shape[<span class="dv">0</span>])</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    ccoef <span class="op">=</span> np.ma.asarray(C)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    ccoef[di] <span class="op">=</span> np.ma.masked </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    ccoef_flat <span class="op">=</span> ccoef.compressed()</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> C, ccoef_flat</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="dd2f2033" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>C, ccoef_flat <span class="op">=</span> calc_cross_corr(log_ret)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>І матрицю кореляцій для перемішаної матриці прибутковостей:</p>
<div id="8abee2ac" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">1234</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>random_stocks <span class="op">=</span> np.random.normal(size<span class="op">=</span>(N,T))</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>R, ccoef_flat_rand <span class="op">=</span> calc_cross_corr(random_stocks)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Виводимо результат:</p>
<div id="cell-fig-matrix-cor" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>gs <span class="op">=</span> gridspec.GridSpec(<span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> fig.add_subplot(gs[<span class="dv">0</span>, <span class="dv">0</span>])</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>im1 <span class="op">=</span> ax1.imshow(C, cmap<span class="op">=</span><span class="st">'hot'</span>, interpolation<span class="op">=</span><span class="st">'nearest'</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>ax1.invert_yaxis()</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>fig.colorbar(im1, ax<span class="op">=</span>ax1)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> fig.add_subplot(gs[<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>im2 <span class="op">=</span> ax2.imshow(R, cmap<span class="op">=</span><span class="st">'hot'</span>, interpolation<span class="op">=</span><span class="st">'nearest'</span>)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>ax2.invert_yaxis()</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>fig.colorbar(im2, ax<span class="op">=</span>ax2)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>ax3 <span class="op">=</span> fig.add_subplot(gs[<span class="dv">1</span>, :])</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>ax3.hist(ccoef_flat, bins<span class="op">=</span><span class="st">'auto'</span>, density<span class="op">=</span><span class="va">True</span>, label<span class="op">=</span><span class="vs">r'$P^</span><span class="sc">{init}</span><span class="vs">(C_</span><span class="sc">{ij}</span><span class="vs">)$'</span>)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>ax3.hist(ccoef_flat_rand, bins<span class="op">=</span><span class="st">'auto'</span>, density<span class="op">=</span><span class="va">True</span>, label<span class="op">=</span><span class="vs">r'$P^</span><span class="sc">{rand}</span><span class="vs">(C_</span><span class="sc">{ij}</span><span class="vs">)$'</span>)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>ax3.set_xlabel(<span class="vs">r'$C_</span><span class="sc">{ij}</span><span class="vs">$'</span>)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>ax3.set_ylabel(<span class="vs">r'$P(C_</span><span class="sc">{ij}</span><span class="vs">)$'</span>)</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>ax3.legend()</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>fig.align_labels()</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>plt.show()<span class="op">;</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-matrix-cor" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-matrix-cor-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lab_8_files/figure-html/fig-matrix-cor-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-matrix-cor-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Рис.&nbsp;8.1: Карти полів кореляцій вихідної і перемішаної матриць. У нижній частині рисунку представлено порівняння розподілів значень коефіцієнтів кореляції вихідної та перемішаної матриць
</figcaption>
</figure>
</div>
</div>
</div>
<p>На <a href="#fig-matrix-cor" class="quarto-xref">Рис.&nbsp;<span>8.1</span></a> видно, що розподіл коефіцієнтів кореляції для вихідної матриці значно відхиляється розподілу для випадкової матриці. Можна помітити, що <span class="math inline">\(P^{init}(C_{ij})\)</span> представляється доволі розтягненим в діапазоні <span class="math inline">\(C_{ij}\in [0.1, 0.8]\)</span>, що вказує на те, що достатньо багато досліджуваних активів досить сильно відрізняють один від одного. Можна виокремити активи, які характеризуються досить значним ступенем лінійної залежності по відношенню до більності активів на протязі значного часу існування, а є такі активи, які проявляють лінійну залежність лише в конкретних ринкових умовах. Тим не менш, увесь ринок характеризується досить значним ступенем детермінованості.</p>
</section>
<section id="розподіл-власних-значень-та-векторів" class="level3" data-number="8.2.2">
<h3 data-number="8.2.2" class="anchored" data-anchor-id="розподіл-власних-значень-та-векторів"><span class="header-section-number">8.2.2</span> Розподіл власних значень та векторів</h3>
<div id="1ee159f1" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calc_lambd_eig(C):</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.linalg.eig(C)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="f303fa90" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>lambdas, u <span class="op">=</span> calc_lambd_eig(C)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>lambdas_rand, u_rand <span class="op">=</span> calc_lambd_eig(R)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>Q <span class="op">=</span> T<span class="op">/</span>N</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>lambda_plus <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> <span class="dv">1</span><span class="op">/</span>Q <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>np.sqrt(<span class="dv">1</span><span class="op">/</span>Q)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>lambda_minus <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> <span class="dv">1</span><span class="op">/</span>Q <span class="op">-</span> <span class="dv">2</span><span class="op">*</span>np.sqrt(<span class="dv">1</span><span class="op">/</span>Q)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Верхня границя розподілу власних значень, що прогнозується ТВМ: "</span>, lambda_plus)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Нижня границя розподілу власних значень, що прогнозується ТВМ: "</span>, lambda_minus)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Верхня границя розподілу власних значень, що прогнозується ТВМ:  1.3038069950128888
Нижня границя розподілу власних значень, що прогнозується ТВМ:  0.6961930049871112</code></pre>
</div>
</div>
<p>Генеруємо 1000 випадкових значень в діапазоні від <span class="math inline">\(\lambda_{-}\)</span> до <span class="math inline">\(\lambda_{+}\)</span>, і генеруємо <span class="math inline">\(P_{rm}(\lambda)\)</span>.</p>
<div id="ce846065" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>lambda_random <span class="op">=</span> np.linspace(lambda_minus, lambda_plus, <span class="dv">1000</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>P_rm <span class="op">=</span> (Q<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>np.pi))<span class="op">*</span>np.sqrt((lambda_plus<span class="op">-</span>lambda_random)<span class="op">*</span>(lambda_random<span class="op">-</span>lambda_minus))<span class="op">/</span>lambda_random</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Виводимо результат:</p>
<div id="cell-fig-lambda" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].hist(lambdas, bins<span class="op">=</span><span class="dv">50</span>, density<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">"skyblue"</span>, label<span class="op">=</span><span class="st">'$P^</span><span class="sc">{init}</span><span class="st">_{\it</span><span class="sc">{empiric}</span><span class="st">}$'</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].hist(lambdas_rand, bins<span class="op">=</span><span class="st">'auto'</span>, density<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">"red"</span>, label<span class="op">=</span><span class="st">'$P^</span><span class="sc">{rand}</span><span class="st">_{\it</span><span class="sc">{empiric}</span><span class="st">}$'</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xlabel(<span class="st">'$\lambda_</span><span class="sc">{i}</span><span class="st">$'</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_ylabel(<span class="st">'$P(\lambda_</span><span class="sc">{i}</span><span class="st">)$'</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].text(<span class="dv">20</span>, <span class="fl">0.5</span>, <span class="st">'$\lambda_</span><span class="sc">{max}</span><span class="st">=$'</span><span class="op">+</span><span class="ss">f'</span><span class="sc">{</span>lambdas<span class="sc">.</span><span class="bu">max</span>()<span class="sc">:.2f}</span><span class="ss">'</span>, ha<span class="op">=</span><span class="st">'center'</span>, va<span class="op">=</span><span class="st">'center'</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_yscale(<span class="st">'log'</span>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].legend()</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].hist(lambdas, bins<span class="op">=</span><span class="st">'auto'</span>, density<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">"skyblue"</span>, label<span class="op">=</span><span class="st">'$P^</span><span class="sc">{init}</span><span class="st">_{\it</span><span class="sc">{empiric}</span><span class="st">}$'</span>)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].hist(lambdas_rand, bins<span class="op">=</span><span class="st">'auto'</span>, density<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">"red"</span>, label<span class="op">=</span><span class="st">'$P^</span><span class="sc">{rand}</span><span class="st">_{\it</span><span class="sc">{empiric}</span><span class="st">}$'</span>)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xlabel(<span class="st">'$\lambda_</span><span class="sc">{i}</span><span class="st">$'</span>)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_ylabel(<span class="st">'$P(\lambda_</span><span class="sc">{i}</span><span class="st">)$'</span>)</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xlim(lambda_minus<span class="op">-</span><span class="dv">3</span><span class="op">*</span>np.std(lambdas_rand), lambda_plus<span class="op">+</span><span class="dv">3</span><span class="op">*</span>np.std(lambdas_rand))</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].scatter(lambda_random, P_rm, label<span class="op">=</span><span class="st">'$P_{\it</span><span class="sc">{RMT}</span><span class="st">}$'</span>, color<span class="op">=</span><span class="st">'green'</span>)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].legend()</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>plt.show()<span class="op">;</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-lambda" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lambda-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lab_8_files/figure-html/fig-lambda-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lambda-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Рис.&nbsp;8.2: Щільність розподілу ймовірностей для матриці прибутковостей фінансових активів <span class="math inline">\(P_{empiric}^{init}\)</span> та випадкової матриці <span class="math inline">\(P_{empiric}^{rand}\)</span>. Другий рисунок представляє щільність розподілу, що прогнозується ТВМ <span class="math inline">\((P_{RMT})\)</span>
</figcaption>
</figure>
</div>
</div>
</div>
<p>На <a href="#fig-lambda" class="quarto-xref">Рис.&nbsp;<span>8.2</span></a> видно, що розподіл <span class="math inline">\(\lambda_i\)</span> значно відхиляється від тієї частки, що відповідає випадковій матриці крос-кореляцій (<span class="math inline">\(P^{rand}_{empiric}\)</span>). Для вихідного розподілу видно, що <span class="math inline">\(\lambda_{max}\)</span> значно відхиляється від передбачення ТВМ. Для <span class="math inline">\(P^{init}_{empiric}\)</span> знаходяться і такі власні значення, що менші за ті, що знаходяться на нижній границі випадкової матриці. Загалом, така закономірність вказує на те, що на ринку є один або декілька індексів, що регулюють динаміку всього ринку.</p>
<p>На <a href="#fig-eigen" class="quarto-xref">Рис.&nbsp;<span>8.3</span></a> представлено щільність розподілу ймовірностей компонент власних векторів вихідної матриці прибутковостей і випадкової матриці при <span class="math inline">\(\lambda_{1}\)</span>, <span class="math inline">\(\lambda_{30}\)</span> та <span class="math inline">\(\lambda_{70}\)</span>.</p>
<div id="cell-fig-eigen" class="cell" data-scrolled="false" data-execution_count="22">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">3</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>), sharex<span class="op">=</span><span class="va">True</span>, sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].hist(u[:, <span class="dv">0</span>], bins<span class="op">=</span><span class="dv">50</span>, density<span class="op">=</span><span class="va">True</span>, label<span class="op">=</span><span class="vs">r'$\rho(u)_</span><span class="sc">{empiric}</span><span class="vs">^</span><span class="sc">{init}</span><span class="vs">$'</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].hist(u_rand[:, <span class="dv">0</span>], bins<span class="op">=</span><span class="dv">50</span>, density<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, label<span class="op">=</span><span class="vs">r'$\rho(u)_</span><span class="sc">{empiric}</span><span class="vs">^</span><span class="sc">{rand}</span><span class="vs">$'</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xlabel(<span class="st">'$u_</span><span class="sc">{1}</span><span class="st">$'</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_ylabel(<span class="st">'$P(u)$'</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_title(<span class="st">'Компоненти власного вектора при $ \lambda_</span><span class="sc">{1}</span><span class="st"> $'</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].legend()</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_yscale(<span class="st">'log'</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].hist(u[:, <span class="dv">30</span>], bins<span class="op">=</span><span class="dv">50</span>, density<span class="op">=</span><span class="va">True</span>, label<span class="op">=</span><span class="vs">r'$\rho(u)_</span><span class="sc">{empiric}</span><span class="vs">^</span><span class="sc">{init}</span><span class="vs">$'</span>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].hist(u_rand[:, <span class="dv">30</span>], bins<span class="op">=</span><span class="dv">50</span>, density<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, label<span class="op">=</span><span class="vs">r'$\rho(u)_</span><span class="sc">{empiric}</span><span class="vs">^</span><span class="sc">{rand}</span><span class="vs">$'</span>)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xlabel(<span class="st">'$u_</span><span class="sc">{30}</span><span class="st">$'</span>)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_ylabel(<span class="st">'$P(u)$'</span>)</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_title(<span class="st">'Компоненти власного вектора при $ \lambda_</span><span class="sc">{30}</span><span class="st"> $'</span>)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].legend()</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_yscale(<span class="st">'log'</span>)</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].hist(u[:, <span class="dv">70</span>], bins<span class="op">=</span><span class="dv">50</span>, density<span class="op">=</span><span class="va">True</span>, label<span class="op">=</span><span class="vs">r'$\rho(u)_</span><span class="sc">{empiric}</span><span class="vs">^</span><span class="sc">{init}</span><span class="vs">$'</span>)</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].hist(u_rand[:, <span class="dv">70</span>], bins<span class="op">=</span><span class="dv">50</span>, density<span class="op">=</span><span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, label<span class="op">=</span><span class="vs">r'$\rho(u)_</span><span class="sc">{empiric}</span><span class="vs">^</span><span class="sc">{rand}</span><span class="vs">$'</span>)</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].set_xlabel(<span class="st">'$u_</span><span class="sc">{70}</span><span class="st">$'</span>)</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].set_ylabel(<span class="st">'$P(u)$'</span>)</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].set_title(<span class="st">'Компоненти власного вектора при $ \lambda_</span><span class="sc">{70}</span><span class="st"> $'</span>)</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].legend()</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].set_yscale(<span class="st">'log'</span>)</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>plt.show()<span class="op">;</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-eigen" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-eigen-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lab_8_files/figure-html/fig-eigen-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-eigen-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Рис.&nbsp;8.3: Щільність розподілу ймовірностей компонент власних векторів вихідної матриці прибутковостей і випадкової матриці при <span class="math inline">\(\lambda_1\)</span>, <span class="math inline">\(\lambda_{30}\)</span> та <span class="math inline">\(\lambda_{70}\)</span>
</figcaption>
</figure>
</div>
</div>
</div>
<p>На <a href="#fig-eigen" class="quarto-xref">Рис.&nbsp;<span>8.3</span></a> видно, що компоненти власного вектора при найбільшому власному значень значно відхиляються від передбачення ТВМ, що вказує на значний ступінь впливовості індексу, який відповідає <span class="math inline">\(\lambda_{1}\)</span>. При <span class="math inline">\(\lambda_{30}\)</span> та <span class="math inline">\(\lambda_{70}\)</span> розподіл компонент власних векторів вихідних значень починає збігатися до розподілу випадкових значень, що говорить про незначний вплив індексів, яким відповідають ці власні значення. Оскільки розподіл компонент їх векторів близький до ТВМ, можна сказати, що вони вносять найбільший шум у динаміку ринку.</p>
<p>На <a href="#fig-ipr" class="quarto-xref">Рис.&nbsp;<span>8.4</span></a> представлено ОВУ для вихідної матриці крос-кореляцій та випадкової.</p>
</section>
<section id="обернене-відношення-участі-1" class="level3" data-number="8.2.3">
<h3 data-number="8.2.3" class="anchored" data-anchor-id="обернене-відношення-участі-1"><span class="header-section-number">8.2.3</span> Обернене відношення участі</h3>
<div id="f8cb8a09" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calc_ipr(u):</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.<span class="bu">sum</span>(u<span class="op">**</span><span class="dv">4</span>, axis<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="b5165d74" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>IPR <span class="op">=</span> calc_ipr(u)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>IPR_rand <span class="op">=</span> calc_ipr(u_rand)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-fig-ipr" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>ax.scatter(lambdas, IPR, color<span class="op">=</span><span class="st">'green'</span>, label<span class="op">=</span><span class="vs">r'$IPR_</span><span class="sc">{init}</span><span class="vs">$'</span>, s<span class="op">=</span><span class="dv">10</span><span class="op">**</span><span class="dv">2</span>, marker<span class="op">=</span><span class="st">'x'</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>ax.scatter(lambdas_rand, IPR_rand, color<span class="op">=</span><span class="st">'red'</span>, label<span class="op">=</span><span class="vs">r'$IPR_</span><span class="sc">{rand}</span><span class="vs">$'</span>, s<span class="op">=</span><span class="dv">10</span><span class="op">**</span><span class="dv">2</span>, marker<span class="op">=</span><span class="st">'x'</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="vs">r'$\lambda_</span><span class="sc">{i}</span><span class="vs">$'</span>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">r'$IPR$'</span>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>ax.set_xscale(<span class="st">'log'</span>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>plt.show()<span class="op">;</span> </span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-ipr" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ipr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lab_8_files/figure-html/fig-ipr-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ipr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Рис.&nbsp;8.4: ОВУ для вихідної та випадкової матриць крос-кореляцій
</figcaption>
</figure>
</div>
</div>
</div>
<p>На <a href="#fig-ipr" class="quarto-xref">Рис.&nbsp;<span>8.4</span></a> видно, що ОВУ для, наприклад, випадкової матриці концентрується в межах <span class="math inline">\(\lambda_i \approx 10^0\)</span>. Для даних, що значно відхиляються від випадкових, ОВУ має довгі хвости, які виходять далеко за межі передбачень ТВМ. Для набільшого власного вектора ОВУ локалізується далеко в правому хвості розподілу. Також видно, що деякі власні значення мають <span class="math inline">\(IRP \approx 0.25\)</span>. Це говорить про те, що компоненти деяких векторів розподілені асиметрично, що може вказувати на деяких ступінь впливу фондових індексів, яким властиві дані вектори.</p>
</section>
<section id="коефіцієнт-поглинання" class="level3" data-number="8.2.4">
<h3 data-number="8.2.4" class="anchored" data-anchor-id="коефіцієнт-поглинання"><span class="header-section-number">8.2.4</span> Коефіцієнт поглинання</h3>
<p>Цікаво буде буде порівняти максимальне власне значення <span class="math inline">\(\lambda_{max}\)</span> з середнім значенням коефіцієнта кореляції і так званим <strong>коефіцієнтом поглинання</strong> (absorption ratio, AR), який є кумулятивною мірою ризику:</p>
<p><span id="eq-8-9"><span class="math display">\[
AR = \sum_{k=1}^{n}\lambda_k \bigg/ \sum_{k=1}^{N}\lambda_k.
\tag{8.9}\]</span></span></p>
<p><span class="math inline">\(AR\)</span> вказує, яку частину загальної варіації описують <span class="math inline">\(n\)</span> із загальної кількості <span class="math inline">\(N\)</span> власних значень.</p>
<p>Щоб вирішити, який власний вектор можна відкинути для розрахунків у чисельнику формули вище, не втрачаючи занадто багато інформації, нам потрібно перевірити відповідні власні значення: власні вектори з найменшими власними значеннями є найменш інформативними, тому їх і можна відсікти.</p>
<p>Загальний підхід полягає в упорядкуванні власних значень від найвищого до найнижчого.</p>
<p>Після сортування власних значень постає питання: “яку кількість найбільш інформативних власних компонент треба вибрати для розрахунку коефіцієнту поглинання?”. Корисною мірою є так звана “врахована (пояснена) дисперсія”, яка може бути обчислена за власними значеннями. Пояснена дисперсія говорить нам, яку частину інформації (дисперсії) можна віднести до кожної із головних компонент.</p>
<p>Визначимо слідуючу функцію для коефіцієнту поглинання:</p>
<div id="357c979d" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ar(lambdas, proc):</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># сортуємо власні значення у спадному порядку</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    sorted_lambdas <span class="op">=</span> np.sort(lambdas)[::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># розраховуємо кумулятивну варіацію </span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    cumulative_variance <span class="op">=</span> np.cumsum(sorted_lambdas) <span class="op">/</span> np.<span class="bu">sum</span>(sorted_lambdas)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># знаходимо індекс, де кумулятивна варіація перетинає "proc"</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    index_percent <span class="op">=</span> np.argmax(cumulative_variance <span class="op">&gt;=</span> proc) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># виділяємо верхні власні значення, які описують встановлений відсоток даних</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    selected_lambdas <span class="op">=</span> sorted_lambdas[:index_percent]</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># повертаємо коефіцієнт поглинання та кількість значень, що пояснюють обраний відсоток варіації</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.<span class="bu">sum</span>(selected_lambdas)<span class="op">/</span>np.<span class="bu">sum</span>(sorted_lambdas), <span class="bu">len</span>(selected_lambdas)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Розглянемо, як варіюється коефіцієнт поглинання при різних значеннях поясненої варіації власними значеннями матриці кореляцій. На <a href="#fig-ar" class="quarto-xref">Рис.&nbsp;<span>8.5</span></a> представлено залежність коефіцієнта поглинання від різних значень поясненої варіації власними значеннями матриць кореляції вихідних прибутковостей та випадкових. Також представлено залежність кількості поясненої варіації від кількості власних значень, що пояснюють такий відсоток.</p>
<div id="cell-fig-ar" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>proc_variance <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="fl">0.99</span>, <span class="dv">100</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>ar_init <span class="op">=</span> np.array([ar(lambdas, proc)[<span class="dv">0</span>] <span class="cf">for</span> proc <span class="kw">in</span> proc_variance])</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>ar_rand <span class="op">=</span> np.array([ar(lambdas_rand, proc)[<span class="dv">0</span>] <span class="cf">for</span> proc <span class="kw">in</span> proc_variance])</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>lambdas_init_cnt <span class="op">=</span> np.array([ar(lambdas, proc)[<span class="dv">1</span>] <span class="cf">for</span> proc <span class="kw">in</span> proc_variance])</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>lambdas_rand_cnt <span class="op">=</span> np.array([ar(lambdas_rand, proc)[<span class="dv">1</span>] <span class="cf">for</span> proc <span class="kw">in</span> proc_variance])</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(proc_variance, ar_init, color<span class="op">=</span><span class="st">'green'</span>, label<span class="op">=</span><span class="vs">r'$AR_</span><span class="sc">{init}</span><span class="vs">$'</span>)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(proc_variance, ar_rand, color<span class="op">=</span><span class="st">'red'</span>, label<span class="op">=</span><span class="vs">r'$AR_</span><span class="sc">{rand}</span><span class="vs">$'</span>)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xlabel(<span class="st">'Відсоток варіації</span><span class="ch">\n</span><span class="st">(a)'</span>)</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_ylabel(<span class="st">'$AR$'</span>)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].legend()</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(proc_variance, lambdas_init_cnt, color<span class="op">=</span><span class="st">'green'</span>, label<span class="op">=</span><span class="vs">r'$\#\lambda_</span><span class="sc">{i}</span><span class="vs">^</span><span class="sc">{init}</span><span class="vs">$'</span>)</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(proc_variance, lambdas_rand_cnt, color<span class="op">=</span><span class="st">'red'</span>, label<span class="op">=</span><span class="vs">r'$\#\lambda_</span><span class="sc">{i}</span><span class="vs">^</span><span class="sc">{rand}</span><span class="vs">$'</span>)</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xlabel(<span class="st">'Відсоток варіації</span><span class="ch">\n</span><span class="st">(b)'</span>)</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_ylabel(<span class="vs">r'Кі-ть $\lambda_i$'</span>)</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].legend()</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>plt.show()<span class="op">;</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-ar" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lab_8_files/figure-html/fig-ar-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Рис.&nbsp;8.5: Залежність коефіцієнта поглинання від різних значень поясненої варіації власними значеннями матриць кореляції вихідних прибутковостей та випадкових (a). Залежність кількості поясненої варіації від кількості власних значень, що пояснюють такий відсоток (b)
</figcaption>
</figure>
</div>
</div>
</div>
<p>Як ми можемо бачити на <a href="#fig-ar" class="quarto-xref">Рис.&nbsp;<span>8.5</span></a>, коефіцієнт поглинання для вихідної матриці кореляцій залишається сталим при перших 40% варіації. На рисунку справа видно, що лише одного власного значення достатньо для опису майже половини всього ринку. Для випадкової матриці кількість власних значень необхідних для опису системи зростає прямо пропоційно відсотку варіації. Отже, для нашої задачі при розрахунку коефіцієнту поглинання достатньо буде взяти до 40% варіації при врахуванні кількості необхідних власних значень у чисельнику (<a href="#eq-8-9" class="quarto-xref"><span>8.9</span></a>).</p>
</section>
<section id="віконна-процедура" class="level3" data-number="8.2.5">
<h3 data-number="8.2.5" class="anchored" data-anchor-id="віконна-процедура"><span class="header-section-number">8.2.5</span> Віконна процедура</h3>
<p>Перш ніж розпочинати розрахунки визначимо функцію для побудови графіків. Вона буде виводити один із часових рядів досліджуваної бази акцій компаній та розраховані індикатори. Ми будемо виводити як двовимірні, так і тривимірні графіки.</p>
<div id="e6872151" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_2d(time_ser_index, </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>            time_ser_values,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>            y1_values,  </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>            time_ser_label, </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>            y1_label, </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>            x_label,</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>            file_name, </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>            clr<span class="op">=</span><span class="st">"magenta"</span>):</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    ax2 <span class="op">=</span> ax.twinx()</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    ax2.spines.right.set_position((<span class="st">"axes"</span>, <span class="fl">1.03</span>))</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    p1, <span class="op">=</span> ax.plot(time_ser_index, </span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>                time_ser_values, </span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>                <span class="st">"b-"</span>, </span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span><span class="vs">fr"</span><span class="sc">{</span>time_ser_label<span class="sc">}</span><span class="vs">"</span>)</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>    p2, <span class="op">=</span> ax2.plot(time_ser_index, </span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>                y1_values, color<span class="op">=</span>clr, label<span class="op">=</span>y1_label)</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(x_label)</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="ss">f"</span><span class="sc">{</span>y1_label<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>    ax.yaxis.label.set_color(p1.get_color())</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>    ax2.yaxis.label.set_color(p2.get_color())</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>    tkw <span class="op">=</span> <span class="bu">dict</span>(size<span class="op">=</span><span class="dv">4</span>, width<span class="op">=</span><span class="fl">1.5</span>)</span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>    ax.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, rotation<span class="op">=</span><span class="dv">45</span>, <span class="op">**</span>tkw)</span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>    ax.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, colors<span class="op">=</span>p1.get_color(), <span class="op">**</span>tkw)</span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>    ax2.tick_params(axis<span class="op">=</span><span class="st">'y'</span>, colors<span class="op">=</span>p2.get_color(), <span class="op">**</span>tkw)</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>    ax2.legend(handles<span class="op">=</span>[p1, p2])</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>    plt.savefig(file_name <span class="op">+</span> <span class="st">".jpg"</span>)</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>    plt.show()<span class="op">;</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="0f31c59d" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>window <span class="op">=</span> <span class="dv">250</span>        <span class="co"># розмір вікна</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>tstep <span class="op">=</span> <span class="dv">1</span>           <span class="co"># крок вікна</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>ret_type <span class="op">=</span> <span class="dv">4</span>        <span class="co"># вид ряду: </span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># 1 - вихідний, </span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># 2 - детрендований (різниця між теп. значенням та попереднім)</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># 3 - прибутковості звичайні, </span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># 4 - стандартизовані прибутковості, </span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># 5 - абсолютні значення (волатильності)</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>                    <span class="co"># 6 - стандартизований ряд</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>length <span class="op">=</span> data.shape[<span class="dv">1</span>]</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>num_bins <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>mean_corr_init <span class="op">=</span> []</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>mean_corr_rand <span class="op">=</span> []</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>C_vals_init <span class="op">=</span> [] </span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>C_vals_rand <span class="op">=</span> []</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>C_hist_vals_init <span class="op">=</span> []</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>C_hist_vals_rand <span class="op">=</span> []</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>u_hist_vals_init <span class="op">=</span> []</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>u_hist_vals_rand <span class="op">=</span> []</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>lambdas_vals_init <span class="op">=</span> []</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>lambdas_vals_rand <span class="op">=</span> []</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>lambdas_vals_max_init <span class="op">=</span> []</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>lambdas_vals_max_rand <span class="op">=</span> []</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>lambdas_hist_vals_init <span class="op">=</span> []</span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>lambdas_hist_vals_rand <span class="op">=</span> []</span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>ipr_vals_init <span class="op">=</span> []</span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>ipr_vals_rand <span class="op">=</span> []</span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>absorb_vals_init <span class="op">=</span> []</span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>absorb_vals_rand <span class="op">=</span> []</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="70dec7aa" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> tqdm(<span class="bu">range</span>(<span class="dv">0</span>,length<span class="op">-</span>window,tstep)):</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># відбираємо фрагменти</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    fragm <span class="op">=</span> data.iloc[:, i:i<span class="op">+</span>window].copy()  </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># виконуємо процедуру трансформації ряду </span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    fragm <span class="op">=</span> transformation(fragm, ret_type)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    fragm <span class="op">=</span> fragm[<span class="op">~</span>np.isnan(fragm).<span class="bu">any</span>(axis<span class="op">=</span><span class="dv">1</span>)]</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># генеруємо випадковий фрагмент</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    fragm_random <span class="op">=</span> np.random.normal(size<span class="op">=</span>(fragm.shape[<span class="dv">0</span>], fragm.shape[<span class="dv">1</span>]))</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># розраховуємо крос-кореляції</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    C_fragm, ccoef_flat_fragm <span class="op">=</span> calc_cross_corr(fragm)</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>    C_fragm_random, ccoef_flat_fragm_random <span class="op">=</span> calc_cross_corr(fragm_random)</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># розраховуємо гістограму крос-кореляцій</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>    C_fragm_hist <span class="op">=</span> np.histogram(ccoef_flat_fragm, bins<span class="op">=</span>num_bins, density<span class="op">=</span><span class="va">True</span>)[<span class="dv">0</span>]</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>    C_fragm_hist_rand <span class="op">=</span> np.histogram(ccoef_flat_fragm_random, bins<span class="op">=</span>num_bins, density<span class="op">=</span><span class="va">True</span>)[<span class="dv">0</span>]</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># розрахунок середнього значення коефіцієнта кореляції</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>    mean_correlation <span class="op">=</span> np.mean(ccoef_flat_fragm)</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>    mean_correlation_random <span class="op">=</span> np.mean(ccoef_flat_fragm_random)</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># розрахунок власних значень та векторів</span></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>    lambdas_fragm, u_fragm <span class="op">=</span> calc_lambd_eig(C_fragm)</span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>    lambdas_fragm_random, u_fragm_random <span class="op">=</span> calc_lambd_eig(C_fragm_random)</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># розраховуємо гістограму власних значень</span></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>    lambdas_fragm_hist <span class="op">=</span> np.histogram(lambdas_fragm, bins<span class="op">=</span>num_bins, density<span class="op">=</span><span class="va">True</span>)[<span class="dv">0</span>]</span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>    u_fragm_hist_init <span class="op">=</span> np.histogram(u_fragm, bins<span class="op">=</span>num_bins, density<span class="op">=</span><span class="va">True</span>)[<span class="dv">0</span>]</span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>    lambdas_fragm_hist_rand <span class="op">=</span> np.histogram(lambdas_fragm_random, bins<span class="op">=</span>num_bins, density<span class="op">=</span><span class="va">True</span>)[<span class="dv">0</span>]</span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>    u_fragm_hist_rand <span class="op">=</span> np.histogram(u_fragm_random, bins<span class="op">=</span>num_bins, density<span class="op">=</span><span class="va">True</span>)[<span class="dv">0</span>]</span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># отримання максимального власного значення</span></span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>    lambdas_fragm_max <span class="op">=</span> lambdas_fragm.<span class="bu">max</span>()</span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>    lambdas_fragm_max_random <span class="op">=</span> lambdas_fragm_random.<span class="bu">max</span>()</span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># отримання оберненого відношення участі</span></span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>    ipr_fragm <span class="op">=</span> calc_ipr(u_fragm)</span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>    ipr_random <span class="op">=</span> calc_ipr(u_fragm_random)</span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># розрахунок коефіцієнта поглинання </span></span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a>    absorb_init <span class="op">=</span> ar(lambdas_fragm, <span class="fl">0.05</span>)[<span class="dv">0</span>]</span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a>    absorb_rand <span class="op">=</span> ar(lambdas_fragm_random, <span class="fl">0.05</span>)[<span class="dv">0</span>]</span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># додаємо індикатори до масивів</span></span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a>    mean_corr_init.append(mean_correlation)</span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a>    mean_corr_rand.append(mean_correlation_random)</span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true" tabindex="-1"></a>    C_vals_init.append(ccoef_flat_fragm)</span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true" tabindex="-1"></a>    C_vals_rand.append(ccoef_flat_fragm_random)</span>
<span id="cb33-53"><a href="#cb33-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-54"><a href="#cb33-54" aria-hidden="true" tabindex="-1"></a>    C_hist_vals_init.append(C_fragm_hist)</span>
<span id="cb33-55"><a href="#cb33-55" aria-hidden="true" tabindex="-1"></a>    C_hist_vals_rand.append(C_fragm_hist_rand)</span>
<span id="cb33-56"><a href="#cb33-56" aria-hidden="true" tabindex="-1"></a>    lambdas_hist_vals_init.append(lambdas_fragm_hist)</span>
<span id="cb33-57"><a href="#cb33-57" aria-hidden="true" tabindex="-1"></a>    lambdas_hist_vals_rand.append(lambdas_fragm_hist_rand)</span>
<span id="cb33-58"><a href="#cb33-58" aria-hidden="true" tabindex="-1"></a>    u_hist_vals_init.append(u_fragm_hist_init)</span>
<span id="cb33-59"><a href="#cb33-59" aria-hidden="true" tabindex="-1"></a>    u_hist_vals_rand.append(u_fragm_hist_rand)</span>
<span id="cb33-60"><a href="#cb33-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-61"><a href="#cb33-61" aria-hidden="true" tabindex="-1"></a>    lambdas_vals_init.append(lambdas_fragm)</span>
<span id="cb33-62"><a href="#cb33-62" aria-hidden="true" tabindex="-1"></a>    lambdas_vals_rand.append(lambdas_fragm_random)</span>
<span id="cb33-63"><a href="#cb33-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-64"><a href="#cb33-64" aria-hidden="true" tabindex="-1"></a>    lambdas_vals_max_init.append(lambdas_fragm_max)</span>
<span id="cb33-65"><a href="#cb33-65" aria-hidden="true" tabindex="-1"></a>    lambdas_vals_max_rand.append(lambdas_fragm_max_random)</span>
<span id="cb33-66"><a href="#cb33-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-67"><a href="#cb33-67" aria-hidden="true" tabindex="-1"></a>    ipr_vals_init.append(ipr_fragm)</span>
<span id="cb33-68"><a href="#cb33-68" aria-hidden="true" tabindex="-1"></a>    ipr_vals_rand.append(ipr_random)</span>
<span id="cb33-69"><a href="#cb33-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-70"><a href="#cb33-70" aria-hidden="true" tabindex="-1"></a>    absorb_vals_init.append(absorb_init)</span>
<span id="cb33-71"><a href="#cb33-71" aria-hidden="true" tabindex="-1"></a>    absorb_vals_rand.append(absorb_rand)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|██████████| 5268/5268 [04:04&lt;00:00, 21.51it/s]</code></pre>
</div>
</div>
<div id="ebec7298" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>ind_names <span class="op">=</span> [<span class="st">'avg_corr_init'</span>, <span class="st">'lambda_max'</span>, <span class="st">'ar'</span>]</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>indicators <span class="op">=</span> [mean_corr_init, lambdas_vals_max_init, absorb_vals_init]</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>measure_labels <span class="op">=</span> [<span class="vs">r'$\langle C \rangle_</span><span class="sc">{init}</span><span class="vs">$'</span>, <span class="vs">r'$\lambda_</span><span class="sc">{max}</span><span class="vs">$'</span>, <span class="vs">r'$AR$'</span>]</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(ind_names)):</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    name <span class="op">=</span> <span class="ss">f"RMT_</span><span class="sc">{</span>ind_names[i]<span class="sc">}</span><span class="ss">_symbol=</span><span class="sc">{</span>ylabel<span class="sc">}</span><span class="ss">_wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_seriestype=</span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    np.savetxt(name <span class="op">+</span> <span class="st">".txt"</span>, indicators[i])</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="середній-коефіцієнт-крос-кореляцій" class="level4" data-number="8.2.5.1">
<h4 data-number="8.2.5.1" class="anchored" data-anchor-id="середній-коефіцієнт-крос-кореляцій"><span class="header-section-number">8.2.5.1</span> Середній коефіцієнт крос-кореляцій</h4>
<div id="cell-fig-wind-crosscorr" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>file_name <span class="op">=</span> <span class="ss">f"avg_corr_symbol=</span><span class="sc">{</span>ylabel<span class="sc">}</span><span class="ss">_wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_seriestype=</span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>plot_2d(data_init.loc[:, ylabel].index[window:length:tstep],</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>        data_init.loc[:, ylabel].values[window:length:tstep],</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>        mean_corr_init, </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>        ylabel,</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>        measure_labels[<span class="dv">0</span>],</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>        xlabel,</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>        file_name,</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>        clr<span class="op">=</span><span class="st">"magenta"</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-wind-crosscorr" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-wind-crosscorr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lab_8_files/figure-html/fig-wind-crosscorr-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-wind-crosscorr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Рис.&nbsp;8.6: Динаміка індексу цін акцій компанії Apple та середнього показника крос-кореляцій прибутковостей досліджуваних акцій
</figcaption>
</figure>
</div>
</div>
</div>
<p>На <a href="#fig-wind-crosscorr" class="quarto-xref">Рис.&nbsp;<span>8.6</span></a> видно, що середній ринковий ступінь крос-кореляцій зростає у (перед-)кризові періоди, що вказує на зростання самоорганізованості ринку. Усі індекси синхронізовано починають “відповідати” на зовнішні чинники, які змушують трейдерів колективно все відкуповувати або розпродавати.</p>
<p>На <a href="#fig-wind-3d-pc" class="quarto-xref">Рис.&nbsp;<span>8.7</span></a> представлений той самий показник, але у тривимірному просторі.</p>
<div id="cell-fig-wind-3d-pc" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>, num_bins)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.arange(window, length, tstep)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.expand_dims(X, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.repeat(a<span class="op">=</span>X, repeats<span class="op">=</span>Y.shape[<span class="dv">0</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> np.array(C_hist_vals_init)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(subplot_kw<span class="op">=</span>{<span class="st">"projection"</span>: <span class="st">"3d"</span>}, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>surf <span class="op">=</span> ax.plot_surface(X, Y, Z, cmap<span class="op">=</span><span class="st">'hot'</span>, rstride<span class="op">=</span><span class="dv">2</span>, cstride<span class="op">=</span><span class="dv">2</span>, linewidth<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(xlabel, fontsize<span class="op">=</span><span class="dv">16</span>, labelpad<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">r"$C_</span><span class="sc">{ij}</span><span class="vs">$"</span>, fontsize<span class="op">=</span><span class="dv">16</span>, labelpad<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>ax.set_zlabel(<span class="vs">r"$P(C)$"</span>, fontsize<span class="op">=</span><span class="dv">16</span>, labelpad<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>ax.tick_params(axis<span class="op">=</span><span class="st">'both'</span>, which<span class="op">=</span><span class="st">'major'</span>, labelsize<span class="op">=</span><span class="dv">16</span>, pad<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>ax.view_init(<span class="dv">60</span>, <span class="dv">140</span>)</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="ss">f"RMT_3D_P(C)_wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_seriestype=</span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">.jpg"</span>, bbox_inches<span class="op">=</span><span class="st">"tight"</span>)</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>plt.show()<span class="op">;</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-wind-3d-pc" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-wind-3d-pc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lab_8_files/figure-html/fig-wind-3d-pc-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-wind-3d-pc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Рис.&nbsp;8.7: Віконна функція щільності розподілу коефіцієнтів кореляції вихідної матриці фінансових активів
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="максимальне-значення-lambda" class="level4" data-number="8.2.5.2">
<h4 data-number="8.2.5.2" class="anchored" data-anchor-id="максимальне-значення-lambda"><span class="header-section-number">8.2.5.2</span> Максимальне значення <span class="math inline">\(\lambda\)</span></h4>
<p>На наступному рисунку (<a href="#fig-wind-lambda" class="quarto-xref">Рис.&nbsp;<span>8.8</span></a>) представлено порівняльну динаміку індексу цін акцій компанії Apple та показника <span class="math inline">\(\lambda_{max}\)</span>.</p>
<div id="cell-fig-wind-lambda" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>file_name <span class="op">=</span> <span class="ss">f"lambda_max_symbol=</span><span class="sc">{</span>ylabel<span class="sc">}</span><span class="ss">_wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_seriestype=</span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>plot_2d(data_init.loc[:, ylabel].index[window:length:tstep],</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>        data_init.loc[:, ylabel].values[window:length:tstep],</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>        lambdas_vals_max_init, </span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>        ylabel,</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>        measure_labels[<span class="dv">1</span>],</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>        xlabel,</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>        file_name,</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>        clr<span class="op">=</span><span class="st">"red"</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-wind-lambda" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-wind-lambda-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lab_8_files/figure-html/fig-wind-lambda-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-wind-lambda-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Рис.&nbsp;8.8: Динаміка індексу цін акцій компанії Apple та показника <span class="math inline">\(\lambda_{max}\)</span>
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-wind-lambda" class="quarto-xref">Рис.&nbsp;<span>8.8</span></a> показує, що <span class="math inline">\(\lambda_{max}\)</span> у схожий спосіб із <span class="math inline">\(\langle C \rangle_{init}\)</span>. Із динаміки даного показника можна зробити висновок, що серед усіх індексів найбільш впливовим є індекс, якому характерно <span class="math inline">\(\lambda_{max}\)</span>. Усі інші індекси, власне значення яких знаходиться в межах теоретичного передбачення ТВМ, вносять лише шумову інформацію в загальну динаміку ринку і реагують на всі інші збурення на фондовому ринку, слідуючи закономірностям найбільш капіталізованих індексів.</p>
</section>
<section id="обернене-відношення-участі-2" class="level4" data-number="8.2.5.3">
<h4 data-number="8.2.5.3" class="anchored" data-anchor-id="обернене-відношення-участі-2"><span class="header-section-number">8.2.5.3</span> Обернене відношення участі</h4>
<p>На <a href="#fig-wind-ipr3d" class="quarto-xref">Рис.&nbsp;<span>8.9</span></a> представлено тривимірну віконну динаміка показника оберненого відношення участі</p>
<div id="cell-fig-wind-ipr3d" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> log_tick_formatter(val, pos<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="ss">f"$10^</span><span class="ch">{{</span><span class="sc">{</span><span class="bu">int</span>(val)<span class="sc">}</span><span class="ch">}}</span><span class="ss">$"</span>  </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> np.array(lambdas_vals_init)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.arange(window, length, tstep)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.expand_dims(X, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.repeat(a<span class="op">=</span>X, repeats<span class="op">=</span>Y.shape[<span class="dv">1</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> np.array(ipr_vals_init)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(subplot_kw<span class="op">=</span>{<span class="st">"projection"</span>: <span class="st">"3d"</span>}, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>surf <span class="op">=</span> ax.plot_surface(X, np.log(Y), Z, cmap<span class="op">=</span><span class="st">'magma'</span>, rstride<span class="op">=</span><span class="dv">2</span>, cstride<span class="op">=</span><span class="dv">2</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(xlabel, fontsize<span class="op">=</span><span class="dv">16</span>, labelpad<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="vs">r"$\lambda_i$"</span>, fontsize<span class="op">=</span><span class="dv">16</span>, labelpad<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>ax.set_zlabel(<span class="vs">r"$IPR$"</span>, fontsize<span class="op">=</span><span class="dv">16</span>, labelpad<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>ax.tick_params(axis<span class="op">=</span><span class="st">'both'</span>, which<span class="op">=</span><span class="st">'major'</span>, labelsize<span class="op">=</span><span class="dv">16</span>, pad<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>ax.yaxis.set_major_formatter(mticker.FuncFormatter(log_tick_formatter))</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>ax.yaxis.set_major_locator(mticker.MaxNLocator(integer<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>plt.savefig(<span class="ss">f"RMT_3D_IPR_wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_seriestype=</span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">.jpg"</span>, bbox_inches<span class="op">=</span><span class="st">"tight"</span>)</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>plt.show()<span class="op">;</span></span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-wind-ipr3d" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-wind-ipr3d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lab_8_files/figure-html/fig-wind-ipr3d-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-wind-ipr3d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Рис.&nbsp;8.9: Тривимірна віконна динаміка показника оберненого відношення участі
</figcaption>
</figure>
</div>
</div>
</div>
<p>ОВУ на <a href="#fig-wind-ipr3d" class="quarto-xref">Рис.&nbsp;<span>8.9</span></a> характеризується значним зростанням у кризові періоди, у той час як для періодів релаксації цей показник залишається на рівні нуля.</p>
</section>
<section id="коефіцієнт-поглинання-1" class="level4" data-number="8.2.5.4">
<h4 data-number="8.2.5.4" class="anchored" data-anchor-id="коефіцієнт-поглинання-1"><span class="header-section-number">8.2.5.4</span> Коефіцієнт поглинання</h4>
<p>На <a href="#fig-wind-ar" class="quarto-xref">Рис.&nbsp;<span>8.10</span></a> представлено порівняльну динаміку індексу цін акцій компаній Apple та коефіцієнту поглинання.</p>
<div id="cell-fig-wind-ar" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>file_name <span class="op">=</span> <span class="ss">f"ar_symbol=</span><span class="sc">{</span>ylabel<span class="sc">}</span><span class="ss">_wind=</span><span class="sc">{</span>window<span class="sc">}</span><span class="ss">_step=</span><span class="sc">{</span>tstep<span class="sc">}</span><span class="ss">_seriestype=</span><span class="sc">{</span>ret_type<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>plot_2d(data_init.loc[:, ylabel].index[window:length:tstep],</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>        data_init.loc[:, ylabel].values[window:length:tstep],</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>        absorb_vals_init, </span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>        ylabel,</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>        measure_labels[<span class="dv">2</span>],</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>        xlabel,</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>        file_name,</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>        clr<span class="op">=</span><span class="st">"black"</span>)</span></code><button title="Копіювати" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="fig-wind-ar" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-wind-ar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="lab_8_files/figure-html/fig-wind-ar-output-1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-wind-ar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Рис.&nbsp;8.10: Динаміка індексу цін акцій компаній Apple та коефіцієнту поглинання
</figcaption>
</figure>
</div>
</div>
</div>
<p>На <a href="#fig-wind-ar" class="quarto-xref">Рис.&nbsp;<span>8.10</span></a> видно, що <span class="math inline">\(AR\)</span> зростає під час крахів 2008, 2015-2016, 2021 і 2023 року. Це говорить про те, що в кризові періоди зростає активність одного або декілька індексів, які стають рушієм для усього фондового ринку.</p>
</section>
</section>
</section>
<section id="висновок" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="висновок"><span class="header-section-number">8.3</span> Висновок</h2>
<p>Таким чином, при наявності сукупності часових рядів, що є даними діяльності економічних об’єктів однієї області, можна провести дослідження стосовно структури вказаної області та взаємодії об’єктів всередині неї. Дослідження проводяться на основі теорії випадкових матриць, що дозволяє отримувати інформацію шляхом аналізу матриці крос-кореляцій, побудованої для сукупної бази економічних об’єктів.</p>
</section>
<section id="завдання-для-самостійної-роботи" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="завдання-для-самостійної-роботи"><span class="header-section-number">8.4</span> Завдання для самостійної роботи</h2>
<p>Оберіть певний фондовий індекс і проведіть дослідження крахових подій для ринку, що він представляє за допомогою теорії випадкових матриць.</p>
</section>
<section id="контрольні-запитання" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="контрольні-запитання"><span class="header-section-number">8.5</span> Контрольні запитання</h2>
<ol type="1">
<li>Поясніть основну ідею теорії випадкових матриць</li>
<li>Про що свідчить відмінність кореляційних і спектральних властивостей матриці даних і випадкової?</li>
<li>Дослідіть, як змінюється розподіл власних значень у випадках:
<ul>
<li><span class="math inline">\(\lambda_{-} &lt; \lambda &lt; \lambda_{+}\)</span>;</li>
<li><span class="math inline">\(\lambda &gt; \lambda_{+}\)</span>;</li>
<li><span class="math inline">\(\lambda &lt; \lambda_{-}\)</span>.</li>
</ul></li>
<li>Порівняйте кольорову карту поля взаємних кореляцій випадкової матриці і заданої. Зробіть висновки</li>
</ol>


<div id="refs" class="references csl-bib-body" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-Wigner_1951_1" class="csl-entry" role="listitem">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline">E. P. Wigner, <em><a href="https://doi.org/10.1017/S0305004100027237">On the Statistical Distribution of the Widths and Spacings of Nuclear Resonance Levels</a></em>, Mathematical Proceedings of the Cambridge Philosophical Society <strong>47</strong>, 790 (1951).</div>
</div>
<div id="ref-Wigner_1951_2" class="csl-entry" role="listitem">
<div class="csl-left-margin">[2] </div><div class="csl-right-inline">E. P. Wigner, <em><a href="http://www.jstor.org/stable/1969342">On a Class of Analytic Functions from the Quantum Theory of Collisions</a></em>, Annals of Mathematics <strong>53</strong>, 36 (1951).</div>
</div>
<div id="ref-10.1063/1.1703773" class="csl-entry" role="listitem">
<div class="csl-left-margin">[3] </div><div class="csl-right-inline">F. J. Dyson, <em><a href="https://doi.org/10.1063/1.1703773"><span class="nocase">Statistical Theory of the Energy Levels of Complex Systems. I</span></a></em>, Journal of Mathematical Physics <strong>3</strong>, 140 (2004).</div>
</div>
<div id="ref-10.1063/1.1704008" class="csl-entry" role="listitem">
<div class="csl-left-margin">[4] </div><div class="csl-right-inline">F. J. Dyson and M. L. Mehta, <em><a href="https://doi.org/10.1063/1.1704008"><span class="nocase">Statistical Theory of the Energy Levels of Complex Systems. IV</span></a></em>, Journal of Mathematical Physics <strong>4</strong>, 701 (2004).</div>
</div>
<div id="ref-10.1063/1.1704009" class="csl-entry" role="listitem">
<div class="csl-left-margin">[5] </div><div class="csl-right-inline">M. L. Mehta and F. J. Dyson, <em><a href="https://doi.org/10.1063/1.1704009"><span class="nocase">Statistical Theory of the Energy Levels of Complex Systems. V</span></a></em>, Journal of Mathematical Physics <strong>4</strong>, 713 (2004).</div>
</div>
<div id="ref-mehta1991random" class="csl-entry" role="listitem">
<div class="csl-left-margin">[6] </div><div class="csl-right-inline">M. L. Mehta, <em>Random Matrices</em> (Academic Press, 1991).</div>
</div>
<div id="ref-RevModPhys.53.385" class="csl-entry" role="listitem">
<div class="csl-left-margin">[7] </div><div class="csl-right-inline">T. A. Brody, J. Flores, J. B. French, P. A. Mello, A. Pandey, and S. S. M. Wong, <em><a href="https://doi.org/10.1103/RevModPhys.53.385">Random-Matrix Physics: Spectrum and Strength Fluctuations</a></em>, Rev. Mod. Phys. <strong>53</strong>, 385 (1981).</div>
</div>
<div id="ref-PhysRevLett.83.1467" class="csl-entry" role="listitem">
<div class="csl-left-margin">[8] </div><div class="csl-right-inline">L. Laloux, P. Cizeau, J.-P. Bouchaud, and M. Potters, <em><a href="https://doi.org/10.1103/PhysRevLett.83.1467">Noise Dressing of Financial Correlation Matrices</a></em>, Phys. Rev. Lett. <strong>83</strong>, 1467 (1999).</div>
</div>
<div id="ref-Muirhead" class="csl-entry" role="listitem">
<div class="csl-left-margin">[9] </div><div class="csl-right-inline"><em><a href="https://doi.org/10.1002/9780470316559">Aspects of Multivariate Statistical Theory</a></em> (Wiley, New York, 1982).</div>
</div>
<div id="ref-dyson1971distribution" class="csl-entry" role="listitem">
<div class="csl-left-margin">[10] </div><div class="csl-right-inline">F. J. Dyson, <em>Distribution of Eigenvalues for a Class of Real Symmetric Matrices</em>, Revista Mexicana de Fisica <strong>20</strong>, 231 (1971).</div>
</div>
<div id="ref-PhysRevE.60.3389" class="csl-entry" role="listitem">
<div class="csl-left-margin">[11] </div><div class="csl-right-inline">A. M. Sengupta and P. P. Mitra, <em><a href="https://doi.org/10.1103/PhysRevE.60.3389">Distributions of Singular Values for Some Random Matrices</a></em>, Phys. Rev. E <strong>60</strong>, 3389 (1999).</div>
</div>
<div id="ref-PhysRevLett.83.1471" class="csl-entry" role="listitem">
<div class="csl-left-margin">[12] </div><div class="csl-right-inline">V. Plerou, P. Gopikrishnan, B. Rosenow, L. A. Nunes Amaral, and H. E. Stanley, <em><a href="https://doi.org/10.1103/PhysRevLett.83.1471">Universal and Nonuniversal Properties of Cross Correlations in Financial Time Series</a></em>, Phys. Rev. Lett. <strong>83</strong>, 1471 (1999).</div>
</div>
<div id="ref-GUHR1998189" class="csl-entry" role="listitem">
<div class="csl-left-margin">[13] </div><div class="csl-right-inline">T. Guhr, A. Müller–Groeling, and H. A. Weidenmüller, <em><a href="https://doi.org/10.1016/S0370-1573(97)00088-4">Random-Matrix Theories in Quantum Physics: Common Concepts</a></em>, Physics Reports <strong>299</strong>, 189 (1998).</div>
</div>
<div id="ref-PhysRevLett.69.1093" class="csl-entry" role="listitem">
<div class="csl-left-margin">[14] </div><div class="csl-right-inline">Y. V. Fyodorov and A. D. Mirlin, <em><a href="https://doi.org/10.1103/PhysRevLett.69.1093">Analytical Derivation of the Scaling Law for the Inverse Participation Ratio in Quasi-One-Dimensional Disordered Systems</a></em>, Phys. Rev. Lett. <strong>69</strong>, 1093 (1992).</div>
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Скопійовано!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Скопійовано!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/butman2099\.github\.io\/Complex-systems-book\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="./lab_7.html" class="pagination-link" aria-label="Лабораторна робота № 7">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Лабораторна робота № 7</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./lab_9.html" class="pagination-link" aria-label="Лабораторна робота № 9">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Лабораторна робота № 9</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.dev/Butman2099/Complex-systems-book/blob/main/lab_8.ipynb" class="toc-action"><i class="bi bi-github"></i>Редагувати сторінку</a></li></ul></div></div></div></footer></body></html>