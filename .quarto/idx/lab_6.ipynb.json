{"title":"Лабораторна робота № 6","markdown":{"yaml":{"title":"Лабораторна робота № 6"},"headingText":"Теоретичні відомості","containsRefs":false,"markdown":"\n\n\n\n\n**Тема.** Фрактальний аналіз складних систем\n \n**Мета.** Навчитися використовувати методи монофрактального аналізу для дослідження нелінійних характеристик складних систем\n\n\n\n\n### Визначення фрактала\n\n**Фракталами** (fractals) називають геометричні об'єкти: лінії, поверхні, просторові тіла, що мають сильно шорстку поверхню або форму і характеризуються властивістю *самоподібності* [@mandelbrot1982fractal;@PhysRevA.42.4528;@10.1007/3-7643-7412-8_8]. Слово фрактал походить від латинського слова *fractus* і перекладається як дробовий, ламаний. Самоподібність як основна характеристика фрактала означає, що він більш-менш однорідно змінюється в широкому діапазоні масштабів. Так, при збільшенні маленькі фрагменти фрактала стають дуже схожими на великі. В ідеальному випадку така самопподібність призводить до того, що  фрактальний об'єкт виявляється інваріантним щодо розтягувань, тобто йому, як кажуть, притаманна дилатаційна симетрія. Вона передбачає незмінність основних геометричних особливостей фрактала при зміні масштабу.\n\nОчевидно, що фрактальні об'єкти реального світу не є нескінченно самоподібними й існує мінімальний масштаб $l_{min}$, такий, що на масштабі $l \\approx l_{min}$ властивість самоподібності зникає. Окрім цього, на достатньо великих масштабах довжин $l > l_{max}$, де $l_{max}$ --- характерний геометричний розмір об'єктів, ця властивість самоподібності також порушується. Тому властивості природніх фракталів розглядаються лише на масштабах $l$, що задовільняють відношення $l_{min} \\ll l \\ll l_{max}$. Такі обмеження природні, оскільки, коли ми приводимо в якості прикладу фракталу --- ламану, негладку траєкторію броунівської частинки, то ми розуміємо, що цей образ представляє очевидну ідеалізацію. Справа в тому, що на малих масштабах приховується граничність маси і розмірів броунівської частинки, а також скінченність часу зіткнення. При врахуванні цих обставин траєкторія броунівської частинки починає представляти гладку криву. \n\nВарто зазначити, що властивість точної самоподібності характерна лише для **регулярних фракталів**. Якщо замість детермінованого способу побудови включити в алгоритм їхнього створення деякий елемент випадковості (як це буває, наприклад, у багатьох процесах диференційованого зростання кластерів, електричному пробої тощо), то виникають так звані **випадкові фрактали**. Основна їхня відмінність від регулярних полягає в тому, що властивості самоподібності є справедливими тільки після відповідного усереднення за всіма статистично незалежними реалізаціями об'єкта. При цьому збільшена частина фрактала не точно ідентична вихідному фрагменту, проте їхні статистичні характеристики збігаються.\n\n### Довжина берегової лінії\n\nПершочергово поняття фрактала у фізиці виникло у зв'язку із завданням про визначення довжини берегової лінії. Під час її вимірювання за наявною картою місцевості з'ясувалася цікава деталь --- чим більш великомасштабна карта береться, тим довшою виявляється ця берегова лінія [@steinhaus1954length;@vulpiani2014lewis;@0c446163-c0a0-36ed-a942-0e71e56cd938;@science.156.3775.636]. Нехай, наприклад, відстань по прямій між розсташованими на береговій лінії точками А та В дорівнює R (див. [@fig-costline]). \n\n::: {#fig-costline}\n\n![](Images\\lab_6\\costline.jpg)\n\nВизначення довжини берегової лінії між точками А та В [@Bozhokin]\n\n:::\n\nТоді, щоб виміряти довжину берегової лінії між цима точками, ми розташуємо по берегу  жорстко пов'язані один з одним вузол так, що відстань між сусідніми вузлами дорівнювала б, наприклад, $l=10$ км. Довжину берегової лінії в кілометрах між точками А і В ми приймемо тоді рівною числу вузлів мінус 1, помноженому на 10. Наступне вимірювання цієї довжини ми зробимо так само, але відстань між сусідніми вузлами зробимо вже рівною $l=1$ км.\n\nВиявляється, що результат цих вимірювань буде різним. При зменшенні масштабу $l$ ми отримуватимемо все більші й більші значення довжини. На відміну від гладкої кривої, лінія морського узбережжя виявляється найчастіше настільки порізаною (аж до найменших масштабів), що зі зменшенням довжини ланки $l$ величина $L$ --- довжина берегової лінії --- не прагне до кінцевого межі, а збільшується за степеневим законом \n\n$$ \nL \\approx l\\left( R \\big/ l \\right)^{D}, \n$$ {#eq-6-1}\n\nа $D > 1$ --- деякий степеневий показник, котрий іменується **фрактальною розмірністю** (fractal dimension) берегової лінії [@science.156.3775.636]. Чим більше значення $D$, тим більш ломаною або деталізованою представляється ця берегова лінія. Походження залежності ([-@eq-6-1]) має бути інтуїтивно зрозумілим: чим менший масштаб ми використовуємо, тим меньші деталі узбережжя будуть враховані і тим менший вклад вони внесуть у вимірювану довжину. Навпаки, збільшуючи масштаб, ми \"розгортаємо\" узбережжя, зменшуючи довжину $L$. \n\nТаким чином, ми бачимо, що для визначення довжини берегової лінії $L$ за допомогою жорсткого масштабу $l$, необхідно зробити $N=L/l$ кроків, причому величина $L$ змінюється з $l$ так, що $N$ залежить від $l$ за законом $N \\approx (R/l)^{D}$. У результаті зі зменшенням масштабу довжина берегової лінії необмежено зростає. Ця обставина різко відрізняє фрактальну криву від звичайної гладкої кривої (типу кола, еліпса), для якої межа довжини апроксимованої ламаної $L$, яка апроксимує, за наближення до нуля довжини її ланки $l$ є скінченною. У результаті для гладкої кривої її фрактальна розмірність $D = 1$, тобто збігається з топологічною.\n\n\n### Фрактальна розмірність множин\n\nВище було введено поняття про фрактальну розмірність берегової лінії. Дамо тепер загальне визначення цієї величини. Нехай $d$ --- звичайна Евклідова розмірність простору, в якому розташований наш фрактальний об'єкт ($d=1$ --- лінія, $d=2$ --- площина, $d=3$ --- звичайний тривимірний простір). Покриємо тепер цей об'єкт цілком $d$-мірними \"кулями\" радіуса 1. Припустимо, що нам потребувалося для цього не менше, ніж $N(l)$ куль. Тоді, якщо за досить малих $l$ величина $N(l)$ змінюється з $l$ за степеневим законом\n\n$$\nN(l) \\sim 1 \\big/ l^D ,\n$$ {#eq-6-2}\n\nтоді $D$ --- називається **хаусдорфовою** (Hausdorff) або **фрактальною розмірністю** цього об'єкта [@10.1214/11-STS370]. Очевидно, що ця формула еквівалентна відношеню $N \\approx \\left( R/l \\right)^{D}$, що використовувалось вище для визначення довжини берегової лінії. [@eq-6-3] можна переписати у вигляді\n\n$$\nD = -\\lim_{l \\to 0} \\ln{N(l)} \\big/ \\ln{l}.\n$$ {#eq-6-3}\n\nЦе відношення і слугує загальним визначенням фрактальної розмірності $D$. У відповідності до нього величина $D$ представляє **локальну** характеристику досліджуваного об'єкта. \n\n### Процедури обчислення монофрактальних розмірностей\n\nНаразі існує багато визначень та методів вимірювання фрактальної розмірності. Найпоширенішими одновимірними фрактальними розмірностями є розмірність Хаусдорфа, розмірність Хігучі, розмірність Петросяна та Мінковського [@falconer2004fractal]. Розмірність Хаусдорфа є найпростішою фрактальною розмірністю. Але її обчислювальна складність є високою, що ускладнює її практичне застосування. Розмірність Мінковського є відносно простою, і фрактальну розмірність сигналу можна отримати, регулюючи розмір довжини сторони клітини в межах якої визначається \"шорсткість\" поверхні сигналу. Тому вона є широко впізнаваємою та застосовуваною. Який з показників фрактальної розмірності найточніше описує складність сигналу та здатний ідентифікувати кризові явища і представляє ключовий момент цієї лабораторної роботи.\n\n#### *R/S*-аналіз\n\n**Метод *R/S*-аналізу** (Rescaled range, *R/S* analysis), розроблений Мандельбротом та Уоллесом [@10.1119/1.13295], базується на попередньо створеному методі гідрологічного аналізу Херста [@doi:10.1061/TACEAT.0006518;@hurst1957suggested], і дозволяє обчислювати параметр самоподібності $H$, який вимірює інтенсивність довготривалих залежностей у часовому ряді. Коефіцієнт $H$, який називають коефіцієнтом Херста, містить мінімальні прогнози стосовно природи системи, що вивчається, і може класифікувати часові ряди. За допомогою цього показника розрізняють випадкові (гаусові) та невипадкові ряди; окрім того, він пов'язаний із фрактальною розмірністю, що, у свою чергу, характеризує ступінь згладженості графіка, побудованого на основі часового ряду. Методом *R/S*-аналізу можливо також виявити максимальну довжину інтервалу (цикл), на якому значення зберігають інформацію про початкові дані системи (довготривала пам’ять). \n\nАналіз починається з побудови ряду логарифмічних прибутковостей, $G(t) \\equiv \\ln{x(t + \\Delta t)} - \\ln{x(t)}$, де $x(t)$ --- значення вихідного часового ряду в момент $t$, $\\Delta t$ --- часовий крок. Отримана послідовність $G(t)$ розбивається на $d$ підпослідовностей довжини $n$. \n\nДля кожної підпослідовності $m=1,...,d$:\n\n1. Шукається середнє значення $\\mu_m$ та стандартне відхилення $S_m$. \n2. Дані нормалізуються шляхом віднімання середнього значення послідовності $X_{i,m}=G_{i,m}-\\mu_m$, $i=1,...,n$.\n3. Знаходиться кумулятивна сума послідовності $X$ів: $Y_{i,m}=\\sum_{j=1}^{i}X_{j,m}$, $i=1,...,n$. \n4. У межах кожної підпослідовності знаходиться розмах між максимальним та мінімальним значеннями: $R_m = \\max\\{Y_{1,m},...,Y_{n,m}\\}-\\min\\{Y_{1,m},...,Y_{n,m}\\}$, який стандартизується середнім квадратичним відхиленням $R_{m}/S_{m}$. \n5. Обчислюється середнє $(R/S)_n$ нормованих значень розмаху для всіх підпослідовностей довжини $n$.  \n\n*R/S*-статистика, обрахована таким чином, відповідає співвідношенню $(R/S)_{n} \\cong cn^{H}$, де значення $H$ може бути отримане шляхом обчислення $(R/S)_n$ для послідовностей інтервалів зі збільшенням часового горизонту:\n\n$$\n\\log{(R/S)}_{n} = \\log{c} + H\\log{n}. \n$$ {#eq-6-4}\n\nЗнайти коефіцієнт Херста можна, побудувавши залежність $(R/S)_n$ vs. $n$ у подвійному логарифмічному масштабі і взявши коефіцієнт нахилу прямої, яка інтерполює точки отриманого графіка. Якщо значення $H=0.5$, говорять про послідовність, що представляє собою **білий шум**; $0.5 < H \\leq 1$ свідчить про **персистентний** (трендостійкий) ряд, коли існує тенденція слідування великих значень ряду за великими і навпаки; $H<0.5$ вказує на **антиперсистентний** (mean-reversion) ряд.\n\nПри збільшенні часового горизонту коефіцієнт нахилу інтерполюючої прямої повинен прямувати до значення $H=0.5$; сам процес переходу свідчить про втрату впливу початкових умов на поточні значення, і, таким чином, можна говорити про горизонт довгої пам’яті --- це точка, до якої коефіцієнт нахилу інтерполюючої прямої відмінний від 0.5, а після --- близько 0.5. \n\n::: {.callout-note}\n## Примітка до *R/S*-аналізу\n\nМіж фрактальною розмірністю та показником Херста також існує зв'язок\n\n$$\nD_f = 2-H. \n$$\n\nЯкщо для берегової лінії ми визначали масштабування її довжини $L$ в залежності від зміни $l$, то у випадку з *R/S*-аналізом ми визначаємо зміну нормованого розмаху значень ряду в межах масштабу $n$\n \n:::\n\n#### Аналіз детрендованих флуктуацій\n\n**Аналіз детрендований флуктуацій** (Detrended fluctuation analysis, DFA) [@PhysRevE.49.1685] базується на гіпотезі про те, що корельований часовий ряд може бути відображений на самоподібний процес шляхом інтегрування. Таким чином, вимірювання властивостей самоподібності може непрямо свідчити про кореляційні властивості ряду. Переваги DFA порівняно з іншими методами (спектральний аналіз, *R/S*-аналіз) полягають в тому, що він виявляє довгочасові кореляції нестаціонарних часових рядів, а також дозволяє ігнорувати очевидні випадкові кореляції, що є наслідком нестаціонарності [@JIANG2014235]. \n\nІснують DFA різних порядків, що відрізняються трендами, які вилучаються з даних. \n\nРозглянемо DFA найнижчого порядку.\n\n1. Для часового ряду довжини $N$ знаходиться кумулятивна сума, $y(k)=\\sum_{i=1}^{k}\\left( x_i - \\bar{x} \\right)$, де $x_i$ --- це $i$-те значення часового ряду, $\\bar{x}$ --- його середнє значення, $k=1,...,N$.\n2. Отриманий ряд $y(k)$ розбивається на $m$ підпослідовностей (вікон) однакової ширини $n$ і для кожної підпослідовності (у кожному вікні) виконується наступне:\n\n    - за допомогою методу найменших квадратів знаходиться локальний лінійний тренд $y_{t}(k)$;  \n    - підпослідовність детрендується шляхом віднімання значення локального тренду $y_{t}(k)$ від значень ряду $y(k)$, що належать послідовності $t$;\n    - знаходиться середнє $\\bar{y_t}$ детрендований значень. \n\nДля отриманих таким чином значень на всіх підпослідовностях знаходиться:\n\n$$\nF_n = \\sqrt{\\bar{y_t} \\cdot m^{-1}}, \n$$\n\nде $n$ --- кількість точок у підпослідовності (ширина вікна), $m$ --- кількість підпослідовностей, $\\bar{y_t}$ --- середнє детрендованих значень для підпослідовності $t$. \n\nВказана процедура повторюється для різних значень $n$, внаслідок чого ми отримує набір залежностей $F_n$ від $n$. Побудова залежності $\\log{F(n)}$ від $\\log{n}$ та інтерполяція отриманих значень лінією регресії дає змогу обчислити показник скейлінга $\\alpha$, що є коефіцієнтом кута нахилу інтерполяційної прямої і характеризує зміну кореляцій флуктуацій часового ряду $F_n$ при збільшенні часового інтервалу $n$. \n\nПорівняно із *R/S*-аналізом, DFA дає більші можливості інтерпретації скейлінгового показника $\\alpha$: \n\n- для випадкового ряду (перемішаного чи \"сурогатного\") $\\alpha = 0.5$; \n- при наявності лише короткочасових кореляцій $\\alpha$ може відрізнятись від 0.5, проте має тенденцію прямувати до 0.5 при збільшенні розміру вікна;\n- Значення $0.5 < \\alpha \\leq 1.0$ показує персистентні довгочасові кореляції, що відповідають степеневому закону; \n- $0 < \\alpha < 0.5$ означає антиперсистентний ряд; \n- cпеціальний випадок, коли $\\alpha = 1$, означає наявність $1/f$ шуму. \n- для випадків, коли $\\alpha \\geq 1$, кореляції існують, проте перестають відображувати степеневу залежність;\n- випадок $\\alpha = 1.5$ свідчить про броунівський шум, який представляє інтегрований білий шум.\n\nУ випадку степеневої залежності функції автокореляцій спостерігається спад автокореляції з показником $\\gamma$:\n\n$$\nC(L) \\sim L^{-\\gamma}.\n$$ \n\nНа додачу до цього, спектральна густина також спадає за степеневим законом: \n\n$$\nP(f) \\sim f^{-\\beta}. \n$$ {#eq-spec-dens}\n\nВідповідні показники виражаються через наступні відношення:\n\n- $\\gamma=2-2\\alpha$; \n- $\\beta=2\\alpha-1$. \n\nУ DFA другого порядку (DFA2) обчислюються відхилення $F^2(v,s)$ профілю від інтерполяційного многочлена другого порядку. Таким чином, вилучаються впливи \nможливих лінійних та параболічних трендів для масштабів, більших за розглядувані. Взагалі, у DFA порядку $n$ обчислюються відхилення профілю від інтерполяційного многочлена $n$-го порядку, що вилучає вплив всіх можливих трендів порядків до ($n-1$) для масштабів, більших від розміру вікна. \n\nПотім обчислюється найближчий поліном $y_{ν}(s)$ для профілю на кожному із $2N_s$ сегментів $v$ і визначається відхилення\n\n$$\nF^2(v,s) \\equiv \\frac{1}{s}\\sum_{i=1}^{s}\\left( x_{(v-1)s+i} - y_{i}(i) \\right)^{2}.\n$$ {#eq-6-5}\n\nДалі знаходиться середнє значення флуктуацій всіх детрендованих профілів:\n\n$$\nF_2(s) \\equiv \\sqrt{\\left( \\frac{1}{2N_s} \\sum_{v=1}^{2N_s}F^{2}(v,s) \\right)}.\n$$ {#eq-6-6}\n\nЗначення ([-@eq-6-6]) можна трактувати як середньоквадратичний зсув (переміщення) точки випадкових блукань у ланцюжку після $s$ кроків. \n\n#### Фрактальна розмірність Хігучі\n\n**Фрактальна розмірність Хігучі** (Higuchi fractal dimension) [@HIGUCHI1988277;@7168285] --- це один з різновидів монофрактальної розмірності, яка визначається наступним чином:\n\nПрипустимо, що у нас є часовий ряд $x(1), x(2),...,x(N)$ і реконструйований часовий ряд $x_{m}^{k} = \\{ x(m), x(m+k), x(m+2k),..., x\\left( m+\\left[ (N-m) \\big/ k \\right] \\cdot k \\right) \\}$ для $m=1,2,...,k$, де $m$ представляє початковий час; $k=2,...,k_{max}$ представляють ступінь часового зміщення. Позначення $[\\cdot]$ представляє цілу частину $x$. Для кожного реконструйованого часового ряду $x_{m}^{k}$ розраховується середня довжина часової послідовності $L_{m}(k)$: \n\n$$\nL_{m}(k) = \\frac{\\sum_{i=1}^{\\left[ (N-m)/k \\right]} | x(m+ik) - x(m+(i-1)\\cdot k) | \\cdot (N-1)}{\\left[ (N-m) \\big/ k \\right] \\cdot k}. \n$$\n\nДалі, для всіх середніх довжин $L_{m}(k)$, знаходиться загальне середнє $L(k) = (k)^{-1}\\sum_{m=1}^{k}L_{m}(k)$. Згідно методу Хігучі узагальне середнє значення $L(k)$ пропорційне масштабу $k$, тобто $L(k) \\propto k^{-D}$. Далі логарифмуємо обидві сторони й отримуємо рівність $\\ln{L(k)} \\propto D \\cdot \\ln{\\left( 1 \\big/ k \\right)}$. Інтерполювавши лінію регресії через залежність $\\ln{L(k)}$ від $\\ln{\\left( 1 \\big/ k \\right)}$, ми можемо отримати показник фрактальності $D$ як кут нахилу цієї лінії. Показник $D$ і представлятиме фрактальну розмірність Хігучі. \n\n#### Фрактальна розмірність Петросяна\n\nСпочатку для часового ряду $\\{ x_1, x_2,...,y_{N} \\}$ створюємо його дискретизовану (бінарну) версію, $z_i$: \n\n$$\nz_i = \n\\begin{cases}\n    1, & x_i > \\langle x \\rangle, \\\\\n    -1, & x_i \\leq \\langle x \\rangle. \n\\end{cases}\n$$\n\n**Фрактальну розмірність Петросяна** (Petrosian fractal dimension) [@465426;@904882;@goh:inria-00442374] можна визначити як \n\n$$\nD = \\log_{10}{N} \\big/ \\left( \\log_{10} + \\log_{10}{\\left[ N \\big/ (N+0.4N_{\\Delta}) \\right]} \\right), \n$$\n\nде $N_{\\Delta}$ --- кількість загальних змін знаку величини $z_i$: $N_{\\Delta} = \\sum_{i=1}^{N-2} \\left| (z_{i+1}-z_i) \\big/ 2 \\right|$.\n\n\n\n#### Фрактальна розмірність Каца\n\nПредставимо, що сигнал складається з пари точок $\\left( x_i, y_i \\right)$. Тоді, **фрактальна розмірність Каца** (Katz fractal dimension) [@KATZ1988145] визначається як \n\n$$\nD = \\log{N}/\\left(\\log{N} + \\log{d/L}\\right),\n$$\n\nде $L = \\sum_{i=0}^{N-2}\\sqrt{\\left( y_{i+1}-y_{i} \\right)^{2} + \\left( x_{i+1}-x_{i} \\right)^{2}}$, а значення $d = \\max{\\left( \\sqrt{\\left( x_i - x_1 \\right)^{2} - \\left( y_i - y_1 \\right)^{2}} \\right)}$. \n\n\n#### Фрактальна розмірність Шевчика\n\nСпочатку, для множини значень $\\left( x_i, y_i \\right)$ виконується нормалізація: $x_{i}^{*} = \\left( x_i-x_{min} \\right) \\big/ \\left( x_{max}-x_{min} \\right)$ і $y_{i}^{*} = \\left( y_i - y_{min} \\right) \\big/ \\left( y_{max}-y_{min} \\right)$.\n\n**Фрактальна розмірність Шевчика** (Sevcik fractal dimension) [@sevcik2010procedure] може бути визначена як\n\n$$\nD = 1 + \\left. \\ln{L} \\big/ \\ln{\\left( 2 \\cdot  [N-1] \\right)} \\right., \n$$\n\n$L$ --- це довжина сигналу, що може бути розрахована за формулою $L = \\sum_{i=0}^{N-2}\\sqrt{\\left( y_{i+1}^{*}-y_{i}^{*} \\right)^{2} + \\left( x_{i+1}^{*}-x_{i}^{*} \\right)^{2}}$. \n\n\n#### Фрактальна розмірність через нормалізовану щільність довжини\n\nДаний показник розраховується в наступний спосіб [@kalauzi2009extracting]:\n\n1. Для часового ряду $\\{ x_1, x_2,...,x_n \\}$ виконується стандартизація: $y_i = (x_i - \\mu)/\\sigma$, де $\\mu$ --- це середнє значення ряду, $\\sigma$ --- це стандартне відхилення. \n2. Розраховується нормалізована щільність довжини $NLD = \\frac{1}{N}\\sum_{i=2}^{N}\\left| y_i - y_{i-1} \\right|$. Фактичний розрахунок **фрактальної розмірності через нормалізовану щільність довжини** (fractal dimension via Normalized Length Density, FNLD) базується на побудові монотонної калібрувальної кривої $D = f(NLD)$ за набором функцій Вейєрштрасса, для яких значення $D$ задаються теоретично.\n3. Для обчислювальних цілей створено дві моделі цієї залежності:\n    - логарифмічну модель: $D = a \\cdot \\log{\\left(NLD - NLD_{0} \\right)} + C$;\n    - степеневу модель: $D = a \\cdot \\left(NLD - NLD_{0} \\right)^{k}$. Бібліотека `neurokit2` використовує саме степеневу модель. Параметр $a=1.9079$, $k=0.18383$ і $NLD_{0}=0.097178$, згідно [@Kalauzi_2009]. \n\n\n#### Фрактальна розмірність і спектральна щільність потужності\n\nФрактальну розмірність можна обчислити на основі аналізу нахилу **спектральної щільності потужності** (power spectral density slope, PSD) [@10.3389/fphys.2013.00075;@Voss1988] в сигналах, що характеризуються степеневою частотною залежністю.\n\nСпочатку виконується перетворення часового ряду до частотної області і далі сигнал розбивається на гармонійні коливання певної амплітуди, які разом \"складаються\", щоб представити вихідний сигнал. Якщо існує систематичний зв'язок між частотами в сигналі і потужністю цих частот, то в логарифмічних координатах це проявляється через лінійну залежність. Кут нахилу лінії регресії приймається як оцінка фрактальної розмірності.\n\nНахил 0 відповідає білому шуму, а нахил менше 0, але більше -1, відповідає рожевому шуму, тобто шуму $1/f$. Спектральні нахили крутіші за -2 вказують на дробовий броунівський рух, що є проявом процесів випадкового блукання.\n\n#### Кореляційна розмірність \n\n**Кореляційна розмірність** (correlation dimension, $D_2$) --- це похідна величина від кореляційного інтеграла (кореляційної суми) і може бути подана у вигляді [@GRASSBERGER1983189;@PhysRevLett.50.346;@GRASSBERGER1983227]:\n\n$$\nC(\\varepsilon) = \\frac{1}{N^{2}}\\sum_{\\substack{i,j=1 \\\\ i\\neq j}}^{N}\\Theta \\left( \\varepsilon - \\| \\vec{x}(i) - \\vec{x}(j) \\| \\right), \\; \\vec{x}(i) \\in \\Re^{m}. \n$$\n\nКореляційна розмірність може бути виведена з наступної степеневої залежності:\n\n$$\nC(\\varepsilon) \\sim \\varepsilon^{\\nu}, \n$$\n\nабо\n\n$$\nD_2 = \\lim_{M\\to\\infty}\\lim_{\\varepsilon\\to 0} \\log{\\left( g_{\\varepsilon} \\big/ N^2 \\right)} \\big/ \\log{\\varepsilon}, \n$$\n\nде $g_{\\varepsilon}$ --- це сумарна кількість пар точок, відстань між якими менша за радіус $\\varepsilon$. \n\nУ першому випадку ми відбираємо $i$-ту траєкторію та всі інші $j$-ті траєкторії, і дивимося, чи потрапляють $j$-ті траєкторії в $\\varepsilon$-окіл $i$-ої траєкторії. Якщо відстань між ними не перевищує окіл радіусом $\\varepsilon$, ми ставимо 1. Але якщо відстань між траєкторіями більша за $\\varepsilon$, тоді ставимо 0. Далі все це підсумовується, ділиться на загальну кількість траєкторій. По суті кореляційний інтеграл це середня ймовірність того, що дві розглянуті траєкторії фазового простору, будуть знаходитися досить близько одна від одної. Чим тісніше розташовані точки фазового простору, тим більше значення кореляційного інтеграла. Чим більш рівновіддаленими видаються траєкторії одна від одної, тим ближче значення кореляційного інтеграла до нуля.   \n\nЗначення кореляційної розмірності ми можемо відшукати аналогічно попередним фрактальним показникам: ми шукаємо залежність кореляційного інтеграла від значення $\\varepsilon$. Ця залежність будується в логарифмічному масштабі. \n\nОсь деякі цікаві приклади. \n\n**Електрокардіограма** (ЕКГ):\nЕКГ-сигнали відображають електричну активність серця. Складність ЕКГ-сигналу може бути оцінена за допомогою кореляційної розмірності. Очікується, що кореляційна розмірність ЕКГ здорового серця буде вищою через наявність складних патернів і варіабельності. З іншого боку, аномальні ЕКГ-сигнали, наприклад, від пацієнтів з аритміями або серцевими захворюваннями, можуть мати нижчу кореляційну розмірність через втрату складності сигналу.\n\n**Електроенцефалограма** (ЕЕГ):\nСигнали ЕЕГ реєструють електричну активність мозку. Кореляційна розмірність може використовуватися для аналізу складності мозкової активності, яка може змінюватися залежно від різних когнітивних станів, стадій сну або неврологічних розладів. У здорових людей сигнали ЕЕГ у стані бадьорості та уваги можуть мати вищу кореляційну розмірність порівняно з сигналами у стадії сну, коли активність мозку є більш регулярною і синхронізованою.\n\n**Дихальні сигнали**:\nДихальні сигнали, такі як частота дихання або повітряний потік, також можуть бути проаналізовані за допомогою кореляційної розмірності. Складність цих сигналів може змінюватися залежно від таких факторів, як стрес, фізичне навантаження або наявність респіраторних захворювань. За нормального дихання може спостерігатися вища кореляційна розмірність, тоді як порушення в дихальних сигналах, наприклад, за обструктивного апное уві сні або дихальних розладів, можуть призвести до зниження кореляційної розмірності.\n\n**Аналіз ходи**:\nКореляційна розмірність може бути використана для аналізу моделей ходи. Вона допомагає зрозуміти складність рухів людини під час ходьби чи бігу. Зміни в кореляційній розмірності сигналів ходи можуть свідчити про зміну стабільності ходи або про наявність відхилень у ході, викликаних неврологічними або опорно-руховими захворюваннями.\n\n**Варіативність динаміки серцевого ритму** (ВСР):\nВСР являє собою зміну часових інтервалів між послідовними ударами серця. Вона перебуває під впливом вегетативної нервової системи і відображає адаптивність і складність серцево-судинної системи. Вищий рівень ВСР, що відповідає вищій кореляційній розмірності, зазвичай асоціюється з кращим станом серцево-судинної системи та її адаптивністю до фізіологічних змін і змін навколишнього середовища. Її падіння може асоціюватися з аномальною динамікою серця.\n\n**Послідовності ДНК**:\nКореляційна розмірність може бути використана і при аналізі послідовностей ДНК. Вона допомагає виявити самоподібні або фрактальні патерни всередині послідовностей, що може мати значення для розуміння генетичної складності, еволюційних зв'язків і регуляції генів. Висока кореляційна розмірність --- висока складність ланцюжка ДНК. Мала кореляційна розмірність --- спрощений ланцюжок ДНК.\n\n**Фінансові ринки**:\nВища кореляційна розмірність у даних часових рядів фінансового ринку свідчить про більшу складність та існування в їхній основі самоподібних моделей або фрактальних структур. Хаотична поведінка цін на акції може бути пов'язана з періодами високої волатильності та непередбачуваності. З іншого боку, нижча величина кореляційної розмірності може свідчити про більш передбачувані та менш складні рухи цін, що відповідає періодам стабільності або менш волатильним ринковим умовам.\n\n## Хід роботи\n\nРозглянемо як можна застосовувати зазначені показники в якості індикаторів кризових станів. \n\nСпочатку імпортуємо необхідні бібліотеки:\n\nДалі виконаємо налаштування формату виведення рисунків:\n\nНа цьому етапі скористаємось монофрактальними показниками для ідентифікації кризових явищ на ринку золота. Розглянемо ціну золота, наприклад, за період з 1 грудня 2001 року по 1 листопада 2023 року:\n\n::: {.callout-warning}\n## Увага\n\nВиконайте цей блок, якщо хочете зчитати дані не з Yahoo! Finance, а із власного файлу. Зрозуміло, що й аналіз результатів, і висновки залежать від того з яким рядом ми працюємо \n\n:::\n\n---\n\n---\n\nВиводимо досліджуваний ряд:\n\nВизначимо функцію `transformation()` для стандартизації ряду:\n\n### Обчислення показника Херста з використанням *R/S*-аналізу\n\nДля подальших розрахунків використовуватимемо бібліотеку `neurokit2` та `fathon`. Другу з них можна встановити в наступний спосіб:\n\nДалі імпортуємо саму бібліотеку та дотичні до неї модулі:\n\nБібліотека `neurokit` містить необхідний метод для *R/S*-аналізу --- `fractal_hurst`. Його синтаксис:\n\n**`fractal_hurst(signal, scale='default', corrected=True, show=False)`**\n\n**Параметри:**\n\n- **signal** (*Union[list, np.array, pd.Series]*) --- сигнал (тобто часовий ряд) у вигляді вектора значень або датафрейму бібліотеки `pandas`;\n- **scale** (*list*) --- список, що містить довжини вікон (кількість точок даних у кожній підмножині ряду), на які розбито сигнал;\n- **corrected** (*bool*) --- якщо значення `True`, до вихідних даних буде застосовано поправочний коефіцієнт Аніса-Ллойда-Пітерса [@Anis_1976] відповідно до очікуваного значення для окремих значень (*R/S*);\n- **show** (*bool*) --- якщо значення `True`, виводить залежність $(R/S)_n$ від $n$ (**scale**) у подвійному логарифмічному масштабі. \n\n**Повертає:**\n\n- **h** (*float*) --- показник Херста;\n- **kwargs** --- словник, що містить інформацію відносно використовуваних у процедурі параметрів.\n\nРозглянемо ступінь трендостійкості в динаміці ціни золота, використовуючи весь часовий ряд. Далі знайдемо значення показника Херста в рамках віконної процедури.\n\n#### Увесь часовий ряд\n\nПершочергово знайдемо значення прибутковостей для нашого ряду та стандартизуємо їх. Після цього виконаємо обчислення:\n\nВиконуємо *R/S*-аналіз:\n\nЯк ми можемо бачити з @fig-gold-rs-all, значення $h=0.53$, що свідчить про подібність цінової динаміки золота до випадкового блукання. Але оскільки закони, що регулюють ринок, змінюються з часом, мають змінюватись і кореляції всередині системи, а тому коефіцієнт Херста також може змінюватись.   \n\n#### Віконна процедура\n\nВизначимо функцію для побудови парних графіків:\n\nПриступимо до віконної процедури:\n\nВізуалізуємо результат:\n\nНа [@fig-gold-wind-rs] можемо бачити, що показник Херста зростає в передкризовий період та спадає під час кризи. Перед кризою динаміка ринку характеризується зростанням трендостійкості (персистентності), що відзеркалює зростання скорельованості дій трейдерів. \n\n### Обчислення на основі DFA\n\nБібліотека `fathon` представляє інструментарій як для виконання класичного аналізу детрендованих флуктуацій, так і для його мультифрактального аналогу, мова про який піде в наступній лабораторній роботі. \n\n#### Для всього ряду\n\nСпочатку представимо значення $\\alpha$ для всього ряду. Процедура розрахунків на основі бібліотеки `fathon` виглядатиме наступним чином: \n\nЗнаходимо стандартизовані прибутковості ряду:\n\nВиводимо залежність функції флуктуацій від масштабу:\n\nБудуємо залежність функції флуктуацій від масштабу в подвійному логарифмічному масштабі:\n\nПроцедура DFA показує, що значення ціни золота представляються скоріше антиперсистентними, але представлений результат доволі близький до того, що був отриманий за допомогою *R/S*-аналізу. Розглянемо значення $\\alpha$ в рамках алгоритму ковзного вікна. \n\n#### Віконна процедура\n\nВизначимо наступні параметри:\n\nЗнайдемо показник Херста ($\\alpha$), фрактальну розмірність ($D_f$), показник спектральної щільності ($\\beta$) та показник автокореляції ($\\gamma$):  \n\nЗберігаємо абсолютні значення показників до текстових файлів:\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результати:\n\nЯкщо порівнювати з *R/S*-аналізом, @fig-gold-wind-alpha демонструє, що DFA динаміка *узагальненого показника Херста* є набагато стабільнішою. Тепер ми здатні диференціювати значну частку крахових подій, що мали місце на ринку золота. Узагальнений Херст показує, що передкризові явища характеризуються зростанням трендостійкості ринку, підвищенням ступеня самоорганізації системи. \n\n[@fig-gold-wind-df] показує, що $D_f$ характеризується спадом при кризових станах. Це є індикатором того, що вищий ступень організованості ринку відзеркалюється в більш згладженій або менш волатильних флуктуаціях досліджуваного сигналу.  \n\nСпектральна густина потужності $\\beta$ [@eq-spec-dens] зростає в кризові періоди, що свідчить про спад потужності сигналу на одиничному інтервалі частоти. Це також є свідченням зростання кореляційних властивостей системи.\n\nЗ [@fig-gold-wind-gamma] видно, що показник $\\gamma$ спадає в кризові та передкризові періоди. Це є показником сповільнення спаду функції автокореляції, що в свою чергу також вказує на зростання корельованності динаміки системи. \n\n### Обчислення фрактальної розмірності Хігучі\n\nЯк уже зазначалося, фрактальна розмірність Хігучі є одним із різновидів фрактальної розмірності для часових рядів. Вона обчислюється шляхом реконструкції $k_{max}$ кількості нових наборів даних. Для кожного відновленого набору даних обчислюється довжина кривої і відкладається проти відповідного $k_{max}$-значення в логарифмічній шкалі. HFD відповідає нахилу лінійного тренду за методом найменших квадратів.\n\nРозрахуємо оптимальне значення $k$ для всього часового ряду. Бібліотека `neurokit2` представляє готову процедуру для автоматизованого підбору даного параметру. Оптимальний $k_{max}$ розраховується на основі точки, в якій значення фрактальної розмірності досягає плато для діапазону значень $k_{max}$ [@7168285]. \n\nСинтаксис даної функції виглядає наступним чином:\n\n**`complexity_k(signal, k_max='max', show=False)`**\n\n**Параметри:**\n\n- **signal** (*Union[list, np.array, pd.Series]*) --- сигнал (тобто часовий ряд) у вигляді вектора значень;\n- **$k_{max}$** (*Union[int, str, list], optional*) --- максимальна кількість інтервалів (має бути більше або дорівнювати 3), які потрібно перевірити. Якщо  $k_{max}$ = `default`, тоді вибирається максимально можливе значення, що відповідає половині довжини сигналу;\n- **show** (*bool*) --- візуалізовується нахил кривої для обраного значення $k_{max}$. \n\n**Повертає:**\n\n- **k** (*float*) --- оптимальний $k_{max}$ часового ряду;\n- **info** (*dict*) --- словник, що містить додаткову інформацію про параметри, які використовуються для обчислення оптимального $k_{max}$.\n\n#### Для всього ряду\n\nДля подальших розрахунків спочатку виконаємо перетворення ряду. Будемо використовувати вихідний часовий ряд для подальших розрахунків: \n\nІ тепер отримаємо оптимальне значення $k_{max}$ згідно зазначеної процедури:\n\nТепер побудуємо залежність довжини сигналу від часового зміщення в логарифмічному масштабі. Для фрактального сигналу має зберігатися лінійна залежність. Бібліотека `neurokit2` містить метод для розрахунку даної фрактальної розмірності. Синтаксис цієї процедури виглядає наступним чином:\n\n**`fractal_higuchi(signal, k_max='default', show=False, **kwargs)`**\n\n**Параметри:**\n\n- **signal** (*Union[list, np.array, pd.Series]*) --- сигнал (тобто часовий ряд) у вигляді вектора значень;\n- **$k_{max}$** (*Union[int, str, list], optional*) --- максимальна кількість інтервалів (має бути більше або дорівнювати 3), які потрібно перевірити;\n- **show** (*bool*) --- візуалізовується нахил кривої для обраного значення $k_{max}$. \n\n**Повертає:**\n\n- **HFD** (*float*) --- фрактальна розмірність Хігучі для досліджуваного часового ряду;\n- **info** (*dict*) --- словник, що містить додаткову інформацію про параметри, які використовуються для обчислення фрактальної розмірності Хігучі.\n\nУ подальшому будемо послуговуватись отриманим оптимальним значенням для розрахунку розмірності Хігучі в рамках алгоритму ковзного вікна. \n\n#### Віконна процедура\n\nСкористаємось наступними параметрами:\n\nРозпочинаємо віконну процедуру:\n\nЗберігаємо вихідні значення до текстового документа:\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результат:\n\nЯк можна бачити з представленого рисунку, фрактальна розмірність Хігучі може працювати як індикатор або індикатор-передвісник кризових явищ. Видно, що даний показник починає спадати у передкризові періоди чи у сам момент кризи, вказуючи на зростання згладженності динаміки системи, ступеня кореляцій та трендостійкості динаміки ринку. \n\n### Обчислення фрактальної розмірності Петросяна\n\nПетросян [@465426] запропонував швидкий метод оцінки фрактальної розмірності шляхом перетворення сигналу в двійкову послідовність, з якої оцінюється фрактальна розмірність. Існує кілька варіацій алгоритму (`neurokit2`, наприклад, пропонує варіанти `\"A\"`, `\"B\"`, `\"C\"` або `\"D\"`), що відрізняються насамперед способом створення дискретної (символьної) послідовності (див. `complexity_symbolize()` для деталей). Найпоширеніший метод (`\"C\"`, за замовчуванням) бінаризує сигнал за знаком послідовних різниць.\n\nБільшість з цих методів дискретизації припускають, що сигнал є періодичним (без лінійного тренду). Для усунення лінійних трендів може бути корисним лінійне детрендування.\n\nСинтаксис даної процедури має наступний вигляд:\n\n**`fractal_petrosian(signal, symbolize='C', show=False)`**\n\n**Параметри:**\n\n- **signal** (*Union[list, np.array, pd.Series]*) --- сигнал (тобто часовий ряд) у вигляді вектора значень;\n- **symbolize** (*str*) - метод перетворення неперервного вхідного сигналу в символьний (дискретний) сигнал. За замовчуванням присвоює 0 та 1 значенням нижче та вище середнього. Може мати значення `None`, що припускає дискретність вхідного сигналу;\n- **show** (*bool*) --- виводить дискретизацію сигналу. \n\n**Повертає:**\n\n- **PFD** (*float*) --- фрактальна розмірність Петросяна для досліджуваного часового ряду;\n- **info** (*dict*) --- словник, що містить додаткову інформацію про параметри, які використовуються для обчислення фрактальної розмірності Петросяна.\n\nМи не розглядатимемо детально синтаксис функції `complexity_symbolize()`. Опишемо лише ті методи дискретизації, що дотичні до фрактальної розмірності Петросяна:\n\n- **метод `A`** бінаризує сигнал за більшими та меншими значеннями порівняно із середнім значенням сигналу. Еквівалентом є `method=\"mean\"` (`method=\"median\"` також є допустимим);\n- **метод `B`** використовує значення, що знаходяться в діапазоні $\\pm 1\\sigma$, проти значень, що виходять за межі цього діапазону;\n- **метод `C`** обчислює різницю між послідовними вибірками та бінаризує їх залежно від знаку;\n- **метод `D`** відокремлює послідовні відліки, що перевищують $1\\sigma$ сигналу, від інших менших змін.\n\nТепер розглянемо віконну динаміку показника. \n\n#### Віконна процедура\n\nОскільки більшість з даних методів дискретизації вимагають детрендування ряду, будемо виконувати розрахунки для прибутковостей ціни золота. Скористаємось наступними параметрами:\n\nРозпочинаємо віконну процедуру:\n\nЗберігаємо вихідні значення до текстового документа:\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результат:\n\n[@fig-gold-wind-petro] показує, що показник Петросяна також спадає під час кризових подій і вказує на зростання періодизації ринку та синхронізації активності трейдерів у відповідні моменти часу.\n\n### Обчислення фрактальної розмірності Каца\n\nОбчислимо фрактальну розмірність Каца. Евклідові відстані між послідовними точками сигналу підсумовуються і усереднюються, а також визначається максимальна відстань між початковою точкою і будь-якою іншою точкою у вибірці.\n\nФрактальна розмірність варіюється від 1.0 для прямих ліній, приблизно до 1.15 для випадкових блукань і наближається до 1.5 для найбільш \"дивних\" форм сигналу.\n\nСинтаксис процедури для розрахунку даної розмірності виглядає наступним чином:\n\n**`fractal_katz(signal)`**\n\n**Параметри:**\n\n- **signal** (*Union[list, np.array, pd.Series]*) --- сигнал (тобто часовий ряд) у вигляді вектора значень.\n\n**Повертає:**\n\n- **KFD** (*float*) --- фрактальна розмірність Каца для досліджуваного часового ряду;\n- **info** (*dict*) --- словник, що містить додаткову інформацію (наразі порожній, але повертається для узгодженості з іншими функціями).\n\n\n#### Віконна процедура\n\nОскільки даний показник є параметронезалежним, нам достатньо буде лише розміру часового вікна, кроку та типу ряду:\n\nРозпочинаємо віконну процедуру:\n\nЗберігаємо вихідні значення до текстового документа:\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результат:\n\nЗ рисунку видно, що фрактальна розмірність Каца також спадає у кризові та передкризові періоди і також є індикатором зростання ступеня корельованості системи в дані періоди.\n\n### Обчислення фрактальної розмірності Шевчика\n\nАлгоритм цієї фрактальної розмірності був запропонований для обчислення фрактальної розмірності сигналів Шевчиком [@sevcik2010procedure]. Цей метод можна використовувати для швидкого вимірювання складності сигналу.\n\nСинтаксис методу:\n\n**`fractal_sevcik(signal)`**\n\n**Параметри**\n\n- **signal** (*Union[list, np.array, pd.Series]*) --- сигнал (тобто часовий ряд) у вигляді вектора значень.\n\n**Повертає**\n\n- **SFD** (*float*) --- фрактальна розмірність Севчика для досліджуваного часового ряду;\n- **info** (*dict*) --- словник, що містить додаткову інформацію (наразі порожній, але повертається для узгодженості з іншими функціями).\n\n\n#### Віконна процедура\n\nРозпочинаємо віконну процедуру:\n\nЗберігаємо вихідні значення до текстового документа:\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результат:\n\nБачимо, що фрактальна розмірність Шевчика реагує спадом на крахові події на ринку золота. Особливо характерними є спади під час криз 2008, 2011, 2015 та 2020 років. Цінові флуктуації золота під час зазначених кризових подій також характеризувалися зростанням персистентності (кореляцій).\n\n### Обчислення фрактальної розмірності через нормалізовану щільність довжини\n\nЦе доволі простий показник, що відповідає середнім абсолютним послідовним різницям (стандартизованого) сигналу (`np.mean(np.abs(np.diff(std_signal)))`). Метод було розроблено для вимірювання складності сигналів дуже короткої тривалості (< 30 відліків), і його можна використовувати, наприклад, коли цікавлять неперервні зміни фрактальної розмірності сигналу при обчисленні в межах ковзних вікон.\n\nСинтаксис процедури:\n\n**`fractal_nld(signal, corrected=False)`**\n\n**Параметри:**\n\n- **signal** (*Union[list, np.array, pd.Series]*) --- сигнал (тобто часовий ряд) у вигляді вектора значень;\n- **corrected** (*bool*) --- якщо значення `True`, змінює масштаб вихідного значення фрактальної розмірності відповідно до степеневої моделі, щоб зробити його більш порівнянним з \"істинним\" значенням: `FD = 1.9079*((NLD-0.097178)^0.18383)`. Зауважте, що це може призвести до `np.nan`, якщо результат різниці буде від'ємним.\n\n**Повертає:**\n\n- **NLDFD** (*float*) --- фрактальна розмірність;\n- **info** (*dict*) --- словник із додатковою інформацією по розрахункам.\n\n\n#### Віконна процедура\n\nДля цього показника нам також не потребується нічого зайвого:\n\nРозпочинаємо віконну процедуру:\n\nЗберігаємо вихідні значення до текстового документа:\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результат:\n\n[@fig-gold-wind-nld] показує, що $NLDFD$ спадає під час кризових та передкризових подій, що свідчить про зростання кореляцій у дані періоди. \n\n### Обчислення фрактальної розмірності через нахил спектральної щільності потужності\n\nСкористаємось наступним методом бібліотеки `neurokit2`:\n\n**`fractal_psdslope(signal, method='voss1988', show=False, **kwargs)`**\n\n**Параметри:**\n\n- **signal** (*Union[list, np.array, pd.Series]*) --- сигнал (тобто часовий ряд) у вигляді вектора значень;\n- **method** (*str*) --- метод оцінки фрактальної розмірності за нахилом, може бути `\"voss1988\"` (за замовчуванням) або `\"hasselman2013\"`;\n- **show** (*bool*) --- якщо значення `True`, повертає графік залежності спектральної щільності потужності від частоти в логарифмічному масштабі;\n- **kwargs** --- інші аргументи, які слід передати до `signal_psd()`.\n\n**Повертає:**\n\n- **slope** (*float*) --- оцінка фрактальної розмірності, отримана в результаті аналізу нахилу спектральної щільності потужності;\n- **info** (*dict*) --- словник, що містить додаткову інформацію про параметри, які використовуються для аналізу нахилу спектральної щільності потужності.\n\n#### Для всього ряду\n\nДля подальших розрахунків спочатку виконаємо перетворення ряду. Будемо використовувати вихідний часовий ряд для подальших розрахунків: \n\nІ тепер виведемо графік залежності спектральної щільності потужності від частоти в логарифмічному масштабі:\n\nОчевидно, нахил спектральної щільності потужності на різних частотах має лінійну залежність, а кут нахилу прямої побудованої за спектром, близький до -2, що вказує на те, що динаміка індексу золота близька до дробового броунівського руху.\n\nТепер розглянемо варіацію кута нахилу спектра в рамках алгоритму ковзного вікна.\n\n#### Віконна процедура\n\nВстановимо наступні параметри:\n\nРозпочинаємо віконну процедуру:\n\nЗберігаємо вихідні значення до текстового документа:\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результат:\n\nРисунок вище показує, що даний показник також реагує спадом на кризові та передкризові події, вказуючи на зростання автокореляції часового ряду. Також зрозуміло, що має місце варіації нахилу спектра щільності потужності. В одні моменти часу динаміка сигналу може бути подібна до броунівського руху, а в інші до білого шуму.\n\n### Обчислення кореляційної розмірності\n\nКореляційна розмірність є нижньою границею оцінки фрактальної розмірності досліджуваного фазового простору.\n\nСпочатку здійснюється реконструкція фазового простору сигналу згідно методу часової затримки, і далі обчислюються відстані між усіма точками траєкторії. Потім обчислюється \"кореляційна сума\", яка є часткою пар точок, відстань між якими менша за заданий радіус. Остаточна кореляційна розмірність апроксимується графіком залежності кореляційної суми від радіусу багатовимірного околу досліджуваних траєкторій у логарифмічному масштабі.\n\nЦю розмірність можна викликати через `fractal_correlation()`. Її синтаксис виглядає наступним чином:\n\n**`fractal_correlation(signal, delay=1, dimension=2, radius=64, show=False, **kwargs)`**\n\n**Параметри:**\n\n- **signal** (*Union[list, np.array, pd.Series]*) --- сигнал (тобто часовий ряд) у вигляді вектора значень;\n- **delay** (*int*) --- часова затримка ($\\tau$);\n- **dimension** (*int*) --- розмірність вкладень ($m$);\n- **radius** (*Union[str, int, list]*) --- послідовність радіусів для перевірки. Якщо передано ціле число, буде отримано експоненціальну послідовність довжиною заданим скалярним значенням `radius` у межах від 2.5% до 50% від діапазону відстані. Методи, реалізовані в інших пакетах, можна використовувати, вказуючи `\"nolds\"`, `\"Corr_Dim\"` або `\"boon2008\"`;\n- **show** (*bool*) --- графік кореляційної розмірності, якщо `True`. За замовчуванням --- `False`;\n- **kwargs** --- інші аргументи для передачі (наразі не використовуються).\n\n**Повертає:**\n\n- **cd** (*float*) --- кореляційна розмірність часового ряду;\n- **info** (*dict*) --- словник, що містить додаткову інформацію про параметри, які використовуються для обчислення кореляційної розмірності.\n\n#### Для всього часового ряду\n\nРозглянемо залежність кореляційної суми від радіусу для всього часового ряду. Перш за все виконаємо перетворення ряду:\n\nТепер розрахуємо кореляційну розмірність, побудувавши залежність кореляційної суми від радіусу в логарифмічному масштабі:\n\nЯк ми можемо бачити, кореляційна сума дійсно має лінійну залежність для різних значень радіусу околу певної траєкторії, що вказує на фрактальність системи. Тепер подивимось як варіюється значення кореляційної розмірності в періоди турбулентності.\n\n#### Віконна процедура\n\nДля цього показника визначимо наступні параметри:\n\nРозпочинаємо віконну процедуру:\n\nЗберігаємо вихідні значення до текстового документа:\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результат:\n\n[@fig-gold-wind-cd] демонструє, що кореляційна розмірність для індексу золота також спадає у кризові та передкризові періоди, вказуючи на зростання корельованості теперішніх цін на золото з попередніми. Можна сказати й по іншому: у період криз трейдери починають самоорганізовуватись та колективно скупати або продавати відповідний актив; іншими словами, їх динаміка стає більш синхронною. Оскільки кореляційна розмірність вимірюється для траєкторій фазового простору, спад цього показника свідчить про зростання щільності досліджуваних траєкторій. Тобто, фазовий простір стає більш розрідженим, а всі його траєкторії концентрованими лише в одній конкретній області, що є індикатором згуртованості прихованих змінних досліджуваної системи.\n\n## Висновок\n\nУ даній лабораторній роботі було проаналізовано цінові коливання індексу золота з використанням спектра монофрактальних показників. Було показано, що дані методи є досить стійкими до нестаціонарності досілджуваного сигналу. Ринок золота характеризується зростаннями та спадами фрактальної розмірності, що вказує на варіацію ефективності його розвитку в різні моменти часу. Як уже зазначалось, спад фрактальної розмірності в кризовий або передкризовий стан ринку може вказувати на зростання ступеня періодизації (впорядкованості) системи. Зростання фрактальної розмірності може бути індикатором зростання невпорядкованості. У подальшій лабораторній роботі буде продемонстровано підхід, що дозволяє розраховувати спектр фрактальних показників, які можна отримати на різних просторово-часових масштабах системи.\n\n## Завдання для виконання\n\n1. Вибрати із запропонованої бази даних варіант завдання \n2. Виконати дослідження фрактальних характеристик заданих часових рядів. Зберегти результати в окремому файлі\n3. Порівняти значення коефіцієнтів Херста, одержаних методом R/S-аналізу та DFA\n4. Провести повний аналіз різних методів розрахунку монофрактальних розмірностей\n5. Дати інтерпретацію отриманим результатам\n","srcMarkdownNoYaml":"\n\n\n\n\n**Тема.** Фрактальний аналіз складних систем\n \n**Мета.** Навчитися використовувати методи монофрактального аналізу для дослідження нелінійних характеристик складних систем\n\n\n\n## Теоретичні відомості\n\n### Визначення фрактала\n\n**Фракталами** (fractals) називають геометричні об'єкти: лінії, поверхні, просторові тіла, що мають сильно шорстку поверхню або форму і характеризуються властивістю *самоподібності* [@mandelbrot1982fractal;@PhysRevA.42.4528;@10.1007/3-7643-7412-8_8]. Слово фрактал походить від латинського слова *fractus* і перекладається як дробовий, ламаний. Самоподібність як основна характеристика фрактала означає, що він більш-менш однорідно змінюється в широкому діапазоні масштабів. Так, при збільшенні маленькі фрагменти фрактала стають дуже схожими на великі. В ідеальному випадку така самопподібність призводить до того, що  фрактальний об'єкт виявляється інваріантним щодо розтягувань, тобто йому, як кажуть, притаманна дилатаційна симетрія. Вона передбачає незмінність основних геометричних особливостей фрактала при зміні масштабу.\n\nОчевидно, що фрактальні об'єкти реального світу не є нескінченно самоподібними й існує мінімальний масштаб $l_{min}$, такий, що на масштабі $l \\approx l_{min}$ властивість самоподібності зникає. Окрім цього, на достатньо великих масштабах довжин $l > l_{max}$, де $l_{max}$ --- характерний геометричний розмір об'єктів, ця властивість самоподібності також порушується. Тому властивості природніх фракталів розглядаються лише на масштабах $l$, що задовільняють відношення $l_{min} \\ll l \\ll l_{max}$. Такі обмеження природні, оскільки, коли ми приводимо в якості прикладу фракталу --- ламану, негладку траєкторію броунівської частинки, то ми розуміємо, що цей образ представляє очевидну ідеалізацію. Справа в тому, що на малих масштабах приховується граничність маси і розмірів броунівської частинки, а також скінченність часу зіткнення. При врахуванні цих обставин траєкторія броунівської частинки починає представляти гладку криву. \n\nВарто зазначити, що властивість точної самоподібності характерна лише для **регулярних фракталів**. Якщо замість детермінованого способу побудови включити в алгоритм їхнього створення деякий елемент випадковості (як це буває, наприклад, у багатьох процесах диференційованого зростання кластерів, електричному пробої тощо), то виникають так звані **випадкові фрактали**. Основна їхня відмінність від регулярних полягає в тому, що властивості самоподібності є справедливими тільки після відповідного усереднення за всіма статистично незалежними реалізаціями об'єкта. При цьому збільшена частина фрактала не точно ідентична вихідному фрагменту, проте їхні статистичні характеристики збігаються.\n\n### Довжина берегової лінії\n\nПершочергово поняття фрактала у фізиці виникло у зв'язку із завданням про визначення довжини берегової лінії. Під час її вимірювання за наявною картою місцевості з'ясувалася цікава деталь --- чим більш великомасштабна карта береться, тим довшою виявляється ця берегова лінія [@steinhaus1954length;@vulpiani2014lewis;@0c446163-c0a0-36ed-a942-0e71e56cd938;@science.156.3775.636]. Нехай, наприклад, відстань по прямій між розсташованими на береговій лінії точками А та В дорівнює R (див. [@fig-costline]). \n\n::: {#fig-costline}\n\n![](Images\\lab_6\\costline.jpg)\n\nВизначення довжини берегової лінії між точками А та В [@Bozhokin]\n\n:::\n\nТоді, щоб виміряти довжину берегової лінії між цима точками, ми розташуємо по берегу  жорстко пов'язані один з одним вузол так, що відстань між сусідніми вузлами дорівнювала б, наприклад, $l=10$ км. Довжину берегової лінії в кілометрах між точками А і В ми приймемо тоді рівною числу вузлів мінус 1, помноженому на 10. Наступне вимірювання цієї довжини ми зробимо так само, але відстань між сусідніми вузлами зробимо вже рівною $l=1$ км.\n\nВиявляється, що результат цих вимірювань буде різним. При зменшенні масштабу $l$ ми отримуватимемо все більші й більші значення довжини. На відміну від гладкої кривої, лінія морського узбережжя виявляється найчастіше настільки порізаною (аж до найменших масштабів), що зі зменшенням довжини ланки $l$ величина $L$ --- довжина берегової лінії --- не прагне до кінцевого межі, а збільшується за степеневим законом \n\n$$ \nL \\approx l\\left( R \\big/ l \\right)^{D}, \n$$ {#eq-6-1}\n\nа $D > 1$ --- деякий степеневий показник, котрий іменується **фрактальною розмірністю** (fractal dimension) берегової лінії [@science.156.3775.636]. Чим більше значення $D$, тим більш ломаною або деталізованою представляється ця берегова лінія. Походження залежності ([-@eq-6-1]) має бути інтуїтивно зрозумілим: чим менший масштаб ми використовуємо, тим меньші деталі узбережжя будуть враховані і тим менший вклад вони внесуть у вимірювану довжину. Навпаки, збільшуючи масштаб, ми \"розгортаємо\" узбережжя, зменшуючи довжину $L$. \n\nТаким чином, ми бачимо, що для визначення довжини берегової лінії $L$ за допомогою жорсткого масштабу $l$, необхідно зробити $N=L/l$ кроків, причому величина $L$ змінюється з $l$ так, що $N$ залежить від $l$ за законом $N \\approx (R/l)^{D}$. У результаті зі зменшенням масштабу довжина берегової лінії необмежено зростає. Ця обставина різко відрізняє фрактальну криву від звичайної гладкої кривої (типу кола, еліпса), для якої межа довжини апроксимованої ламаної $L$, яка апроксимує, за наближення до нуля довжини її ланки $l$ є скінченною. У результаті для гладкої кривої її фрактальна розмірність $D = 1$, тобто збігається з топологічною.\n\n\n### Фрактальна розмірність множин\n\nВище було введено поняття про фрактальну розмірність берегової лінії. Дамо тепер загальне визначення цієї величини. Нехай $d$ --- звичайна Евклідова розмірність простору, в якому розташований наш фрактальний об'єкт ($d=1$ --- лінія, $d=2$ --- площина, $d=3$ --- звичайний тривимірний простір). Покриємо тепер цей об'єкт цілком $d$-мірними \"кулями\" радіуса 1. Припустимо, що нам потребувалося для цього не менше, ніж $N(l)$ куль. Тоді, якщо за досить малих $l$ величина $N(l)$ змінюється з $l$ за степеневим законом\n\n$$\nN(l) \\sim 1 \\big/ l^D ,\n$$ {#eq-6-2}\n\nтоді $D$ --- називається **хаусдорфовою** (Hausdorff) або **фрактальною розмірністю** цього об'єкта [@10.1214/11-STS370]. Очевидно, що ця формула еквівалентна відношеню $N \\approx \\left( R/l \\right)^{D}$, що використовувалось вище для визначення довжини берегової лінії. [@eq-6-3] можна переписати у вигляді\n\n$$\nD = -\\lim_{l \\to 0} \\ln{N(l)} \\big/ \\ln{l}.\n$$ {#eq-6-3}\n\nЦе відношення і слугує загальним визначенням фрактальної розмірності $D$. У відповідності до нього величина $D$ представляє **локальну** характеристику досліджуваного об'єкта. \n\n### Процедури обчислення монофрактальних розмірностей\n\nНаразі існує багато визначень та методів вимірювання фрактальної розмірності. Найпоширенішими одновимірними фрактальними розмірностями є розмірність Хаусдорфа, розмірність Хігучі, розмірність Петросяна та Мінковського [@falconer2004fractal]. Розмірність Хаусдорфа є найпростішою фрактальною розмірністю. Але її обчислювальна складність є високою, що ускладнює її практичне застосування. Розмірність Мінковського є відносно простою, і фрактальну розмірність сигналу можна отримати, регулюючи розмір довжини сторони клітини в межах якої визначається \"шорсткість\" поверхні сигналу. Тому вона є широко впізнаваємою та застосовуваною. Який з показників фрактальної розмірності найточніше описує складність сигналу та здатний ідентифікувати кризові явища і представляє ключовий момент цієї лабораторної роботи.\n\n#### *R/S*-аналіз\n\n**Метод *R/S*-аналізу** (Rescaled range, *R/S* analysis), розроблений Мандельбротом та Уоллесом [@10.1119/1.13295], базується на попередньо створеному методі гідрологічного аналізу Херста [@doi:10.1061/TACEAT.0006518;@hurst1957suggested], і дозволяє обчислювати параметр самоподібності $H$, який вимірює інтенсивність довготривалих залежностей у часовому ряді. Коефіцієнт $H$, який називають коефіцієнтом Херста, містить мінімальні прогнози стосовно природи системи, що вивчається, і може класифікувати часові ряди. За допомогою цього показника розрізняють випадкові (гаусові) та невипадкові ряди; окрім того, він пов'язаний із фрактальною розмірністю, що, у свою чергу, характеризує ступінь згладженості графіка, побудованого на основі часового ряду. Методом *R/S*-аналізу можливо також виявити максимальну довжину інтервалу (цикл), на якому значення зберігають інформацію про початкові дані системи (довготривала пам’ять). \n\nАналіз починається з побудови ряду логарифмічних прибутковостей, $G(t) \\equiv \\ln{x(t + \\Delta t)} - \\ln{x(t)}$, де $x(t)$ --- значення вихідного часового ряду в момент $t$, $\\Delta t$ --- часовий крок. Отримана послідовність $G(t)$ розбивається на $d$ підпослідовностей довжини $n$. \n\nДля кожної підпослідовності $m=1,...,d$:\n\n1. Шукається середнє значення $\\mu_m$ та стандартне відхилення $S_m$. \n2. Дані нормалізуються шляхом віднімання середнього значення послідовності $X_{i,m}=G_{i,m}-\\mu_m$, $i=1,...,n$.\n3. Знаходиться кумулятивна сума послідовності $X$ів: $Y_{i,m}=\\sum_{j=1}^{i}X_{j,m}$, $i=1,...,n$. \n4. У межах кожної підпослідовності знаходиться розмах між максимальним та мінімальним значеннями: $R_m = \\max\\{Y_{1,m},...,Y_{n,m}\\}-\\min\\{Y_{1,m},...,Y_{n,m}\\}$, який стандартизується середнім квадратичним відхиленням $R_{m}/S_{m}$. \n5. Обчислюється середнє $(R/S)_n$ нормованих значень розмаху для всіх підпослідовностей довжини $n$.  \n\n*R/S*-статистика, обрахована таким чином, відповідає співвідношенню $(R/S)_{n} \\cong cn^{H}$, де значення $H$ може бути отримане шляхом обчислення $(R/S)_n$ для послідовностей інтервалів зі збільшенням часового горизонту:\n\n$$\n\\log{(R/S)}_{n} = \\log{c} + H\\log{n}. \n$$ {#eq-6-4}\n\nЗнайти коефіцієнт Херста можна, побудувавши залежність $(R/S)_n$ vs. $n$ у подвійному логарифмічному масштабі і взявши коефіцієнт нахилу прямої, яка інтерполює точки отриманого графіка. Якщо значення $H=0.5$, говорять про послідовність, що представляє собою **білий шум**; $0.5 < H \\leq 1$ свідчить про **персистентний** (трендостійкий) ряд, коли існує тенденція слідування великих значень ряду за великими і навпаки; $H<0.5$ вказує на **антиперсистентний** (mean-reversion) ряд.\n\nПри збільшенні часового горизонту коефіцієнт нахилу інтерполюючої прямої повинен прямувати до значення $H=0.5$; сам процес переходу свідчить про втрату впливу початкових умов на поточні значення, і, таким чином, можна говорити про горизонт довгої пам’яті --- це точка, до якої коефіцієнт нахилу інтерполюючої прямої відмінний від 0.5, а після --- близько 0.5. \n\n::: {.callout-note}\n## Примітка до *R/S*-аналізу\n\nМіж фрактальною розмірністю та показником Херста також існує зв'язок\n\n$$\nD_f = 2-H. \n$$\n\nЯкщо для берегової лінії ми визначали масштабування її довжини $L$ в залежності від зміни $l$, то у випадку з *R/S*-аналізом ми визначаємо зміну нормованого розмаху значень ряду в межах масштабу $n$\n \n:::\n\n#### Аналіз детрендованих флуктуацій\n\n**Аналіз детрендований флуктуацій** (Detrended fluctuation analysis, DFA) [@PhysRevE.49.1685] базується на гіпотезі про те, що корельований часовий ряд може бути відображений на самоподібний процес шляхом інтегрування. Таким чином, вимірювання властивостей самоподібності може непрямо свідчити про кореляційні властивості ряду. Переваги DFA порівняно з іншими методами (спектральний аналіз, *R/S*-аналіз) полягають в тому, що він виявляє довгочасові кореляції нестаціонарних часових рядів, а також дозволяє ігнорувати очевидні випадкові кореляції, що є наслідком нестаціонарності [@JIANG2014235]. \n\nІснують DFA різних порядків, що відрізняються трендами, які вилучаються з даних. \n\nРозглянемо DFA найнижчого порядку.\n\n1. Для часового ряду довжини $N$ знаходиться кумулятивна сума, $y(k)=\\sum_{i=1}^{k}\\left( x_i - \\bar{x} \\right)$, де $x_i$ --- це $i$-те значення часового ряду, $\\bar{x}$ --- його середнє значення, $k=1,...,N$.\n2. Отриманий ряд $y(k)$ розбивається на $m$ підпослідовностей (вікон) однакової ширини $n$ і для кожної підпослідовності (у кожному вікні) виконується наступне:\n\n    - за допомогою методу найменших квадратів знаходиться локальний лінійний тренд $y_{t}(k)$;  \n    - підпослідовність детрендується шляхом віднімання значення локального тренду $y_{t}(k)$ від значень ряду $y(k)$, що належать послідовності $t$;\n    - знаходиться середнє $\\bar{y_t}$ детрендований значень. \n\nДля отриманих таким чином значень на всіх підпослідовностях знаходиться:\n\n$$\nF_n = \\sqrt{\\bar{y_t} \\cdot m^{-1}}, \n$$\n\nде $n$ --- кількість точок у підпослідовності (ширина вікна), $m$ --- кількість підпослідовностей, $\\bar{y_t}$ --- середнє детрендованих значень для підпослідовності $t$. \n\nВказана процедура повторюється для різних значень $n$, внаслідок чого ми отримує набір залежностей $F_n$ від $n$. Побудова залежності $\\log{F(n)}$ від $\\log{n}$ та інтерполяція отриманих значень лінією регресії дає змогу обчислити показник скейлінга $\\alpha$, що є коефіцієнтом кута нахилу інтерполяційної прямої і характеризує зміну кореляцій флуктуацій часового ряду $F_n$ при збільшенні часового інтервалу $n$. \n\nПорівняно із *R/S*-аналізом, DFA дає більші можливості інтерпретації скейлінгового показника $\\alpha$: \n\n- для випадкового ряду (перемішаного чи \"сурогатного\") $\\alpha = 0.5$; \n- при наявності лише короткочасових кореляцій $\\alpha$ може відрізнятись від 0.5, проте має тенденцію прямувати до 0.5 при збільшенні розміру вікна;\n- Значення $0.5 < \\alpha \\leq 1.0$ показує персистентні довгочасові кореляції, що відповідають степеневому закону; \n- $0 < \\alpha < 0.5$ означає антиперсистентний ряд; \n- cпеціальний випадок, коли $\\alpha = 1$, означає наявність $1/f$ шуму. \n- для випадків, коли $\\alpha \\geq 1$, кореляції існують, проте перестають відображувати степеневу залежність;\n- випадок $\\alpha = 1.5$ свідчить про броунівський шум, який представляє інтегрований білий шум.\n\nУ випадку степеневої залежності функції автокореляцій спостерігається спад автокореляції з показником $\\gamma$:\n\n$$\nC(L) \\sim L^{-\\gamma}.\n$$ \n\nНа додачу до цього, спектральна густина також спадає за степеневим законом: \n\n$$\nP(f) \\sim f^{-\\beta}. \n$$ {#eq-spec-dens}\n\nВідповідні показники виражаються через наступні відношення:\n\n- $\\gamma=2-2\\alpha$; \n- $\\beta=2\\alpha-1$. \n\nУ DFA другого порядку (DFA2) обчислюються відхилення $F^2(v,s)$ профілю від інтерполяційного многочлена другого порядку. Таким чином, вилучаються впливи \nможливих лінійних та параболічних трендів для масштабів, більших за розглядувані. Взагалі, у DFA порядку $n$ обчислюються відхилення профілю від інтерполяційного многочлена $n$-го порядку, що вилучає вплив всіх можливих трендів порядків до ($n-1$) для масштабів, більших від розміру вікна. \n\nПотім обчислюється найближчий поліном $y_{ν}(s)$ для профілю на кожному із $2N_s$ сегментів $v$ і визначається відхилення\n\n$$\nF^2(v,s) \\equiv \\frac{1}{s}\\sum_{i=1}^{s}\\left( x_{(v-1)s+i} - y_{i}(i) \\right)^{2}.\n$$ {#eq-6-5}\n\nДалі знаходиться середнє значення флуктуацій всіх детрендованих профілів:\n\n$$\nF_2(s) \\equiv \\sqrt{\\left( \\frac{1}{2N_s} \\sum_{v=1}^{2N_s}F^{2}(v,s) \\right)}.\n$$ {#eq-6-6}\n\nЗначення ([-@eq-6-6]) можна трактувати як середньоквадратичний зсув (переміщення) точки випадкових блукань у ланцюжку після $s$ кроків. \n\n#### Фрактальна розмірність Хігучі\n\n**Фрактальна розмірність Хігучі** (Higuchi fractal dimension) [@HIGUCHI1988277;@7168285] --- це один з різновидів монофрактальної розмірності, яка визначається наступним чином:\n\nПрипустимо, що у нас є часовий ряд $x(1), x(2),...,x(N)$ і реконструйований часовий ряд $x_{m}^{k} = \\{ x(m), x(m+k), x(m+2k),..., x\\left( m+\\left[ (N-m) \\big/ k \\right] \\cdot k \\right) \\}$ для $m=1,2,...,k$, де $m$ представляє початковий час; $k=2,...,k_{max}$ представляють ступінь часового зміщення. Позначення $[\\cdot]$ представляє цілу частину $x$. Для кожного реконструйованого часового ряду $x_{m}^{k}$ розраховується середня довжина часової послідовності $L_{m}(k)$: \n\n$$\nL_{m}(k) = \\frac{\\sum_{i=1}^{\\left[ (N-m)/k \\right]} | x(m+ik) - x(m+(i-1)\\cdot k) | \\cdot (N-1)}{\\left[ (N-m) \\big/ k \\right] \\cdot k}. \n$$\n\nДалі, для всіх середніх довжин $L_{m}(k)$, знаходиться загальне середнє $L(k) = (k)^{-1}\\sum_{m=1}^{k}L_{m}(k)$. Згідно методу Хігучі узагальне середнє значення $L(k)$ пропорційне масштабу $k$, тобто $L(k) \\propto k^{-D}$. Далі логарифмуємо обидві сторони й отримуємо рівність $\\ln{L(k)} \\propto D \\cdot \\ln{\\left( 1 \\big/ k \\right)}$. Інтерполювавши лінію регресії через залежність $\\ln{L(k)}$ від $\\ln{\\left( 1 \\big/ k \\right)}$, ми можемо отримати показник фрактальності $D$ як кут нахилу цієї лінії. Показник $D$ і представлятиме фрактальну розмірність Хігучі. \n\n#### Фрактальна розмірність Петросяна\n\nСпочатку для часового ряду $\\{ x_1, x_2,...,y_{N} \\}$ створюємо його дискретизовану (бінарну) версію, $z_i$: \n\n$$\nz_i = \n\\begin{cases}\n    1, & x_i > \\langle x \\rangle, \\\\\n    -1, & x_i \\leq \\langle x \\rangle. \n\\end{cases}\n$$\n\n**Фрактальну розмірність Петросяна** (Petrosian fractal dimension) [@465426;@904882;@goh:inria-00442374] можна визначити як \n\n$$\nD = \\log_{10}{N} \\big/ \\left( \\log_{10} + \\log_{10}{\\left[ N \\big/ (N+0.4N_{\\Delta}) \\right]} \\right), \n$$\n\nде $N_{\\Delta}$ --- кількість загальних змін знаку величини $z_i$: $N_{\\Delta} = \\sum_{i=1}^{N-2} \\left| (z_{i+1}-z_i) \\big/ 2 \\right|$.\n\n\n\n#### Фрактальна розмірність Каца\n\nПредставимо, що сигнал складається з пари точок $\\left( x_i, y_i \\right)$. Тоді, **фрактальна розмірність Каца** (Katz fractal dimension) [@KATZ1988145] визначається як \n\n$$\nD = \\log{N}/\\left(\\log{N} + \\log{d/L}\\right),\n$$\n\nде $L = \\sum_{i=0}^{N-2}\\sqrt{\\left( y_{i+1}-y_{i} \\right)^{2} + \\left( x_{i+1}-x_{i} \\right)^{2}}$, а значення $d = \\max{\\left( \\sqrt{\\left( x_i - x_1 \\right)^{2} - \\left( y_i - y_1 \\right)^{2}} \\right)}$. \n\n\n#### Фрактальна розмірність Шевчика\n\nСпочатку, для множини значень $\\left( x_i, y_i \\right)$ виконується нормалізація: $x_{i}^{*} = \\left( x_i-x_{min} \\right) \\big/ \\left( x_{max}-x_{min} \\right)$ і $y_{i}^{*} = \\left( y_i - y_{min} \\right) \\big/ \\left( y_{max}-y_{min} \\right)$.\n\n**Фрактальна розмірність Шевчика** (Sevcik fractal dimension) [@sevcik2010procedure] може бути визначена як\n\n$$\nD = 1 + \\left. \\ln{L} \\big/ \\ln{\\left( 2 \\cdot  [N-1] \\right)} \\right., \n$$\n\n$L$ --- це довжина сигналу, що може бути розрахована за формулою $L = \\sum_{i=0}^{N-2}\\sqrt{\\left( y_{i+1}^{*}-y_{i}^{*} \\right)^{2} + \\left( x_{i+1}^{*}-x_{i}^{*} \\right)^{2}}$. \n\n\n#### Фрактальна розмірність через нормалізовану щільність довжини\n\nДаний показник розраховується в наступний спосіб [@kalauzi2009extracting]:\n\n1. Для часового ряду $\\{ x_1, x_2,...,x_n \\}$ виконується стандартизація: $y_i = (x_i - \\mu)/\\sigma$, де $\\mu$ --- це середнє значення ряду, $\\sigma$ --- це стандартне відхилення. \n2. Розраховується нормалізована щільність довжини $NLD = \\frac{1}{N}\\sum_{i=2}^{N}\\left| y_i - y_{i-1} \\right|$. Фактичний розрахунок **фрактальної розмірності через нормалізовану щільність довжини** (fractal dimension via Normalized Length Density, FNLD) базується на побудові монотонної калібрувальної кривої $D = f(NLD)$ за набором функцій Вейєрштрасса, для яких значення $D$ задаються теоретично.\n3. Для обчислювальних цілей створено дві моделі цієї залежності:\n    - логарифмічну модель: $D = a \\cdot \\log{\\left(NLD - NLD_{0} \\right)} + C$;\n    - степеневу модель: $D = a \\cdot \\left(NLD - NLD_{0} \\right)^{k}$. Бібліотека `neurokit2` використовує саме степеневу модель. Параметр $a=1.9079$, $k=0.18383$ і $NLD_{0}=0.097178$, згідно [@Kalauzi_2009]. \n\n\n#### Фрактальна розмірність і спектральна щільність потужності\n\nФрактальну розмірність можна обчислити на основі аналізу нахилу **спектральної щільності потужності** (power spectral density slope, PSD) [@10.3389/fphys.2013.00075;@Voss1988] в сигналах, що характеризуються степеневою частотною залежністю.\n\nСпочатку виконується перетворення часового ряду до частотної області і далі сигнал розбивається на гармонійні коливання певної амплітуди, які разом \"складаються\", щоб представити вихідний сигнал. Якщо існує систематичний зв'язок між частотами в сигналі і потужністю цих частот, то в логарифмічних координатах це проявляється через лінійну залежність. Кут нахилу лінії регресії приймається як оцінка фрактальної розмірності.\n\nНахил 0 відповідає білому шуму, а нахил менше 0, але більше -1, відповідає рожевому шуму, тобто шуму $1/f$. Спектральні нахили крутіші за -2 вказують на дробовий броунівський рух, що є проявом процесів випадкового блукання.\n\n#### Кореляційна розмірність \n\n**Кореляційна розмірність** (correlation dimension, $D_2$) --- це похідна величина від кореляційного інтеграла (кореляційної суми) і може бути подана у вигляді [@GRASSBERGER1983189;@PhysRevLett.50.346;@GRASSBERGER1983227]:\n\n$$\nC(\\varepsilon) = \\frac{1}{N^{2}}\\sum_{\\substack{i,j=1 \\\\ i\\neq j}}^{N}\\Theta \\left( \\varepsilon - \\| \\vec{x}(i) - \\vec{x}(j) \\| \\right), \\; \\vec{x}(i) \\in \\Re^{m}. \n$$\n\nКореляційна розмірність може бути виведена з наступної степеневої залежності:\n\n$$\nC(\\varepsilon) \\sim \\varepsilon^{\\nu}, \n$$\n\nабо\n\n$$\nD_2 = \\lim_{M\\to\\infty}\\lim_{\\varepsilon\\to 0} \\log{\\left( g_{\\varepsilon} \\big/ N^2 \\right)} \\big/ \\log{\\varepsilon}, \n$$\n\nде $g_{\\varepsilon}$ --- це сумарна кількість пар точок, відстань між якими менша за радіус $\\varepsilon$. \n\nУ першому випадку ми відбираємо $i$-ту траєкторію та всі інші $j$-ті траєкторії, і дивимося, чи потрапляють $j$-ті траєкторії в $\\varepsilon$-окіл $i$-ої траєкторії. Якщо відстань між ними не перевищує окіл радіусом $\\varepsilon$, ми ставимо 1. Але якщо відстань між траєкторіями більша за $\\varepsilon$, тоді ставимо 0. Далі все це підсумовується, ділиться на загальну кількість траєкторій. По суті кореляційний інтеграл це середня ймовірність того, що дві розглянуті траєкторії фазового простору, будуть знаходитися досить близько одна від одної. Чим тісніше розташовані точки фазового простору, тим більше значення кореляційного інтеграла. Чим більш рівновіддаленими видаються траєкторії одна від одної, тим ближче значення кореляційного інтеграла до нуля.   \n\nЗначення кореляційної розмірності ми можемо відшукати аналогічно попередним фрактальним показникам: ми шукаємо залежність кореляційного інтеграла від значення $\\varepsilon$. Ця залежність будується в логарифмічному масштабі. \n\nОсь деякі цікаві приклади. \n\n**Електрокардіограма** (ЕКГ):\nЕКГ-сигнали відображають електричну активність серця. Складність ЕКГ-сигналу може бути оцінена за допомогою кореляційної розмірності. Очікується, що кореляційна розмірність ЕКГ здорового серця буде вищою через наявність складних патернів і варіабельності. З іншого боку, аномальні ЕКГ-сигнали, наприклад, від пацієнтів з аритміями або серцевими захворюваннями, можуть мати нижчу кореляційну розмірність через втрату складності сигналу.\n\n**Електроенцефалограма** (ЕЕГ):\nСигнали ЕЕГ реєструють електричну активність мозку. Кореляційна розмірність може використовуватися для аналізу складності мозкової активності, яка може змінюватися залежно від різних когнітивних станів, стадій сну або неврологічних розладів. У здорових людей сигнали ЕЕГ у стані бадьорості та уваги можуть мати вищу кореляційну розмірність порівняно з сигналами у стадії сну, коли активність мозку є більш регулярною і синхронізованою.\n\n**Дихальні сигнали**:\nДихальні сигнали, такі як частота дихання або повітряний потік, також можуть бути проаналізовані за допомогою кореляційної розмірності. Складність цих сигналів може змінюватися залежно від таких факторів, як стрес, фізичне навантаження або наявність респіраторних захворювань. За нормального дихання може спостерігатися вища кореляційна розмірність, тоді як порушення в дихальних сигналах, наприклад, за обструктивного апное уві сні або дихальних розладів, можуть призвести до зниження кореляційної розмірності.\n\n**Аналіз ходи**:\nКореляційна розмірність може бути використана для аналізу моделей ходи. Вона допомагає зрозуміти складність рухів людини під час ходьби чи бігу. Зміни в кореляційній розмірності сигналів ходи можуть свідчити про зміну стабільності ходи або про наявність відхилень у ході, викликаних неврологічними або опорно-руховими захворюваннями.\n\n**Варіативність динаміки серцевого ритму** (ВСР):\nВСР являє собою зміну часових інтервалів між послідовними ударами серця. Вона перебуває під впливом вегетативної нервової системи і відображає адаптивність і складність серцево-судинної системи. Вищий рівень ВСР, що відповідає вищій кореляційній розмірності, зазвичай асоціюється з кращим станом серцево-судинної системи та її адаптивністю до фізіологічних змін і змін навколишнього середовища. Її падіння може асоціюватися з аномальною динамікою серця.\n\n**Послідовності ДНК**:\nКореляційна розмірність може бути використана і при аналізі послідовностей ДНК. Вона допомагає виявити самоподібні або фрактальні патерни всередині послідовностей, що може мати значення для розуміння генетичної складності, еволюційних зв'язків і регуляції генів. Висока кореляційна розмірність --- висока складність ланцюжка ДНК. Мала кореляційна розмірність --- спрощений ланцюжок ДНК.\n\n**Фінансові ринки**:\nВища кореляційна розмірність у даних часових рядів фінансового ринку свідчить про більшу складність та існування в їхній основі самоподібних моделей або фрактальних структур. Хаотична поведінка цін на акції може бути пов'язана з періодами високої волатильності та непередбачуваності. З іншого боку, нижча величина кореляційної розмірності може свідчити про більш передбачувані та менш складні рухи цін, що відповідає періодам стабільності або менш волатильним ринковим умовам.\n\n## Хід роботи\n\nРозглянемо як можна застосовувати зазначені показники в якості індикаторів кризових станів. \n\nСпочатку імпортуємо необхідні бібліотеки:\n\nДалі виконаємо налаштування формату виведення рисунків:\n\nНа цьому етапі скористаємось монофрактальними показниками для ідентифікації кризових явищ на ринку золота. Розглянемо ціну золота, наприклад, за період з 1 грудня 2001 року по 1 листопада 2023 року:\n\n::: {.callout-warning}\n## Увага\n\nВиконайте цей блок, якщо хочете зчитати дані не з Yahoo! Finance, а із власного файлу. Зрозуміло, що й аналіз результатів, і висновки залежать від того з яким рядом ми працюємо \n\n:::\n\n---\n\n---\n\nВиводимо досліджуваний ряд:\n\nВизначимо функцію `transformation()` для стандартизації ряду:\n\n### Обчислення показника Херста з використанням *R/S*-аналізу\n\nДля подальших розрахунків використовуватимемо бібліотеку `neurokit2` та `fathon`. Другу з них можна встановити в наступний спосіб:\n\nДалі імпортуємо саму бібліотеку та дотичні до неї модулі:\n\nБібліотека `neurokit` містить необхідний метод для *R/S*-аналізу --- `fractal_hurst`. Його синтаксис:\n\n**`fractal_hurst(signal, scale='default', corrected=True, show=False)`**\n\n**Параметри:**\n\n- **signal** (*Union[list, np.array, pd.Series]*) --- сигнал (тобто часовий ряд) у вигляді вектора значень або датафрейму бібліотеки `pandas`;\n- **scale** (*list*) --- список, що містить довжини вікон (кількість точок даних у кожній підмножині ряду), на які розбито сигнал;\n- **corrected** (*bool*) --- якщо значення `True`, до вихідних даних буде застосовано поправочний коефіцієнт Аніса-Ллойда-Пітерса [@Anis_1976] відповідно до очікуваного значення для окремих значень (*R/S*);\n- **show** (*bool*) --- якщо значення `True`, виводить залежність $(R/S)_n$ від $n$ (**scale**) у подвійному логарифмічному масштабі. \n\n**Повертає:**\n\n- **h** (*float*) --- показник Херста;\n- **kwargs** --- словник, що містить інформацію відносно використовуваних у процедурі параметрів.\n\nРозглянемо ступінь трендостійкості в динаміці ціни золота, використовуючи весь часовий ряд. Далі знайдемо значення показника Херста в рамках віконної процедури.\n\n#### Увесь часовий ряд\n\nПершочергово знайдемо значення прибутковостей для нашого ряду та стандартизуємо їх. Після цього виконаємо обчислення:\n\nВиконуємо *R/S*-аналіз:\n\nЯк ми можемо бачити з @fig-gold-rs-all, значення $h=0.53$, що свідчить про подібність цінової динаміки золота до випадкового блукання. Але оскільки закони, що регулюють ринок, змінюються з часом, мають змінюватись і кореляції всередині системи, а тому коефіцієнт Херста також може змінюватись.   \n\n#### Віконна процедура\n\nВизначимо функцію для побудови парних графіків:\n\nПриступимо до віконної процедури:\n\nВізуалізуємо результат:\n\nНа [@fig-gold-wind-rs] можемо бачити, що показник Херста зростає в передкризовий період та спадає під час кризи. Перед кризою динаміка ринку характеризується зростанням трендостійкості (персистентності), що відзеркалює зростання скорельованості дій трейдерів. \n\n### Обчислення на основі DFA\n\nБібліотека `fathon` представляє інструментарій як для виконання класичного аналізу детрендованих флуктуацій, так і для його мультифрактального аналогу, мова про який піде в наступній лабораторній роботі. \n\n#### Для всього ряду\n\nСпочатку представимо значення $\\alpha$ для всього ряду. Процедура розрахунків на основі бібліотеки `fathon` виглядатиме наступним чином: \n\nЗнаходимо стандартизовані прибутковості ряду:\n\nВиводимо залежність функції флуктуацій від масштабу:\n\nБудуємо залежність функції флуктуацій від масштабу в подвійному логарифмічному масштабі:\n\nПроцедура DFA показує, що значення ціни золота представляються скоріше антиперсистентними, але представлений результат доволі близький до того, що був отриманий за допомогою *R/S*-аналізу. Розглянемо значення $\\alpha$ в рамках алгоритму ковзного вікна. \n\n#### Віконна процедура\n\nВизначимо наступні параметри:\n\nЗнайдемо показник Херста ($\\alpha$), фрактальну розмірність ($D_f$), показник спектральної щільності ($\\beta$) та показник автокореляції ($\\gamma$):  \n\nЗберігаємо абсолютні значення показників до текстових файлів:\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результати:\n\nЯкщо порівнювати з *R/S*-аналізом, @fig-gold-wind-alpha демонструє, що DFA динаміка *узагальненого показника Херста* є набагато стабільнішою. Тепер ми здатні диференціювати значну частку крахових подій, що мали місце на ринку золота. Узагальнений Херст показує, що передкризові явища характеризуються зростанням трендостійкості ринку, підвищенням ступеня самоорганізації системи. \n\n[@fig-gold-wind-df] показує, що $D_f$ характеризується спадом при кризових станах. Це є індикатором того, що вищий ступень організованості ринку відзеркалюється в більш згладженій або менш волатильних флуктуаціях досліджуваного сигналу.  \n\nСпектральна густина потужності $\\beta$ [@eq-spec-dens] зростає в кризові періоди, що свідчить про спад потужності сигналу на одиничному інтервалі частоти. Це також є свідченням зростання кореляційних властивостей системи.\n\nЗ [@fig-gold-wind-gamma] видно, що показник $\\gamma$ спадає в кризові та передкризові періоди. Це є показником сповільнення спаду функції автокореляції, що в свою чергу також вказує на зростання корельованності динаміки системи. \n\n### Обчислення фрактальної розмірності Хігучі\n\nЯк уже зазначалося, фрактальна розмірність Хігучі є одним із різновидів фрактальної розмірності для часових рядів. Вона обчислюється шляхом реконструкції $k_{max}$ кількості нових наборів даних. Для кожного відновленого набору даних обчислюється довжина кривої і відкладається проти відповідного $k_{max}$-значення в логарифмічній шкалі. HFD відповідає нахилу лінійного тренду за методом найменших квадратів.\n\nРозрахуємо оптимальне значення $k$ для всього часового ряду. Бібліотека `neurokit2` представляє готову процедуру для автоматизованого підбору даного параметру. Оптимальний $k_{max}$ розраховується на основі точки, в якій значення фрактальної розмірності досягає плато для діапазону значень $k_{max}$ [@7168285]. \n\nСинтаксис даної функції виглядає наступним чином:\n\n**`complexity_k(signal, k_max='max', show=False)`**\n\n**Параметри:**\n\n- **signal** (*Union[list, np.array, pd.Series]*) --- сигнал (тобто часовий ряд) у вигляді вектора значень;\n- **$k_{max}$** (*Union[int, str, list], optional*) --- максимальна кількість інтервалів (має бути більше або дорівнювати 3), які потрібно перевірити. Якщо  $k_{max}$ = `default`, тоді вибирається максимально можливе значення, що відповідає половині довжини сигналу;\n- **show** (*bool*) --- візуалізовується нахил кривої для обраного значення $k_{max}$. \n\n**Повертає:**\n\n- **k** (*float*) --- оптимальний $k_{max}$ часового ряду;\n- **info** (*dict*) --- словник, що містить додаткову інформацію про параметри, які використовуються для обчислення оптимального $k_{max}$.\n\n#### Для всього ряду\n\nДля подальших розрахунків спочатку виконаємо перетворення ряду. Будемо використовувати вихідний часовий ряд для подальших розрахунків: \n\nІ тепер отримаємо оптимальне значення $k_{max}$ згідно зазначеної процедури:\n\nТепер побудуємо залежність довжини сигналу від часового зміщення в логарифмічному масштабі. Для фрактального сигналу має зберігатися лінійна залежність. Бібліотека `neurokit2` містить метод для розрахунку даної фрактальної розмірності. Синтаксис цієї процедури виглядає наступним чином:\n\n**`fractal_higuchi(signal, k_max='default', show=False, **kwargs)`**\n\n**Параметри:**\n\n- **signal** (*Union[list, np.array, pd.Series]*) --- сигнал (тобто часовий ряд) у вигляді вектора значень;\n- **$k_{max}$** (*Union[int, str, list], optional*) --- максимальна кількість інтервалів (має бути більше або дорівнювати 3), які потрібно перевірити;\n- **show** (*bool*) --- візуалізовується нахил кривої для обраного значення $k_{max}$. \n\n**Повертає:**\n\n- **HFD** (*float*) --- фрактальна розмірність Хігучі для досліджуваного часового ряду;\n- **info** (*dict*) --- словник, що містить додаткову інформацію про параметри, які використовуються для обчислення фрактальної розмірності Хігучі.\n\nУ подальшому будемо послуговуватись отриманим оптимальним значенням для розрахунку розмірності Хігучі в рамках алгоритму ковзного вікна. \n\n#### Віконна процедура\n\nСкористаємось наступними параметрами:\n\nРозпочинаємо віконну процедуру:\n\nЗберігаємо вихідні значення до текстового документа:\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результат:\n\nЯк можна бачити з представленого рисунку, фрактальна розмірність Хігучі може працювати як індикатор або індикатор-передвісник кризових явищ. Видно, що даний показник починає спадати у передкризові періоди чи у сам момент кризи, вказуючи на зростання згладженності динаміки системи, ступеня кореляцій та трендостійкості динаміки ринку. \n\n### Обчислення фрактальної розмірності Петросяна\n\nПетросян [@465426] запропонував швидкий метод оцінки фрактальної розмірності шляхом перетворення сигналу в двійкову послідовність, з якої оцінюється фрактальна розмірність. Існує кілька варіацій алгоритму (`neurokit2`, наприклад, пропонує варіанти `\"A\"`, `\"B\"`, `\"C\"` або `\"D\"`), що відрізняються насамперед способом створення дискретної (символьної) послідовності (див. `complexity_symbolize()` для деталей). Найпоширеніший метод (`\"C\"`, за замовчуванням) бінаризує сигнал за знаком послідовних різниць.\n\nБільшість з цих методів дискретизації припускають, що сигнал є періодичним (без лінійного тренду). Для усунення лінійних трендів може бути корисним лінійне детрендування.\n\nСинтаксис даної процедури має наступний вигляд:\n\n**`fractal_petrosian(signal, symbolize='C', show=False)`**\n\n**Параметри:**\n\n- **signal** (*Union[list, np.array, pd.Series]*) --- сигнал (тобто часовий ряд) у вигляді вектора значень;\n- **symbolize** (*str*) - метод перетворення неперервного вхідного сигналу в символьний (дискретний) сигнал. За замовчуванням присвоює 0 та 1 значенням нижче та вище середнього. Може мати значення `None`, що припускає дискретність вхідного сигналу;\n- **show** (*bool*) --- виводить дискретизацію сигналу. \n\n**Повертає:**\n\n- **PFD** (*float*) --- фрактальна розмірність Петросяна для досліджуваного часового ряду;\n- **info** (*dict*) --- словник, що містить додаткову інформацію про параметри, які використовуються для обчислення фрактальної розмірності Петросяна.\n\nМи не розглядатимемо детально синтаксис функції `complexity_symbolize()`. Опишемо лише ті методи дискретизації, що дотичні до фрактальної розмірності Петросяна:\n\n- **метод `A`** бінаризує сигнал за більшими та меншими значеннями порівняно із середнім значенням сигналу. Еквівалентом є `method=\"mean\"` (`method=\"median\"` також є допустимим);\n- **метод `B`** використовує значення, що знаходяться в діапазоні $\\pm 1\\sigma$, проти значень, що виходять за межі цього діапазону;\n- **метод `C`** обчислює різницю між послідовними вибірками та бінаризує їх залежно від знаку;\n- **метод `D`** відокремлює послідовні відліки, що перевищують $1\\sigma$ сигналу, від інших менших змін.\n\nТепер розглянемо віконну динаміку показника. \n\n#### Віконна процедура\n\nОскільки більшість з даних методів дискретизації вимагають детрендування ряду, будемо виконувати розрахунки для прибутковостей ціни золота. Скористаємось наступними параметрами:\n\nРозпочинаємо віконну процедуру:\n\nЗберігаємо вихідні значення до текстового документа:\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результат:\n\n[@fig-gold-wind-petro] показує, що показник Петросяна також спадає під час кризових подій і вказує на зростання періодизації ринку та синхронізації активності трейдерів у відповідні моменти часу.\n\n### Обчислення фрактальної розмірності Каца\n\nОбчислимо фрактальну розмірність Каца. Евклідові відстані між послідовними точками сигналу підсумовуються і усереднюються, а також визначається максимальна відстань між початковою точкою і будь-якою іншою точкою у вибірці.\n\nФрактальна розмірність варіюється від 1.0 для прямих ліній, приблизно до 1.15 для випадкових блукань і наближається до 1.5 для найбільш \"дивних\" форм сигналу.\n\nСинтаксис процедури для розрахунку даної розмірності виглядає наступним чином:\n\n**`fractal_katz(signal)`**\n\n**Параметри:**\n\n- **signal** (*Union[list, np.array, pd.Series]*) --- сигнал (тобто часовий ряд) у вигляді вектора значень.\n\n**Повертає:**\n\n- **KFD** (*float*) --- фрактальна розмірність Каца для досліджуваного часового ряду;\n- **info** (*dict*) --- словник, що містить додаткову інформацію (наразі порожній, але повертається для узгодженості з іншими функціями).\n\n\n#### Віконна процедура\n\nОскільки даний показник є параметронезалежним, нам достатньо буде лише розміру часового вікна, кроку та типу ряду:\n\nРозпочинаємо віконну процедуру:\n\nЗберігаємо вихідні значення до текстового документа:\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результат:\n\nЗ рисунку видно, що фрактальна розмірність Каца також спадає у кризові та передкризові періоди і також є індикатором зростання ступеня корельованості системи в дані періоди.\n\n### Обчислення фрактальної розмірності Шевчика\n\nАлгоритм цієї фрактальної розмірності був запропонований для обчислення фрактальної розмірності сигналів Шевчиком [@sevcik2010procedure]. Цей метод можна використовувати для швидкого вимірювання складності сигналу.\n\nСинтаксис методу:\n\n**`fractal_sevcik(signal)`**\n\n**Параметри**\n\n- **signal** (*Union[list, np.array, pd.Series]*) --- сигнал (тобто часовий ряд) у вигляді вектора значень.\n\n**Повертає**\n\n- **SFD** (*float*) --- фрактальна розмірність Севчика для досліджуваного часового ряду;\n- **info** (*dict*) --- словник, що містить додаткову інформацію (наразі порожній, але повертається для узгодженості з іншими функціями).\n\n\n#### Віконна процедура\n\nРозпочинаємо віконну процедуру:\n\nЗберігаємо вихідні значення до текстового документа:\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результат:\n\nБачимо, що фрактальна розмірність Шевчика реагує спадом на крахові події на ринку золота. Особливо характерними є спади під час криз 2008, 2011, 2015 та 2020 років. Цінові флуктуації золота під час зазначених кризових подій також характеризувалися зростанням персистентності (кореляцій).\n\n### Обчислення фрактальної розмірності через нормалізовану щільність довжини\n\nЦе доволі простий показник, що відповідає середнім абсолютним послідовним різницям (стандартизованого) сигналу (`np.mean(np.abs(np.diff(std_signal)))`). Метод було розроблено для вимірювання складності сигналів дуже короткої тривалості (< 30 відліків), і його можна використовувати, наприклад, коли цікавлять неперервні зміни фрактальної розмірності сигналу при обчисленні в межах ковзних вікон.\n\nСинтаксис процедури:\n\n**`fractal_nld(signal, corrected=False)`**\n\n**Параметри:**\n\n- **signal** (*Union[list, np.array, pd.Series]*) --- сигнал (тобто часовий ряд) у вигляді вектора значень;\n- **corrected** (*bool*) --- якщо значення `True`, змінює масштаб вихідного значення фрактальної розмірності відповідно до степеневої моделі, щоб зробити його більш порівнянним з \"істинним\" значенням: `FD = 1.9079*((NLD-0.097178)^0.18383)`. Зауважте, що це може призвести до `np.nan`, якщо результат різниці буде від'ємним.\n\n**Повертає:**\n\n- **NLDFD** (*float*) --- фрактальна розмірність;\n- **info** (*dict*) --- словник із додатковою інформацією по розрахункам.\n\n\n#### Віконна процедура\n\nДля цього показника нам також не потребується нічого зайвого:\n\nРозпочинаємо віконну процедуру:\n\nЗберігаємо вихідні значення до текстового документа:\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результат:\n\n[@fig-gold-wind-nld] показує, що $NLDFD$ спадає під час кризових та передкризових подій, що свідчить про зростання кореляцій у дані періоди. \n\n### Обчислення фрактальної розмірності через нахил спектральної щільності потужності\n\nСкористаємось наступним методом бібліотеки `neurokit2`:\n\n**`fractal_psdslope(signal, method='voss1988', show=False, **kwargs)`**\n\n**Параметри:**\n\n- **signal** (*Union[list, np.array, pd.Series]*) --- сигнал (тобто часовий ряд) у вигляді вектора значень;\n- **method** (*str*) --- метод оцінки фрактальної розмірності за нахилом, може бути `\"voss1988\"` (за замовчуванням) або `\"hasselman2013\"`;\n- **show** (*bool*) --- якщо значення `True`, повертає графік залежності спектральної щільності потужності від частоти в логарифмічному масштабі;\n- **kwargs** --- інші аргументи, які слід передати до `signal_psd()`.\n\n**Повертає:**\n\n- **slope** (*float*) --- оцінка фрактальної розмірності, отримана в результаті аналізу нахилу спектральної щільності потужності;\n- **info** (*dict*) --- словник, що містить додаткову інформацію про параметри, які використовуються для аналізу нахилу спектральної щільності потужності.\n\n#### Для всього ряду\n\nДля подальших розрахунків спочатку виконаємо перетворення ряду. Будемо використовувати вихідний часовий ряд для подальших розрахунків: \n\nІ тепер виведемо графік залежності спектральної щільності потужності від частоти в логарифмічному масштабі:\n\nОчевидно, нахил спектральної щільності потужності на різних частотах має лінійну залежність, а кут нахилу прямої побудованої за спектром, близький до -2, що вказує на те, що динаміка індексу золота близька до дробового броунівського руху.\n\nТепер розглянемо варіацію кута нахилу спектра в рамках алгоритму ковзного вікна.\n\n#### Віконна процедура\n\nВстановимо наступні параметри:\n\nРозпочинаємо віконну процедуру:\n\nЗберігаємо вихідні значення до текстового документа:\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результат:\n\nРисунок вище показує, що даний показник також реагує спадом на кризові та передкризові події, вказуючи на зростання автокореляції часового ряду. Також зрозуміло, що має місце варіації нахилу спектра щільності потужності. В одні моменти часу динаміка сигналу може бути подібна до броунівського руху, а в інші до білого шуму.\n\n### Обчислення кореляційної розмірності\n\nКореляційна розмірність є нижньою границею оцінки фрактальної розмірності досліджуваного фазового простору.\n\nСпочатку здійснюється реконструкція фазового простору сигналу згідно методу часової затримки, і далі обчислюються відстані між усіма точками траєкторії. Потім обчислюється \"кореляційна сума\", яка є часткою пар точок, відстань між якими менша за заданий радіус. Остаточна кореляційна розмірність апроксимується графіком залежності кореляційної суми від радіусу багатовимірного околу досліджуваних траєкторій у логарифмічному масштабі.\n\nЦю розмірність можна викликати через `fractal_correlation()`. Її синтаксис виглядає наступним чином:\n\n**`fractal_correlation(signal, delay=1, dimension=2, radius=64, show=False, **kwargs)`**\n\n**Параметри:**\n\n- **signal** (*Union[list, np.array, pd.Series]*) --- сигнал (тобто часовий ряд) у вигляді вектора значень;\n- **delay** (*int*) --- часова затримка ($\\tau$);\n- **dimension** (*int*) --- розмірність вкладень ($m$);\n- **radius** (*Union[str, int, list]*) --- послідовність радіусів для перевірки. Якщо передано ціле число, буде отримано експоненціальну послідовність довжиною заданим скалярним значенням `radius` у межах від 2.5% до 50% від діапазону відстані. Методи, реалізовані в інших пакетах, можна використовувати, вказуючи `\"nolds\"`, `\"Corr_Dim\"` або `\"boon2008\"`;\n- **show** (*bool*) --- графік кореляційної розмірності, якщо `True`. За замовчуванням --- `False`;\n- **kwargs** --- інші аргументи для передачі (наразі не використовуються).\n\n**Повертає:**\n\n- **cd** (*float*) --- кореляційна розмірність часового ряду;\n- **info** (*dict*) --- словник, що містить додаткову інформацію про параметри, які використовуються для обчислення кореляційної розмірності.\n\n#### Для всього часового ряду\n\nРозглянемо залежність кореляційної суми від радіусу для всього часового ряду. Перш за все виконаємо перетворення ряду:\n\nТепер розрахуємо кореляційну розмірність, побудувавши залежність кореляційної суми від радіусу в логарифмічному масштабі:\n\nЯк ми можемо бачити, кореляційна сума дійсно має лінійну залежність для різних значень радіусу околу певної траєкторії, що вказує на фрактальність системи. Тепер подивимось як варіюється значення кореляційної розмірності в періоди турбулентності.\n\n#### Віконна процедура\n\nДля цього показника визначимо наступні параметри:\n\nРозпочинаємо віконну процедуру:\n\nЗберігаємо вихідні значення до текстового документа:\n\nОголошуємо мітки для рисунків та назви збережених рисунків:\n\nВиводимо результат:\n\n[@fig-gold-wind-cd] демонструє, що кореляційна розмірність для індексу золота також спадає у кризові та передкризові періоди, вказуючи на зростання корельованості теперішніх цін на золото з попередніми. Можна сказати й по іншому: у період криз трейдери починають самоорганізовуватись та колективно скупати або продавати відповідний актив; іншими словами, їх динаміка стає більш синхронною. Оскільки кореляційна розмірність вимірюється для траєкторій фазового простору, спад цього показника свідчить про зростання щільності досліджуваних траєкторій. Тобто, фазовий простір стає більш розрідженим, а всі його траєкторії концентрованими лише в одній конкретній області, що є індикатором згуртованості прихованих змінних досліджуваної системи.\n\n## Висновок\n\nУ даній лабораторній роботі було проаналізовано цінові коливання індексу золота з використанням спектра монофрактальних показників. Було показано, що дані методи є досить стійкими до нестаціонарності досілджуваного сигналу. Ринок золота характеризується зростаннями та спадами фрактальної розмірності, що вказує на варіацію ефективності його розвитку в різні моменти часу. Як уже зазначалось, спад фрактальної розмірності в кризовий або передкризовий стан ринку може вказувати на зростання ступеня періодизації (впорядкованості) системи. Зростання фрактальної розмірності може бути індикатором зростання невпорядкованості. У подальшій лабораторній роботі буде продемонстровано підхід, що дозволяє розраховувати спектр фрактальних показників, які можна отримати на різних просторово-часових масштабах системи.\n\n## Завдання для виконання\n\n1. Вибрати із запропонованої бази даних варіант завдання \n2. Виконати дослідження фрактальних характеристик заданих часових рядів. Зберегти результати в окремому файлі\n3. Порівняти значення коефіцієнтів Херста, одержаних методом R/S-аналізу та DFA\n4. Провести повний аналіз різних методів розрахунку монофрактальних розмірностей\n5. Дати інтерпретацію отриманим результатам\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"jupyter"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"number-sections":true,"highlight-style":"arrow","css":["style.css"],"output-file":"lab_6.html"},"language":{"toc-title-document":"Зміст","toc-title-website":"На цій сторінці","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Анотація","section-title-appendices":"Додатки","section-title-footnotes":"Зноски","section-title-references":"Використана література","section-title-reuse":"Повторне використання","section-title-copyright":"Copyright","section-title-citation":"Цитата","appendix-attribution-cite-as":"Будь-ласка, цитуйте цю роботу як:","appendix-attribution-bibtex":"BibTeX:","title-block-author-single":"Автор","title-block-author-plural":"Автори","title-block-affiliation-single":"Приналежність","title-block-affiliation-plural":"Приналежності","title-block-published":"Дата публікації","title-block-modified":"Змінено","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Код","code-tools-menu-caption":"Код","code-tools-show-all-code":"Розгорнути код","code-tools-hide-all-code":"Приховати код","code-tools-view-source":"Переглянути код","code-tools-source-code":"Вихідний код","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Копіювати","copy-button-tooltip-success":"Скопійовано!","repo-action-links-edit":"Редагувати сторінку","repo-action-links-source":"Переглянути код","repo-action-links-issue":"Повідомити про проблему","back-to-top":"Back to top","search-no-results-text":"Пошук не дав результату","search-matching-documents-text":"Результати пошуку","search-copy-link-title":"Скопіюйте посилання для пошуку","search-hide-matches-text":"Приховати додаткові результати","search-more-match-text":"Додатковий результат у цьому документі","search-more-matches-text":"Додаткові результати у цьому документі","search-clear-button-title":"Очистити","search-text-placeholder":"","search-detached-cancel-button-title":"Скасувати","search-submit-button-title":"Надіслати","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Рис.","crossref-tbl-title":"Таблиця","crossref-lst-title":"Список","crossref-thm-title":"Теорема","crossref-lem-title":"Лема","crossref-cor-title":"Наслідок","crossref-prp-title":"Твердження","crossref-cnj-title":"Гіпотеза","crossref-def-title":"Визначення","crossref-exm-title":"Приклад","crossref-exr-title":"Завдання","crossref-ch-prefix":"Глава","crossref-apx-prefix":"Додаток","crossref-sec-prefix":"Розділ","crossref-eq-prefix":"Рівняння","crossref-lof-title":"Список Рисунків","crossref-lot-title":"Список Таблиць","crossref-lol-title":"Список Каталогів","environment-proof-title":"Доведення","environment-remark-title":"Зауваження","environment-solution-title":"Рішення","listing-page-order-by":"Сортувати по","listing-page-order-by-default":"попередньо вибраний","listing-page-order-by-date-asc":"Найновіші","listing-page-order-by-date-desc":"Найстріші","listing-page-order-by-number-desc":"За спаданням","listing-page-order-by-number-asc":"За зростанням","listing-page-field-date":"Дата","listing-page-field-title":"Заголовок","listing-page-field-description":"Опис","listing-page-field-author":"Автор","listing-page-field-filename":"Ім'я файлу","listing-page-field-filemodified":"Змінено","listing-page-field-subtitle":"Підзаголовок","listing-page-field-readingtime":"Час читання","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Категорії","listing-page-minutes-compact":"{0} хвилин","listing-page-category-all":"Все","listing-page-no-matches":"Немає відповідних елементів","listing-page-words":"{0} words"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.4.551","bibliography":["references_main.bib"],"csl":"physical-review-b.csl","callout-appearance":"default","grid":{"body-width":"1050px"},"page-layout":"full","theme":{"light":"cosmo","dark":"superhero"},"title":"Лабораторна робота № 6"},"extensions":{"book":{"multiFile":true}}},"docx":{"identifier":{"display-name":"MS Word","target-format":"docx","base-format":"docx"},"execute":{"fig-width":5,"fig-height":4,"fig-format":"png","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"jupyter"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"docx","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"page-width":6.5},"pandoc":{"default-image-extension":"png","to":"docx","toc":true,"number-sections":true,"output-file":"lab_6.docx"},"language":{"toc-title-document":"Зміст","toc-title-website":"На цій сторінці","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Анотація","section-title-appendices":"Додатки","section-title-footnotes":"Зноски","section-title-references":"Використана література","section-title-reuse":"Повторне використання","section-title-copyright":"Copyright","section-title-citation":"Цитата","appendix-attribution-cite-as":"Будь-ласка, цитуйте цю роботу як:","appendix-attribution-bibtex":"BibTeX:","title-block-author-single":"Автор","title-block-author-plural":"Автори","title-block-affiliation-single":"Приналежність","title-block-affiliation-plural":"Приналежності","title-block-published":"Дата публікації","title-block-modified":"Змінено","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Код","code-tools-menu-caption":"Код","code-tools-show-all-code":"Розгорнути код","code-tools-hide-all-code":"Приховати код","code-tools-view-source":"Переглянути код","code-tools-source-code":"Вихідний код","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Копіювати","copy-button-tooltip-success":"Скопійовано!","repo-action-links-edit":"Редагувати сторінку","repo-action-links-source":"Переглянути код","repo-action-links-issue":"Повідомити про проблему","back-to-top":"Back to top","search-no-results-text":"Пошук не дав результату","search-matching-documents-text":"Результати пошуку","search-copy-link-title":"Скопіюйте посилання для пошуку","search-hide-matches-text":"Приховати додаткові результати","search-more-match-text":"Додатковий результат у цьому документі","search-more-matches-text":"Додаткові результати у цьому документі","search-clear-button-title":"Очистити","search-text-placeholder":"","search-detached-cancel-button-title":"Скасувати","search-submit-button-title":"Надіслати","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Рис.","crossref-tbl-title":"Таблиця","crossref-lst-title":"Список","crossref-thm-title":"Теорема","crossref-lem-title":"Лема","crossref-cor-title":"Наслідок","crossref-prp-title":"Твердження","crossref-cnj-title":"Гіпотеза","crossref-def-title":"Визначення","crossref-exm-title":"Приклад","crossref-exr-title":"Завдання","crossref-ch-prefix":"Глава","crossref-apx-prefix":"Додаток","crossref-sec-prefix":"Розділ","crossref-eq-prefix":"Рівняння","crossref-lof-title":"Список Рисунків","crossref-lot-title":"Список Таблиць","crossref-lol-title":"Список Каталогів","environment-proof-title":"Доведення","environment-remark-title":"Зауваження","environment-solution-title":"Рішення","listing-page-order-by":"Сортувати по","listing-page-order-by-default":"попередньо вибраний","listing-page-order-by-date-asc":"Найновіші","listing-page-order-by-date-desc":"Найстріші","listing-page-order-by-number-desc":"За спаданням","listing-page-order-by-number-asc":"За зростанням","listing-page-field-date":"Дата","listing-page-field-title":"Заголовок","listing-page-field-description":"Опис","listing-page-field-author":"Автор","listing-page-field-filename":"Ім'я файлу","listing-page-field-filemodified":"Змінено","listing-page-field-subtitle":"Підзаголовок","listing-page-field-readingtime":"Час читання","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Категорії","listing-page-minutes-compact":"{0} хвилин","listing-page-category-all":"Все","listing-page-no-matches":"Немає відповідних елементів","listing-page-words":"{0} words"},"metadata":{"bibliography":["references_main.bib"],"csl":"physical-review-b.csl","callout-appearance":"default","fontsize":14,"title":"Лабораторна робота № 6"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","docx"]}